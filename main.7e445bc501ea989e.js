(self.webpackChunkamazon_clone_app=self.webpackChunkamazon_clone_app||[]).push([[179],{4423:(fe,F,S)=>{"use strict";var E={};function p(e){return"function"==typeof e}function O(e){const n=e(r=>{Error.call(r),r.stack=(new Error).stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}S.r(E),S.d(E,{hasBrowserEnv:()=>cD,hasStandardBrowserEnv:()=>E4,hasStandardBrowserWebWorkerEnv:()=>w4});const R=O(e=>function(n){e(this),this.message=n?`${n.length} errors occurred during unsubscription:\n${n.map((r,o)=>`${o+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=n});function $(e,t){if(e){const n=e.indexOf(t);0<=n&&e.splice(n,1)}}class H{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(const i of n)i.remove(this);else n.remove(this);const{initialTeardown:r}=this;if(p(r))try{r()}catch(i){t=i instanceof R?i.errors:[i]}const{_finalizers:o}=this;if(o){this._finalizers=null;for(const i of o)try{M(i)}catch(s){t=t??[],s instanceof R?t=[...t,...s.errors]:t.push(s)}}if(t)throw new R(t)}}add(t){var n;if(t&&t!==this)if(this.closed)M(t);else{if(t instanceof H){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}}_hasParent(t){const{_parentage:n}=this;return n===t||Array.isArray(n)&&n.includes(t)}_addParent(t){const{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t}_removeParent(t){const{_parentage:n}=this;n===t?this._parentage=null:Array.isArray(n)&&$(n,t)}remove(t){const{_finalizers:n}=this;n&&$(n,t),t instanceof H&&t._removeParent(this)}}H.EMPTY=(()=>{const e=new H;return e.closed=!0,e})();const B=H.EMPTY;function g(e){return e instanceof H||e&&"closed"in e&&p(e.remove)&&p(e.add)&&p(e.unsubscribe)}function M(e){p(e)?e():e.unsubscribe()}const D={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},V={setTimeout(e,t,...n){const{delegate:r}=V;return r?.setTimeout?r.setTimeout(e,t,...n):setTimeout(e,t,...n)},clearTimeout(e){const{delegate:t}=V;return(t?.clearTimeout||clearTimeout)(e)},delegate:void 0};function J(e){V.setTimeout(()=>{const{onUnhandledError:t}=D;if(!t)throw e;t(e)})}function z(){}const C=w("C",void 0,void 0);function w(e,t,n){return{kind:e,value:t,error:n}}let j=null;function _(e){if(D.useDeprecatedSynchronousErrorHandling){const t=!j;if(t&&(j={errorThrown:!1,error:null}),e(),t){const{errorThrown:n,error:r}=j;if(j=null,n)throw r}}else e()}class U extends H{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,g(t)&&t.add(this)):this.destination=Ee}static create(t,n,r){return new ie(t,n,r)}next(t){this.isStopped?De(function K(e){return w("N",e,void 0)}(t),this):this._next(t)}error(t){this.isStopped?De(function k(e){return w("E",void 0,e)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?De(C,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const q=Function.prototype.bind;function te(e,t){return q.call(e,t)}class se{constructor(t){this.partialObserver=t}next(t){const{partialObserver:n}=this;if(n.next)try{n.next(t)}catch(r){ce(r)}}error(t){const{partialObserver:n}=this;if(n.error)try{n.error(t)}catch(r){ce(r)}else ce(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(n){ce(n)}}}class ie extends U{constructor(t,n,r){let o;if(super(),p(t)||!t)o={next:t??void 0,error:n??void 0,complete:r??void 0};else{let i;this&&D.useDeprecatedNextContext?(i=Object.create(t),i.unsubscribe=()=>this.unsubscribe(),o={next:t.next&&te(t.next,i),error:t.error&&te(t.error,i),complete:t.complete&&te(t.complete,i)}):o=t}this.destination=new se(o)}}function ce(e){D.useDeprecatedSynchronousErrorHandling?function b(e){D.useDeprecatedSynchronousErrorHandling&&j&&(j.errorThrown=!0,j.error=e)}(e):J(e)}function De(e,t){const{onStoppedNotification:n}=D;n&&V.setTimeout(()=>n(e,t))}const Ee={closed:!0,next:z,error:function me(e){throw e},complete:z},He="function"==typeof Symbol&&Symbol.observable||"@@observable";function Be(e){return e}function pe(e){return 0===e.length?Be:1===e.length?e[0]:function(n){return e.reduce((r,o)=>o(r),n)}}let G=(()=>{class e{constructor(n){n&&(this._subscribe=n)}lift(n){const r=new e;return r.source=this,r.operator=n,r}subscribe(n,r,o){const i=function ue(e){return e&&e instanceof U||function ee(e){return e&&p(e.next)&&p(e.error)&&p(e.complete)}(e)&&g(e)}(n)?n:new ie(n,r,o);return _(()=>{const{operator:s,source:a}=this;i.add(s?s.call(i,a):a?this._subscribe(i):this._trySubscribe(i))}),i}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return new(r=oe(r))((o,i)=>{const s=new ie({next:a=>{try{n(a)}catch(l){i(l),s.unsubscribe()}},error:i,complete:o});this.subscribe(s)})}_subscribe(n){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(n)}[He](){return this}pipe(...n){return pe(n)(this)}toPromise(n){return new(n=oe(n))((r,o)=>{let i;this.subscribe(s=>i=s,s=>o(s),()=>r(i))})}}return e.create=t=>new e(t),e})();function oe(e){var t;return null!==(t=e??D.Promise)&&void 0!==t?t:Promise}const m=O(e=>function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let T=(()=>{class e extends G{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){const r=new N(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new m}next(n){_(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const r of this.currentObservers)r.next(n)}})}error(n){_(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;const{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){_(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return(null===(n=this.observers)||void 0===n?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){const{hasError:r,isStopped:o,observers:i}=this;return r||o?B:(this.currentObservers=null,i.push(n),new H(()=>{this.currentObservers=null,$(i,n)}))}_checkFinalizedStatuses(n){const{hasError:r,thrownError:o,isStopped:i}=this;r?n.error(o):i&&n.complete()}asObservable(){const n=new G;return n.source=this,n}}return e.create=(t,n)=>new N(t,n),e})();class N extends T{constructor(t,n){super(),this.destination=t,this.source=n}next(t){var n,r;null===(r=null===(n=this.destination)||void 0===n?void 0:n.next)||void 0===r||r.call(n,t)}error(t){var n,r;null===(r=null===(n=this.destination)||void 0===n?void 0:n.error)||void 0===r||r.call(n,t)}complete(){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===n||n.call(t)}_subscribe(t){var n,r;return null!==(r=null===(n=this.source)||void 0===n?void 0:n.subscribe(t))&&void 0!==r?r:B}}function le(e){return p(e?.lift)}function Ce(e){return t=>{if(le(t))return t.lift(function(n){try{return e(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Me(e,t,n,r,o){return new Ke(e,t,n,r,o)}class Ke extends U{constructor(t,n,r,o,i,s){super(t),this.onFinalize=i,this.shouldUnsubscribe=s,this._next=n?function(a){try{n(a)}catch(l){t.error(l)}}:super._next,this._error=o?function(a){try{o(a)}catch(l){t.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){t.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:n}=this;super.unsubscribe(),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function be(e,t){return Ce((n,r)=>{let o=0;n.subscribe(Me(r,i=>{r.next(e.call(t,i,o++))}))})}var xe=S(7582);const ft=e=>e&&"number"==typeof e.length&&"function"!=typeof e;function Ge(e){return p(e?.then)}function tn(e){return p(e[He])}function qt(e){return Symbol.asyncIterator&&p(e?.[Symbol.asyncIterator])}function ut(e){return new TypeError(`You provided ${null!==e&&"object"==typeof e?"an invalid object":`'${e}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const ur=function tt(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function qn(e){return p(e?.[ur])}function Re(e){return(0,xe.__asyncGenerator)(this,arguments,function*(){const n=e.getReader();try{for(;;){const{value:r,done:o}=yield(0,xe.__await)(n.read());if(o)return yield(0,xe.__await)(void 0);yield yield(0,xe.__await)(r)}}finally{n.releaseLock()}})}function qr(e){return p(e?.getReader)}function vn(e){if(e instanceof G)return e;if(null!=e){if(tn(e))return function ei(e){return new G(t=>{const n=e[He]();if(p(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(ft(e))return function Kn(e){return new G(t=>{for(let n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}(e);if(Ge(e))return function dr(e){return new G(t=>{e.then(n=>{t.closed||(t.next(n),t.complete())},n=>t.error(n)).then(null,J)})}(e);if(qt(e))return Cn(e);if(qn(e))return function Fn(e){return new G(t=>{for(const n of e)if(t.next(n),t.closed)return;t.complete()})}(e);if(qr(e))return function Oo(e){return Cn(Re(e))}(e)}throw ut(e)}function Cn(e){return new G(t=>{(function Y(e,t){var n,r,o,i;return(0,xe.__awaiter)(this,void 0,void 0,function*(){try{for(n=(0,xe.__asyncValues)(e);!(r=yield n.next()).done;)if(t.next(r.value),t.closed)return}catch(s){o={error:s}}finally{try{r&&!r.done&&(i=n.return)&&(yield i.call(n))}finally{if(o)throw o.error}}t.complete()})})(e,t).catch(n=>t.error(n))})}function I(e,t,n,r=0,o=!1){const i=t.schedule(function(){n(),o?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(i),!o)return i}function X(e,t,n=1/0){return p(t)?X((r,o)=>be((i,s)=>t(r,i,o,s))(vn(e(r,o))),n):("number"==typeof t&&(n=t),Ce((r,o)=>function P(e,t,n,r,o,i,s,a){const l=[];let h=0,f=0,v=!1;const x=()=>{v&&!l.length&&!h&&t.complete()},W=ae=>h<r?ne(ae):l.push(ae),ne=ae=>{i&&t.next(ae),h++;let _e=!1;vn(n(ae,f++)).subscribe(Me(t,Ae=>{o?.(Ae),i?W(Ae):t.next(Ae)},()=>{_e=!0},void 0,()=>{if(_e)try{for(h--;l.length&&h<r;){const Ae=l.shift();s?I(t,s,()=>ne(Ae)):ne(Ae)}x()}catch(Ae){t.error(Ae)}}))};return e.subscribe(Me(t,W,()=>{v=!0,x()})),()=>{a?.()}}(r,o,e,n)))}function he(e=1/0){return X(Be,e)}const ye=new G(e=>e.complete());function wt(e){return e[e.length-1]}function Gt(e){return p(wt(e))?e.pop():void 0}function St(e){return function Kt(e){return e&&p(e.schedule)}(wt(e))?e.pop():void 0}function hs(e,t=0){return Ce((n,r)=>{n.subscribe(Me(r,o=>I(r,e,()=>r.next(o),t),()=>I(r,e,()=>r.complete(),t),o=>I(r,e,()=>r.error(o),t)))})}function Hl(e,t=0){return Ce((n,r)=>{r.add(e.schedule(()=>n.subscribe(r),t))})}function Vl(e,t){if(!e)throw new Error("Iterable cannot be null");return new G(n=>{I(n,t,()=>{const r=e[Symbol.asyncIterator]();I(n,t,()=>{r.next().then(o=>{o.done?n.complete():n.next(o.value)})},0,!0)})})}function kt(e,t){return t?function pf(e,t){if(null!=e){if(tn(e))return function ff(e,t){return vn(e).pipe(Hl(t),hs(t))}(e,t);if(ft(e))return function ti(e,t){return new G(n=>{let r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}(e,t);if(Ge(e))return function Ba(e,t){return vn(e).pipe(Hl(t),hs(t))}(e,t);if(qt(e))return Vl(e,t);if(qn(e))return function $l(e,t){return new G(n=>{let r;return I(n,t,()=>{r=e[ur](),I(n,t,()=>{let o,i;try{({value:o,done:i}=r.next())}catch(s){return void n.error(s)}i?n.complete():n.next(o)},0,!0)}),()=>p(r?.return)&&r.return()})}(e,t);if(qr(e))return function zl(e,t){return Vl(Re(e),t)}(e,t)}throw ut(e)}(e,t):vn(e)}class An extends T{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const n=super._subscribe(t);return!n.closed&&t.next(this._value),n}getValue(){const{hasError:t,thrownError:n,_value:r}=this;if(t)throw n;return this._throwIfClosed(),r}next(t){super.next(this._value=t)}}function Xe(...e){return kt(e,St(e))}function ja(e={}){const{connector:t=(()=>new T),resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:o=!0}=e;return i=>{let s,a,l,h=0,f=!1,v=!1;const x=()=>{a?.unsubscribe(),a=void 0},W=()=>{x(),s=l=void 0,f=v=!1},ne=()=>{const ae=s;W(),ae?.unsubscribe()};return Ce((ae,_e)=>{h++,!v&&!f&&x();const Ae=l=l??t();_e.add(()=>{h--,0===h&&!v&&!f&&(a=Ha(ne,o))}),Ae.subscribe(_e),!s&&h>0&&(s=new ie({next:ve=>Ae.next(ve),error:ve=>{v=!0,x(),a=Ha(W,n,ve),Ae.error(ve)},complete:()=>{f=!0,x(),a=Ha(W,r),Ae.complete()}}),vn(ae).subscribe(s))})(i)}}function Ha(e,t,...n){if(!0===t)return void e();if(!1===t)return;const r=new ie({next:()=>{r.unsubscribe(),e()}});return vn(t(...n)).subscribe(r)}function br(e,t){return Ce((n,r)=>{let o=null,i=0,s=!1;const a=()=>s&&!o&&r.complete();n.subscribe(Me(r,l=>{o?.unsubscribe();let h=0;const f=i++;vn(e(l,f)).subscribe(o=Me(r,v=>r.next(t?t(l,v,f,h++):v),()=>{o=null,a()}))},()=>{s=!0,a()}))})}function ni(e,t){return e===t}function Mt(e){for(let t in e)if(e[t]===Mt)return t;throw Error("Could not find renamed property on target object.")}function ri(e,t){for(const n in t)t.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function un(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(un).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;const t=e.toString();if(null==t)return""+t;const n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}function fs(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}const $a=Mt({__forward_ref__:Mt});function Rt(e){return e.__forward_ref__=Rt,e.toString=function(){return un(this())},e}function ot(e){return Oi(e)?e():e}function Oi(e){return"function"==typeof e&&e.hasOwnProperty($a)&&e.__forward_ref__===Rt}function oi(e){return e&&!!e.\u0275providers}const Gl="https://g.co/ng/security#xss";class Fe extends Error{constructor(t,n){super(function ki(e,t){return`NG0${Math.abs(e)}${t?": "+t:""}`}(t,n)),this.code=t}}function ct(e){return"string"==typeof e?e:null==e?"":String(e)}function Pi(e,t){throw new Fe(-201,!1)}function d(e,t){null==e&&function y(e,t,n,r){throw new Error(`ASSERTION ERROR: ${e}`+(null==r?"":` [Expected=> ${n} ${r} ${t} <=Actual]`))}(t,e,null,"!=")}function de(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function Se(e){return{providers:e.providers||[],imports:e.imports||[]}}function nt(e){return Bt(e,Ir)||Bt(e,ii)}function Bt(e,t){return e.hasOwnProperty(t)?e[t]:null}function En(e){return e&&(e.hasOwnProperty(hr)||e.hasOwnProperty(Ni))?e[hr]:null}const Ir=Mt({\u0275prov:Mt}),hr=Mt({\u0275inj:Mt}),ii=Mt({ngInjectableDef:Mt}),Ni=Mt({ngInjectorDef:Mt});var mt=function(e){return e[e.Default=0]="Default",e[e.Host=1]="Host",e[e.Self=2]="Self",e[e.SkipSelf=4]="SkipSelf",e[e.Optional=8]="Optional",e}(mt||{});let ps;function fr(e){const t=ps;return ps=e,t}function Gy(e,t,n){const r=nt(e);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&mt.Optional?null:void 0!==t?t:void Pi(un(e))}const Yt=globalThis;class Ve{constructor(t,n){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=de({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const za={},bf="__NG_DI_FLAG__",Wl="ngTempTokenPath",ZR=/\n/gm,Ky="__source";let gs;function si(e){const t=gs;return gs=e,t}function JR(e,t=mt.Default){if(void 0===gs)throw new Fe(-203,!1);return null===gs?Gy(e,void 0,t):gs.get(e,t&mt.Optional?null:void 0,t)}function qe(e,t=mt.Default){return(function zy(){return ps}()||JR)(ot(e),t)}function Ze(e,t=mt.Default){return qe(e,Zl(t))}function Zl(e){return typeof e>"u"||"number"==typeof e?e:0|(e.optional&&8)|(e.host&&1)|(e.self&&2)|(e.skipSelf&&4)}function If(e){const t=[];for(let n=0;n<e.length;n++){const r=ot(e[n]);if(Array.isArray(r)){if(0===r.length)throw new Fe(900,!1);let o,i=mt.Default;for(let s=0;s<r.length;s++){const a=r[s],l=XR(a);"number"==typeof l?-1===l?o=a.token:i|=l:o=a}t.push(qe(o,i))}else t.push(qe(r))}return t}function Ga(e,t){return e[bf]=t,e.prototype[bf]=t,e}function XR(e){return e[bf]}function Po(e){return{toString:e}.toString()}var Yl=function(e){return e[e.OnPush=0]="OnPush",e[e.Default=1]="Default",e}(Yl||{}),Wr=function(e){return e[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",e}(Wr||{});const lo={},Pt=[],Ql=Mt({\u0275cmp:Mt}),Sf=Mt({\u0275dir:Mt}),Tf=Mt({\u0275pipe:Mt}),Zy=Mt({\u0275mod:Mt}),No=Mt({\u0275fac:Mt}),qa=Mt({__NG_ELEMENT_ID__:Mt}),Yy=Mt({__NG_ENV_ID__:Mt});function Qy(e,t,n){let r=e.length;for(;;){const o=e.indexOf(t,n);if(-1===o)return o;if(0===o||e.charCodeAt(o-1)<=32){const i=t.length;if(o+i===r||e.charCodeAt(o+i)<=32)return o}n=o+1}}function Af(e,t,n){let r=0;for(;r<n.length;){const o=n[r];if("number"==typeof o){if(0!==o)break;r++;const i=n[r++],s=n[r++],a=n[r++];e.setAttribute(t,s,a,i)}else{const i=o,s=n[++r];Xy(i)?e.setProperty(t,i,s):e.setAttribute(t,i,s),r++}}return r}function Jy(e){return 3===e||4===e||6===e}function Xy(e){return 64===e.charCodeAt(0)}function Ka(e,t){if(null!==t&&0!==t.length)if(null===e||0===e.length)e=t.slice();else{let n=-1;for(let r=0;r<t.length;r++){const o=t[r];"number"==typeof o?n=o:0===n||ev(e,n,o,null,-1===n||2===n?t[++r]:null)}}return e}function ev(e,t,n,r,o){let i=0,s=e.length;if(-1===t)s=-1;else for(;i<e.length;){const a=e[i++];if("number"==typeof a){if(a===t){s=-1;break}if(a>t){s=i-1;break}}}for(;i<e.length;){const a=e[i];if("number"==typeof a)break;if(a===n){if(null===r)return void(null!==o&&(e[i+1]=o));if(r===e[i+1])return void(e[i+2]=o)}i++,null!==r&&i++,null!==o&&i++}-1!==s&&(e.splice(s,0,t),i=s+1),e.splice(i++,0,n),null!==r&&e.splice(i++,0,r),null!==o&&e.splice(i++,0,o)}const tv="ng-template";function nO(e,t,n){let r=0,o=!0;for(;r<e.length;){let i=e[r++];if("string"==typeof i&&o){const s=e[r++];if(n&&"class"===i&&-1!==Qy(s.toLowerCase(),t,0))return!0}else{if(1===i){for(;r<e.length&&"string"==typeof(i=e[r++]);)if(i.toLowerCase()===t)return!0;return!1}"number"==typeof i&&(o=!1)}}return!1}function nv(e){return 4===e.type&&e.value!==tv}function rO(e,t,n){return t===(4!==e.type||n?e.value:tv)}function oO(e,t,n){let r=4;const o=e.attrs||[],i=function aO(e){for(let t=0;t<e.length;t++)if(Jy(e[t]))return t;return e.length}(o);let s=!1;for(let a=0;a<t.length;a++){const l=t[a];if("number"!=typeof l){if(!s)if(4&r){if(r=2|1&r,""!==l&&!rO(e,l,n)||""===l&&1===t.length){if(Zr(r))return!1;s=!0}}else{const h=8&r?l:t[++a];if(8&r&&null!==e.attrs){if(!nO(e.attrs,h,n)){if(Zr(r))return!1;s=!0}continue}const v=iO(8&r?"class":l,o,nv(e),n);if(-1===v){if(Zr(r))return!1;s=!0;continue}if(""!==h){let x;x=v>i?"":o[v+1].toLowerCase();const W=8&r?x:null;if(W&&-1!==Qy(W,h,0)||2&r&&h!==x){if(Zr(r))return!1;s=!0}}}}else{if(!s&&!Zr(r)&&!Zr(l))return!1;if(s&&Zr(l))continue;s=!1,r=l|1&r}}return Zr(r)||s}function Zr(e){return 0==(1&e)}function iO(e,t,n,r){if(null===t)return-1;let o=0;if(r||!n){let i=!1;for(;o<t.length;){const s=t[o];if(s===e)return o;if(3===s||6===s)i=!0;else{if(1===s||2===s){let a=t[++o];for(;"string"==typeof a;)a=t[++o];continue}if(4===s)break;if(0===s){o+=4;continue}}o+=i?1:2}return-1}return function cO(e,t){let n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){const r=e[n];if("number"==typeof r)return-1;if(r===t)return n;n++}return-1}(t,e)}function rv(e,t,n=!1){for(let r=0;r<t.length;r++)if(oO(e,t[r],n))return!0;return!1}function lO(e,t){e:for(let n=0;n<t.length;n++){const r=t[n];if(e.length===r.length){for(let o=0;o<e.length;o++)if(e[o]!==r[o])continue e;return!0}}return!1}function ov(e,t){return e?":not("+t.trim()+")":t}function uO(e){let t=e[0],n=1,r=2,o="",i=!1;for(;n<e.length;){let s=e[n];if("string"==typeof s)if(2&r){const a=e[++n];o+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else 8&r?o+="."+s:4&r&&(o+=" "+s);else""!==o&&!Zr(s)&&(t+=ov(i,o),o=""),r=s,i=i||!Zr(r);n++}return""!==o&&(t+=ov(i,o)),t}function Sr(e){return Po(()=>{const t=sv(e),n={...t,decls:e.decls,vars:e.vars,template:e.template,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,onPush:e.changeDetection===Yl.OnPush,directiveDefs:null,pipeDefs:null,dependencies:t.standalone&&e.dependencies||null,getStandaloneInjector:null,signals:e.signals??!1,data:e.data||{},encapsulation:e.encapsulation||Wr.Emulated,styles:e.styles||Pt,_:null,schemas:e.schemas||null,tView:null,id:""};av(n);const r=e.dependencies;return n.directiveDefs=Jl(r,!1),n.pipeDefs=Jl(r,!0),n.id=function yO(e){let t=0;const n=[e.selectors,e.ngContentSelectors,e.hostVars,e.hostAttrs,e.consts,e.vars,e.decls,e.encapsulation,e.standalone,e.signals,e.exportAs,JSON.stringify(e.inputs),JSON.stringify(e.outputs),Object.getOwnPropertyNames(e.type.prototype),!!e.contentQueries,!!e.viewQuery].join("|");for(const o of n)t=Math.imul(31,t)+o.charCodeAt(0)<<0;return t+=2147483648,"c"+t}(n),n})}function pO(e){return Tt(e)||Rn(e)}function gO(e){return null!==e}function Bn(e){return Po(()=>({type:e.type,bootstrap:e.bootstrap||Pt,declarations:e.declarations||Pt,imports:e.imports||Pt,exports:e.exports||Pt,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null}))}function iv(e,t){if(null==e)return lo;const n={};for(const r in e)if(e.hasOwnProperty(r)){let o=e[r],i=o;Array.isArray(o)&&(i=o[1],o=o[0]),n[o]=r,t&&(t[o]=i)}return n}function lt(e){return Po(()=>{const t=sv(e);return av(t),t})}function pr(e){return{type:e.type,name:e.name,factory:null,pure:!1!==e.pure,standalone:!0===e.standalone,onDestroy:e.type.prototype.ngOnDestroy||null}}function Tt(e){return e[Ql]||null}function Rn(e){return e[Sf]||null}function Zn(e){return e[Tf]||null}function Tr(e,t){const n=e[Zy]||null;if(!n&&!0===t)throw new Error(`Type ${un(e)} does not have '\u0275mod' property.`);return n}function sv(e){const t={};return{type:e.type,providersResolver:null,factory:null,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:t,inputTransforms:null,inputConfig:e.inputs||lo,exportAs:e.exportAs||null,standalone:!0===e.standalone,signals:!0===e.signals,selectors:e.selectors||Pt,viewQuery:e.viewQuery||null,features:e.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:iv(e.inputs,t),outputs:iv(e.outputs)}}function av(e){e.features?.forEach(t=>t(e))}function Jl(e,t){if(!e)return null;const n=t?Zn:pO;return()=>("function"==typeof e?e():e).map(r=>n(r)).filter(gO)}const cn=0,Ye=1,_t=2,nn=3,Yr=4,Wa=5,jn=6,_s=7,dn=8,ai=9,ys=10,ht=11,Za=12,cv=13,vs=14,hn=15,Ya=16,Cs=17,uo=18,Qa=19,lv=20,ci=21,xo=22,Ja=23,Xa=24,bt=25,Df=1,uv=2,ho=7,Es=9,On=11;function gr(e){return Array.isArray(e)&&"object"==typeof e[Df]}function Yn(e){return Array.isArray(e)&&!0===e[Df]}function Mf(e){return 0!=(4&e.flags)}function xi(e){return e.componentOffset>-1}function eu(e){return 1==(1&e.flags)}function Qr(e){return!!e.template}function Rf(e){return 0!=(512&e[_t])}function Li(e,t){return e.hasOwnProperty(No)?e[No]:null}let kn=null,tu=!1;function Lr(e){const t=kn;return kn=e,t}const fv={version:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{}};function gv(e){if(!tc(e)||e.dirty){if(!e.producerMustRecompute(e)&&!yv(e))return void(e.dirty=!1);e.producerRecomputeValue(e),e.dirty=!1}}function _v(e){e.dirty=!0,function mv(e){if(void 0===e.liveConsumerNode)return;const t=tu;tu=!0;try{for(const n of e.liveConsumerNode)n.dirty||_v(n)}finally{tu=t}}(e),e.consumerMarkedDirty?.(e)}function kf(e){return e&&(e.nextProducerIndex=0),Lr(e)}function Pf(e,t){if(Lr(t),e&&void 0!==e.producerNode&&void 0!==e.producerIndexOfThis&&void 0!==e.producerLastReadVersion){if(tc(e))for(let n=e.nextProducerIndex;n<e.producerNode.length;n++)nu(e.producerNode[n],e.producerIndexOfThis[n]);for(;e.producerNode.length>e.nextProducerIndex;)e.producerNode.pop(),e.producerLastReadVersion.pop(),e.producerIndexOfThis.pop()}}function yv(e){ws(e);for(let t=0;t<e.producerNode.length;t++){const n=e.producerNode[t],r=e.producerLastReadVersion[t];if(r!==n.version||(gv(n),r!==n.version))return!0}return!1}function vv(e){if(ws(e),tc(e))for(let t=0;t<e.producerNode.length;t++)nu(e.producerNode[t],e.producerIndexOfThis[t]);e.producerNode.length=e.producerLastReadVersion.length=e.producerIndexOfThis.length=0,e.liveConsumerNode&&(e.liveConsumerNode.length=e.liveConsumerIndexOfThis.length=0)}function nu(e,t){if(function Ev(e){e.liveConsumerNode??=[],e.liveConsumerIndexOfThis??=[]}(e),ws(e),1===e.liveConsumerNode.length)for(let r=0;r<e.producerNode.length;r++)nu(e.producerNode[r],e.producerIndexOfThis[r]);const n=e.liveConsumerNode.length-1;if(e.liveConsumerNode[t]=e.liveConsumerNode[n],e.liveConsumerIndexOfThis[t]=e.liveConsumerIndexOfThis[n],e.liveConsumerNode.length--,e.liveConsumerIndexOfThis.length--,t<e.liveConsumerNode.length){const r=e.liveConsumerIndexOfThis[t],o=e.liveConsumerNode[t];ws(o),o.producerIndexOfThis[r]=t}}function tc(e){return e.consumerIsAlwaysLive||(e?.liveConsumerNode?.length??0)>0}function ws(e){e.producerNode??=[],e.producerIndexOfThis??=[],e.producerLastReadVersion??=[]}let wv=null;const Tv=()=>{},OO=(()=>({...fv,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:e=>{e.schedule(e.ref)},hasRun:!1,cleanupFn:Tv}))();class kO{constructor(t,n,r){this.previousValue=t,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}}function Ar(){return Av}function Av(e){return e.type.prototype.ngOnChanges&&(e.setInput=NO),PO}function PO(){const e=Mv(this),t=e?.current;if(t){const n=e.previous;if(n===lo)e.previous=t;else for(let r in t)n[r]=t[r];e.current=null,this.ngOnChanges(t)}}function NO(e,t,n,r){const o=this.declaredInputs[n],i=Mv(e)||function xO(e,t){return e[Dv]=t}(e,{previous:lo,current:null}),s=i.current||(i.current={}),a=i.previous,l=a[o];s[o]=new kO(l&&l.currentValue,t,a===lo),e[r]=t}Ar.ngInherit=!0;const Dv="__ngSimpleChanges__";function Mv(e){return e[Dv]||null}const fo=function(e,t,n){};function Qt(e){for(;Array.isArray(e);)e=e[cn];return e}function ru(e,t){return Qt(t[e])}function mr(e,t){return Qt(t[e.index])}function kv(e,t){return e.data[t]}function bs(e,t){return e[t]}function Dr(e,t){const n=t[e];return gr(n)?n:n[cn]}function ui(e,t){return null==t?null:e[t]}function Pv(e){e[Cs]=0}function HO(e){1024&e[_t]||(e[_t]|=1024,xv(e,1))}function Nv(e){1024&e[_t]&&(e[_t]&=-1025,xv(e,-1))}function xv(e,t){let n=e[nn];if(null===n)return;n[Wa]+=t;let r=n;for(n=n[nn];null!==n&&(1===t&&1===r[Wa]||-1===t&&0===r[Wa]);)n[Wa]+=t,r=n,n=n[nn]}const at={lFrame:qv(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Uv(){return at.bindingsEnabled}function Is(){return null!==at.skipHydrationRootTNode}function Le(){return at.lFrame.lView}function At(){return at.lFrame.tView}function Fi(e){return at.lFrame.contextLView=e,e[dn]}function Ui(e){return at.lFrame.contextLView=null,e}function Pn(){let e=Bv();for(;null!==e&&64===e.type;)e=e.parent;return e}function Bv(){return at.lFrame.currentTNode}function po(e,t){const n=at.lFrame;n.currentTNode=e,n.isParent=t}function Uf(){return at.lFrame.isParent}function Bf(){at.lFrame.isParent=!1}function Qn(){const e=at.lFrame;let t=e.bindingRootIndex;return-1===t&&(t=e.bindingRootIndex=e.tView.bindingStartIndex),t}function Ss(){return at.lFrame.bindingIndex++}function XO(e,t){const n=at.lFrame;n.bindingIndex=n.bindingRootIndex=e,jf(t)}function jf(e){at.lFrame.currentDirectiveIndex=e}function Vv(){return at.lFrame.currentQueryIndex}function $f(e){at.lFrame.currentQueryIndex=e}function tk(e){const t=e[Ye];return 2===t.type?t.declTNode:1===t.type?e[jn]:null}function zv(e,t,n){if(n&mt.SkipSelf){let o=t,i=e;for(;!(o=o.parent,null!==o||n&mt.Host||(o=tk(i),null===o||(i=i[vs],10&o.type))););if(null===o)return!1;t=o,e=i}const r=at.lFrame=Gv();return r.currentTNode=t,r.lView=e,!0}function Vf(e){const t=Gv(),n=e[Ye];at.lFrame=t,t.currentTNode=n.firstChild,t.lView=e,t.tView=n,t.contextLView=e,t.bindingIndex=n.bindingStartIndex,t.inI18n=!1}function Gv(){const e=at.lFrame,t=null===e?null:e.child;return null===t?qv(e):t}function qv(e){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function Kv(){const e=at.lFrame;return at.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}const Wv=Kv;function zf(){const e=Kv();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function Jn(){return at.lFrame.selectedIndex}function Bi(e){at.lFrame.selectedIndex=e}function sn(){const e=at.lFrame;return kv(e.tView,e.selectedIndex)}let Yv=!0;function ou(){return Yv}function di(e){Yv=e}function iu(e,t){for(let n=t.directiveStart,r=t.directiveEnd;n<r;n++){const i=e.data[n].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:h,ngOnDestroy:f}=i;s&&(e.contentHooks??=[]).push(-n,s),a&&((e.contentHooks??=[]).push(n,a),(e.contentCheckHooks??=[]).push(n,a)),l&&(e.viewHooks??=[]).push(-n,l),h&&((e.viewHooks??=[]).push(n,h),(e.viewCheckHooks??=[]).push(n,h)),null!=f&&(e.destroyHooks??=[]).push(n,f)}}function su(e,t,n){Qv(e,t,3,n)}function au(e,t,n,r){(3&e[_t])===n&&Qv(e,t,n,r)}function Gf(e,t){let n=e[_t];(3&n)===t&&(n&=8191,n+=1,e[_t]=n)}function Qv(e,t,n,r){const i=r??-1,s=t.length-1;let a=0;for(let l=void 0!==r?65535&e[Cs]:0;l<s;l++)if("number"==typeof t[l+1]){if(a=t[l],null!=r&&a>=r)break}else t[l]<0&&(e[Cs]+=65536),(a<i||-1==i)&&(lk(e,n,t,l),e[Cs]=(4294901760&e[Cs])+l+2),l++}function Jv(e,t){fo(4,e,t);const n=Lr(null);try{t.call(e)}finally{Lr(n),fo(5,e,t)}}function lk(e,t,n,r){const o=n[r]<0,i=n[r+1],a=e[o?-n[r]:n[r]];o?e[_t]>>13<e[Cs]>>16&&(3&e[_t])===t&&(e[_t]+=8192,Jv(a,i)):Jv(a,i)}const Ts=-1;class rc{constructor(t,n,r){this.factory=t,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}}function Kf(e){return e!==Ts}function oc(e){return 32767&e}function ic(e,t){let n=function fk(e){return e>>16}(e),r=t;for(;n>0;)r=r[vs],n--;return r}let Wf=!0;function cu(e){const t=Wf;return Wf=e,t}const Xv=255,eC=5;let pk=0;const go={};function lu(e,t){const n=tC(e,t);if(-1!==n)return n;const r=t[Ye];r.firstCreatePass&&(e.injectorIndex=t.length,Zf(r.data,e),Zf(t,null),Zf(r.blueprint,null));const o=uu(e,t),i=e.injectorIndex;if(Kf(o)){const s=oc(o),a=ic(o,t),l=a[Ye].data;for(let h=0;h<8;h++)t[i+h]=a[s+h]|l[s+h]}return t[i+8]=o,i}function Zf(e,t){e.push(0,0,0,0,0,0,0,0,t)}function tC(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function uu(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let n=0,r=null,o=t;for(;null!==o;){if(r=cC(o),null===r)return Ts;if(n++,o=o[vs],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return Ts}function Yf(e,t,n){!function gk(e,t,n){let r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(qa)&&(r=n[qa]),null==r&&(r=n[qa]=pk++);const o=r&Xv;t.data[e+(o>>eC)]|=1<<o}(e,t,n)}function nC(e,t,n){if(n&mt.Optional||void 0!==e)return e;Pi()}function rC(e,t,n,r){if(n&mt.Optional&&void 0===r&&(r=null),!(n&(mt.Self|mt.Host))){const o=e[ai],i=fr(void 0);try{return o?o.get(t,r,n&mt.Optional):Gy(t,r,n&mt.Optional)}finally{fr(i)}}return nC(r,0,n)}function oC(e,t,n,r=mt.Default,o){if(null!==e){if(2048&t[_t]&&!(r&mt.Self)){const s=function Ek(e,t,n,r,o){let i=e,s=t;for(;null!==i&&null!==s&&2048&s[_t]&&!(512&s[_t]);){const a=iC(i,s,n,r|mt.Self,go);if(a!==go)return a;let l=i.parent;if(!l){const h=s[lv];if(h){const f=h.get(n,go,r);if(f!==go)return f}l=cC(s),s=s[vs]}i=l}return o}(e,t,n,r,go);if(s!==go)return s}const i=iC(e,t,n,r,go);if(i!==go)return i}return rC(t,n,r,o)}function iC(e,t,n,r,o){const i=function yk(e){if("string"==typeof e)return e.charCodeAt(0)||0;const t=e.hasOwnProperty(qa)?e[qa]:void 0;return"number"==typeof t?t>=0?t&Xv:Ck:t}(n);if("function"==typeof i){if(!zv(t,e,r))return r&mt.Host?nC(o,0,r):rC(t,n,r,o);try{let s;if(s=i(r),null!=s||r&mt.Optional)return s;Pi()}finally{Wv()}}else if("number"==typeof i){let s=null,a=tC(e,t),l=Ts,h=r&mt.Host?t[hn][jn]:null;for((-1===a||r&mt.SkipSelf)&&(l=-1===a?uu(e,t):t[a+8],l!==Ts&&aC(r,!1)?(s=t[Ye],a=oc(l),t=ic(l,t)):a=-1);-1!==a;){const f=t[Ye];if(sC(i,a,f.data)){const v=_k(a,t,n,s,r,h);if(v!==go)return v}l=t[a+8],l!==Ts&&aC(r,t[Ye].data[a+8]===h)&&sC(i,a,t)?(s=f,a=oc(l),t=ic(l,t)):a=-1}}return o}function _k(e,t,n,r,o,i){const s=t[Ye],a=s.data[e+8],f=du(a,s,n,null==r?xi(a)&&Wf:r!=s&&0!=(3&a.type),o&mt.Host&&i===a);return null!==f?ji(t,s,f,a):go}function du(e,t,n,r,o){const i=e.providerIndexes,s=t.data,a=1048575&i,l=e.directiveStart,f=i>>20,x=o?a+f:e.directiveEnd;for(let W=r?a:a+f;W<x;W++){const ne=s[W];if(W<l&&n===ne||W>=l&&ne.type===n)return W}if(o){const W=s[l];if(W&&Qr(W)&&W.type===n)return l}return null}function ji(e,t,n,r){let o=e[n];const i=t.data;if(function uk(e){return e instanceof rc}(o)){const s=o;s.resolving&&function _f(e,t){const n=t?`. Dependency path: ${t.join(" > ")} > ${e}`:"";throw new Fe(-200,`Circular dependency in DI detected for ${e}${n}`)}(function Ot(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():ct(e)}(i[n]));const a=cu(s.canSeeViewProviders);s.resolving=!0;const h=s.injectImpl?fr(s.injectImpl):null;zv(e,r,mt.Default);try{o=e[n]=s.factory(void 0,i,e,r),t.firstCreatePass&&n>=r.directiveStart&&function ck(e,t,n){const{ngOnChanges:r,ngOnInit:o,ngDoCheck:i}=t.type.prototype;if(r){const s=Av(t);(n.preOrderHooks??=[]).push(e,s),(n.preOrderCheckHooks??=[]).push(e,s)}o&&(n.preOrderHooks??=[]).push(0-e,o),i&&((n.preOrderHooks??=[]).push(e,i),(n.preOrderCheckHooks??=[]).push(e,i))}(n,i[n],t)}finally{null!==h&&fr(h),cu(a),s.resolving=!1,Wv()}}return o}function sC(e,t,n){return!!(n[t+(e>>eC)]&1<<e)}function aC(e,t){return!(e&mt.Self||e&mt.Host&&t)}class Xn{constructor(t,n){this._tNode=t,this._lView=n}get(t,n,r){return oC(this._tNode,this._lView,t,Zl(r),n)}}function Ck(){return new Xn(Pn(),Le())}function Qf(e){return Oi(e)?()=>{const t=Qf(ot(e));return t&&t()}:Li(e)}function cC(e){const t=e[Ye],n=t.type;return 2===n?t.declTNode:1===n?e[jn]:null}function ac(e){return function mk(e,t){if("class"===t)return e.classes;if("style"===t)return e.styles;const n=e.attrs;if(n){const r=n.length;let o=0;for(;o<r;){const i=n[o];if(Jy(i))break;if(0===i)o+=2;else if("number"==typeof i)for(o++;o<r&&"string"==typeof n[o];)o++;else{if(i===t)return n[o+1];o+=2}}}return null}(Pn(),e)}const Ds="__parameters__";function Rs(e,t,n){return Po(()=>{const r=function Jf(e){return function(...n){if(e){const r=e(...n);for(const o in r)this[o]=r[o]}}}(t);function o(...i){if(this instanceof o)return r.apply(this,i),this;const s=new o(...i);return a.annotation=s,a;function a(l,h,f){const v=l.hasOwnProperty(Ds)?l[Ds]:Object.defineProperty(l,Ds,{value:[]})[Ds];for(;v.length<=f;)v.push(null);return(v[f]=v[f]||[]).push(s),l}}return n&&(o.prototype=Object.create(n.prototype)),o.prototype.ngMetadataName=e,o.annotationCls=o,o})}function ks(e,t){e.forEach(n=>Array.isArray(n)?ks(n,t):t(n))}function uC(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function hu(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function lc(e,t){const n=[];for(let r=0;r<e;r++)n.push(t);return n}function Mr(e,t,n){let r=Ps(e,t);return r>=0?e[1|r]=n:(r=~r,function Dk(e,t,n,r){let o=e.length;if(o==t)e.push(n,r);else if(1===o)e.push(r,e[0]),e[0]=n;else{for(o--,e.push(e[o-1],e[o]);o>t;)e[o]=e[o-2],o--;e[t]=n,e[t+1]=r}}(e,r,t,n)),r}function Xf(e,t){const n=Ps(e,t);if(n>=0)return e[1|n]}function Ps(e,t){return function dC(e,t,n){let r=0,o=e.length>>n;for(;o!==r;){const i=r+(o-r>>1),s=e[i<<n];if(t===s)return i<<n;s>t?o=i:r=i+1}return~(o<<n)}(e,t,1)}const Hi=Ga(Rs("Optional"),8),uc=Ga(Rs("SkipSelf"),4);function yu(e){return 128==(128&e.flags)}var hi=function(e){return e[e.Important=1]="Important",e[e.DashCase=2]="DashCase",e}(hi||{});const Zk=/^>|^->|<!--|-->|--!>|<!-$/g,Yk=/(<|>)/g,Qk="\u200b$1\u200b";const op=new Map;let Jk=0;const sp="__ngContext__";function Hn(e,t){gr(t)?(e[sp]=t[Qa],function eP(e){op.set(e[Qa],e)}(t)):e[sp]=t}let ap;function cp(e,t){return ap(e,t)}function fc(e){const t=e[nn];return Yn(t)?t[nn]:t}function OC(e){return PC(e[Za])}function kC(e){return PC(e[Yr])}function PC(e){for(;null!==e&&!Yn(e);)e=e[Yr];return e}function Ls(e,t,n,r,o){if(null!=r){let i,s=!1;Yn(r)?i=r:gr(r)&&(s=!0,r=r[cn]);const a=Qt(r);0===e&&null!==n?null==o?FC(t,n,a):$i(t,n,a,o||null,!0):1===e&&null!==n?$i(t,n,a,o||null,!0):2===e?function Su(e,t,n){const r=bu(e,t);r&&function vP(e,t,n,r){e.removeChild(t,n,r)}(e,r,t,n)}(t,a,s):3===e&&t.destroyNode(a),null!=i&&function wP(e,t,n,r,o){const i=n[ho];i!==Qt(n)&&Ls(t,e,r,i,o);for(let a=On;a<n.length;a++){const l=n[a];gc(l[Ye],l,e,t,r,i)}}(t,e,i,n,o)}}function lp(e,t){return e.createComment(function bC(e){return e.replace(Zk,t=>t.replace(Yk,Qk))}(t))}function Eu(e,t,n){return e.createElement(t,n)}function xC(e,t){const n=e[Es],r=n.indexOf(t);Nv(t),n.splice(r,1)}function wu(e,t){if(e.length<=On)return;const n=On+t,r=e[n];if(r){const o=r[Ya];null!==o&&o!==e&&xC(o,r),t>0&&(e[n-1][Yr]=r[Yr]);const i=hu(e,On+t);!function dP(e,t){gc(e,t,t[ht],2,null,null),t[cn]=null,t[jn]=null}(r[Ye],r);const s=i[uo];null!==s&&s.detachView(i[Ye]),r[nn]=null,r[Yr]=null,r[_t]&=-129}return r}function up(e,t){if(!(256&t[_t])){const n=t[ht];t[Ja]&&vv(t[Ja]),t[Xa]&&vv(t[Xa]),n.destroyNode&&gc(e,t,n,3,null,null),function pP(e){let t=e[Za];if(!t)return dp(e[Ye],e);for(;t;){let n=null;if(gr(t))n=t[Za];else{const r=t[On];r&&(n=r)}if(!n){for(;t&&!t[Yr]&&t!==e;)gr(t)&&dp(t[Ye],t),t=t[nn];null===t&&(t=e),gr(t)&&dp(t[Ye],t),n=t&&t[Yr]}t=n}}(t)}}function dp(e,t){if(!(256&t[_t])){t[_t]&=-129,t[_t]|=256,function yP(e,t){let n;if(null!=e&&null!=(n=e.destroyHooks))for(let r=0;r<n.length;r+=2){const o=t[n[r]];if(!(o instanceof rc)){const i=n[r+1];if(Array.isArray(i))for(let s=0;s<i.length;s+=2){const a=o[i[s]],l=i[s+1];fo(4,a,l);try{l.call(a)}finally{fo(5,a,l)}}else{fo(4,o,i);try{i.call(o)}finally{fo(5,o,i)}}}}}(e,t),function _P(e,t){const n=e.cleanup,r=t[_s];if(null!==n)for(let i=0;i<n.length-1;i+=2)if("string"==typeof n[i]){const s=n[i+3];s>=0?r[s]():r[-s].unsubscribe(),i+=2}else n[i].call(r[n[i+1]]);null!==r&&(t[_s]=null);const o=t[ci];if(null!==o){t[ci]=null;for(let i=0;i<o.length;i++)(0,o[i])()}}(e,t),1===t[Ye].type&&t[ht].destroy();const n=t[Ya];if(null!==n&&Yn(t[nn])){n!==t[nn]&&xC(n,t);const r=t[uo];null!==r&&r.detachView(e)}!function tP(e){op.delete(e[Qa])}(t)}}function hp(e,t,n){return function LC(e,t,n){let r=t;for(;null!==r&&40&r.type;)r=(t=r).parent;if(null===r)return n[cn];{const{componentOffset:o}=r;if(o>-1){const{encapsulation:i}=e.data[r.directiveStart+o];if(i===Wr.None||i===Wr.Emulated)return null}return mr(r,n)}}(e,t.parent,n)}function $i(e,t,n,r,o){e.insertBefore(t,n,r,o)}function FC(e,t,n){e.appendChild(t,n)}function UC(e,t,n,r,o){null!==r?$i(e,t,n,r,o):FC(e,t,n)}function bu(e,t){return e.parentNode(t)}function BC(e,t,n){return HC(e,t,n)}let fp,Tu,_p,Au,HC=function jC(e,t,n){return 40&e.type?mr(e,n):null};function Iu(e,t,n,r){const o=hp(e,r,t),i=t[ht],a=BC(r.parent||t[jn],r,t);if(null!=o)if(Array.isArray(n))for(let l=0;l<n.length;l++)UC(i,o,n[l],a,!1);else UC(i,o,n,a,!1);void 0!==fp&&fp(i,r,t,n,o)}function pc(e,t){if(null!==t){const n=t.type;if(3&n)return mr(t,e);if(4&n)return pp(-1,e[t.index]);if(8&n){const r=t.child;if(null!==r)return pc(e,r);{const o=e[t.index];return Yn(o)?pp(-1,o):Qt(o)}}if(32&n)return cp(t,e)()||Qt(e[t.index]);{const r=VC(e,t);return null!==r?Array.isArray(r)?r[0]:pc(fc(e[hn]),r):pc(e,t.next)}}return null}function VC(e,t){return null!==t?e[hn][jn].projection[t.projection]:null}function pp(e,t){const n=On+e+1;if(n<t.length){const r=t[n],o=r[Ye].firstChild;if(null!==o)return pc(r,o)}return t[ho]}function gp(e,t,n,r,o,i,s){for(;null!=n;){const a=r[n.index],l=n.type;if(s&&0===t&&(a&&Hn(Qt(a),r),n.flags|=2),32!=(32&n.flags))if(8&l)gp(e,t,n.child,r,o,i,!1),Ls(t,e,o,a,i);else if(32&l){const h=cp(n,r);let f;for(;f=h();)Ls(t,e,o,f,i);Ls(t,e,o,a,i)}else 16&l?GC(e,t,r,n,o,i):Ls(t,e,o,a,i);n=s?n.projectionNext:n.next}}function gc(e,t,n,r,o,i){gp(n,r,e.firstChild,t,o,i,!1)}function GC(e,t,n,r,o,i){const s=n[hn],l=s[jn].projection[r.projection];if(Array.isArray(l))for(let h=0;h<l.length;h++)Ls(t,e,o,l[h],i);else{let h=l;const f=s[nn];yu(r)&&(h.flags|=128),gp(e,t,h,f,o,i,!0)}}function qC(e,t,n){""===n?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n)}function KC(e,t,n){const{mergedAttrs:r,classes:o,styles:i}=n;null!==r&&Af(e,t,r),null!==o&&qC(e,t,o),null!==i&&function IP(e,t,n){e.setAttribute(t,"style",n)}(e,t,i)}function Fs(e){return function mp(){if(void 0===Tu&&(Tu=null,Yt.trustedTypes))try{Tu=Yt.trustedTypes.createPolicy("angular",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return Tu}()?.createHTML(e)||e}function Us(){if(void 0!==_p)return _p;if(typeof document<"u")return document;throw new Fe(210,!1)}function yp(){if(void 0===Au&&(Au=null,Yt.trustedTypes))try{Au=Yt.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return Au}function WC(e){return yp()?.createHTML(e)||e}function YC(e){return yp()?.createScriptURL(e)||e}class Vi{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Gl})`}}class MP extends Vi{getTypeName(){return"HTML"}}class RP extends Vi{getTypeName(){return"Style"}}class OP extends Vi{getTypeName(){return"Script"}}class kP extends Vi{getTypeName(){return"URL"}}class PP extends Vi{getTypeName(){return"ResourceURL"}}function Rr(e){return e instanceof Vi?e.changingThisBreaksApplicationSecurity:e}function mo(e,t){const n=function NP(e){return e instanceof Vi&&e.getTypeName()||null}(e);if(null!=n&&n!==t){if("ResourceURL"===n&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${n} (see ${Gl})`)}return n===t}class jP{constructor(t){this.inertDocumentHelper=t}getInertBodyElement(t){t="<body><remove></remove>"+t;try{const n=(new window.DOMParser).parseFromString(Fs(t),"text/html").body;return null===n?this.inertDocumentHelper.getInertBodyElement(t):(n.removeChild(n.firstChild),n)}catch{return null}}}class HP{constructor(t){this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(t){const n=this.inertDocument.createElement("template");return n.innerHTML=Fs(t),n}}const VP=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Du(e){return(e=String(e)).match(VP)?e:"unsafe:"+e}function Uo(e){const t={};for(const n of e.split(","))t[n]=!0;return t}function mc(...e){const t={};for(const n of e)for(const r in n)n.hasOwnProperty(r)&&(t[r]=!0);return t}const JC=Uo("area,br,col,hr,img,wbr"),XC=Uo("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),eE=Uo("rp,rt"),vp=mc(JC,mc(XC,Uo("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),mc(eE,Uo("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),mc(eE,XC)),Cp=Uo("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),tE=mc(Cp,Uo("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Uo("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),zP=Uo("script,style,template");class GP{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let n=t.firstChild,r=!0;for(;n;)if(n.nodeType===Node.ELEMENT_NODE?r=this.startElement(n):n.nodeType===Node.TEXT_NODE?this.chars(n.nodeValue):this.sanitizedSomething=!0,r&&n.firstChild)n=n.firstChild;else for(;n;){n.nodeType===Node.ELEMENT_NODE&&this.endElement(n);let o=this.checkClobberedElement(n,n.nextSibling);if(o){n=o;break}n=this.checkClobberedElement(n,n.parentNode)}return this.buf.join("")}startElement(t){const n=t.nodeName.toLowerCase();if(!vp.hasOwnProperty(n))return this.sanitizedSomething=!0,!zP.hasOwnProperty(n);this.buf.push("<"),this.buf.push(n);const r=t.attributes;for(let o=0;o<r.length;o++){const i=r.item(o),s=i.name,a=s.toLowerCase();if(!tE.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let l=i.value;Cp[a]&&(l=Du(l)),this.buf.push(" ",s,'="',nE(l),'"')}return this.buf.push(">"),!0}endElement(t){const n=t.nodeName.toLowerCase();vp.hasOwnProperty(n)&&!JC.hasOwnProperty(n)&&(this.buf.push("</"),this.buf.push(n),this.buf.push(">"))}chars(t){this.buf.push(nE(t))}checkClobberedElement(t,n){if(n&&(t.compareDocumentPosition(n)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`);return n}}const qP=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,KP=/([^\#-~ |!])/g;function nE(e){return e.replace(/&/g,"&amp;").replace(qP,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace(KP,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Mu;function rE(e,t){let n=null;try{Mu=Mu||function QC(e){const t=new HP(e);return function $P(){try{return!!(new window.DOMParser).parseFromString(Fs(""),"text/html")}catch{return!1}}()?new jP(t):t}(e);let r=t?String(t):"";n=Mu.getInertBodyElement(r);let o=5,i=r;do{if(0===o)throw new Error("Failed to sanitize html because the input is unstable");o--,r=i,i=n.innerHTML,n=Mu.getInertBodyElement(r)}while(r!==i);return Fs((new GP).sanitizeChildren(Ep(n)||n))}finally{if(n){const r=Ep(n)||n;for(;r.firstChild;)r.removeChild(r.firstChild)}}}function Ep(e){return"content"in e&&function WP(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var xn=function(e){return e[e.NONE=0]="NONE",e[e.HTML=1]="HTML",e[e.STYLE=2]="STYLE",e[e.SCRIPT=3]="SCRIPT",e[e.URL=4]="URL",e[e.RESOURCE_URL=5]="RESOURCE_URL",e}(xn||{});function Ru(e){const t=_c();return t?WC(t.sanitize(xn.HTML,e)||""):mo(e,"HTML")?WC(Rr(e)):rE(Us(),ct(e))}function Ou(e){const t=_c();return t?t.sanitize(xn.URL,e)||"":mo(e,"URL")?Rr(e):Du(ct(e))}function oE(e){const t=_c();if(t)return YC(t.sanitize(xn.RESOURCE_URL,e)||"");if(mo(e,"ResourceURL"))return YC(Rr(e));throw new Fe(904,!1)}function _c(){const e=Le();return e&&e[ys].sanitizer}const yc=new Ve("ENVIRONMENT_INITIALIZER"),sE=new Ve("INJECTOR",-1),aE=new Ve("INJECTOR_DEF_TYPES");class wp{get(t,n=za){if(n===za){const r=new Error(`NullInjectorError: No provider for ${un(t)}!`);throw r.name="NullInjectorError",r}return n}}function eN(...e){return{\u0275providers:cE(0,e),\u0275fromNgModule:!0}}function cE(e,...t){const n=[],r=new Set;let o;const i=s=>{n.push(s)};return ks(t,s=>{const a=s;ku(a,i,[],r)&&(o||=[],o.push(a))}),void 0!==o&&lE(o,i),n}function lE(e,t){for(let n=0;n<e.length;n++){const{ngModule:r,providers:o}=e[n];Ip(o,i=>{t(i,r)})}}function ku(e,t,n,r){if(!(e=ot(e)))return!1;let o=null,i=En(e);const s=!i&&Tt(e);if(i||s){if(s&&!s.standalone)return!1;o=e}else{const l=e.ngModule;if(i=En(l),!i)return!1;o=l}const a=r.has(o);if(s){if(a)return!1;if(r.add(o),s.dependencies){const l="function"==typeof s.dependencies?s.dependencies():s.dependencies;for(const h of l)ku(h,t,n,r)}}else{if(!i)return!1;{if(null!=i.imports&&!a){let h;r.add(o);try{ks(i.imports,f=>{ku(f,t,n,r)&&(h||=[],h.push(f))})}finally{}void 0!==h&&lE(h,t)}if(!a){const h=Li(o)||(()=>new o);t({provide:o,useFactory:h,deps:Pt},o),t({provide:aE,useValue:o,multi:!0},o),t({provide:yc,useValue:()=>qe(o),multi:!0},o)}const l=i.providers;if(null!=l&&!a){const h=e;Ip(l,f=>{t(f,h)})}}}return o!==e&&void 0!==e.providers}function Ip(e,t){for(let n of e)oi(n)&&(n=n.\u0275providers),Array.isArray(n)?Ip(n,t):t(n)}const tN=Mt({provide:String,useValue:Mt});function Sp(e){return null!==e&&"object"==typeof e&&tN in e}function zi(e){return"function"==typeof e}const Tp=new Ve("Set Injector scope."),Pu={},rN={};let Ap;function Nu(){return void 0===Ap&&(Ap=new wp),Ap}class Or{}class Bs extends Or{get destroyed(){return this._destroyed}constructor(t,n,r,o){super(),this.parent=n,this.source=r,this.scopes=o,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Mp(t,s=>this.processProvider(s)),this.records.set(sE,js(void 0,this)),o.has("environment")&&this.records.set(Or,js(void 0,this));const i=this.records.get(Tp);null!=i&&"string"==typeof i.value&&this.scopes.add(i.value),this.injectorDefTypes=new Set(this.get(aE.multi,Pt,mt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const n of this._ngOnDestroyHooks)n.ngOnDestroy();const t=this._onDestroyHooks;this._onDestroyHooks=[];for(const n of t)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(t){return this.assertNotDestroyed(),this._onDestroyHooks.push(t),()=>this.removeOnDestroy(t)}runInContext(t){this.assertNotDestroyed();const n=si(this),r=fr(void 0);try{return t()}finally{si(n),fr(r)}}get(t,n=za,r=mt.Default){if(this.assertNotDestroyed(),t.hasOwnProperty(Yy))return t[Yy](this);r=Zl(r);const i=si(this),s=fr(void 0);try{if(!(r&mt.SkipSelf)){let l=this.records.get(t);if(void 0===l){const h=function cN(e){return"function"==typeof e||"object"==typeof e&&e instanceof Ve}(t)&&nt(t);l=h&&this.injectableDefInScope(h)?js(Dp(t),Pu):null,this.records.set(t,l)}if(null!=l)return this.hydrate(t,l)}return(r&mt.Self?Nu():this.parent).get(t,n=r&mt.Optional&&n===za?null:n)}catch(a){if("NullInjectorError"===a.name){if((a[Wl]=a[Wl]||[]).unshift(un(t)),i)throw a;return function eO(e,t,n,r){const o=e[Wl];throw t[Ky]&&o.unshift(t[Ky]),e.message=function tO(e,t,n,r=null){e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.slice(2):e;let o=un(t);if(Array.isArray(t))o=t.map(un).join(" -> ");else if("object"==typeof t){let i=[];for(let s in t)if(t.hasOwnProperty(s)){let a=t[s];i.push(s+":"+("string"==typeof a?JSON.stringify(a):un(a)))}o=`{${i.join(", ")}}`}return`${n}${r?"("+r+")":""}[${o}]: ${e.replace(ZR,"\n  ")}`}("\n"+e.message,o,n,r),e.ngTokenPath=o,e[Wl]=null,e}(a,t,"R3InjectorError",this.source)}throw a}finally{fr(s),si(i)}}resolveInjectorInitializers(){const t=si(this),n=fr(void 0);try{const o=this.get(yc.multi,Pt,mt.Self);for(const i of o)i()}finally{si(t),fr(n)}}toString(){const t=[],n=this.records;for(const r of n.keys())t.push(un(r));return`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Fe(205,!1)}processProvider(t){let n=zi(t=ot(t))?t:ot(t&&t.provide);const r=function iN(e){return Sp(e)?js(void 0,e.useValue):js(hE(e),Pu)}(t);if(zi(t)||!0!==t.multi)this.records.get(n);else{let o=this.records.get(n);o||(o=js(void 0,Pu,!0),o.factory=()=>If(o.multi),this.records.set(n,o)),n=t,o.multi.push(t)}this.records.set(n,r)}hydrate(t,n){return n.value===Pu&&(n.value=rN,n.value=n.factory()),"object"==typeof n.value&&n.value&&function aN(e){return null!==e&&"object"==typeof e&&"function"==typeof e.ngOnDestroy}(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}injectableDefInScope(t){if(!t.providedIn)return!1;const n=ot(t.providedIn);return"string"==typeof n?"any"===n||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(t){const n=this._onDestroyHooks.indexOf(t);-1!==n&&this._onDestroyHooks.splice(n,1)}}function Dp(e){const t=nt(e),n=null!==t?t.factory:Li(e);if(null!==n)return n;if(e instanceof Ve)throw new Fe(204,!1);if(e instanceof Function)return function oN(e){const t=e.length;if(t>0)throw lc(t,"?"),new Fe(204,!1);const n=function Un(e){return e&&(e[Ir]||e[ii])||null}(e);return null!==n?()=>n.factory(e):()=>new e}(e);throw new Fe(204,!1)}function hE(e,t,n){let r;if(zi(e)){const o=ot(e);return Li(o)||Dp(o)}if(Sp(e))r=()=>ot(e.useValue);else if(function dE(e){return!(!e||!e.useFactory)}(e))r=()=>e.useFactory(...If(e.deps||[]));else if(function uE(e){return!(!e||!e.useExisting)}(e))r=()=>qe(ot(e.useExisting));else{const o=ot(e&&(e.useClass||e.provide));if(!function sN(e){return!!e.deps}(e))return Li(o)||Dp(o);r=()=>new o(...If(e.deps))}return r}function js(e,t,n=!1){return{factory:e,value:t,multi:n?[]:void 0}}function Mp(e,t){for(const n of e)Array.isArray(n)?Mp(n,t):n&&oi(n)?Mp(n.\u0275providers,t):t(n)}const xu=new Ve("AppId",{providedIn:"root",factory:()=>lN}),lN="ng",fE=new Ve("Platform Initializer"),fi=new Ve("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),Rp=new Ve("CSP nonce",{providedIn:"root",factory:()=>Us().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let pE=(e,t,n)=>null;function Up(e,t,n=!1){return pE(e,t,n)}class vN{}class _E{}class EN{resolveComponentFactory(t){throw function CN(e){const t=Error(`No component factory found for ${un(e)}.`);return t.ngComponent=e,t}(t)}}let Hu=(()=>{class e{static#e=this.NULL=new EN}return e})();function wN(){return Vs(Pn(),Le())}function Vs(e,t){return new er(mr(e,t))}let er=(()=>{class e{constructor(n){this.nativeElement=n}static#e=this.__NG_ELEMENT_ID__=wN}return e})();function bN(e){return e instanceof er?e.nativeElement:e}class vE{}let Bo=(()=>{class e{constructor(){this.destroyNode=null}static#e=this.__NG_ELEMENT_ID__=()=>function IN(){const e=Le(),n=Dr(Pn().index,e);return(gr(n)?n:e)[ht]}()}return e})(),SN=(()=>{class e{static#e=this.\u0275prov=de({token:e,providedIn:"root",factory:()=>null})}return e})();class Gi{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const TN=new Gi("16.2.12"),Hp={};function bE(e,t=null,n=null,r){const o=IE(e,t,n,r);return o.resolveInjectorInitializers(),o}function IE(e,t=null,n=null,r,o=new Set){const i=[n||Pt,eN(e)];return r=r||("object"==typeof e?void 0:un(e)),new Bs(i,t||Nu(),r||null,o)}let yr=(()=>{class e{static#e=this.THROW_IF_NOT_FOUND=za;static#t=this.NULL=new wp;static create(n,r){if(Array.isArray(n))return bE({name:""},r,n,"");{const o=n.name??"";return bE({name:o},n.parent,n.providers,o)}}static#n=this.\u0275prov=de({token:e,providedIn:"any",factory:()=>qe(sE)});static#r=this.__NG_ELEMENT_ID__=-1}return e})();function Vp(e){return e.ngOriginalError}class Ur{constructor(){this._console=console}handleError(t){const n=this._findOriginalError(t);this._console.error("ERROR",t),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(t){let n=t&&Vp(t);for(;n&&Vp(n);)n=Vp(n);return n||null}}function Gp(e){return t=>{setTimeout(e,void 0,t)}}const an=class PN extends T{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,n,r){let o=t,i=n||(()=>null),s=r;if(t&&"object"==typeof t){const l=t;o=l.next?.bind(l),i=l.error?.bind(l),s=l.complete?.bind(l)}this.__isAsync&&(i=Gp(i),o&&(o=Gp(o)),s&&(s=Gp(s)));const a=super.subscribe({next:o,error:i,complete:s});return t instanceof H&&t.add(a),a}};function TE(...e){}class Wt{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new an(!1),this.onMicrotaskEmpty=new an(!1),this.onStable=new an(!1),this.onError=new an(!1),typeof Zone>"u")throw new Fe(908,!1);Zone.assertZonePatched();const o=this;o._nesting=0,o._outer=o._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(o._inner=o._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(o._inner=o._inner.fork(Zone.longStackTraceZoneSpec)),o.shouldCoalesceEventChangeDetection=!r&&n,o.shouldCoalesceRunChangeDetection=r,o.lastRequestAnimationFrameId=-1,o.nativeRequestAnimationFrame=function NN(){const e="function"==typeof Yt.requestAnimationFrame;let t=Yt[e?"requestAnimationFrame":"setTimeout"],n=Yt[e?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&t&&n){const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r);const o=n[Zone.__symbol__("OriginalDelegate")];o&&(n=o)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:n}}().nativeRequestAnimationFrame,function FN(e){const t=()=>{!function LN(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(Yt,()=>{e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{e.lastRequestAnimationFrameId=-1,Kp(e),e.isCheckStableRunning=!0,qp(e),e.isCheckStableRunning=!1},void 0,()=>{},()=>{})),e.fakeTopEventTask.invoke()}),Kp(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,o,i,s,a)=>{if(function BN(e){return!(!Array.isArray(e)||1!==e.length)&&!0===e[0].data?.__ignore_ng_zone__}(a))return n.invokeTask(o,i,s,a);try{return AE(e),n.invokeTask(o,i,s,a)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===i.type||e.shouldCoalesceRunChangeDetection)&&t(),DE(e)}},onInvoke:(n,r,o,i,s,a,l)=>{try{return AE(e),n.invoke(o,i,s,a,l)}finally{e.shouldCoalesceRunChangeDetection&&t(),DE(e)}},onHasTask:(n,r,o,i)=>{n.hasTask(o,i),r===o&&("microTask"==i.change?(e._hasPendingMicrotasks=i.microTask,Kp(e),qp(e)):"macroTask"==i.change&&(e.hasPendingMacrotasks=i.macroTask))},onHandleError:(n,r,o,i)=>(n.handleError(o,i),e.runOutsideAngular(()=>e.onError.emit(i)),!1)})}(o)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Wt.isInAngularZone())throw new Fe(909,!1)}static assertNotInAngularZone(){if(Wt.isInAngularZone())throw new Fe(909,!1)}run(t,n,r){return this._inner.run(t,n,r)}runTask(t,n,r,o){const i=this._inner,s=i.scheduleEventTask("NgZoneEvent: "+o,t,xN,TE,TE);try{return i.runTask(s,n,r)}finally{i.cancelTask(s)}}runGuarded(t,n,r){return this._inner.runGuarded(t,n,r)}runOutsideAngular(t){return this._outer.run(t)}}const xN={};function qp(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function Kp(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function AE(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function DE(e){e._nesting--,qp(e)}class UN{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new an,this.onMicrotaskEmpty=new an,this.onStable=new an,this.onError=new an}run(t,n,r){return t.apply(n,r)}runGuarded(t,n,r){return t.apply(n,r)}runOutsideAngular(t){return t()}runTask(t,n,r,o){return t.apply(n,r)}}const ME=new Ve("",{providedIn:"root",factory:RE});function RE(){const e=Ze(Wt);let t=!0;return function gf(...e){const t=St(e),n=function hf(e,t){return"number"==typeof wt(e)?e.pop():t}(e,1/0),r=e;return r.length?1===r.length?vn(r[0]):he(n)(kt(r,t)):ye}(new G(o=>{t=e.isStable&&!e.hasPendingMacrotasks&&!e.hasPendingMicrotasks,e.runOutsideAngular(()=>{o.next(t),o.complete()})}),new G(o=>{let i;e.runOutsideAngular(()=>{i=e.onStable.subscribe(()=>{Wt.assertNotInAngularZone(),queueMicrotask(()=>{!t&&!e.hasPendingMacrotasks&&!e.hasPendingMicrotasks&&(t=!0,o.next(!0))})})});const s=e.onUnstable.subscribe(()=>{Wt.assertInAngularZone(),t&&(t=!1,e.runOutsideAngular(()=>{o.next(!1)}))});return()=>{i.unsubscribe(),s.unsubscribe()}}).pipe(ja()))}function jo(e){return e instanceof Function?e():e}let Wp=(()=>{class e{constructor(){this.renderDepth=0,this.handler=null}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){this.renderDepth--,0===this.renderDepth&&this.handler?.execute()}ngOnDestroy(){this.handler?.destroy(),this.handler=null}static#e=this.\u0275prov=de({token:e,providedIn:"root",factory:()=>new e})}return e})();function Ec(e){for(;e;){e[_t]|=64;const t=fc(e);if(Rf(e)&&!t)return e;e=t}return null}const xE=new Ve("",{providedIn:"root",factory:()=>!1});let Vu=null;function BE(e,t){return e[t]??$E()}function jE(e,t){const n=$E();n.producerNode?.length&&(e[t]=Vu,n.lView=e,Vu=HE())}const ZN={...fv,consumerIsAlwaysLive:!0,consumerMarkedDirty:e=>{Ec(e.lView)},lView:null};function HE(){return Object.create(ZN)}function $E(){return Vu??=HE(),Vu}const pt={};function st(e){VE(At(),Le(),Jn()+e,!1)}function VE(e,t,n,r){if(!r)if(3==(3&t[_t])){const i=e.preOrderCheckHooks;null!==i&&su(t,i,n)}else{const i=e.preOrderHooks;null!==i&&au(t,i,0,n)}Bi(n)}function Pe(e,t=mt.Default){const n=Le();return null===n?qe(e,t):oC(Pn(),n,ot(e),t)}function zu(e,t,n,r,o,i,s,a,l,h,f){const v=t.blueprint.slice();return v[cn]=o,v[_t]=140|r,(null!==h||e&&2048&e[_t])&&(v[_t]|=2048),Pv(v),v[nn]=v[vs]=e,v[dn]=n,v[ys]=s||e&&e[ys],v[ht]=a||e&&e[ht],v[ai]=l||e&&e[ai]||null,v[jn]=i,v[Qa]=function Xk(){return Jk++}(),v[xo]=f,v[lv]=h,v[hn]=2==t.type?e[hn]:v,v}function qs(e,t,n,r,o){let i=e.data[t];if(null===i)i=function Zp(e,t,n,r,o){const i=Bv(),s=Uf(),l=e.data[t]=function rx(e,t,n,r,o,i){let s=t?t.injectorIndex:-1,a=0;return Is()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:o,attrs:i,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,s?i:i&&i.parent,n,t,r,o);return null===e.firstChild&&(e.firstChild=l),null!==i&&(s?null==i.child&&null!==l.parent&&(i.child=l):null===i.next&&(i.next=l,l.prev=i)),l}(e,t,n,r,o),function JO(){return at.lFrame.inI18n}()&&(i.flags|=32);else if(64&i.type){i.type=n,i.value=r,i.attrs=o;const s=function nc(){const e=at.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}();i.injectorIndex=null===s?-1:s.injectorIndex}return po(i,!0),i}function wc(e,t,n,r){if(0===n)return-1;const o=t.length;for(let i=0;i<n;i++)t.push(r),e.blueprint.push(r),e.data.push(null);return o}function GE(e,t,n,r,o){const i=BE(t,Ja),s=Jn(),a=2&r;try{Bi(-1),a&&t.length>bt&&VE(e,t,bt,!1),fo(a?2:0,o);const h=a?i:null,f=kf(h);try{null!==h&&(h.dirty=!1),n(r,o)}finally{Pf(h,f)}}finally{a&&null===t[Ja]&&jE(t,Ja),Bi(s),fo(a?3:1,o)}}function Yp(e,t,n){if(Mf(t)){const r=Lr(null);try{const i=t.directiveEnd;for(let s=t.directiveStart;s<i;s++){const a=e.data[s];a.contentQueries&&a.contentQueries(1,n[s],s)}}finally{Lr(r)}}}function Qp(e,t,n){Uv()&&(function ux(e,t,n,r){const o=n.directiveStart,i=n.directiveEnd;xi(n)&&function _x(e,t,n){const r=mr(t,e),o=qE(n);let s=16;n.signals?s=4096:n.onPush&&(s=64);const a=Gu(e,zu(e,o,null,s,r,t,null,e[ys].rendererFactory.createRenderer(r,n),null,null,null));e[t.index]=a}(t,n,e.data[o+n.componentOffset]),e.firstCreatePass||lu(n,t),Hn(r,t);const s=n.initialInputs;for(let a=o;a<i;a++){const l=e.data[a],h=ji(t,e,a,n);Hn(h,t),null!==s&&yx(0,a-o,h,l,0,s),Qr(l)&&(Dr(n.index,t)[dn]=ji(t,e,a,n))}}(e,t,n,mr(n,t)),64==(64&n.flags)&&QE(e,t,n))}function Jp(e,t,n=mr){const r=t.localNames;if(null!==r){let o=t.index+1;for(let i=0;i<r.length;i+=2){const s=r[i+1],a=-1===s?n(t,e):e[s];e[o++]=a}}}function qE(e){const t=e.tView;return null===t||t.incompleteFirstPass?e.tView=Xp(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts,e.id):t}function Xp(e,t,n,r,o,i,s,a,l,h,f){const v=bt+r,x=v+o,W=function QN(e,t){const n=[];for(let r=0;r<t;r++)n.push(r<e?null:pt);return n}(v,x),ne="function"==typeof h?h():h;return W[Ye]={type:e,blueprint:W,template:n,queries:null,viewQuery:a,declTNode:t,data:W.slice().fill(null,v),bindingStartIndex:v,expandoStartIndex:x,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof i?i():i,pipeRegistry:"function"==typeof s?s():s,firstChild:null,schemas:l,consts:ne,incompleteFirstPass:!1,ssrId:f}}let KE=e=>null;function WE(e,t,n,r){for(let o in e)if(e.hasOwnProperty(o)){n=null===n?{}:n;const i=e[o];null===r?ZE(n,t,o,i):r.hasOwnProperty(o)&&ZE(n,t,r[o],i)}return n}function ZE(e,t,n,r){e.hasOwnProperty(n)?e[n].push(t,r):e[n]=[t,r]}function eg(e,t,n,r){if(Uv()){const o=null===r?null:{"":-1},i=function hx(e,t){const n=e.directiveRegistry;let r=null,o=null;if(n)for(let i=0;i<n.length;i++){const s=n[i];if(rv(t,s.selectors,!1))if(r||(r=[]),Qr(s))if(null!==s.findHostDirectiveDefs){const a=[];o=o||new Map,s.findHostDirectiveDefs(s,a,o),r.unshift(...a,s),tg(e,t,a.length)}else r.unshift(s),tg(e,t,0);else o=o||new Map,s.findHostDirectiveDefs?.(s,r,o),r.push(s)}return null===r?null:[r,o]}(e,n);let s,a;null===i?s=a=null:[s,a]=i,null!==s&&YE(e,t,n,s,o,a),o&&function fx(e,t,n){if(t){const r=e.localNames=[];for(let o=0;o<t.length;o+=2){const i=n[t[o+1]];if(null==i)throw new Fe(-301,!1);r.push(t[o],i)}}}(n,r,o)}n.mergedAttrs=Ka(n.mergedAttrs,n.attrs)}function YE(e,t,n,r,o,i){for(let h=0;h<r.length;h++)Yf(lu(n,t),e,r[h].type);!function gx(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}(n,e.data.length,r.length);for(let h=0;h<r.length;h++){const f=r[h];f.providersResolver&&f.providersResolver(f)}let s=!1,a=!1,l=wc(e,t,r.length,null);for(let h=0;h<r.length;h++){const f=r[h];n.mergedAttrs=Ka(n.mergedAttrs,f.hostAttrs),mx(e,n,t,l,f),px(l,f,o),null!==f.contentQueries&&(n.flags|=4),(null!==f.hostBindings||null!==f.hostAttrs||0!==f.hostVars)&&(n.flags|=64);const v=f.type.prototype;!s&&(v.ngOnChanges||v.ngOnInit||v.ngDoCheck)&&((e.preOrderHooks??=[]).push(n.index),s=!0),!a&&(v.ngOnChanges||v.ngDoCheck)&&((e.preOrderCheckHooks??=[]).push(n.index),a=!0),l++}!function ox(e,t,n){const o=t.directiveEnd,i=e.data,s=t.attrs,a=[];let l=null,h=null;for(let f=t.directiveStart;f<o;f++){const v=i[f],x=n?n.get(v):null,ne=x?x.outputs:null;l=WE(v.inputs,f,l,x?x.inputs:null),h=WE(v.outputs,f,h,ne);const ae=null===l||null===s||nv(t)?null:vx(l,f,s);a.push(ae)}null!==l&&(l.hasOwnProperty("class")&&(t.flags|=8),l.hasOwnProperty("style")&&(t.flags|=16)),t.initialInputs=a,t.inputs=l,t.outputs=h}(e,n,i)}function QE(e,t,n){const r=n.directiveStart,o=n.directiveEnd,i=n.index,s=function ek(){return at.lFrame.currentDirectiveIndex}();try{Bi(i);for(let a=r;a<o;a++){const l=e.data[a],h=t[a];jf(a),(null!==l.hostBindings||0!==l.hostVars||null!==l.hostAttrs)&&dx(l,h)}}finally{Bi(-1),jf(s)}}function dx(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function tg(e,t,n){t.componentOffset=n,(e.components??=[]).push(t.index)}function px(e,t,n){if(n){if(t.exportAs)for(let r=0;r<t.exportAs.length;r++)n[t.exportAs[r]]=e;Qr(t)&&(n[""]=e)}}function mx(e,t,n,r,o){e.data[r]=o;const i=o.factory||(o.factory=Li(o.type)),s=new rc(i,Qr(o),Pe);e.blueprint[r]=s,n[r]=s,function cx(e,t,n,r,o){const i=o.hostBindings;if(i){let s=e.hostBindingOpCodes;null===s&&(s=e.hostBindingOpCodes=[]);const a=~t.index;(function lx(e){let t=e.length;for(;t>0;){const n=e[--t];if("number"==typeof n&&n<0)return n}return 0})(s)!=a&&s.push(a),s.push(n,r,i)}}(e,t,r,wc(e,n,o.hostVars,pt),o)}function _o(e,t,n,r,o,i){const s=mr(e,t);!function ng(e,t,n,r,o,i,s){if(null==i)e.removeAttribute(t,o,n);else{const a=null==s?ct(i):s(i,r||"",o);e.setAttribute(t,o,a,n)}}(t[ht],s,i,e.value,n,r,o)}function yx(e,t,n,r,o,i){const s=i[t];if(null!==s)for(let a=0;a<s.length;)JE(r,n,s[a++],s[a++],s[a++])}function JE(e,t,n,r,o){const i=Lr(null);try{const s=e.inputTransforms;null!==s&&s.hasOwnProperty(r)&&(o=s[r].call(t,o)),null!==e.setInput?e.setInput(t,o,n,r):t[r]=o}finally{Lr(i)}}function vx(e,t,n){let r=null,o=0;for(;o<n.length;){const i=n[o];if(0!==i)if(5!==i){if("number"==typeof i)break;if(e.hasOwnProperty(i)){null===r&&(r=[]);const s=e[i];for(let a=0;a<s.length;a+=2)if(s[a]===t){r.push(i,s[a+1],n[o+1]);break}}o+=2}else o+=2;else o+=4}return r}function XE(e,t,n,r){return[e,!0,!1,t,null,0,r,n,null,null,null]}function ew(e,t){const n=e.contentQueries;if(null!==n)for(let r=0;r<n.length;r+=2){const i=n[r+1];if(-1!==i){const s=e.data[i];$f(n[r]),s.contentQueries(2,t[i],i)}}}function Gu(e,t){return e[Za]?e[cv][Yr]=t:e[Za]=t,e[cv]=t,t}function rg(e,t,n){$f(0);const r=Lr(null);try{t(e,n)}finally{Lr(r)}}function tw(e){return e[_s]||(e[_s]=[])}function nw(e){return e.cleanup||(e.cleanup=[])}function ow(e,t){const n=e[ai],r=n?n.get(Ur,null):null;r&&r.handleError(t)}function og(e,t,n,r,o){for(let i=0;i<n.length;){const s=n[i++],a=n[i++];JE(e.data[s],t[s],r,a,o)}}function Cx(e,t){const n=Dr(t,e),r=n[Ye];!function Ex(e,t){for(let n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])}(r,n);const o=n[cn];null!==o&&null===n[xo]&&(n[xo]=Up(o,n[ai])),ig(r,n,n[dn])}function ig(e,t,n){Vf(t);try{const r=e.viewQuery;null!==r&&rg(1,r,n);const o=e.template;null!==o&&GE(e,t,o,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&ew(e,t),e.staticViewQueries&&rg(2,e.viewQuery,n);const i=e.components;null!==i&&function wx(e,t){for(let n=0;n<t.length;n++)Cx(e,t[n])}(t,i)}catch(r){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),r}finally{t[_t]&=-5,zf()}}let iw=(()=>{class e{constructor(){this.all=new Set,this.queue=new Map}create(n,r,o){const i=typeof Zone>"u"?null:Zone.current,s=function RO(e,t,n){const r=Object.create(OO);n&&(r.consumerAllowSignalWrites=!0),r.fn=e,r.schedule=t;const o=s=>{r.cleanupFn=s};return r.ref={notify:()=>_v(r),run:()=>{if(r.dirty=!1,r.hasRun&&!yv(r))return;r.hasRun=!0;const s=kf(r);try{r.cleanupFn(),r.cleanupFn=Tv,r.fn(o)}finally{Pf(r,s)}},cleanup:()=>r.cleanupFn()},r.ref}(n,h=>{this.all.has(h)&&this.queue.set(h,i)},o);let a;this.all.add(s),s.notify();const l=()=>{s.cleanup(),a?.(),this.all.delete(s),this.queue.delete(s)};return a=r?.onDestroy(l),{destroy:l}}flush(){if(0!==this.queue.size)for(const[n,r]of this.queue)this.queue.delete(n),r?r.run(()=>n.run()):n.run()}get isQueueEmpty(){return 0===this.queue.size}static#e=this.\u0275prov=de({token:e,providedIn:"root",factory:()=>new e})}return e})();function qu(e,t,n){let r=n?e.styles:null,o=n?e.classes:null,i=0;if(null!==t)for(let s=0;s<t.length;s++){const a=t[s];"number"==typeof a?i=a:1==i?o=fs(o,a):2==i&&(r=fs(r,a+": "+t[++s]+";"))}n?e.styles=r:e.stylesWithoutHost=r,n?e.classes=o:e.classesWithoutHost=o}function bc(e,t,n,r,o=!1){for(;null!==n;){const i=t[n.index];null!==i&&r.push(Qt(i)),Yn(i)&&sw(i,r);const s=n.type;if(8&s)bc(e,t,n.child,r);else if(32&s){const a=cp(n,t);let l;for(;l=a();)r.push(l)}else if(16&s){const a=VC(t,n);if(Array.isArray(a))r.push(...a);else{const l=fc(t[hn]);bc(l[Ye],l,a,r,!0)}}n=o?n.projectionNext:n.next}return r}function sw(e,t){for(let n=On;n<e.length;n++){const r=e[n],o=r[Ye].firstChild;null!==o&&bc(r[Ye],r,o,t)}e[ho]!==e[cn]&&t.push(e[ho])}function Ku(e,t,n,r=!0){const o=t[ys],i=o.rendererFactory,s=o.afterRenderEventManager;i.begin?.(),s?.begin();try{aw(e,t,e.template,n)}catch(l){throw r&&ow(t,l),l}finally{i.end?.(),o.effectManager?.flush(),s?.end()}}function aw(e,t,n,r){const o=t[_t];if(256!=(256&o)){t[ys].effectManager?.flush(),Vf(t);try{Pv(t),function Hv(e){return at.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==n&&GE(e,t,n,2,r);const s=3==(3&o);if(s){const h=e.preOrderCheckHooks;null!==h&&su(t,h,null)}else{const h=e.preOrderHooks;null!==h&&au(t,h,0,null),Gf(t,0)}if(function Sx(e){for(let t=OC(e);null!==t;t=kC(t)){if(!t[uv])continue;const n=t[Es];for(let r=0;r<n.length;r++){HO(n[r])}}}(t),cw(t,2),null!==e.contentQueries&&ew(e,t),s){const h=e.contentCheckHooks;null!==h&&su(t,h)}else{const h=e.contentHooks;null!==h&&au(t,h,1),Gf(t,1)}!function YN(e,t){const n=e.hostBindingOpCodes;if(null===n)return;const r=BE(t,Xa);try{for(let o=0;o<n.length;o++){const i=n[o];if(i<0)Bi(~i);else{const s=i,a=n[++o],l=n[++o];XO(a,s),r.dirty=!1;const h=kf(r);try{l(2,t[s])}finally{Pf(r,h)}}}}finally{null===t[Xa]&&jE(t,Xa),Bi(-1)}}(e,t);const a=e.components;null!==a&&uw(t,a,0);const l=e.viewQuery;if(null!==l&&rg(2,l,r),s){const h=e.viewCheckHooks;null!==h&&su(t,h)}else{const h=e.viewHooks;null!==h&&au(t,h,2),Gf(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),t[_t]&=-73,Nv(t)}finally{zf()}}}function cw(e,t){for(let n=OC(e);null!==n;n=kC(n))for(let r=On;r<n.length;r++)lw(n[r],t)}function Tx(e,t,n){lw(Dr(t,e),n)}function lw(e,t){if(!function BO(e){return 128==(128&e[_t])}(e))return;const n=e[Ye],r=e[_t];if(80&r&&0===t||1024&r||2===t)aw(n,e,n.template,e[dn]);else if(e[Wa]>0){cw(e,1);const o=n.components;null!==o&&uw(e,o,1)}}function uw(e,t,n){for(let r=0;r<t.length;r++)Tx(e,t[r],n)}class Ic{get rootNodes(){const t=this._lView,n=t[Ye];return bc(n,t,n.firstChild,[])}constructor(t,n){this._lView=t,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[dn]}set context(t){this._lView[dn]=t}get destroyed(){return 256==(256&this._lView[_t])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[nn];if(Yn(t)){const n=t[8],r=n?n.indexOf(this):-1;r>-1&&(wu(t,r),hu(n,r))}this._attachedToViewContainer=!1}up(this._lView[Ye],this._lView)}onDestroy(t){!function Lv(e,t){if(256==(256&e[_t]))throw new Fe(911,!1);null===e[ci]&&(e[ci]=[]),e[ci].push(t)}(this._lView,t)}markForCheck(){Ec(this._cdRefInjectingView||this._lView)}detach(){this._lView[_t]&=-129}reattach(){this._lView[_t]|=128}detectChanges(){Ku(this._lView[Ye],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Fe(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function fP(e,t){gc(e,t,t[ht],2,null,null)}(this._lView[Ye],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new Fe(902,!1);this._appRef=t}}class Ax extends Ic{constructor(t){super(t),this._view=t}detectChanges(){const t=this._view;Ku(t[Ye],t,t[dn],!1)}checkNoChanges(){}get context(){return null}}class dw extends Hu{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const n=Tt(t);return new Sc(n,this.ngModule)}}function hw(e){const t=[];for(let n in e)e.hasOwnProperty(n)&&t.push({propName:e[n],templateName:n});return t}class Mx{constructor(t,n){this.injector=t,this.parentInjector=n}get(t,n,r){r=Zl(r);const o=this.injector.get(t,Hp,r);return o!==Hp||n===Hp?o:this.parentInjector.get(t,n,r)}}class Sc extends _E{get inputs(){const t=this.componentDef,n=t.inputTransforms,r=hw(t.inputs);if(null!==n)for(const o of r)n.hasOwnProperty(o.propName)&&(o.transform=n[o.propName]);return r}get outputs(){return hw(this.componentDef.outputs)}constructor(t,n){super(),this.componentDef=t,this.ngModule=n,this.componentType=t.type,this.selector=function dO(e){return e.map(uO).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!n}create(t,n,r,o){let i=(o=o||this.ngModule)instanceof Or?o:o?.injector;i&&null!==this.componentDef.getStandaloneInjector&&(i=this.componentDef.getStandaloneInjector(i)||i);const s=i?new Mx(t,i):t,a=s.get(vE,null);if(null===a)throw new Fe(407,!1);const v={rendererFactory:a,sanitizer:s.get(SN,null),effectManager:s.get(iw,null),afterRenderEventManager:s.get(Wp,null)},x=a.createRenderer(null,this.componentDef),W=this.componentDef.selectors[0][0]||"div",ne=r?function JN(e,t,n,r){const i=r.get(xE,!1)||n===Wr.ShadowDom,s=e.selectRootElement(t,i);return function XN(e){KE(e)}(s),s}(x,r,this.componentDef.encapsulation,s):Eu(x,W,function Dx(e){const t=e.toLowerCase();return"svg"===t?"svg":"math"===t?"math":null}(W)),Ae=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let ve=null;null!==ne&&(ve=Up(ne,s,!0));const Ue=Xp(0,null,null,1,0,null,null,null,null,null,null),We=zu(null,Ue,null,Ae,null,null,v,x,s,null,ve);let Qe,et;Vf(We);try{const Ct=this.componentDef;let Ht,lr=null;Ct.findHostDirectiveDefs?(Ht=[],lr=new Map,Ct.findHostDirectiveDefs(Ct,Ht,lr),Ht.push(Ct)):Ht=[Ct];const ds=function Ox(e,t){const n=e[Ye],r=bt;return e[r]=t,qs(n,r,2,"#host",null)}(We,ne),uf=function kx(e,t,n,r,o,i,s){const a=o[Ye];!function Px(e,t,n,r){for(const o of e)t.mergedAttrs=Ka(t.mergedAttrs,o.hostAttrs);null!==t.mergedAttrs&&(qu(t,t.mergedAttrs,!0),null!==n&&KC(r,n,t))}(r,e,t,s);let l=null;null!==t&&(l=Up(t,o[ai]));const h=i.rendererFactory.createRenderer(t,n);let f=16;n.signals?f=4096:n.onPush&&(f=64);const v=zu(o,qE(n),null,f,o[e.index],e,i,h,null,null,l);return a.firstCreatePass&&tg(a,e,r.length-1),Gu(o,v),o[e.index]=v}(ds,ne,Ct,Ht,We,v,x);et=kv(Ue,bt),ne&&function xx(e,t,n,r){if(r)Af(e,n,["ng-version",TN.full]);else{const{attrs:o,classes:i}=function hO(e){const t=[],n=[];let r=1,o=2;for(;r<e.length;){let i=e[r];if("string"==typeof i)2===o?""!==i&&t.push(i,e[++r]):8===o&&n.push(i);else{if(!Zr(o))break;o=i}r++}return{attrs:t,classes:n}}(t.selectors[0]);o&&Af(e,n,o),i&&i.length>0&&qC(e,n,i.join(" "))}}(x,Ct,ne,r),void 0!==n&&function Lx(e,t,n){const r=e.projection=[];for(let o=0;o<t.length;o++){const i=n[o];r.push(null!=i?Array.from(i):null)}}(et,this.ngContentSelectors,n),Qe=function Nx(e,t,n,r,o,i){const s=Pn(),a=o[Ye],l=mr(s,o);YE(a,o,s,n,null,r);for(let f=0;f<n.length;f++)Hn(ji(o,a,s.directiveStart+f,s),o);QE(a,o,s),l&&Hn(l,o);const h=ji(o,a,s.directiveStart+s.componentOffset,s);if(e[dn]=o[dn]=h,null!==i)for(const f of i)f(h,t);return Yp(a,s,e),h}(uf,Ct,Ht,lr,We,[Fx]),ig(Ue,We,null)}finally{zf()}return new Rx(this.componentType,Qe,Vs(et,We),We,et)}}class Rx extends vN{constructor(t,n,r,o,i){super(),this.location=r,this._rootLView=o,this._tNode=i,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new Ax(o),this.componentType=t}setInput(t,n){const r=this._tNode.inputs;let o;if(null!==r&&(o=r[t])){if(this.previousInputValues??=new Map,this.previousInputValues.has(t)&&Object.is(this.previousInputValues.get(t),n))return;const i=this._rootLView;og(i[Ye],i,o,t,n),this.previousInputValues.set(t,n),Ec(Dr(this._tNode.index,i))}}get injector(){return new Xn(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}function Fx(){const e=Pn();iu(Le()[Ye],e)}function jt(e){let t=function fw(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),n=!0;const r=[e];for(;t;){let o;if(Qr(e))o=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Fe(903,!1);o=t.\u0275dir}if(o){if(n){r.push(o);const s=e;s.inputs=Wu(e.inputs),s.inputTransforms=Wu(e.inputTransforms),s.declaredInputs=Wu(e.declaredInputs),s.outputs=Wu(e.outputs);const a=o.hostBindings;a&&Hx(e,a);const l=o.viewQuery,h=o.contentQueries;if(l&&Bx(e,l),h&&jx(e,h),ri(e.inputs,o.inputs),ri(e.declaredInputs,o.declaredInputs),ri(e.outputs,o.outputs),null!==o.inputTransforms&&(null===s.inputTransforms&&(s.inputTransforms={}),ri(s.inputTransforms,o.inputTransforms)),Qr(o)&&o.data.animation){const f=e.data;f.animation=(f.animation||[]).concat(o.data.animation)}}const i=o.features;if(i)for(let s=0;s<i.length;s++){const a=i[s];a&&a.ngInherit&&a(e),a===jt&&(n=!1)}}t=Object.getPrototypeOf(t)}!function Ux(e){let t=0,n=null;for(let r=e.length-1;r>=0;r--){const o=e[r];o.hostVars=t+=o.hostVars,o.hostAttrs=Ka(o.hostAttrs,n=Ka(n,o.hostAttrs))}}(r)}function Wu(e){return e===lo?{}:e===Pt?[]:e}function Bx(e,t){const n=e.viewQuery;e.viewQuery=n?(r,o)=>{t(r,o),n(r,o)}:t}function jx(e,t){const n=e.contentQueries;e.contentQueries=n?(r,o,i)=>{t(r,o,i),n(r,o,i)}:t}function Hx(e,t){const n=e.hostBindings;e.hostBindings=n?(r,o)=>{t(r,o),n(r,o)}:t}function _w(e){const t=e.inputConfig,n={};for(const r in t)if(t.hasOwnProperty(r)){const o=t[r];Array.isArray(o)&&o[2]&&(n[r]=o[2])}e.inputTransforms=n}function Zu(e){return!!sg(e)&&(Array.isArray(e)||!(e instanceof Map)&&Symbol.iterator in e)}function sg(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function yo(e,t,n){return e[t]=n}function $n(e,t,n){return!Object.is(e[t],n)&&(e[t]=n,!0)}function Yu(e,t,n,r,o){const i=function qi(e,t,n,r){const o=$n(e,t,n);return $n(e,t+1,r)||o}(e,t,n,r);return $n(e,t+2,o)||i}function Jr(e,t,n,r){const o=Le();return $n(o,Ss(),t)&&(At(),_o(sn(),o,e,t,n,r)),Jr}function tr(e,t,n,r,o,i,s,a){const l=Le(),h=At(),f=e+bt,v=h.firstCreatePass?function f1(e,t,n,r,o,i,s,a,l){const h=t.consts,f=qs(t,e,4,s||null,ui(h,a));eg(t,n,f,ui(h,l)),iu(t,f);const v=f.tView=Xp(2,f,r,o,i,t.directiveRegistry,t.pipeRegistry,null,t.schemas,h,null);return null!==t.queries&&(t.queries.template(t,f),v.queries=t.queries.embeddedTView(f)),f}(f,h,l,t,n,r,o,i,s):h.data[f];po(v,!1);const x=Rw(h,l,v,e);ou()&&Iu(h,l,x,v),Hn(x,l),Gu(l,l[f]=XE(x,l,x,v)),eu(v)&&Qp(h,l,v),null!=s&&Jp(l,v,a)}let Rw=function Ow(e,t,n,r){return di(!0),t[ht].createComment("")};function Et(e,t,n){const r=Le();return $n(r,Ss(),t)&&function kr(e,t,n,r,o,i,s,a){const l=mr(t,n);let f,h=t.inputs;!a&&null!=h&&(f=h[r])?(og(e,n,f,r,o),xi(t)&&function sx(e,t){const n=Dr(t,e);16&n[_t]||(n[_t]|=64)}(n,t.index)):3&t.type&&(r=function ix(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(r),o=null!=s?s(o,t.value||"",r):o,i.setProperty(l,r,o))}(At(),sn(),r,e,t,r[ht],n,!1),Et}function hg(e,t,n,r,o){const s=o?"class":"style";og(e,n,t.inputs[s],s,r)}function Je(e,t,n,r){const o=Le(),i=At(),s=bt+e,a=o[ht],l=i.firstCreatePass?function _1(e,t,n,r,o,i){const s=t.consts,l=qs(t,e,2,r,ui(s,o));return eg(t,n,l,ui(s,i)),null!==l.attrs&&qu(l,l.attrs,!1),null!==l.mergedAttrs&&qu(l,l.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,l),l}(s,i,o,t,n,r):i.data[s],h=Pw(i,o,l,a,t,e);o[s]=h;const f=eu(l);return po(l,!0),KC(a,h,l),32!=(32&l.flags)&&ou()&&Iu(i,o,h,l),0===function VO(){return at.lFrame.elementDepthCount}()&&Hn(h,o),function zO(){at.lFrame.elementDepthCount++}(),f&&(Qp(i,o,l),Yp(i,l,o)),null!==r&&Jp(o,l),Je}function it(){let e=Pn();Uf()?Bf():(e=e.parent,po(e,!1));const t=e;(function qO(e){return at.skipHydrationRootTNode===e})(t)&&function YO(){at.skipHydrationRootTNode=null}(),function GO(){at.lFrame.elementDepthCount--}();const n=At();return n.firstCreatePass&&(iu(n,e),Mf(e)&&n.queries.elementEnd(e)),null!=t.classesWithoutHost&&function dk(e){return 0!=(8&e.flags)}(t)&&hg(n,t,Le(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function hk(e){return 0!=(16&e.flags)}(t)&&hg(n,t,Le(),t.stylesWithoutHost,!1),it}function $t(e,t,n,r){return Je(e,t,n,r),it(),$t}let Pw=(e,t,n,r,o,i)=>(di(!0),Eu(r,o,function Zv(){return at.lFrame.currentNamespace}()));function ed(e,t,n){const r=Le(),o=At(),i=e+bt,s=o.firstCreatePass?function C1(e,t,n,r,o){const i=t.consts,s=ui(i,r),a=qs(t,e,8,"ng-container",s);return null!==s&&qu(a,s,!0),eg(t,n,a,ui(i,o)),null!==t.queries&&t.queries.elementStart(t,a),a}(i,o,r,t,n):o.data[i];po(s,!0);const a=xw(o,r,s,e);return r[i]=a,ou()&&Iu(o,r,a,s),Hn(a,r),eu(s)&&(Qp(o,r,s),Yp(o,s,r)),null!=n&&Jp(r,s),ed}function td(){let e=Pn();const t=At();return Uf()?Bf():(e=e.parent,po(e,!1)),t.firstCreatePass&&(iu(t,e),Mf(e)&&t.queries.elementEnd(e)),td}let xw=(e,t,n,r)=>(di(!0),lp(t[ht],""));function Ki(){return Le()}function Rc(e){return!!e&&"function"==typeof e.then}function Lw(e){return!!e&&"function"==typeof e.subscribe}function fn(e,t,n,r){const o=Le(),i=At(),s=Pn();return function Uw(e,t,n,r,o,i,s){const a=eu(r),h=e.firstCreatePass&&nw(e),f=t[dn],v=tw(t);let x=!0;if(3&r.type||s){const ae=mr(r,t),_e=s?s(ae):ae,Ae=v.length,ve=s?We=>s(Qt(We[r.index])):r.index;let Ue=null;if(!s&&a&&(Ue=function b1(e,t,n,r){const o=e.cleanup;if(null!=o)for(let i=0;i<o.length-1;i+=2){const s=o[i];if(s===n&&o[i+1]===r){const a=t[_s],l=o[i+2];return a.length>l?a[l]:null}"string"==typeof s&&(i+=2)}return null}(e,t,o,r.index)),null!==Ue)(Ue.__ngLastListenerFn__||Ue).__ngNextListenerFn__=i,Ue.__ngLastListenerFn__=i,x=!1;else{i=jw(r,t,f,i,!1);const We=n.listen(_e,o,i);v.push(i,We),h&&h.push(o,ve,Ae,Ae+1)}}else i=jw(r,t,f,i,!1);const W=r.outputs;let ne;if(x&&null!==W&&(ne=W[o])){const ae=ne.length;if(ae)for(let _e=0;_e<ae;_e+=2){const Qe=t[ne[_e]][ne[_e+1]].subscribe(i),et=v.length;v.push(i,Qe),h&&h.push(o,r.index,et,-(et+1))}}}(i,o,o[ht],s,e,t,r),fn}function Bw(e,t,n,r){try{return fo(6,t,n),!1!==n(r)}catch(o){return ow(e,o),!1}finally{fo(7,t,n)}}function jw(e,t,n,r,o){return function i(s){if(s===Function)return r;Ec(e.componentOffset>-1?Dr(e.index,t):t);let l=Bw(t,n,r,s),h=i.__ngNextListenerFn__;for(;h;)l=Bw(t,n,h,s)&&l,h=h.__ngNextListenerFn__;return o&&!1===l&&s.preventDefault(),l}}function Pr(e=1){return function nk(e){return(at.lFrame.contextLView=function rk(e,t){for(;e>0;)t=t[vs],e--;return t}(e,at.lFrame.contextLView))[dn]}(e)}function I1(e,t){let n=null;const r=function sO(e){const t=e.attrs;if(null!=t){const n=t.indexOf(5);if(!(1&n))return t[n+1]}return null}(e);for(let o=0;o<t.length;o++){const i=t[o];if("*"!==i){if(null===r?rv(e,i,!0):lO(r,i))return o}else n=o}return n}function nd(e,t){return e<<17|t<<2}function pi(e){return e>>17&32767}function pg(e){return 2|e}function Wi(e){return(131068&e)>>2}function gg(e,t){return-131069&e|t<<2}function mg(e){return 1|e}function Jw(e,t,n,r,o){const i=e[n+1],s=null===t;let a=r?pi(i):Wi(i),l=!1;for(;0!==a&&(!1===l||s);){const f=e[a+1];R1(e[a],t)&&(l=!0,e[a+1]=r?mg(f):pg(f)),a=r?pi(f):Wi(f)}l&&(e[n+1]=r?pg(i):mg(i))}function R1(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&Ps(e,t)>=0}function Oc(e,t){return function Xr(e,t,n,r){const o=Le(),i=At(),s=function Fo(e){const t=at.lFrame,n=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,n}(2);i.firstUpdatePass&&function ab(e,t,n,r){const o=e.data;if(null===o[n+1]){const i=o[Jn()],s=function sb(e,t){return t>=e.expandoStartIndex}(e,n);(function db(e,t){return 0!=(e.flags&(t?8:16))})(i,r)&&null===t&&!s&&(t=!1),t=function B1(e,t,n,r){const o=function Hf(e){const t=at.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}(e);let i=r?t.residualClasses:t.residualStyles;if(null===o)0===(r?t.classBindings:t.styleBindings)&&(n=kc(n=_g(null,e,t,n,r),t.attrs,r),i=null);else{const s=t.directiveStylingLast;if(-1===s||e[s]!==o)if(n=_g(o,e,t,n,r),null===i){let l=function j1(e,t,n){const r=n?t.classBindings:t.styleBindings;if(0!==Wi(r))return e[pi(r)]}(e,t,r);void 0!==l&&Array.isArray(l)&&(l=_g(null,e,t,l[1],r),l=kc(l,t.attrs,r),function H1(e,t,n,r){e[pi(n?t.classBindings:t.styleBindings)]=r}(e,t,r,l))}else i=function $1(e,t,n){let r;const o=t.directiveEnd;for(let i=1+t.directiveStylingLast;i<o;i++)r=kc(r,e[i].hostAttrs,n);return kc(r,t.attrs,n)}(e,t,r)}return void 0!==i&&(r?t.residualClasses=i:t.residualStyles=i),n}(o,i,t,r),function D1(e,t,n,r,o,i){let s=i?t.classBindings:t.styleBindings,a=pi(s),l=Wi(s);e[r]=n;let f,h=!1;if(Array.isArray(n)?(f=n[1],(null===f||Ps(n,f)>0)&&(h=!0)):f=n,o)if(0!==l){const x=pi(e[a+1]);e[r+1]=nd(x,a),0!==x&&(e[x+1]=gg(e[x+1],r)),e[a+1]=function T1(e,t){return 131071&e|t<<17}(e[a+1],r)}else e[r+1]=nd(a,0),0!==a&&(e[a+1]=gg(e[a+1],r)),a=r;else e[r+1]=nd(l,0),0===a?a=r:e[l+1]=gg(e[l+1],r),l=r;h&&(e[r+1]=pg(e[r+1])),Jw(e,f,r,!0),Jw(e,f,r,!1),function M1(e,t,n,r,o){const i=o?e.residualClasses:e.residualStyles;null!=i&&"string"==typeof t&&Ps(i,t)>=0&&(n[r+1]=mg(n[r+1]))}(t,f,e,r,i),s=nd(a,l),i?t.classBindings=s:t.styleBindings=s}(o,i,t,n,s,r)}}(i,e,s,r),t!==pt&&$n(o,s,t)&&function lb(e,t,n,r,o,i,s,a){if(!(3&t.type))return;const l=e.data,h=l[a+1],f=function A1(e){return 1==(1&e)}(h)?ub(l,t,n,o,Wi(h),s):void 0;rd(f)||(rd(i)||function S1(e){return 2==(2&e)}(h)&&(i=ub(l,null,n,o,a,s)),function bP(e,t,n,r,o){if(t)o?e.addClass(n,r):e.removeClass(n,r);else{let i=-1===r.indexOf("-")?void 0:hi.DashCase;null==o?e.removeStyle(n,r,i):("string"==typeof o&&o.endsWith("!important")&&(o=o.slice(0,-10),i|=hi.Important),e.setStyle(n,r,o,i))}}(r,s,ru(Jn(),n),o,i))}(i,i.data[Jn()],o,o[ht],e,o[s+1]=function q1(e,t){return null==e||""===e||("string"==typeof t?e+=t:"object"==typeof e&&(e=un(Rr(e)))),e}(t,n),r,s)}(e,t,null,!0),Oc}function _g(e,t,n,r,o){let i=null;const s=n.directiveEnd;let a=n.directiveStylingLast;for(-1===a?a=n.directiveStart:a++;a<s&&(i=t[a],r=kc(r,i.hostAttrs,o),i!==e);)a++;return null!==e&&(n.directiveStylingLast=a),r}function kc(e,t,n){const r=n?1:2;let o=-1;if(null!==t)for(let i=0;i<t.length;i++){const s=t[i];"number"==typeof s?o=s:o===r&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),Mr(e,s,!!n||t[++i]))}return void 0===e?null:e}function ub(e,t,n,r,o,i){const s=null===t;let a;for(;o>0;){const l=e[o],h=Array.isArray(l),f=h?l[1]:l,v=null===f;let x=n[o+1];x===pt&&(x=v?Pt:void 0);let W=v?Xf(x,r):f===r?x:void 0;if(h&&!rd(W)&&(W=Xf(l,r)),rd(W)&&(a=W,s))return a;const ne=e[o+1];o=s?pi(ne):Wi(ne)}if(null!==t){let l=i?t.residualClasses:t.residualStyles;null!=l&&(a=Xf(l,r))}return a}function rd(e){return void 0!==e}function yt(e,t=""){const n=Le(),r=At(),o=e+bt,i=r.firstCreatePass?qs(r,o,1,t,null):r.data[o],s=hb(r,n,i,t,e);n[o]=s,ou()&&Iu(r,n,s,i),po(i,!1)}let hb=(e,t,n,r,o)=>(di(!0),function Cu(e,t){return e.createText(t)}(t[ht],r));function to(e){return $o("",e,""),to}function $o(e,t,n){const r=Le(),o=function Ws(e,t,n,r){return $n(e,Ss(),n)?t+ct(n)+r:pt}(r,e,t,n);return o!==pt&&function Ho(e,t,n){const r=ru(t,e);!function NC(e,t,n){e.setValue(t,n)}(e[ht],r,n)}(r,Jn(),o),$o}const Zi=void 0;var pL=["en",[["a","p"],["AM","PM"],Zi],[["AM","PM"],Zi,Zi],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Zi,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Zi,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Zi,"{1} 'at' {0}",Zi],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function fL(e){const n=Math.floor(Math.abs(e)),r=e.toString().replace(/^[^.]*\.?/,"").length;return 1===n&&0===r?1:5}];let ra={};function nr(e){const t=function gL(e){return e.toLowerCase().replace(/_/g,"-")}(e);let n=Pb(t);if(n)return n;const r=t.split("-")[0];if(n=Pb(r),n)return n;if("en"===r)return pL;throw new Fe(701,!1)}function Pb(e){return e in ra||(ra[e]=Yt.ng&&Yt.ng.common&&Yt.ng.common.locales&&Yt.ng.common.locales[e]),ra[e]}var Jt=function(e){return e[e.LocaleId=0]="LocaleId",e[e.DayPeriodsFormat=1]="DayPeriodsFormat",e[e.DayPeriodsStandalone=2]="DayPeriodsStandalone",e[e.DaysFormat=3]="DaysFormat",e[e.DaysStandalone=4]="DaysStandalone",e[e.MonthsFormat=5]="MonthsFormat",e[e.MonthsStandalone=6]="MonthsStandalone",e[e.Eras=7]="Eras",e[e.FirstDayOfWeek=8]="FirstDayOfWeek",e[e.WeekendRange=9]="WeekendRange",e[e.DateFormat=10]="DateFormat",e[e.TimeFormat=11]="TimeFormat",e[e.DateTimeFormat=12]="DateTimeFormat",e[e.NumberSymbols=13]="NumberSymbols",e[e.NumberFormats=14]="NumberFormats",e[e.CurrencyCode=15]="CurrencyCode",e[e.CurrencySymbol=16]="CurrencySymbol",e[e.CurrencyName=17]="CurrencyName",e[e.Currencies=18]="Currencies",e[e.Directionality=19]="Directionality",e[e.PluralCase=20]="PluralCase",e[e.ExtraData=21]="ExtraData",e}(Jt||{});const oa="en-US";let Nb=oa;function Cg(e,t,n,r,o){if(e=ot(e),Array.isArray(e))for(let i=0;i<e.length;i++)Cg(e[i],t,n,r,o);else{const i=At(),s=Le(),a=Pn();let l=zi(e)?e:ot(e.provide);const h=hE(e),f=1048575&a.providerIndexes,v=a.directiveStart,x=a.providerIndexes>>20;if(zi(e)||!e.multi){const W=new rc(h,o,Pe),ne=wg(l,t,o?f:f+x,v);-1===ne?(Yf(lu(a,s),i,l),Eg(i,e,t.length),t.push(l),a.directiveStart++,a.directiveEnd++,o&&(a.providerIndexes+=1048576),n.push(W),s.push(W)):(n[ne]=W,s[ne]=W)}else{const W=wg(l,t,f+x,v),ne=wg(l,t,f,f+x),_e=ne>=0&&n[ne];if(o&&!_e||!o&&!(W>=0&&n[W])){Yf(lu(a,s),i,l);const Ae=function fF(e,t,n,r,o){const i=new rc(e,n,Pe);return i.multi=[],i.index=t,i.componentProviders=0,iI(i,o,r&&!n),i}(o?hF:dF,n.length,o,r,h);!o&&_e&&(n[ne].providerFactory=Ae),Eg(i,e,t.length,0),t.push(l),a.directiveStart++,a.directiveEnd++,o&&(a.providerIndexes+=1048576),n.push(Ae),s.push(Ae)}else Eg(i,e,W>-1?W:ne,iI(n[o?ne:W],h,!o&&r));!o&&r&&_e&&n[ne].componentProviders++}}}function Eg(e,t,n,r){const o=zi(t),i=function nN(e){return!!e.useClass}(t);if(o||i){const l=(i?ot(t.useClass):t).prototype.ngOnDestroy;if(l){const h=e.destroyHooks||(e.destroyHooks=[]);if(!o&&t.multi){const f=h.indexOf(n);-1===f?h.push(n,[r,l]):h[f+1].push(r,l)}else h.push(n,l)}}}function iI(e,t,n){return n&&e.componentProviders++,e.multi.push(t)-1}function wg(e,t,n,r){for(let o=n;o<r;o++)if(t[o]===e)return o;return-1}function dF(e,t,n,r){return bg(this.multi,[])}function hF(e,t,n,r){const o=this.multi;let i;if(this.providerFactory){const s=this.providerFactory.componentProviders,a=ji(n,n[Ye],this.providerFactory.index,r);i=a.slice(0,s),bg(o,i);for(let l=s;l<a.length;l++)i.push(a[l])}else i=[],bg(o,i);return i}function bg(e,t){for(let n=0;n<e.length;n++)t.push((0,e[n])());return t}function rn(e,t=[]){return n=>{n.providersResolver=(r,o)=>function uF(e,t,n){const r=At();if(r.firstCreatePass){const o=Qr(e);Cg(n,r.data,r.blueprint,o,!0),Cg(t,r.data,r.blueprint,o,!1)}}(r,o?o(e):e,t)}}class Yi{}class sI{}class Ig extends Yi{constructor(t,n,r){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new dw(this);const o=Tr(t);this._bootstrapComponents=jo(o.bootstrap),this._r3Injector=IE(t,n,[{provide:Yi,useValue:this},{provide:Hu,useValue:this.componentFactoryResolver},...r],un(t),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(t)}get injector(){return this._r3Injector}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class Sg extends sI{constructor(t){super(),this.moduleType=t}create(t){return new Ig(this.moduleType,t,[])}}class aI extends Yi{constructor(t){super(),this.componentFactoryResolver=new dw(this),this.instance=null;const n=new Bs([...t.providers,{provide:Yi,useValue:this},{provide:Hu,useValue:this.componentFactoryResolver}],t.parent||Nu(),t.debugName,new Set(["environment"]));this.injector=n,t.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(t){this.injector.onDestroy(t)}}function Tg(e,t,n=null){return new aI({providers:e,parent:t,debugName:n,runEnvironmentInitializers:!0}).injector}let mF=(()=>{class e{constructor(n){this._injector=n,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(n){if(!n.standalone)return null;if(!this.cachedInjectors.has(n)){const r=cE(0,n.type),o=r.length>0?Tg([r],this._injector,`Standalone[${n.type.name}]`):null;this.cachedInjectors.set(n,o)}return this.cachedInjectors.get(n)}ngOnDestroy(){try{for(const n of this.cachedInjectors.values())null!==n&&n.destroy()}finally{this.cachedInjectors.clear()}}static#e=this.\u0275prov=de({token:e,providedIn:"environment",factory:()=>new e(qe(Or))})}return e})();function cI(e){e.getStandaloneInjector=t=>t.get(mF).getOrCreateStandaloneInjector(e)}function Uc(e,t){const n=e[t];return n===pt?void 0:n}function mI(e,t,n,r,o,i){const s=t+n;return $n(e,s,o)?yo(e,s+1,i?r.call(i,o):r(o)):Uc(e,s+1)}function Bc(e,t){const n=At();let r;const o=e+bt;n.firstCreatePass?(r=function NF(e,t){if(t)for(let n=t.length-1;n>=0;n--){const r=t[n];if(e===r.name)return r}}(t,n.pipeRegistry),n.data[o]=r,r.onDestroy&&(n.destroyHooks??=[]).push(o,r.onDestroy)):r=n.data[o];const i=r.factory||(r.factory=Li(r.type)),a=fr(Pe);try{const l=cu(!1),h=i();return cu(l),function m1(e,t,n,r){n>=e.data.length&&(e.data[n]=null,e.blueprint[n]=null),t[n]=r}(n,Le(),o,h),h}finally{fr(a)}}function cd(e,t,n){const r=e+bt,o=Le(),i=bs(o,r);return jc(o,r)?mI(o,Qn(),t,i.transform,n,i):i.transform(n)}function EI(e,t,n,r,o){const i=e+bt,s=Le(),a=bs(s,i);return jc(s,i)?function yI(e,t,n,r,o,i,s,a){const l=t+n;return Yu(e,l,o,i,s)?yo(e,l+3,a?r.call(a,o,i,s):r(o,i,s)):Uc(e,l+3)}(s,Qn(),t,a.transform,n,r,o,a):a.transform(n,r,o)}function jc(e,t){return e[Ye].data[t].pure}function UF(){return this._results[Symbol.iterator]()}class Dg{static#e=Symbol.iterator;get changes(){return this._changes||(this._changes=new an)}constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const n=Dg.prototype;n[Symbol.iterator]||(n[Symbol.iterator]=UF)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,n){return this._results.reduce(t,n)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,n){const r=this;r.dirty=!1;const o=function Fr(e){return e.flat(Number.POSITIVE_INFINITY)}(t);(this._changesDetected=!function Tk(e,t,n){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++){let o=e[r],i=t[r];if(n&&(o=n(o),i=n(i)),i!==o)return!1}return!0}(r._results,o,n))&&(r._results=o,r.length=o.length,r.last=o[this.length-1],r.first=o[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}function jF(e,t,n,r=!0){const o=t[Ye];if(function gP(e,t,n,r){const o=On+r,i=n.length;r>0&&(n[o-1][Yr]=t),r<i-On?(t[Yr]=n[o],uC(n,On+r,t)):(n.push(t),t[Yr]=null),t[nn]=n;const s=t[Ya];null!==s&&n!==s&&function mP(e,t){const n=e[Es];t[hn]!==t[nn][nn][hn]&&(e[uv]=!0),null===n?e[Es]=[t]:n.push(t)}(s,t);const a=t[uo];null!==a&&a.insertView(e),t[_t]|=128}(o,t,e,n),r){const i=pp(n,e),s=t[ht],a=bu(s,e[ho]);null!==a&&function hP(e,t,n,r,o,i){r[cn]=o,r[jn]=t,gc(e,r,n,1,o,i)}(o,e[jn],s,t,a,i)}}let Vo=(()=>{class e{static#e=this.__NG_ELEMENT_ID__=VF}return e})();const HF=Vo,$F=class extends HF{constructor(t,n,r){super(),this._declarationLView=t,this._declarationTContainer=n,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,n){return this.createEmbeddedViewImpl(t,n)}createEmbeddedViewImpl(t,n,r){const o=function BF(e,t,n,r){const o=t.tView,a=zu(e,o,n,4096&e[_t]?4096:16,null,t,null,null,null,r?.injector??null,r?.hydrationInfo??null);a[Ya]=e[t.index];const h=e[uo];return null!==h&&(a[uo]=h.createEmbeddedView(o)),ig(o,a,n),a}(this._declarationLView,this._declarationTContainer,t,{injector:n,hydrationInfo:r});return new Ic(o)}};function VF(){return ld(Pn(),Le())}function ld(e,t){return 4&e.type?new $F(t,e,Vs(e,t)):null}let no=(()=>{class e{static#e=this.__NG_ELEMENT_ID__=ZF}return e})();function ZF(){return DI(Pn(),Le())}const YF=no,TI=class extends YF{constructor(t,n,r){super(),this._lContainer=t,this._hostTNode=n,this._hostLView=r}get element(){return Vs(this._hostTNode,this._hostLView)}get injector(){return new Xn(this._hostTNode,this._hostLView)}get parentInjector(){const t=uu(this._hostTNode,this._hostLView);if(Kf(t)){const n=ic(t,this._hostLView),r=oc(t);return new Xn(n[Ye].data[r+8],n)}return new Xn(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const n=AI(this._lContainer);return null!==n&&n[t]||null}get length(){return this._lContainer.length-On}createEmbeddedView(t,n,r){let o,i;"number"==typeof r?o=r:null!=r&&(o=r.index,i=r.injector);const a=t.createEmbeddedViewImpl(n||{},i,null);return this.insertImpl(a,o,false),a}createComponent(t,n,r,o,i){const s=t&&!function cc(e){return"function"==typeof e}(t);let a;if(s)a=n;else{const ae=n||{};a=ae.index,r=ae.injector,o=ae.projectableNodes,i=ae.environmentInjector||ae.ngModuleRef}const l=s?t:new Sc(Tt(t)),h=r||this.parentInjector;if(!i&&null==l.ngModule){const _e=(s?h:this.parentInjector).get(Or,null);_e&&(i=_e)}Tt(l.componentType??{});const W=l.create(h,o,null,i);return this.insertImpl(W.hostView,a,false),W}insert(t,n){return this.insertImpl(t,n,!1)}insertImpl(t,n,r){const o=t._lView;if(function jO(e){return Yn(e[nn])}(o)){const l=this.indexOf(t);if(-1!==l)this.detach(l);else{const h=o[nn],f=new TI(h,h[jn],h[nn]);f.detach(f.indexOf(t))}}const s=this._adjustIndex(n),a=this._lContainer;return jF(a,o,s,!r),t.attachToViewContainerRef(),uC(Mg(a),s,t),t}move(t,n){return this.insert(t,n)}indexOf(t){const n=AI(this._lContainer);return null!==n?n.indexOf(t):-1}remove(t){const n=this._adjustIndex(t,-1),r=wu(this._lContainer,n);r&&(hu(Mg(this._lContainer),n),up(r[Ye],r))}detach(t){const n=this._adjustIndex(t,-1),r=wu(this._lContainer,n);return r&&null!=hu(Mg(this._lContainer),n)?new Ic(r):null}_adjustIndex(t,n=0){return t??this.length+n}};function AI(e){return e[8]}function Mg(e){return e[8]||(e[8]=[])}function DI(e,t){let n;const r=t[e.index];return Yn(r)?n=r:(n=XE(r,t,null,e),t[e.index]=n,Gu(t,n)),MI(n,t,e,r),new TI(n,e,t)}let MI=function RI(e,t,n,r){if(e[ho])return;let o;o=8&n.type?Qt(r):function QF(e,t){const n=e[ht],r=n.createComment(""),o=mr(t,e);return $i(n,bu(n,o),r,function CP(e,t){return e.nextSibling(t)}(n,o),!1),r}(t,n),e[ho]=o};class Rg{constructor(t){this.queryList=t,this.matches=null}clone(){return new Rg(this.queryList)}setDirty(){this.queryList.setDirty()}}class Og{constructor(t=[]){this.queries=t}createEmbeddedView(t){const n=t.queries;if(null!==n){const r=null!==t.contentQueries?t.contentQueries[0]:n.length,o=[];for(let i=0;i<r;i++){const s=n.getByIndex(i);o.push(this.queries[s.indexInDeclarationView].clone())}return new Og(o)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let n=0;n<this.queries.length;n++)null!==FI(t,n).matches&&this.queries[n].setDirty()}}class OI{constructor(t,n,r=null){this.predicate=t,this.flags=n,this.read=r}}class kg{constructor(t=[]){this.queries=t}elementStart(t,n){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(t,n)}elementEnd(t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementEnd(t)}embeddedTView(t){let n=null;for(let r=0;r<this.length;r++){const o=null!==n?n.length:0,i=this.getByIndex(r).embeddedTView(t,o);i&&(i.indexInDeclarationView=r,null!==n?n.push(i):n=[i])}return null!==n?new kg(n):null}template(t,n){for(let r=0;r<this.queries.length;r++)this.queries[r].template(t,n)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class Pg{constructor(t,n=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}elementStart(t,n){this.isApplyingToNode(n)&&this.matchTNode(t,n)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,n){this.elementStart(t,n)}embeddedTView(t,n){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,n),new Pg(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const n=this._declarationNodeIndex;let r=t.parent;for(;null!==r&&8&r.type&&r.index!==n;)r=r.parent;return n===(null!==r?r.index:-1)}return this._appliesToNextNode}matchTNode(t,n){const r=this.metadata.predicate;if(Array.isArray(r))for(let o=0;o<r.length;o++){const i=r[o];this.matchTNodeWithReadOption(t,n,eU(n,i)),this.matchTNodeWithReadOption(t,n,du(n,t,i,!1,!1))}else r===Vo?4&n.type&&this.matchTNodeWithReadOption(t,n,-1):this.matchTNodeWithReadOption(t,n,du(n,t,r,!1,!1))}matchTNodeWithReadOption(t,n,r){if(null!==r){const o=this.metadata.read;if(null!==o)if(o===er||o===no||o===Vo&&4&n.type)this.addMatch(n.index,-2);else{const i=du(n,t,o,!1,!1);null!==i&&this.addMatch(n.index,i)}else this.addMatch(n.index,r)}}addMatch(t,n){null===this.matches?this.matches=[t,n]:this.matches.push(t,n)}}function eU(e,t){const n=e.localNames;if(null!==n)for(let r=0;r<n.length;r+=2)if(n[r]===t)return n[r+1];return null}function nU(e,t,n,r){return-1===n?function tU(e,t){return 11&e.type?Vs(e,t):4&e.type?ld(e,t):null}(t,e):-2===n?function rU(e,t,n){return n===er?Vs(t,e):n===Vo?ld(t,e):n===no?DI(t,e):void 0}(e,t,r):ji(e,e[Ye],n,t)}function kI(e,t,n,r){const o=t[uo].queries[r];if(null===o.matches){const i=e.data,s=n.matches,a=[];for(let l=0;l<s.length;l+=2){const h=s[l];a.push(h<0?null:nU(t,i[h],s[l+1],n.metadata.read))}o.matches=a}return o.matches}function Ng(e,t,n,r){const o=e.queries.getByIndex(n),i=o.matches;if(null!==i){const s=kI(e,t,o,n);for(let a=0;a<i.length;a+=2){const l=i[a];if(l>0)r.push(s[a/2]);else{const h=i[a+1],f=t[-l];for(let v=On;v<f.length;v++){const x=f[v];x[Ya]===x[nn]&&Ng(x[Ye],x,h,r)}if(null!==f[Es]){const v=f[Es];for(let x=0;x<v.length;x++){const W=v[x];Ng(W[Ye],W,h,r)}}}}}return r}function xg(e){const t=Le(),n=At(),r=Vv();$f(r+1);const o=FI(n,r);if(e.dirty&&function UO(e){return 4==(4&e[_t])}(t)===(2==(2&o.metadata.flags))){if(null===o.matches)e.reset([]);else{const i=o.crossesNgTemplate?Ng(n,t,r,[]):kI(n,t,o,r);e.reset(i,bN),e.notifyOnChanges()}return!0}return!1}function Lg(){return function oU(e,t){return e[uo].queries[t].queryList}(Le(),Vv())}function xI(e,t,n){const r=new Dg(4==(4&n));(function nx(e,t,n,r){const o=tw(t);o.push(n),e.firstCreatePass&&nw(e).push(r,o.length-1)})(e,t,r,r.destroy),null===t[uo]&&(t[uo]=new Og),t[uo].queries.push(new Rg(r))}function LI(e,t,n){null===e.queries&&(e.queries=new kg),e.queries.track(new Pg(t,n))}function FI(e,t){return e.queries.getByIndex(t)}function UI(e,t){return ld(e,t)}const $g=new Ve("Application Initializer");let Vg=(()=>{class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((n,r)=>{this.resolve=n,this.reject=r}),this.appInits=Ze($g,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const n=[];for(const o of this.appInits){const i=o();if(Rc(i))n.push(i);else if(Lw(i)){const s=new Promise((a,l)=>{i.subscribe({complete:a,error:l})});n.push(s)}}const r=()=>{this.done=!0,this.resolve()};Promise.all(n).then(()=>{r()}).catch(o=>{this.reject(o)}),0===n.length&&r(),this.initialized=!0}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),tS=(()=>{class e{log(n){console.log(n)}warn(n){console.warn(n)}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})();const Eo=new Ve("LocaleId",{providedIn:"root",factory:()=>Ze(Eo,mt.Optional|mt.SkipSelf)||function TU(){return typeof $localize<"u"&&$localize.locale||oa}()}),AU=new Ve("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});let hd=(()=>{class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new An(!1)}add(){this.hasPendingTasks.next(!0);const n=this.taskId++;return this.pendingTasks.add(n),n}remove(n){this.pendingTasks.delete(n),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class MU{constructor(t,n){this.ngModuleFactory=t,this.componentFactories=n}}let nS=(()=>{class e{compileModuleSync(n){return new Sg(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){const r=this.compileModuleSync(n),i=jo(Tr(n).declarations).reduce((s,a)=>{const l=Tt(a);return l&&s.push(new Sc(l)),s},[]);return new MU(r,i)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const sS=new Ve(""),pd=new Ve("");let Wg,qg=(()=>{class e{constructor(n,r,o){this._ngZone=n,this.registry=r,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,Wg||(function QU(e){Wg=e}(o),o.addToWindow(r)),this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Wt.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb(this._didWork)}this._didWork=!1});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(n)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,r,o){let i=-1;r&&r>0&&(i=setTimeout(()=>{this._callbacks=this._callbacks.filter(s=>s.timeoutId!==i),n(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:n,timeoutId:i,updateCb:o})}whenStable(n,r,o){if(o&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,r,o),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(n){this.registry.registerApplication(n,this)}unregisterApplication(n){this.registry.unregisterApplication(n)}findProviders(n,r,o){return[]}static#e=this.\u0275fac=function(r){return new(r||e)(qe(Wt),qe(Kg),qe(pd))};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac})}return e})(),Kg=(()=>{class e{constructor(){this._applications=new Map}registerApplication(n,r){this._applications.set(n,r)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,r=!0){return Wg?.findTestabilityInTree(this,n,r)??null}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})(),gi=null;const aS=new Ve("AllowMultipleToken"),Zg=new Ve("PlatformDestroyListeners"),Yg=new Ve("appBootstrapListener");class lS{constructor(t,n){this.name=t,this.token=n}}function dS(e,t,n=[]){const r=`Platform: ${t}`,o=new Ve(r);return(i=[])=>{let s=Qg();if(!s||s.injector.get(aS,!1)){const a=[...n,...i,{provide:o,useValue:!0}];e?e(a):function e2(e){if(gi&&!gi.get(aS,!1))throw new Fe(400,!1);(function cS(){!function SO(e){wv=e}(()=>{throw new Fe(600,!1)})})(),gi=e;const t=e.get(fS);(function uS(e){e.get(fE,null)?.forEach(n=>n())})(e)}(function hS(e=[],t){return yr.create({name:t,providers:[{provide:Tp,useValue:"platform"},{provide:Zg,useValue:new Set([()=>gi=null])},...e]})}(a,r))}return function n2(e){const t=Qg();if(!t)throw new Fe(401,!1);return t}()}}function Qg(){return gi?.get(fS)??null}let fS=(()=>{class e{constructor(n){this._injector=n,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(n,r){const o=function r2(e="zone.js",t){return"noop"===e?new UN:"zone.js"===e?new Wt(t):e}(r?.ngZone,function pS(e){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:e?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:e?.runCoalescing??!1}}({eventCoalescing:r?.ngZoneEventCoalescing,runCoalescing:r?.ngZoneRunCoalescing}));return o.run(()=>{const i=function gF(e,t,n){return new Ig(e,t,n)}(n.moduleType,this.injector,function vS(e){return[{provide:Wt,useFactory:e},{provide:yc,multi:!0,useFactory:()=>{const t=Ze(i2,{optional:!0});return()=>t.initialize()}},{provide:yS,useFactory:o2},{provide:ME,useFactory:RE}]}(()=>o)),s=i.injector.get(Ur,null);return o.runOutsideAngular(()=>{const a=o.onError.subscribe({next:l=>{s.handleError(l)}});i.onDestroy(()=>{gd(this._modules,i),a.unsubscribe()})}),function gS(e,t,n){try{const r=n();return Rc(r)?r.catch(o=>{throw t.runOutsideAngular(()=>e.handleError(o)),o}):r}catch(r){throw t.runOutsideAngular(()=>e.handleError(r)),r}}(s,o,()=>{const a=i.injector.get(Vg);return a.runInitializers(),a.donePromise.then(()=>(function xb(e){d(e,"Expected localeId to be defined"),"string"==typeof e&&(Nb=e.toLowerCase().replace(/_/g,"-"))}(i.injector.get(Eo,oa)||oa),this._moduleDoBootstrap(i),i))})})}bootstrapModule(n,r=[]){const o=mS({},r);return function JU(e,t,n){const r=new Sg(n);return Promise.resolve(r)}(0,0,n).then(i=>this.bootstrapModuleFactory(i,o))}_moduleDoBootstrap(n){const r=n.injector.get(aa);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(o=>r.bootstrap(o));else{if(!n.instance.ngDoBootstrap)throw new Fe(-403,!1);n.instance.ngDoBootstrap(r)}this._modules.push(n)}onDestroy(n){this._destroyListeners.push(n)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Fe(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());const n=this._injector.get(Zg,null);n&&(n.forEach(r=>r()),n.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#e=this.\u0275fac=function(r){return new(r||e)(qe(yr))};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})();function mS(e,t){return Array.isArray(t)?t.reduce(mS,e):{...e,...t}}let aa=(()=>{class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=Ze(yS),this.zoneIsStable=Ze(ME),this.componentTypes=[],this.components=[],this.isStable=Ze(hd).hasPendingTasks.pipe(br(n=>n?Xe(!1):this.zoneIsStable),function Kr(e,t=Be){return e=e??ni,Ce((n,r)=>{let o,i=!0;n.subscribe(Me(r,s=>{const a=t(s);(i||!e(o,a))&&(i=!1,o=a,r.next(s))}))})}(),ja()),this._injector=Ze(Or)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(n,r){const o=n instanceof _E;if(!this._injector.get(Vg).done)throw!o&&function ms(e){const t=Tt(e)||Rn(e)||Zn(e);return null!==t&&t.standalone}(n),new Fe(405,!1);let s;s=o?n:this._injector.get(Hu).resolveComponentFactory(n),this.componentTypes.push(s.componentType);const a=function XU(e){return e.isBoundToModule}(s)?void 0:this._injector.get(Yi),h=s.create(yr.NULL,[],r||s.selector,a),f=h.location.nativeElement,v=h.injector.get(sS,null);return v?.registerApplication(f),h.onDestroy(()=>{this.detachView(h.hostView),gd(this.components,h),v?.unregisterApplication(f)}),this._loadComponent(h),h}tick(){if(this._runningTick)throw new Fe(101,!1);try{this._runningTick=!0;for(let n of this._views)n.detectChanges()}catch(n){this.internalErrorHandler(n)}finally{this._runningTick=!1}}attachView(n){const r=n;this._views.push(r),r.attachToAppRef(this)}detachView(n){const r=n;gd(this._views,r),r.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n);const r=this._injector.get(Yg,[]);r.push(...this._bootstrapListeners),r.forEach(o=>o(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>gd(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new Fe(406,!1);const n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function gd(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}const yS=new Ve("",{providedIn:"root",factory:()=>Ze(Ur).handleError.bind(void 0)});function o2(){const e=Ze(Wt),t=Ze(Ur);return n=>e.runOutsideAngular(()=>t.handleError(n))}let i2=(()=>{class e{constructor(){this.zone=Ze(Wt),this.applicationRef=Ze(aa)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();let md=(()=>{class e{static#e=this.__NG_ELEMENT_ID__=a2}return e})();function a2(e){return function c2(e,t,n){if(xi(e)&&!n){const r=Dr(e.index,t);return new Ic(r,r)}return 47&e.type?new Ic(t[hn],t):null}(Pn(),Le(),16==(16&e))}class bS{constructor(){}supports(t){return Zu(t)}create(t){return new p2(t)}}const f2=(e,t)=>t;class p2{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||f2}forEachItem(t){let n;for(n=this._itHead;null!==n;n=n._next)t(n)}forEachOperation(t){let n=this._itHead,r=this._removalsHead,o=0,i=null;for(;n||r;){const s=!r||n&&n.currentIndex<SS(r,o,i)?n:r,a=SS(s,o,i),l=s.currentIndex;if(s===r)o--,r=r._nextRemoved;else if(n=n._next,null==s.previousIndex)o++;else{i||(i=[]);const h=a-o,f=l-o;if(h!=f){for(let x=0;x<h;x++){const W=x<i.length?i[x]:i[x]=0,ne=W+x;f<=ne&&ne<h&&(i[x]=W+1)}i[s.previousIndex]=f-h}}a!==l&&t(s,a,l)}}forEachPreviousItem(t){let n;for(n=this._previousItHead;null!==n;n=n._nextPrevious)t(n)}forEachAddedItem(t){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)t(n)}forEachMovedItem(t){let n;for(n=this._movesHead;null!==n;n=n._nextMoved)t(n)}forEachRemovedItem(t){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)t(n)}forEachIdentityChange(t){let n;for(n=this._identityChangesHead;null!==n;n=n._nextIdentityChange)t(n)}diff(t){if(null==t&&(t=[]),!Zu(t))throw new Fe(900,!1);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let o,i,s,n=this._itHead,r=!1;if(Array.isArray(t)){this.length=t.length;for(let a=0;a<this.length;a++)i=t[a],s=this._trackByFn(a,i),null!==n&&Object.is(n.trackById,s)?(r&&(n=this._verifyReinsertion(n,i,s,a)),Object.is(n.item,i)||this._addIdentityChange(n,i)):(n=this._mismatch(n,i,s,a),r=!0),n=n._next}else o=0,function Wx(e,t){if(Array.isArray(e))for(let n=0;n<e.length;n++)t(e[n]);else{const n=e[Symbol.iterator]();let r;for(;!(r=n.next()).done;)t(r.value)}}(t,a=>{s=this._trackByFn(o,a),null!==n&&Object.is(n.trackById,s)?(r&&(n=this._verifyReinsertion(n,a,s,o)),Object.is(n.item,a)||this._addIdentityChange(n,a)):(n=this._mismatch(n,a,s,o),r=!0),n=n._next,o++}),this.length=o;return this._truncate(n),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,n,r,o){let i;return null===t?i=this._itTail:(i=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null))?(Object.is(t.item,n)||this._addIdentityChange(t,n),this._reinsertAfter(t,i,o)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(r,o))?(Object.is(t.item,n)||this._addIdentityChange(t,n),this._moveAfter(t,i,o)):t=this._addAfter(new g2(n,r),i,o),t}_verifyReinsertion(t,n,r,o){let i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null);return null!==i?t=this._reinsertAfter(i,t._prev,o):t.currentIndex!=o&&(t.currentIndex=o,this._addToMoves(t,o)),t}_truncate(t){for(;null!==t;){const n=t._next;this._addToRemovals(this._unlink(t)),t=n}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,n,r){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const o=t._prevRemoved,i=t._nextRemoved;return null===o?this._removalsHead=i:o._nextRemoved=i,null===i?this._removalsTail=o:i._prevRemoved=o,this._insertAfter(t,n,r),this._addToMoves(t,r),t}_moveAfter(t,n,r){return this._unlink(t),this._insertAfter(t,n,r),this._addToMoves(t,r),t}_addAfter(t,n,r){return this._insertAfter(t,n,r),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,n,r){const o=null===n?this._itHead:n._next;return t._next=o,t._prev=n,null===o?this._itTail=t:o._prev=t,null===n?this._itHead=t:n._next=t,null===this._linkedRecords&&(this._linkedRecords=new IS),this._linkedRecords.put(t),t.currentIndex=r,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const n=t._prev,r=t._next;return null===n?this._itHead=r:n._next=r,null===r?this._itTail=n:r._prev=n,t}_addToMoves(t,n){return t.previousIndex===n||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new IS),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,n){return t.item=n,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class g2{constructor(t,n){this.item=t,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class m2{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,n){let r;for(r=this._head;null!==r;r=r._nextDup)if((null===n||n<=r.currentIndex)&&Object.is(r.trackById,t))return r;return null}remove(t){const n=t._prevDup,r=t._nextDup;return null===n?this._head=r:n._nextDup=r,null===r?this._tail=n:r._prevDup=n,null===this._head}}class IS{constructor(){this.map=new Map}put(t){const n=t.trackById;let r=this.map.get(n);r||(r=new m2,this.map.set(n,r)),r.add(t)}get(t,n){const o=this.map.get(t);return o?o.get(t,n):null}remove(t){const n=t.trackById;return this.map.get(n).remove(t)&&this.map.delete(n),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function SS(e,t,n){const r=e.previousIndex;if(null===r)return r;let o=0;return n&&r<n.length&&(o=n[r]),r+t+o}class TS{constructor(){}supports(t){return t instanceof Map||sg(t)}create(){return new _2}}class _2{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let n;for(n=this._mapHead;null!==n;n=n._next)t(n)}forEachPreviousItem(t){let n;for(n=this._previousMapHead;null!==n;n=n._nextPrevious)t(n)}forEachChangedItem(t){let n;for(n=this._changesHead;null!==n;n=n._nextChanged)t(n)}forEachAddedItem(t){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)t(n)}forEachRemovedItem(t){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)t(n)}diff(t){if(t){if(!(t instanceof Map||sg(t)))throw new Fe(900,!1)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let n=this._mapHead;if(this._appendAfter=null,this._forEach(t,(r,o)=>{if(n&&n.key===o)this._maybeAddToChanges(n,r),this._appendAfter=n,n=n._next;else{const i=this._getOrCreateRecordForKey(o,r);n=this._insertBeforeOrAppend(n,i)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(let r=n;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,n){if(t){const r=t._prev;return n._next=t,n._prev=r,t._prev=n,r&&(r._next=n),t===this._mapHead&&(this._mapHead=n),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=n,n._prev=this._appendAfter):this._mapHead=n,this._appendAfter=n,null}_getOrCreateRecordForKey(t,n){if(this._records.has(t)){const o=this._records.get(t);this._maybeAddToChanges(o,n);const i=o._prev,s=o._next;return i&&(i._next=s),s&&(s._prev=i),o._next=null,o._prev=null,o}const r=new y2(t);return this._records.set(t,r),r.currentValue=n,this._addToAdditions(r),r}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,n){Object.is(n,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=n,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,n){t instanceof Map?t.forEach(n):Object.keys(t).forEach(r=>n(t[r],r))}}class y2{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function AS(){return new vd([new bS])}let vd=(()=>{class e{static#e=this.\u0275prov=de({token:e,providedIn:"root",factory:AS});constructor(n){this.factories=n}static create(n,r){if(null!=r){const o=r.factories.slice();n=n.concat(o)}return new e(n)}static extend(n){return{provide:e,useFactory:r=>e.create(n,r||AS()),deps:[[e,new uc,new Hi]]}}find(n){const r=this.factories.find(o=>o.supports(n));if(null!=r)return r;throw new Fe(901,!1)}}return e})();function DS(){return new Vc([new TS])}let Vc=(()=>{class e{static#e=this.\u0275prov=de({token:e,providedIn:"root",factory:DS});constructor(n){this.factories=n}static create(n,r){if(r){const o=r.factories.slice();n=n.concat(o)}return new e(n)}static extend(n){return{provide:e,useFactory:r=>e.create(n,r||DS()),deps:[[e,new uc,new Hi]]}}find(n){const r=this.factories.find(o=>o.supports(n));if(r)return r;throw new Fe(901,!1)}}return e})();const E2=dS(null,"core",[]);let w2=(()=>{class e{constructor(n){}static#e=this.\u0275fac=function(r){return new(r||e)(qe(aa))};static#t=this.\u0275mod=Bn({type:e});static#n=this.\u0275inj=Se({})}return e})();function ca(e){return"boolean"==typeof e?e:null!=e&&"false"!==e}let rm=null;function mi(){return rm}class L2{}const pn=new Ve("DocumentToken");let om=(()=>{class e{historyGo(n){throw new Error("Not implemented")}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=de({token:e,factory:function(){return Ze(U2)},providedIn:"platform"})}return e})();const F2=new Ve("Location Initialized");let U2=(()=>{class e extends om{constructor(){super(),this._doc=Ze(pn),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return mi().getBaseHref(this._doc)}onPopState(n){const r=mi().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",n,!1),()=>r.removeEventListener("popstate",n)}onHashChange(n){const r=mi().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",n,!1),()=>r.removeEventListener("hashchange",n)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(n){this._location.pathname=n}pushState(n,r,o){this._history.pushState(n,r,o)}replaceState(n,r,o){this._history.replaceState(n,r,o)}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=de({token:e,factory:function(){return new e},providedIn:"platform"})}return e})();function im(e,t){if(0==e.length)return t;if(0==t.length)return e;let n=0;return e.endsWith("/")&&n++,t.startsWith("/")&&n++,2==n?e+t.substring(1):1==n?e+t:e+"/"+t}function FS(e){const t=e.match(/#|\?|$/),n=t&&t.index||e.length;return e.slice(0,n-("/"===e[n-1]?1:0))+e.slice(n)}function zo(e){return e&&"?"!==e[0]?"?"+e:e}let Ji=(()=>{class e{historyGo(n){throw new Error("Not implemented")}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=de({token:e,factory:function(){return Ze(BS)},providedIn:"root"})}return e})();const US=new Ve("appBaseHref");let BS=(()=>{class e extends Ji{constructor(n,r){super(),this._platformLocation=n,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??Ze(pn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return im(this._baseHref,n)}path(n=!1){const r=this._platformLocation.pathname+zo(this._platformLocation.search),o=this._platformLocation.hash;return o&&n?`${r}${o}`:r}pushState(n,r,o,i){const s=this.prepareExternalUrl(o+zo(i));this._platformLocation.pushState(n,r,s)}replaceState(n,r,o,i){const s=this.prepareExternalUrl(o+zo(i));this._platformLocation.replaceState(n,r,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}static#e=this.\u0275fac=function(r){return new(r||e)(qe(om),qe(US,8))};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),B2=(()=>{class e extends Ji{constructor(n,r){super(),this._platformLocation=n,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}path(n=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(n){const r=im(this._baseHref,n);return r.length>0?"#"+r:r}pushState(n,r,o,i){let s=this.prepareExternalUrl(o+zo(i));0==s.length&&(s=this._platformLocation.pathname),this._platformLocation.pushState(n,r,s)}replaceState(n,r,o,i){let s=this.prepareExternalUrl(o+zo(i));0==s.length&&(s=this._platformLocation.pathname),this._platformLocation.replaceState(n,r,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}static#e=this.\u0275fac=function(r){return new(r||e)(qe(om),qe(US,8))};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac})}return e})(),zc=(()=>{class e{constructor(n){this._subject=new an,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=n;const r=this._locationStrategy.getBaseHref();this._basePath=function $2(e){if(new RegExp("^(https?:)?//").test(e)){const[,n]=e.split(/\/\/[^\/]+/);return n}return e}(FS(jS(r))),this._locationStrategy.onPopState(o=>{this._subject.emit({url:this.path(!0),pop:!0,state:o.state,type:o.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(n=!1){return this.normalize(this._locationStrategy.path(n))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(n,r=""){return this.path()==this.normalize(n+zo(r))}normalize(n){return e.stripTrailingSlash(function H2(e,t){if(!e||!t.startsWith(e))return t;const n=t.substring(e.length);return""===n||["/",";","?","#"].includes(n[0])?n:t}(this._basePath,jS(n)))}prepareExternalUrl(n){return n&&"/"!==n[0]&&(n="/"+n),this._locationStrategy.prepareExternalUrl(n)}go(n,r="",o=null){this._locationStrategy.pushState(o,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+zo(r)),o)}replaceState(n,r="",o=null){this._locationStrategy.replaceState(o,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+zo(r)),o)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(n=0){this._locationStrategy.historyGo?.(n)}onUrlChange(n){return this._urlChangeListeners.push(n),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)})),()=>{const r=this._urlChangeListeners.indexOf(n);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(n="",r){this._urlChangeListeners.forEach(o=>o(n,r))}subscribe(n,r,o){return this._subject.subscribe({next:n,error:r,complete:o})}static#e=this.normalizeQueryParams=zo;static#t=this.joinWithSlash=im;static#n=this.stripTrailingSlash=FS;static#r=this.\u0275fac=function(r){return new(r||e)(qe(Ji))};static#o=this.\u0275prov=de({token:e,factory:function(){return function j2(){return new zc(qe(Ji))}()},providedIn:"root"})}return e})();function jS(e){return e.replace(/\/index.html$/,"")}const HS={ADP:[void 0,void 0,0],AFN:[void 0,"\u060b",0],ALL:[void 0,void 0,0],AMD:[void 0,"\u058f",2],AOA:[void 0,"Kz"],ARS:[void 0,"$"],AUD:["A$","$"],AZN:[void 0,"\u20bc"],BAM:[void 0,"KM"],BBD:[void 0,"$"],BDT:[void 0,"\u09f3"],BHD:[void 0,void 0,3],BIF:[void 0,void 0,0],BMD:[void 0,"$"],BND:[void 0,"$"],BOB:[void 0,"Bs"],BRL:["R$"],BSD:[void 0,"$"],BWP:[void 0,"P"],BYN:[void 0,void 0,2],BYR:[void 0,void 0,0],BZD:[void 0,"$"],CAD:["CA$","$",2],CHF:[void 0,void 0,2],CLF:[void 0,void 0,4],CLP:[void 0,"$",0],CNY:["CN\xa5","\xa5"],COP:[void 0,"$",2],CRC:[void 0,"\u20a1",2],CUC:[void 0,"$"],CUP:[void 0,"$"],CZK:[void 0,"K\u010d",2],DJF:[void 0,void 0,0],DKK:[void 0,"kr",2],DOP:[void 0,"$"],EGP:[void 0,"E\xa3"],ESP:[void 0,"\u20a7",0],EUR:["\u20ac"],FJD:[void 0,"$"],FKP:[void 0,"\xa3"],GBP:["\xa3"],GEL:[void 0,"\u20be"],GHS:[void 0,"GH\u20b5"],GIP:[void 0,"\xa3"],GNF:[void 0,"FG",0],GTQ:[void 0,"Q"],GYD:[void 0,"$",2],HKD:["HK$","$"],HNL:[void 0,"L"],HRK:[void 0,"kn"],HUF:[void 0,"Ft",2],IDR:[void 0,"Rp",2],ILS:["\u20aa"],INR:["\u20b9"],IQD:[void 0,void 0,0],IRR:[void 0,void 0,0],ISK:[void 0,"kr",0],ITL:[void 0,void 0,0],JMD:[void 0,"$"],JOD:[void 0,void 0,3],JPY:["\xa5",void 0,0],KHR:[void 0,"\u17db"],KMF:[void 0,"CF",0],KPW:[void 0,"\u20a9",0],KRW:["\u20a9",void 0,0],KWD:[void 0,void 0,3],KYD:[void 0,"$"],KZT:[void 0,"\u20b8"],LAK:[void 0,"\u20ad",0],LBP:[void 0,"L\xa3",0],LKR:[void 0,"Rs"],LRD:[void 0,"$"],LTL:[void 0,"Lt"],LUF:[void 0,void 0,0],LVL:[void 0,"Ls"],LYD:[void 0,void 0,3],MGA:[void 0,"Ar",0],MGF:[void 0,void 0,0],MMK:[void 0,"K",0],MNT:[void 0,"\u20ae",2],MRO:[void 0,void 0,0],MUR:[void 0,"Rs",2],MXN:["MX$","$"],MYR:[void 0,"RM"],NAD:[void 0,"$"],NGN:[void 0,"\u20a6"],NIO:[void 0,"C$"],NOK:[void 0,"kr",2],NPR:[void 0,"Rs"],NZD:["NZ$","$"],OMR:[void 0,void 0,3],PHP:["\u20b1"],PKR:[void 0,"Rs",2],PLN:[void 0,"z\u0142"],PYG:[void 0,"\u20b2",0],RON:[void 0,"lei"],RSD:[void 0,void 0,0],RUB:[void 0,"\u20bd"],RWF:[void 0,"RF",0],SBD:[void 0,"$"],SEK:[void 0,"kr",2],SGD:[void 0,"$"],SHP:[void 0,"\xa3"],SLE:[void 0,void 0,2],SLL:[void 0,void 0,0],SOS:[void 0,void 0,0],SRD:[void 0,"$"],SSP:[void 0,"\xa3"],STD:[void 0,void 0,0],STN:[void 0,"Db"],SYP:[void 0,"\xa3",0],THB:[void 0,"\u0e3f"],TMM:[void 0,void 0,0],TND:[void 0,void 0,3],TOP:[void 0,"T$"],TRL:[void 0,void 0,0],TRY:[void 0,"\u20ba"],TTD:[void 0,"$"],TWD:["NT$","$",2],TZS:[void 0,void 0,2],UAH:[void 0,"\u20b4"],UGX:[void 0,void 0,0],USD:["$"],UYI:[void 0,void 0,0],UYU:[void 0,"$"],UYW:[void 0,void 0,4],UZS:[void 0,void 0,2],VEF:[void 0,"Bs",2],VND:["\u20ab",void 0,0],VUV:[void 0,void 0,0],XAF:["FCFA",void 0,0],XCD:["EC$","$"],XOF:["F\u202fCFA",void 0,0],XPF:["CFPF",void 0,0],XXX:["\xa4"],YER:[void 0,void 0,0],ZAR:[void 0,"R"],ZMK:[void 0,void 0,0],ZMW:[void 0,"ZK"],ZWD:[void 0,void 0,0]};var Ed=function(e){return e[e.Decimal=0]="Decimal",e[e.Percent=1]="Percent",e[e.Currency=2]="Currency",e[e.Scientific=3]="Scientific",e}(Ed||{}),or=function(e){return e[e.Format=0]="Format",e[e.Standalone=1]="Standalone",e}(or||{}),Zt=function(e){return e[e.Narrow=0]="Narrow",e[e.Abbreviated=1]="Abbreviated",e[e.Wide=2]="Wide",e[e.Short=3]="Short",e}(Zt||{}),Nr=function(e){return e[e.Short=0]="Short",e[e.Medium=1]="Medium",e[e.Long=2]="Long",e[e.Full=3]="Full",e}(Nr||{}),gn=function(e){return e[e.Decimal=0]="Decimal",e[e.Group=1]="Group",e[e.List=2]="List",e[e.PercentSign=3]="PercentSign",e[e.PlusSign=4]="PlusSign",e[e.MinusSign=5]="MinusSign",e[e.Exponential=6]="Exponential",e[e.SuperscriptingExponent=7]="SuperscriptingExponent",e[e.PerMille=8]="PerMille",e[e.Infinity=9]="Infinity",e[e.NaN=10]="NaN",e[e.TimeSeparator=11]="TimeSeparator",e[e.CurrencyDecimal=12]="CurrencyDecimal",e[e.CurrencyGroup=13]="CurrencyGroup",e}(gn||{});function wd(e,t){return Hr(nr(e)[Jt.DateFormat],t)}function bd(e,t){return Hr(nr(e)[Jt.TimeFormat],t)}function Id(e,t){return Hr(nr(e)[Jt.DateTimeFormat],t)}function jr(e,t){const n=nr(e),r=n[Jt.NumberSymbols][t];if(typeof r>"u"){if(t===gn.CurrencyDecimal)return n[Jt.NumberSymbols][gn.Decimal];if(t===gn.CurrencyGroup)return n[Jt.NumberSymbols][gn.Group]}return r}function $S(e){if(!e[Jt.ExtraData])throw new Error(`Missing extra locale data for the locale "${e[Jt.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Hr(e,t){for(let n=t;n>-1;n--)if(typeof e[n]<"u")return e[n];throw new Error("Locale data API: locale data undefined")}function am(e){const[t,n]=e.split(":");return{hours:+t,minutes:+n}}const nB=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,Gc={},rB=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var Go=function(e){return e[e.Short=0]="Short",e[e.ShortGMT=1]="ShortGMT",e[e.Long=2]="Long",e[e.Extended=3]="Extended",e}(Go||{}),Lt=function(e){return e[e.FullYear=0]="FullYear",e[e.Month=1]="Month",e[e.Date=2]="Date",e[e.Hours=3]="Hours",e[e.Minutes=4]="Minutes",e[e.Seconds=5]="Seconds",e[e.FractionalSeconds=6]="FractionalSeconds",e[e.Day=7]="Day",e}(Lt||{}),Ft=function(e){return e[e.DayPeriods=0]="DayPeriods",e[e.Days=1]="Days",e[e.Months=2]="Months",e[e.Eras=3]="Eras",e}(Ft||{});function oB(e,t,n,r){let o=function fB(e){if(GS(e))return e;if("number"==typeof e&&!isNaN(e))return new Date(e);if("string"==typeof e){if(e=e.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(e)){const[o,i=1,s=1]=e.split("-").map(a=>+a);return Sd(o,i-1,s)}const n=parseFloat(e);if(!isNaN(e-n))return new Date(n);let r;if(r=e.match(nB))return function pB(e){const t=new Date(0);let n=0,r=0;const o=e[8]?t.setUTCFullYear:t.setFullYear,i=e[8]?t.setUTCHours:t.setHours;e[9]&&(n=Number(e[9]+e[10]),r=Number(e[9]+e[11])),o.call(t,Number(e[1]),Number(e[2])-1,Number(e[3]));const s=Number(e[4]||0)-n,a=Number(e[5]||0)-r,l=Number(e[6]||0),h=Math.floor(1e3*parseFloat("0."+(e[7]||0)));return i.call(t,s,a,l,h),t}(r)}const t=new Date(e);if(!GS(t))throw new Error(`Unable to convert "${e}" into a date`);return t}(e);t=qo(n,t)||t;let a,s=[];for(;t;){if(a=rB.exec(t),!a){s.push(t);break}{s=s.concat(a.slice(1));const f=s.pop();if(!f)break;t=f}}let l=o.getTimezoneOffset();r&&(l=zS(r,l),o=function hB(e,t,n){const r=n?-1:1,o=e.getTimezoneOffset();return function dB(e,t){return(e=new Date(e.getTime())).setMinutes(e.getMinutes()+t),e}(e,r*(zS(t,o)-o))}(o,r,!0));let h="";return s.forEach(f=>{const v=function uB(e){if(lm[e])return lm[e];let t;switch(e){case"G":case"GG":case"GGG":t=Xt(Ft.Eras,Zt.Abbreviated);break;case"GGGG":t=Xt(Ft.Eras,Zt.Wide);break;case"GGGGG":t=Xt(Ft.Eras,Zt.Narrow);break;case"y":t=_n(Lt.FullYear,1,0,!1,!0);break;case"yy":t=_n(Lt.FullYear,2,0,!0,!0);break;case"yyy":t=_n(Lt.FullYear,3,0,!1,!0);break;case"yyyy":t=_n(Lt.FullYear,4,0,!1,!0);break;case"Y":t=Md(1);break;case"YY":t=Md(2,!0);break;case"YYY":t=Md(3);break;case"YYYY":t=Md(4);break;case"M":case"L":t=_n(Lt.Month,1,1);break;case"MM":case"LL":t=_n(Lt.Month,2,1);break;case"MMM":t=Xt(Ft.Months,Zt.Abbreviated);break;case"MMMM":t=Xt(Ft.Months,Zt.Wide);break;case"MMMMM":t=Xt(Ft.Months,Zt.Narrow);break;case"LLL":t=Xt(Ft.Months,Zt.Abbreviated,or.Standalone);break;case"LLLL":t=Xt(Ft.Months,Zt.Wide,or.Standalone);break;case"LLLLL":t=Xt(Ft.Months,Zt.Narrow,or.Standalone);break;case"w":t=cm(1);break;case"ww":t=cm(2);break;case"W":t=cm(1,!0);break;case"d":t=_n(Lt.Date,1);break;case"dd":t=_n(Lt.Date,2);break;case"c":case"cc":t=_n(Lt.Day,1);break;case"ccc":t=Xt(Ft.Days,Zt.Abbreviated,or.Standalone);break;case"cccc":t=Xt(Ft.Days,Zt.Wide,or.Standalone);break;case"ccccc":t=Xt(Ft.Days,Zt.Narrow,or.Standalone);break;case"cccccc":t=Xt(Ft.Days,Zt.Short,or.Standalone);break;case"E":case"EE":case"EEE":t=Xt(Ft.Days,Zt.Abbreviated);break;case"EEEE":t=Xt(Ft.Days,Zt.Wide);break;case"EEEEE":t=Xt(Ft.Days,Zt.Narrow);break;case"EEEEEE":t=Xt(Ft.Days,Zt.Short);break;case"a":case"aa":case"aaa":t=Xt(Ft.DayPeriods,Zt.Abbreviated);break;case"aaaa":t=Xt(Ft.DayPeriods,Zt.Wide);break;case"aaaaa":t=Xt(Ft.DayPeriods,Zt.Narrow);break;case"b":case"bb":case"bbb":t=Xt(Ft.DayPeriods,Zt.Abbreviated,or.Standalone,!0);break;case"bbbb":t=Xt(Ft.DayPeriods,Zt.Wide,or.Standalone,!0);break;case"bbbbb":t=Xt(Ft.DayPeriods,Zt.Narrow,or.Standalone,!0);break;case"B":case"BB":case"BBB":t=Xt(Ft.DayPeriods,Zt.Abbreviated,or.Format,!0);break;case"BBBB":t=Xt(Ft.DayPeriods,Zt.Wide,or.Format,!0);break;case"BBBBB":t=Xt(Ft.DayPeriods,Zt.Narrow,or.Format,!0);break;case"h":t=_n(Lt.Hours,1,-12);break;case"hh":t=_n(Lt.Hours,2,-12);break;case"H":t=_n(Lt.Hours,1);break;case"HH":t=_n(Lt.Hours,2);break;case"m":t=_n(Lt.Minutes,1);break;case"mm":t=_n(Lt.Minutes,2);break;case"s":t=_n(Lt.Seconds,1);break;case"ss":t=_n(Lt.Seconds,2);break;case"S":t=_n(Lt.FractionalSeconds,1);break;case"SS":t=_n(Lt.FractionalSeconds,2);break;case"SSS":t=_n(Lt.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=Ad(Go.Short);break;case"ZZZZZ":t=Ad(Go.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=Ad(Go.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=Ad(Go.Long);break;default:return null}return lm[e]=t,t}(f);h+=v?v(o,n,l):"''"===f?"'":f.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),h}function Sd(e,t,n){const r=new Date(0);return r.setFullYear(e,t,n),r.setHours(0,0,0),r}function qo(e,t){const n=function z2(e){return nr(e)[Jt.LocaleId]}(e);if(Gc[n]=Gc[n]||{},Gc[n][t])return Gc[n][t];let r="";switch(t){case"shortDate":r=wd(e,Nr.Short);break;case"mediumDate":r=wd(e,Nr.Medium);break;case"longDate":r=wd(e,Nr.Long);break;case"fullDate":r=wd(e,Nr.Full);break;case"shortTime":r=bd(e,Nr.Short);break;case"mediumTime":r=bd(e,Nr.Medium);break;case"longTime":r=bd(e,Nr.Long);break;case"fullTime":r=bd(e,Nr.Full);break;case"short":const o=qo(e,"shortTime"),i=qo(e,"shortDate");r=Td(Id(e,Nr.Short),[o,i]);break;case"medium":const s=qo(e,"mediumTime"),a=qo(e,"mediumDate");r=Td(Id(e,Nr.Medium),[s,a]);break;case"long":const l=qo(e,"longTime"),h=qo(e,"longDate");r=Td(Id(e,Nr.Long),[l,h]);break;case"full":const f=qo(e,"fullTime"),v=qo(e,"fullDate");r=Td(Id(e,Nr.Full),[f,v])}return r&&(Gc[n][t]=r),r}function Td(e,t){return t&&(e=e.replace(/\{([^}]+)}/g,function(n,r){return null!=t&&r in t?t[r]:n})),e}function ro(e,t,n="-",r,o){let i="";(e<0||o&&e<=0)&&(o?e=1-e:(e=-e,i=n));let s=String(e);for(;s.length<t;)s="0"+s;return r&&(s=s.slice(s.length-t)),i+s}function _n(e,t,n=0,r=!1,o=!1){return function(i,s){let a=function sB(e,t){switch(e){case Lt.FullYear:return t.getFullYear();case Lt.Month:return t.getMonth();case Lt.Date:return t.getDate();case Lt.Hours:return t.getHours();case Lt.Minutes:return t.getMinutes();case Lt.Seconds:return t.getSeconds();case Lt.FractionalSeconds:return t.getMilliseconds();case Lt.Day:return t.getDay();default:throw new Error(`Unknown DateType value "${e}".`)}}(e,i);if((n>0||a>-n)&&(a+=n),e===Lt.Hours)0===a&&-12===n&&(a=12);else if(e===Lt.FractionalSeconds)return function iB(e,t){return ro(e,3).substring(0,t)}(a,t);const l=jr(s,gn.MinusSign);return ro(a,t,l,r,o)}}function Xt(e,t,n=or.Format,r=!1){return function(o,i){return function aB(e,t,n,r,o,i){switch(n){case Ft.Months:return function K2(e,t,n){const r=nr(e),i=Hr([r[Jt.MonthsFormat],r[Jt.MonthsStandalone]],t);return Hr(i,n)}(t,o,r)[e.getMonth()];case Ft.Days:return function q2(e,t,n){const r=nr(e),i=Hr([r[Jt.DaysFormat],r[Jt.DaysStandalone]],t);return Hr(i,n)}(t,o,r)[e.getDay()];case Ft.DayPeriods:const s=e.getHours(),a=e.getMinutes();if(i){const h=function Q2(e){const t=nr(e);return $S(t),(t[Jt.ExtraData][2]||[]).map(r=>"string"==typeof r?am(r):[am(r[0]),am(r[1])])}(t),f=function J2(e,t,n){const r=nr(e);$S(r);const i=Hr([r[Jt.ExtraData][0],r[Jt.ExtraData][1]],t)||[];return Hr(i,n)||[]}(t,o,r),v=h.findIndex(x=>{if(Array.isArray(x)){const[W,ne]=x,ae=s>=W.hours&&a>=W.minutes,_e=s<ne.hours||s===ne.hours&&a<ne.minutes;if(W.hours<ne.hours){if(ae&&_e)return!0}else if(ae||_e)return!0}else if(x.hours===s&&x.minutes===a)return!0;return!1});if(-1!==v)return f[v]}return function G2(e,t,n){const r=nr(e),i=Hr([r[Jt.DayPeriodsFormat],r[Jt.DayPeriodsStandalone]],t);return Hr(i,n)}(t,o,r)[s<12?0:1];case Ft.Eras:return function W2(e,t){return Hr(nr(e)[Jt.Eras],t)}(t,r)[e.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${n}`)}}(o,i,e,t,n,r)}}function Ad(e){return function(t,n,r){const o=-1*r,i=jr(n,gn.MinusSign),s=o>0?Math.floor(o/60):Math.ceil(o/60);switch(e){case Go.Short:return(o>=0?"+":"")+ro(s,2,i)+ro(Math.abs(o%60),2,i);case Go.ShortGMT:return"GMT"+(o>=0?"+":"")+ro(s,1,i);case Go.Long:return"GMT"+(o>=0?"+":"")+ro(s,2,i)+":"+ro(Math.abs(o%60),2,i);case Go.Extended:return 0===r?"Z":(o>=0?"+":"")+ro(s,2,i)+":"+ro(Math.abs(o%60),2,i);default:throw new Error(`Unknown zone width "${e}"`)}}}const cB=0,Dd=4;function VS(e){return Sd(e.getFullYear(),e.getMonth(),e.getDate()+(Dd-e.getDay()))}function cm(e,t=!1){return function(n,r){let o;if(t){const i=new Date(n.getFullYear(),n.getMonth(),1).getDay()-1,s=n.getDate();o=1+Math.floor((s+i)/7)}else{const i=VS(n),s=function lB(e){const t=Sd(e,cB,1).getDay();return Sd(e,0,1+(t<=Dd?Dd:Dd+7)-t)}(i.getFullYear()),a=i.getTime()-s.getTime();o=1+Math.round(a/6048e5)}return ro(o,e,jr(r,gn.MinusSign))}}function Md(e,t=!1){return function(n,r){return ro(VS(n).getFullYear(),e,jr(r,gn.MinusSign),t)}}const lm={};function zS(e,t){e=e.replace(/:/g,"");const n=Date.parse("Jan 01, 1970 00:00:00 "+e)/6e4;return isNaN(n)?t:n}function GS(e){return e instanceof Date&&!isNaN(e.valueOf())}const gB=/^(\d+)?\.((\d+)(-(\d+))?)?$/,qS=22,Rd=".",qc="0",mB=";",_B=",",um="#";function vB(e,t,n,r,o){const s=function hm(e,t="-"){const n={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=e.split(mB),o=r[0],i=r[1],s=-1!==o.indexOf(Rd)?o.split(Rd):[o.substring(0,o.lastIndexOf(qc)+1),o.substring(o.lastIndexOf(qc)+1)],a=s[0],l=s[1]||"";n.posPre=a.substring(0,a.indexOf(um));for(let f=0;f<l.length;f++){const v=l.charAt(f);v===qc?n.minFrac=n.maxFrac=f+1:v===um?n.maxFrac=f+1:n.posSuf+=v}const h=a.split(_B);if(n.gSize=h[1]?h[1].length:0,n.lgSize=h[2]||h[1]?(h[2]||h[1]).length:0,i){const f=o.length-n.posPre.length-n.posSuf.length,v=i.indexOf(um);n.negPre=i.substring(0,v).replace(/'/g,""),n.negSuf=i.slice(v+f).replace(/'/g,"")}else n.negPre=t+n.posPre,n.negSuf=n.posSuf;return n}(function sm(e,t){return nr(e)[Jt.NumberFormats][t]}(t,Ed.Currency),jr(t,gn.MinusSign));return s.minFrac=function tB(e){let t;const n=HS[e];return n&&(t=n[2]),"number"==typeof t?t:2}(r),s.maxFrac=s.minFrac,function dm(e,t,n,r,o,i,s=!1){let a="",l=!1;if(isFinite(e)){let h=function bB(e){let r,o,i,s,a,t=Math.abs(e)+"",n=0;for((o=t.indexOf(Rd))>-1&&(t=t.replace(Rd,"")),(i=t.search(/e/i))>0?(o<0&&(o=i),o+=+t.slice(i+1),t=t.substring(0,i)):o<0&&(o=t.length),i=0;t.charAt(i)===qc;i++);if(i===(a=t.length))r=[0],o=1;else{for(a--;t.charAt(a)===qc;)a--;for(o-=i,r=[],s=0;i<=a;i++,s++)r[s]=Number(t.charAt(i))}return o>qS&&(r=r.splice(0,qS-1),n=o-1,o=1),{digits:r,exponent:n,integerLen:o}}(e);s&&(h=function wB(e){if(0===e.digits[0])return e;const t=e.digits.length-e.integerLen;return e.exponent?e.exponent+=2:(0===t?e.digits.push(0,0):1===t&&e.digits.push(0),e.integerLen+=2),e}(h));let f=t.minInt,v=t.minFrac,x=t.maxFrac;if(i){const ve=i.match(gB);if(null===ve)throw new Error(`${i} is not a valid digit info`);const Ue=ve[1],We=ve[3],Qe=ve[5];null!=Ue&&(f=fm(Ue)),null!=We&&(v=fm(We)),null!=Qe?x=fm(Qe):null!=We&&v>x&&(x=v)}!function IB(e,t,n){if(t>n)throw new Error(`The minimum number of digits after fraction (${t}) is higher than the maximum (${n}).`);let r=e.digits,o=r.length-e.integerLen;const i=Math.min(Math.max(t,o),n);let s=i+e.integerLen,a=r[s];if(s>0){r.splice(Math.max(e.integerLen,s));for(let v=s;v<r.length;v++)r[v]=0}else{o=Math.max(0,o),e.integerLen=1,r.length=Math.max(1,s=i+1),r[0]=0;for(let v=1;v<s;v++)r[v]=0}if(a>=5)if(s-1<0){for(let v=0;v>s;v--)r.unshift(0),e.integerLen++;r.unshift(1),e.integerLen++}else r[s-1]++;for(;o<Math.max(0,i);o++)r.push(0);let l=0!==i;const h=t+e.integerLen,f=r.reduceRight(function(v,x,W,ne){return ne[W]=(x+=v)<10?x:x-10,l&&(0===ne[W]&&W>=h?ne.pop():l=!1),x>=10?1:0},0);f&&(r.unshift(f),e.integerLen++)}(h,v,x);let W=h.digits,ne=h.integerLen;const ae=h.exponent;let _e=[];for(l=W.every(ve=>!ve);ne<f;ne++)W.unshift(0);for(;ne<0;ne++)W.unshift(0);ne>0?_e=W.splice(ne,W.length):(_e=W,W=[0]);const Ae=[];for(W.length>=t.lgSize&&Ae.unshift(W.splice(-t.lgSize,W.length).join(""));W.length>t.gSize;)Ae.unshift(W.splice(-t.gSize,W.length).join(""));W.length&&Ae.unshift(W.join("")),a=Ae.join(jr(n,r)),_e.length&&(a+=jr(n,o)+_e.join("")),ae&&(a+=jr(n,gn.Exponential)+"+"+ae)}else a=jr(n,gn.Infinity);return a=e<0&&!l?t.negPre+a+t.negSuf:t.posPre+a+t.posSuf,a}(e,s,t,gn.CurrencyGroup,gn.CurrencyDecimal,o).replace("\xa4",n).replace("\xa4","").trim()}function fm(e){const t=parseInt(e);if(isNaN(t))throw new Error("Invalid integer literal when parsing "+e);return t}function ZS(e,t){t=encodeURIComponent(t);for(const n of e.split(";")){const r=n.indexOf("="),[o,i]=-1==r?[n,""]:[n.slice(0,r),n.slice(r+1)];if(o.trim()===t)return decodeURIComponent(i)}return null}const gm=/\s+/,YS=[];let QS=(()=>{class e{constructor(n,r,o,i){this._iterableDiffers=n,this._keyValueDiffers=r,this._ngEl=o,this._renderer=i,this.initialClasses=YS,this.stateMap=new Map}set klass(n){this.initialClasses=null!=n?n.trim().split(gm):YS}set ngClass(n){this.rawClass="string"==typeof n?n.trim().split(gm):n}ngDoCheck(){for(const r of this.initialClasses)this._updateState(r,!0);const n=this.rawClass;if(Array.isArray(n)||n instanceof Set)for(const r of n)this._updateState(r,!0);else if(null!=n)for(const r of Object.keys(n))this._updateState(r,!!n[r]);this._applyStateDiff()}_updateState(n,r){const o=this.stateMap.get(n);void 0!==o?(o.enabled!==r&&(o.changed=!0,o.enabled=r),o.touched=!0):this.stateMap.set(n,{enabled:r,changed:!0,touched:!0})}_applyStateDiff(){for(const n of this.stateMap){const r=n[0],o=n[1];o.changed?(this._toggleClass(r,o.enabled),o.changed=!1):o.touched||(o.enabled&&this._toggleClass(r,!1),this.stateMap.delete(r)),o.touched=!1}}_toggleClass(n,r){(n=n.trim()).length>0&&n.split(gm).forEach(o=>{r?this._renderer.addClass(this._ngEl.nativeElement,o):this._renderer.removeClass(this._ngEl.nativeElement,o)})}static#e=this.\u0275fac=function(r){return new(r||e)(Pe(vd),Pe(Vc),Pe(er),Pe(Bo))};static#t=this.\u0275dir=lt({type:e,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0})}return e})();class AB{constructor(t,n,r,o){this.$implicit=t,this.ngForOf=n,this.index=r,this.count=o}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Od=(()=>{class e{set ngForOf(n){this._ngForOf=n,this._ngForOfDirty=!0}set ngForTrackBy(n){this._trackByFn=n}get ngForTrackBy(){return this._trackByFn}constructor(n,r,o){this._viewContainer=n,this._template=r,this._differs=o,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(n){n&&(this._template=n)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;!this._differ&&n&&(this._differ=this._differs.find(n).create(this.ngForTrackBy))}if(this._differ){const n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}_applyChanges(n){const r=this._viewContainer;n.forEachOperation((o,i,s)=>{if(null==o.previousIndex)r.createEmbeddedView(this._template,new AB(o.item,this._ngForOf,-1,-1),null===s?void 0:s);else if(null==s)r.remove(null===i?void 0:i);else if(null!==i){const a=r.get(i);r.move(a,s),XS(a,o)}});for(let o=0,i=r.length;o<i;o++){const a=r.get(o).context;a.index=o,a.count=i,a.ngForOf=this._ngForOf}n.forEachIdentityChange(o=>{XS(r.get(o.currentIndex),o)})}static ngTemplateContextGuard(n,r){return!0}static#e=this.\u0275fac=function(r){return new(r||e)(Pe(no),Pe(Vo),Pe(vd))};static#t=this.\u0275dir=lt({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}return e})();function XS(e,t){e.context.$implicit=t.item}let ua=(()=>{class e{constructor(n,r){this._viewContainer=n,this._context=new DB,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){eT("ngIfThen",n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){eT("ngIfElse",n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(n,r){return!0}static#e=this.\u0275fac=function(r){return new(r||e)(Pe(no),Pe(Vo))};static#t=this.\u0275dir=lt({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return e})();class DB{constructor(){this.$implicit=null,this.ngIf=null}}function eT(e,t){if(t&&!t.createEmbeddedView)throw new Error(`${e} must be a TemplateRef, but received '${un(t)}'.`)}function oo(e,t){return new Fe(2100,!1)}const HB=new Ve("DATE_PIPE_DEFAULT_TIMEZONE"),$B=new Ve("DATE_PIPE_DEFAULT_OPTIONS");let ym=(()=>{class e{constructor(n,r,o){this.locale=n,this.defaultTimezone=r,this.defaultOptions=o}transform(n,r,o,i){if(null==n||""===n||n!=n)return null;try{return oB(n,r??this.defaultOptions?.dateFormat??"mediumDate",i||this.locale,o??this.defaultOptions?.timezone??this.defaultTimezone??void 0)}catch(s){throw oo()}}static#e=this.\u0275fac=function(r){return new(r||e)(Pe(Eo,16),Pe(HB,24),Pe($B,24))};static#t=this.\u0275pipe=pr({name:"date",type:e,pure:!0,standalone:!0})}return e})(),kd=(()=>{class e{constructor(n,r="USD"){this._locale=n,this._defaultCurrencyCode=r}transform(n,r=this._defaultCurrencyCode,o="symbol",i,s){if(!function vm(e){return!(null==e||""===e||e!=e)}(n))return null;s=s||this._locale,"boolean"==typeof o&&(o=o?"symbol":"code");let a=r||this._defaultCurrencyCode;"code"!==o&&(a="symbol"===o||"symbol-narrow"===o?function X2(e,t,n="en"){const r=function Z2(e){return nr(e)[Jt.Currencies]}(n)[e]||HS[e]||[],o=r[1];return"narrow"===t&&"string"==typeof o?o:r[0]||e}(a,"symbol"===o?"wide":"narrow",s):o);try{return vB(function Cm(e){if("string"==typeof e&&!isNaN(Number(e)-parseFloat(e)))return Number(e);if("number"!=typeof e)throw new Error(`${e} is not a number`);return e}(n),s,a,r,i)}catch(l){throw oo()}}static#e=this.\u0275fac=function(r){return new(r||e)(Pe(Eo,16),Pe(AU,16))};static#t=this.\u0275pipe=pr({name:"currency",type:e,pure:!0,standalone:!0})}return e})();let rT=(()=>{class e{transform(n,r,o){if(null==n)return null;if(!this.supports(n))throw oo();return n.slice(r,o)}supports(n){return"string"==typeof n||Array.isArray(n)}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275pipe=pr({name:"slice",type:e,pure:!1,standalone:!0})}return e})(),oT=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275mod=Bn({type:e});static#n=this.\u0275inj=Se({})}return e})();const iT="browser";function sT(e){return"server"===e}let tj=(()=>{class e{static#e=this.\u0275prov=de({token:e,providedIn:"root",factory:()=>new nj(qe(pn),window)})}return e})();class nj{constructor(t,n){this.document=t,this.window=n,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(!this.supportsScrolling())return;const n=function rj(e,t){const n=e.getElementById(t)||e.getElementsByName(t)[0];if(n)return n;if("function"==typeof e.createTreeWalker&&e.body&&"function"==typeof e.body.attachShadow){const r=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT);let o=r.currentNode;for(;o;){const i=o.shadowRoot;if(i){const s=i.getElementById(t)||i.querySelector(`[name="${t}"]`);if(s)return s}o=r.nextNode()}}return null}(this.document,t);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(t){this.supportsScrolling()&&(this.window.history.scrollRestoration=t)}scrollToElement(t){const n=t.getBoundingClientRect(),r=n.left+this.window.pageXOffset,o=n.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(r-i[0],o-i[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class aT{}class Tj extends L2{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class bm extends Tj{static makeCurrent(){!function x2(e){rm||(rm=e)}(new bm)}onAndCancel(t,n,r){return t.addEventListener(n,r),()=>{t.removeEventListener(n,r)}}dispatchEvent(t,n){t.dispatchEvent(n)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,n){return(n=n||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,n){return"window"===n?window:"document"===n?t:"body"===n?t.body:null}getBaseHref(t){const n=function Aj(){return Wc=Wc||document.querySelector("base"),Wc?Wc.getAttribute("href"):null}();return null==n?null:function Dj(e){xd=xd||document.createElement("a"),xd.setAttribute("href",e);const t=xd.pathname;return"/"===t.charAt(0)?t:`/${t}`}(n)}resetBaseElement(){Wc=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return ZS(document.cookie,t)}}let xd,Wc=null,Rj=(()=>{class e{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac})}return e})();const Im=new Ve("EventManagerPlugins");let hT=(()=>{class e{constructor(n,r){this._zone=r,this._eventNameToPlugin=new Map,n.forEach(o=>{o.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,r,o){return this._findPluginFor(r).addEventListener(n,r,o)}getZone(){return this._zone}_findPluginFor(n){let r=this._eventNameToPlugin.get(n);if(r)return r;if(r=this._plugins.find(i=>i.supports(n)),!r)throw new Fe(5101,!1);return this._eventNameToPlugin.set(n,r),r}static#e=this.\u0275fac=function(r){return new(r||e)(qe(Im),qe(Wt))};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac})}return e})();class fT{constructor(t){this._doc=t}}const Sm="ng-app-id";let pT=(()=>{class e{constructor(n,r,o,i={}){this.doc=n,this.appId=r,this.nonce=o,this.platformId=i,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=sT(i),this.resetHostNodes()}addStyles(n){for(const r of n)1===this.changeUsageCount(r,1)&&this.onStyleAdded(r)}removeStyles(n){for(const r of n)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){const n=this.styleNodesInDOM;n&&(n.forEach(r=>r.remove()),n.clear());for(const r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(n){this.hostNodes.add(n);for(const r of this.getAllStyles())this.addStyleToHost(n,r)}removeHost(n){this.hostNodes.delete(n)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(n){for(const r of this.hostNodes)this.addStyleToHost(r,n)}onStyleRemoved(n){const r=this.styleRef;r.get(n)?.elements?.forEach(o=>o.remove()),r.delete(n)}collectServerRenderedStyles(){const n=this.doc.head?.querySelectorAll(`style[${Sm}="${this.appId}"]`);if(n?.length){const r=new Map;return n.forEach(o=>{null!=o.textContent&&r.set(o.textContent,o)}),r}return null}changeUsageCount(n,r){const o=this.styleRef;if(o.has(n)){const i=o.get(n);return i.usage+=r,i.usage}return o.set(n,{usage:r,elements:[]}),r}getStyleElement(n,r){const o=this.styleNodesInDOM,i=o?.get(r);if(i?.parentNode===n)return o.delete(r),i.removeAttribute(Sm),i;{const s=this.doc.createElement("style");return this.nonce&&s.setAttribute("nonce",this.nonce),s.textContent=r,this.platformIsServer&&s.setAttribute(Sm,this.appId),s}}addStyleToHost(n,r){const o=this.getStyleElement(n,r);n.appendChild(o);const i=this.styleRef,s=i.get(r)?.elements;s?s.push(o):i.set(r,{elements:[o],usage:1})}resetHostNodes(){const n=this.hostNodes;n.clear(),n.add(this.doc.head)}static#e=this.\u0275fac=function(r){return new(r||e)(qe(pn),qe(xu),qe(Rp,8),qe(fi))};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac})}return e})();const Tm={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Am=/%COMP%/g,Nj=new Ve("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function mT(e,t){return t.map(n=>n.replace(Am,e))}let _T=(()=>{class e{constructor(n,r,o,i,s,a,l,h=null){this.eventManager=n,this.sharedStylesHost=r,this.appId=o,this.removeStylesOnCompDestroy=i,this.doc=s,this.platformId=a,this.ngZone=l,this.nonce=h,this.rendererByCompId=new Map,this.platformIsServer=sT(a),this.defaultRenderer=new Dm(n,s,l,this.platformIsServer)}createRenderer(n,r){if(!n||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===Wr.ShadowDom&&(r={...r,encapsulation:Wr.Emulated});const o=this.getOrCreateRenderer(n,r);return o instanceof vT?o.applyToHost(n):o instanceof Mm&&o.applyStyles(),o}getOrCreateRenderer(n,r){const o=this.rendererByCompId;let i=o.get(r.id);if(!i){const s=this.doc,a=this.ngZone,l=this.eventManager,h=this.sharedStylesHost,f=this.removeStylesOnCompDestroy,v=this.platformIsServer;switch(r.encapsulation){case Wr.Emulated:i=new vT(l,h,r,this.appId,f,s,a,v);break;case Wr.ShadowDom:return new Uj(l,h,n,r,s,a,this.nonce,v);default:i=new Mm(l,h,r,f,s,a,v)}o.set(r.id,i)}return i}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(r){return new(r||e)(qe(hT),qe(pT),qe(xu),qe(Nj),qe(pn),qe(fi),qe(Wt),qe(Rp))};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac})}return e})();class Dm{constructor(t,n,r,o){this.eventManager=t,this.doc=n,this.ngZone=r,this.platformIsServer=o,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,n){return n?this.doc.createElementNS(Tm[n]||n,t):this.doc.createElement(t)}createComment(t){return this.doc.createComment(t)}createText(t){return this.doc.createTextNode(t)}appendChild(t,n){(yT(t)?t.content:t).appendChild(n)}insertBefore(t,n,r){t&&(yT(t)?t.content:t).insertBefore(n,r)}removeChild(t,n){t&&t.removeChild(n)}selectRootElement(t,n){let r="string"==typeof t?this.doc.querySelector(t):t;if(!r)throw new Fe(-5104,!1);return n||(r.textContent=""),r}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,n,r,o){if(o){n=o+":"+n;const i=Tm[o];i?t.setAttributeNS(i,n,r):t.setAttribute(n,r)}else t.setAttribute(n,r)}removeAttribute(t,n,r){if(r){const o=Tm[r];o?t.removeAttributeNS(o,n):t.removeAttribute(`${r}:${n}`)}else t.removeAttribute(n)}addClass(t,n){t.classList.add(n)}removeClass(t,n){t.classList.remove(n)}setStyle(t,n,r,o){o&(hi.DashCase|hi.Important)?t.style.setProperty(n,r,o&hi.Important?"important":""):t.style[n]=r}removeStyle(t,n,r){r&hi.DashCase?t.style.removeProperty(n):t.style[n]=""}setProperty(t,n,r){t[n]=r}setValue(t,n){t.nodeValue=n}listen(t,n,r){if("string"==typeof t&&!(t=mi().getGlobalEventTarget(this.doc,t)))throw new Error(`Unsupported event target ${t} for event ${n}`);return this.eventManager.addEventListener(t,n,this.decoratePreventDefault(r))}decoratePreventDefault(t){return n=>{if("__ngUnwrap__"===n)return t;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>t(n)):t(n))&&n.preventDefault()}}}function yT(e){return"TEMPLATE"===e.tagName&&void 0!==e.content}class Uj extends Dm{constructor(t,n,r,o,i,s,a,l){super(t,i,s,l),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const h=mT(o.id,o.styles);for(const f of h){const v=document.createElement("style");a&&v.setAttribute("nonce",a),v.textContent=f,this.shadowRoot.appendChild(v)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}appendChild(t,n){return super.appendChild(this.nodeOrShadowRoot(t),n)}insertBefore(t,n,r){return super.insertBefore(this.nodeOrShadowRoot(t),n,r)}removeChild(t,n){return super.removeChild(this.nodeOrShadowRoot(t),n)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class Mm extends Dm{constructor(t,n,r,o,i,s,a,l){super(t,i,s,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=o,this.styles=l?mT(l,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class vT extends Mm{constructor(t,n,r,o,i,s,a,l){const h=o+"-"+r.id;super(t,n,r,i,s,a,l,h),this.contentAttr=function xj(e){return"_ngcontent-%COMP%".replace(Am,e)}(h),this.hostAttr=function Lj(e){return"_nghost-%COMP%".replace(Am,e)}(h)}applyToHost(t){this.applyStyles(),this.setAttribute(t,this.hostAttr,"")}createElement(t,n){const r=super.createElement(t,n);return super.setAttribute(r,this.contentAttr,""),r}}let Bj=(()=>{class e extends fT{constructor(n){super(n)}supports(n){return!0}addEventListener(n,r,o){return n.addEventListener(r,o,!1),()=>this.removeEventListener(n,r,o)}removeEventListener(n,r,o){return n.removeEventListener(r,o)}static#e=this.\u0275fac=function(r){return new(r||e)(qe(pn))};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac})}return e})();const CT=["alt","control","meta","shift"],jj={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Hj={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey};let $j=(()=>{class e extends fT{constructor(n){super(n)}supports(n){return null!=e.parseEventName(n)}addEventListener(n,r,o){const i=e.parseEventName(r),s=e.eventCallback(i.fullKey,o,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>mi().onAndCancel(n,i.domEventName,s))}static parseEventName(n){const r=n.toLowerCase().split("."),o=r.shift();if(0===r.length||"keydown"!==o&&"keyup"!==o)return null;const i=e._normalizeKey(r.pop());let s="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),s="code."),CT.forEach(h=>{const f=r.indexOf(h);f>-1&&(r.splice(f,1),s+=h+".")}),s+=i,0!=r.length||0===i.length)return null;const l={};return l.domEventName=o,l.fullKey=s,l}static matchEventFullKeyCode(n,r){let o=jj[n.key]||n.key,i="";return r.indexOf("code.")>-1&&(o=n.code,i="code."),!(null==o||!o)&&(o=o.toLowerCase()," "===o?o="space":"."===o&&(o="dot"),CT.forEach(s=>{s!==o&&(0,Hj[s])(n)&&(i+=s+".")}),i+=o,i===r)}static eventCallback(n,r,o){return i=>{e.matchEventFullKeyCode(i,n)&&o.runGuarded(()=>r(i))}}static _normalizeKey(n){return"esc"===n?"escape":n}static#e=this.\u0275fac=function(r){return new(r||e)(qe(pn))};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac})}return e})();const wT=[{provide:fi,useValue:iT},{provide:fE,useValue:function Vj(){bm.makeCurrent()},multi:!0},{provide:pn,useFactory:function Gj(){return function DP(e){_p=e}(document),document},deps:[]}],qj=dS(E2,"browser",wT),Kj=new Ve(""),bT=[{provide:pd,useClass:class Mj{addToWindow(t){Yt.getAngularTestability=(r,o=!0)=>{const i=t.findTestabilityInTree(r,o);if(null==i)throw new Fe(5103,!1);return i},Yt.getAllAngularTestabilities=()=>t.getAllTestabilities(),Yt.getAllAngularRootElements=()=>t.getAllRootElements(),Yt.frameworkStabilizers||(Yt.frameworkStabilizers=[]),Yt.frameworkStabilizers.push(r=>{const o=Yt.getAllAngularTestabilities();let i=o.length,s=!1;const a=function(l){s=s||l,i--,0==i&&r(s)};o.forEach(l=>{l.whenStable(a)})})}findTestabilityInTree(t,n,r){return null==n?null:t.getTestability(n)??(r?mi().isShadowRoot(n)?this.findTestabilityInTree(t,n.host,!0):this.findTestabilityInTree(t,n.parentElement,!0):null)}},deps:[]},{provide:sS,useClass:qg,deps:[Wt,Kg,pd]},{provide:qg,useClass:qg,deps:[Wt,Kg,pd]}],IT=[{provide:Tp,useValue:"root"},{provide:Ur,useFactory:function zj(){return new Ur},deps:[]},{provide:Im,useClass:Bj,multi:!0,deps:[pn,Wt,fi]},{provide:Im,useClass:$j,multi:!0,deps:[pn]},_T,pT,hT,{provide:vE,useExisting:_T},{provide:aT,useClass:Rj,deps:[]},[]];let Wj=(()=>{class e{constructor(n){}static withServerTransition(n){return{ngModule:e,providers:[{provide:xu,useValue:n.appId}]}}static#e=this.\u0275fac=function(r){return new(r||e)(qe(Kj,12))};static#t=this.\u0275mod=Bn({type:e});static#n=this.\u0275inj=Se({providers:[...IT,...bT],imports:[oT,w2]})}return e})(),ST=(()=>{class e{constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}static#e=this.\u0275fac=function(r){return new(r||e)(qe(pn))};static#t=this.\u0275prov=de({token:e,factory:function(r){let o=null;return o=r?new r:function Yj(){return new ST(qe(pn))}(),o},providedIn:"root"})}return e})();typeof window<"u"&&window;let Om=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=de({token:e,factory:function(r){let o=null;return o=r?new(r||e):qe(DT),o},providedIn:"root"})}return e})(),DT=(()=>{class e extends Om{constructor(n){super(),this._doc=n}sanitize(n,r){if(null==r)return null;switch(n){case xn.NONE:return r;case xn.HTML:return mo(r,"HTML")?Rr(r):rE(this._doc,String(r)).toString();case xn.STYLE:return mo(r,"Style")?Rr(r):r;case xn.SCRIPT:if(mo(r,"Script"))return Rr(r);throw new Fe(5200,!1);case xn.URL:return mo(r,"URL")?Rr(r):Du(String(r));case xn.RESOURCE_URL:if(mo(r,"ResourceURL"))return Rr(r);throw new Fe(5201,!1);default:throw new Fe(5202,!1)}}bypassSecurityTrustHtml(n){return function xP(e){return new MP(e)}(n)}bypassSecurityTrustStyle(n){return function LP(e){return new RP(e)}(n)}bypassSecurityTrustScript(n){return function FP(e){return new OP(e)}(n)}bypassSecurityTrustUrl(n){return function UP(e){return new kP(e)}(n)}bypassSecurityTrustResourceUrl(n){return function BP(e){return new PP(e)}(n)}static#e=this.\u0275fac=function(r){return new(r||e)(qe(pn))};static#t=this.\u0275prov=de({token:e,factory:function(r){let o=null;return o=r?new r:function eH(e){return new DT(e.get(pn))}(qe(yr)),o},providedIn:"root"})}return e})();const{isArray:nH}=Array,{getPrototypeOf:rH,prototype:oH,keys:iH}=Object;function RT(e){if(1===e.length){const t=e[0];if(nH(t))return{args:t,keys:null};if(function sH(e){return e&&"object"==typeof e&&rH(e)===oH}(t)){const n=iH(t);return{args:n.map(r=>t[r]),keys:n}}}return{args:e,keys:null}}const{isArray:aH}=Array;function OT(e){return be(t=>function cH(e,t){return aH(t)?e(...t):e(t)}(e,t))}function kT(e,t){return e.reduce((n,r,o)=>(n[r]=t[o],n),{})}function Ld(...e){const t=St(e),n=Gt(e),{args:r,keys:o}=RT(e);if(0===r.length)return kt([],t);const i=new G(function lH(e,t,n=Be){return r=>{PT(t,()=>{const{length:o}=e,i=new Array(o);let s=o,a=o;for(let l=0;l<o;l++)PT(t,()=>{const h=kt(e[l],t);let f=!1;h.subscribe(Me(r,v=>{i[l]=v,f||(f=!0,a--),a||r.next(n(i.slice()))},()=>{--s||r.complete()}))},r)},r)}}(r,t,o?s=>kT(o,s):Be));return n?i.pipe(OT(n)):i}function PT(e,t,n){e?I(n,e,t):t()}const Fd=O(e=>function(){e(this),this.name="EmptyError",this.message="no elements in sequence"});function Ud(...e){return function uH(){return he(1)}()(kt(e,St(e)))}function NT(e){return new G(t=>{vn(e()).subscribe(t)})}function da(e,t){const n=p(e)?e:()=>e,r=o=>o.error(n());return new G(t?o=>t.schedule(r,0,o):r)}function km(){return Ce((e,t)=>{let n=null;e._refCount++;const r=Me(t,void 0,void 0,void 0,()=>{if(!e||e._refCount<=0||0<--e._refCount)return void(n=null);const o=e._connection,i=n;n=null,o&&(!i||o===i)&&o.unsubscribe(),t.unsubscribe()});e.subscribe(r),r.closed||(n=e.connect())})}class xT extends G{constructor(t,n){super(),this.source=t,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,le(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,t?.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new H;const n=this.getSubject();t.add(this.source.subscribe(Me(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),t.closed&&(this._connection=null,t=H.EMPTY)}return t}refCount(){return km()(this)}}function yi(e){return e<=0?()=>ye:Ce((t,n)=>{let r=0;t.subscribe(Me(n,o=>{++r<=e&&(n.next(o),e<=r&&n.complete())}))})}function LT(...e){const t=St(e);return Ce((n,r)=>{(t?Ud(e,n,t):Ud(e,n)).subscribe(r)})}function wo(e,t){return Ce((n,r)=>{let o=0;n.subscribe(Me(r,i=>e.call(t,i,o++)&&r.next(i)))})}function Bd(e){return Ce((t,n)=>{let r=!1;t.subscribe(Me(n,o=>{r=!0,n.next(o)},()=>{r||n.next(e),n.complete()}))})}function FT(e=dH){return Ce((t,n)=>{let r=!1;t.subscribe(Me(n,o=>{r=!0,n.next(o)},()=>r?n.complete():n.error(e())))})}function dH(){return new Fd}function Xi(e,t){const n=arguments.length>=2;return r=>r.pipe(e?wo((o,i)=>e(o,i,r)):Be,yi(1),n?Bd(t):FT(()=>new Fd))}function vi(e,t){return p(t)?X(e,t,1):X(e,1)}function In(e,t,n){const r=p(e)||t||n?{next:e,error:t,complete:n}:e;return r?Ce((o,i)=>{var s;null===(s=r.subscribe)||void 0===s||s.call(r);let a=!0;o.subscribe(Me(i,l=>{var h;null===(h=r.next)||void 0===h||h.call(r,l),i.next(l)},()=>{var l;a=!1,null===(l=r.complete)||void 0===l||l.call(r),i.complete()},l=>{var h;a=!1,null===(h=r.error)||void 0===h||h.call(r,l),i.error(l)},()=>{var l,h;a&&(null===(l=r.unsubscribe)||void 0===l||l.call(r)),null===(h=r.finalize)||void 0===h||h.call(r)}))}):Be}function Ko(e){return Ce((t,n)=>{let i,r=null,o=!1;r=t.subscribe(Me(n,void 0,void 0,s=>{i=vn(e(s,Ko(e)(t))),r?(r.unsubscribe(),r=null,i.subscribe(n)):o=!0})),o&&(r.unsubscribe(),r=null,i.subscribe(n))})}function Pm(e){return e<=0?()=>ye:Ce((t,n)=>{let r=[];t.subscribe(Me(n,o=>{r.push(o),e<r.length&&r.shift()},()=>{for(const o of r)n.next(o);n.complete()},void 0,()=>{r=null}))})}function ha(e){return Ce((t,n)=>{try{t.subscribe(n)}finally{n.add(e)}})}function UT(e){return Ce((t,n)=>{vn(e).subscribe(Me(n,()=>n.complete(),z)),!n.closed&&t.subscribe(n)})}const vt="primary",Zc=Symbol("RouteTitle");class mH{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const n=this.params[t];return Array.isArray(n)?n[0]:n}return null}getAll(t){if(this.has(t)){const n=this.params[t];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}}function fa(e){return new mH(e)}function _H(e,t,n){const r=n.path.split("/");if(r.length>e.length||"full"===n.pathMatch&&(t.hasChildren()||r.length<e.length))return null;const o={};for(let i=0;i<r.length;i++){const s=r[i],a=e[i];if(s.startsWith(":"))o[s.substring(1)]=a;else if(s!==a.path)return null}return{consumed:e.slice(0,r.length),posParams:o}}function bo(e,t){const n=e?Object.keys(e):void 0,r=t?Object.keys(t):void 0;if(!n||!r||n.length!=r.length)return!1;let o;for(let i=0;i<n.length;i++)if(o=n[i],!BT(e[o],t[o]))return!1;return!0}function BT(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;const n=[...e].sort(),r=[...t].sort();return n.every((o,i)=>r[i]===o)}return e===t}function jT(e){return e.length>0?e[e.length-1]:null}function Ci(e){return function tH(e){return!!e&&(e instanceof G||p(e.lift)&&p(e.subscribe))}(e)?e:Rc(e)?kt(Promise.resolve(e)):Xe(e)}const vH={exact:function VT(e,t,n){if(!es(e.segments,t.segments)||!jd(e.segments,t.segments,n)||e.numberOfChildren!==t.numberOfChildren)return!1;for(const r in t.children)if(!e.children[r]||!VT(e.children[r],t.children[r],n))return!1;return!0},subset:zT},HT={exact:function CH(e,t){return bo(e,t)},subset:function EH(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(n=>BT(e[n],t[n]))},ignored:()=>!0};function $T(e,t,n){return vH[n.paths](e.root,t.root,n.matrixParams)&&HT[n.queryParams](e.queryParams,t.queryParams)&&!("exact"===n.fragment&&e.fragment!==t.fragment)}function zT(e,t,n){return GT(e,t,t.segments,n)}function GT(e,t,n,r){if(e.segments.length>n.length){const o=e.segments.slice(0,n.length);return!(!es(o,n)||t.hasChildren()||!jd(o,n,r))}if(e.segments.length===n.length){if(!es(e.segments,n)||!jd(e.segments,n,r))return!1;for(const o in t.children)if(!e.children[o]||!zT(e.children[o],t.children[o],r))return!1;return!0}{const o=n.slice(0,e.segments.length),i=n.slice(e.segments.length);return!!(es(e.segments,o)&&jd(e.segments,o,r)&&e.children[vt])&&GT(e.children[vt],t,i,r)}}function jd(e,t,n){return t.every((r,o)=>HT[n](e[o].parameters,r.parameters))}class pa{constructor(t=new Vt([],{}),n={},r=null){this.root=t,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=fa(this.queryParams)),this._queryParamMap}toString(){return IH.serialize(this)}}class Vt{constructor(t,n){this.segments=t,this.children=n,this.parent=null,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Hd(this)}}class Yc{constructor(t,n){this.path=t,this.parameters=n}get parameterMap(){return this._parameterMap||(this._parameterMap=fa(this.parameters)),this._parameterMap}toString(){return WT(this)}}function es(e,t){return e.length===t.length&&e.every((n,r)=>n.path===t[r].path)}let Qc=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=de({token:e,factory:function(){return new Nm},providedIn:"root"})}return e})();class Nm{parse(t){const n=new xH(t);return new pa(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(t){const n=`/${Jc(t.root,!0)}`,r=function AH(e){const t=Object.keys(e).map(n=>{const r=e[n];return Array.isArray(r)?r.map(o=>`${$d(n)}=${$d(o)}`).join("&"):`${$d(n)}=${$d(r)}`}).filter(n=>!!n);return t.length?`?${t.join("&")}`:""}(t.queryParams);return`${n}${r}${"string"==typeof t.fragment?`#${function SH(e){return encodeURI(e)}(t.fragment)}`:""}`}}const IH=new Nm;function Hd(e){return e.segments.map(t=>WT(t)).join("/")}function Jc(e,t){if(!e.hasChildren())return Hd(e);if(t){const n=e.children[vt]?Jc(e.children[vt],!1):"",r=[];return Object.entries(e.children).forEach(([o,i])=>{o!==vt&&r.push(`${o}:${Jc(i,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}{const n=function bH(e,t){let n=[];return Object.entries(e.children).forEach(([r,o])=>{r===vt&&(n=n.concat(t(o,r)))}),Object.entries(e.children).forEach(([r,o])=>{r!==vt&&(n=n.concat(t(o,r)))}),n}(e,(r,o)=>o===vt?[Jc(e.children[vt],!1)]:[`${o}:${Jc(r,!1)}`]);return 1===Object.keys(e.children).length&&null!=e.children[vt]?`${Hd(e)}/${n[0]}`:`${Hd(e)}/(${n.join("//")})`}}function qT(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function $d(e){return qT(e).replace(/%3B/gi,";")}function xm(e){return qT(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Vd(e){return decodeURIComponent(e)}function KT(e){return Vd(e.replace(/\+/g,"%20"))}function WT(e){return`${xm(e.path)}${function TH(e){return Object.keys(e).map(t=>`;${xm(t)}=${xm(e[t])}`).join("")}(e.parameters)}`}const DH=/^[^\/()?;#]+/;function Lm(e){const t=e.match(DH);return t?t[0]:""}const MH=/^[^\/()?;=#]+/,OH=/^[^=?&#]+/,PH=/^[^&#]+/;class xH{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Vt([],{}):new Vt([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(t.length>0||Object.keys(n).length>0)&&(r[vt]=new Vt(t,n)),r}parseSegment(){const t=Lm(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Fe(4009,!1);return this.capture(t),new Yc(Vd(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const n=function RH(e){const t=e.match(MH);return t?t[0]:""}(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){const o=Lm(this.remaining);o&&(r=o,this.capture(r))}t[Vd(n)]=Vd(r)}parseQueryParam(t){const n=function kH(e){const t=e.match(OH);return t?t[0]:""}(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){const s=function NH(e){const t=e.match(PH);return t?t[0]:""}(this.remaining);s&&(r=s,this.capture(r))}const o=KT(n),i=KT(r);if(t.hasOwnProperty(o)){let s=t[o];Array.isArray(s)||(s=[s],t[o]=s),s.push(i)}else t[o]=i}parseParens(t){const n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=Lm(this.remaining),o=this.remaining[r.length];if("/"!==o&&")"!==o&&";"!==o)throw new Fe(4010,!1);let i;r.indexOf(":")>-1?(i=r.slice(0,r.indexOf(":")),this.capture(i),this.capture(":")):t&&(i=vt);const s=this.parseChildren();n[i]=1===Object.keys(s).length?s[vt]:new Vt([],s),this.consumeOptional("//")}return n}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Fe(4011,!1)}}function ZT(e){return e.segments.length>0?new Vt([],{[vt]:e}):e}function YT(e){const t={};for(const r of Object.keys(e.children)){const i=YT(e.children[r]);if(r===vt&&0===i.segments.length&&i.hasChildren())for(const[s,a]of Object.entries(i.children))t[s]=a;else(i.segments.length>0||i.hasChildren())&&(t[r]=i)}return function LH(e){if(1===e.numberOfChildren&&e.children[vt]){const t=e.children[vt];return new Vt(e.segments.concat(t.segments),t.children)}return e}(new Vt(e.segments,t))}function ts(e){return e instanceof pa}function QT(e){let t;const o=ZT(function n(i){const s={};for(const l of i.children){const h=n(l);s[l.outlet]=h}const a=new Vt(i.url,s);return i===e&&(t=a),a}(e.root));return t??o}function JT(e,t,n,r){let o=e;for(;o.parent;)o=o.parent;if(0===t.length)return Fm(o,o,o,n,r);const i=function UH(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new eA(!0,0,e);let t=0,n=!1;const r=e.reduce((o,i,s)=>{if("object"==typeof i&&null!=i){if(i.outlets){const a={};return Object.entries(i.outlets).forEach(([l,h])=>{a[l]="string"==typeof h?h.split("/"):h}),[...o,{outlets:a}]}if(i.segmentPath)return[...o,i.segmentPath]}return"string"!=typeof i?[...o,i]:0===s?(i.split("/").forEach((a,l)=>{0==l&&"."===a||(0==l&&""===a?n=!0:".."===a?t++:""!=a&&o.push(a))}),o):[...o,i]},[]);return new eA(n,t,r)}(t);if(i.toRoot())return Fm(o,o,new Vt([],{}),n,r);const s=function BH(e,t,n){if(e.isAbsolute)return new Gd(t,!0,0);if(!n)return new Gd(t,!1,NaN);if(null===n.parent)return new Gd(n,!0,0);const r=zd(e.commands[0])?0:1;return function jH(e,t,n){let r=e,o=t,i=n;for(;i>o;){if(i-=o,r=r.parent,!r)throw new Fe(4005,!1);o=r.segments.length}return new Gd(r,!1,o-i)}(n,n.segments.length-1+r,e.numberOfDoubleDots)}(i,o,e),a=s.processChildren?el(s.segmentGroup,s.index,i.commands):tA(s.segmentGroup,s.index,i.commands);return Fm(o,s.segmentGroup,a,n,r)}function zd(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function Xc(e){return"object"==typeof e&&null!=e&&e.outlets}function Fm(e,t,n,r,o){let s,i={};r&&Object.entries(r).forEach(([l,h])=>{i[l]=Array.isArray(h)?h.map(f=>`${f}`):`${h}`}),s=e===t?n:XT(e,t,n);const a=ZT(YT(s));return new pa(a,i,o)}function XT(e,t,n){const r={};return Object.entries(e.children).forEach(([o,i])=>{r[o]=i===t?n:XT(i,t,n)}),new Vt(e.segments,r)}class eA{constructor(t,n,r){if(this.isAbsolute=t,this.numberOfDoubleDots=n,this.commands=r,t&&r.length>0&&zd(r[0]))throw new Fe(4003,!1);const o=r.find(Xc);if(o&&o!==jT(r))throw new Fe(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Gd{constructor(t,n,r){this.segmentGroup=t,this.processChildren=n,this.index=r}}function tA(e,t,n){if(e||(e=new Vt([],{})),0===e.segments.length&&e.hasChildren())return el(e,t,n);const r=function $H(e,t,n){let r=0,o=t;const i={match:!1,pathIndex:0,commandIndex:0};for(;o<e.segments.length;){if(r>=n.length)return i;const s=e.segments[o],a=n[r];if(Xc(a))break;const l=`${a}`,h=r<n.length-1?n[r+1]:null;if(o>0&&void 0===l)break;if(l&&h&&"object"==typeof h&&void 0===h.outlets){if(!rA(l,h,s))return i;r+=2}else{if(!rA(l,{},s))return i;r++}o++}return{match:!0,pathIndex:o,commandIndex:r}}(e,t,n),o=n.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){const i=new Vt(e.segments.slice(0,r.pathIndex),{});return i.children[vt]=new Vt(e.segments.slice(r.pathIndex),e.children),el(i,0,o)}return r.match&&0===o.length?new Vt(e.segments,{}):r.match&&!e.hasChildren()?Um(e,t,n):r.match?el(e,0,o):Um(e,t,n)}function el(e,t,n){if(0===n.length)return new Vt(e.segments,{});{const r=function HH(e){return Xc(e[0])?e[0].outlets:{[vt]:e}}(n),o={};if(Object.keys(r).some(i=>i!==vt)&&e.children[vt]&&1===e.numberOfChildren&&0===e.children[vt].segments.length){const i=el(e.children[vt],t,n);return new Vt(e.segments,i.children)}return Object.entries(r).forEach(([i,s])=>{"string"==typeof s&&(s=[s]),null!==s&&(o[i]=tA(e.children[i],t,s))}),Object.entries(e.children).forEach(([i,s])=>{void 0===r[i]&&(o[i]=s)}),new Vt(e.segments,o)}}function Um(e,t,n){const r=e.segments.slice(0,t);let o=0;for(;o<n.length;){const i=n[o];if(Xc(i)){const l=VH(i.outlets);return new Vt(r,l)}if(0===o&&zd(n[0])){r.push(new Yc(e.segments[t].path,nA(n[0]))),o++;continue}const s=Xc(i)?i.outlets[vt]:`${i}`,a=o<n.length-1?n[o+1]:null;s&&a&&zd(a)?(r.push(new Yc(s,nA(a))),o+=2):(r.push(new Yc(s,{})),o++)}return new Vt(r,{})}function VH(e){const t={};return Object.entries(e).forEach(([n,r])=>{"string"==typeof r&&(r=[r]),null!==r&&(t[n]=Um(new Vt([],{}),0,r))}),t}function nA(e){const t={};return Object.entries(e).forEach(([n,r])=>t[n]=`${r}`),t}function rA(e,t,n){return e==n.path&&bo(t,n.parameters)}const tl="imperative";class Io{constructor(t,n){this.id=t,this.url=n}}class qd extends Io{constructor(t,n,r="imperative",o=null){super(t,n),this.type=0,this.navigationTrigger=r,this.restoredState=o}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Ei extends Io{constructor(t,n,r){super(t,n),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class nl extends Io{constructor(t,n,r,o){super(t,n),this.reason=r,this.code=o,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class ga extends Io{constructor(t,n,r,o){super(t,n),this.reason=r,this.code=o,this.type=16}}class Kd extends Io{constructor(t,n,r,o){super(t,n),this.error=r,this.target=o,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class oA extends Io{constructor(t,n,r,o){super(t,n),this.urlAfterRedirects=r,this.state=o,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class zH extends Io{constructor(t,n,r,o){super(t,n),this.urlAfterRedirects=r,this.state=o,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class GH extends Io{constructor(t,n,r,o,i){super(t,n),this.urlAfterRedirects=r,this.state=o,this.shouldActivate=i,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class qH extends Io{constructor(t,n,r,o){super(t,n),this.urlAfterRedirects=r,this.state=o,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class KH extends Io{constructor(t,n,r,o){super(t,n),this.urlAfterRedirects=r,this.state=o,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class WH{constructor(t){this.route=t,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class ZH{constructor(t){this.route=t,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class YH{constructor(t){this.snapshot=t,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class QH{constructor(t){this.snapshot=t,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class JH{constructor(t){this.snapshot=t,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class XH{constructor(t){this.snapshot=t,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class iA{constructor(t,n,r){this.routerEvent=t,this.position=n,this.anchor=r,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class Bm{}class jm{constructor(t){this.url=t}}class e${constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new rl,this.attachRef=null}}let rl=(()=>{class e{constructor(){this.contexts=new Map}onChildOutletCreated(n,r){const o=this.getOrCreateContext(n);o.outlet=r,this.contexts.set(n,o)}onChildOutletDestroyed(n){const r=this.getContext(n);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let r=this.getContext(n);return r||(r=new e$,this.contexts.set(n,r)),r}getContext(n){return this.contexts.get(n)||null}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class sA{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const n=this.pathFromRoot(t);return n.length>1?n[n.length-2]:null}children(t){const n=Hm(t,this._root);return n?n.children.map(r=>r.value):[]}firstChild(t){const n=Hm(t,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(t){const n=$m(t,this._root);return n.length<2?[]:n[n.length-2].children.map(o=>o.value).filter(o=>o!==t)}pathFromRoot(t){return $m(t,this._root).map(n=>n.value)}}function Hm(e,t){if(e===t.value)return t;for(const n of t.children){const r=Hm(e,n);if(r)return r}return null}function $m(e,t){if(e===t.value)return[t];for(const n of t.children){const r=$m(e,n);if(r.length)return r.unshift(t),r}return[]}class Wo{constructor(t,n){this.value=t,this.children=n}toString(){return`TreeNode(${this.value})`}}function ma(e){const t={};return e&&e.children.forEach(n=>t[n.value.outlet]=n),t}class aA extends sA{constructor(t,n){super(t),this.snapshot=n,Vm(this,t)}toString(){return this.snapshot.toString()}}function cA(e,t){const n=function t$(e,t){const s=new Wd([],{},{},"",{},vt,t,null,{});return new uA("",new Wo(s,[]))}(0,t),r=new An([new Yc("",{})]),o=new An({}),i=new An({}),s=new An({}),a=new An(""),l=new ns(r,o,s,a,i,vt,t,n.root);return l.snapshot=n.root,new aA(new Wo(l,[]),n)}class ns{constructor(t,n,r,o,i,s,a,l){this.urlSubject=t,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=o,this.dataSubject=i,this.outlet=s,this.component=a,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(be(h=>h[Zc]))??Xe(void 0),this.url=t,this.params=n,this.queryParams=r,this.fragment=o,this.data=i}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(be(t=>fa(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(be(t=>fa(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function lA(e,t="emptyOnly"){const n=e.pathFromRoot;let r=0;if("always"!==t)for(r=n.length-1;r>=1;){const o=n[r],i=n[r-1];if(o.routeConfig&&""===o.routeConfig.path)r--;else{if(i.component)break;r--}}return function n$(e){return e.reduce((t,n)=>({params:{...t.params,...n.params},data:{...t.data,...n.data},resolve:{...n.data,...t.resolve,...n.routeConfig?.data,...n._resolvedData}}),{params:{},data:{},resolve:{}})}(n.slice(r))}class Wd{get title(){return this.data?.[Zc]}constructor(t,n,r,o,i,s,a,l,h){this.url=t,this.params=n,this.queryParams=r,this.fragment=o,this.data=i,this.outlet=s,this.component=a,this.routeConfig=l,this._resolve=h}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=fa(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=fa(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class uA extends sA{constructor(t,n){super(n),this.url=t,Vm(this,n)}toString(){return dA(this._root)}}function Vm(e,t){t.value._routerState=e,t.children.forEach(n=>Vm(e,n))}function dA(e){const t=e.children.length>0?` { ${e.children.map(dA).join(", ")} } `:"";return`${e.value}${t}`}function zm(e){if(e.snapshot){const t=e.snapshot,n=e._futureSnapshot;e.snapshot=n,bo(t.queryParams,n.queryParams)||e.queryParamsSubject.next(n.queryParams),t.fragment!==n.fragment&&e.fragmentSubject.next(n.fragment),bo(t.params,n.params)||e.paramsSubject.next(n.params),function yH(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(!bo(e[n],t[n]))return!1;return!0}(t.url,n.url)||e.urlSubject.next(n.url),bo(t.data,n.data)||e.dataSubject.next(n.data)}else e.snapshot=e._futureSnapshot,e.dataSubject.next(e._futureSnapshot.data)}function Gm(e,t){const n=bo(e.params,t.params)&&function wH(e,t){return es(e,t)&&e.every((n,r)=>bo(n.parameters,t[r].parameters))}(e.url,t.url);return n&&!(!e.parent!=!t.parent)&&(!e.parent||Gm(e.parent,t.parent))}let qm=(()=>{class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=vt,this.activateEvents=new an,this.deactivateEvents=new an,this.attachEvents=new an,this.detachEvents=new an,this.parentContexts=Ze(rl),this.location=Ze(no),this.changeDetector=Ze(md),this.environmentInjector=Ze(Or),this.inputBinder=Ze(Zd,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(n){if(n.name){const{firstChange:r,previousValue:o}=n.name;if(r)return;this.isTrackedInParentContexts(o)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(o)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Fe(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Fe(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Fe(4012,!1);this.location.detach();const n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,r){this.activated=n,this._activatedRoute=r,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){const n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,r){if(this.isActivated)throw new Fe(4013,!1);this._activatedRoute=n;const o=this.location,s=n.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new r$(n,a,o.injector);this.activated=o.createComponent(s,{index:o.length,injector:l,environmentInjector:r??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275dir=lt({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Ar]})}return e})();class r${constructor(t,n,r){this.route=t,this.childContexts=n,this.parent=r}get(t,n){return t===ns?this.route:t===rl?this.childContexts:this.parent.get(t,n)}}const Zd=new Ve("");let hA=(()=>{class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(n){this.unsubscribeFromRouteData(n),this.subscribeToRouteData(n)}unsubscribeFromRouteData(n){this.outletDataSubscriptions.get(n)?.unsubscribe(),this.outletDataSubscriptions.delete(n)}subscribeToRouteData(n){const{activatedRoute:r}=n,o=Ld([r.queryParams,r.params,r.data]).pipe(br(([i,s,a],l)=>(a={...i,...s,...a},0===l?Xe(a):Promise.resolve(a)))).subscribe(i=>{if(!n.isActivated||!n.activatedComponentRef||n.activatedRoute!==r||null===r.component)return void this.unsubscribeFromRouteData(n);const s=function N2(e){const t=Tt(e);if(!t)return null;const n=new Sc(t);return{get selector(){return n.selector},get type(){return n.componentType},get inputs(){return n.inputs},get outputs(){return n.outputs},get ngContentSelectors(){return n.ngContentSelectors},get isStandalone(){return t.standalone},get isSignal(){return t.signals}}}(r.component);if(s)for(const{templateName:a}of s.inputs)n.activatedComponentRef.setInput(a,i[a]);else this.unsubscribeFromRouteData(n)});this.outletDataSubscriptions.set(n,o)}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac})}return e})();function ol(e,t,n){if(n&&e.shouldReuseRoute(t.value,n.value.snapshot)){const r=n.value;r._futureSnapshot=t.value;const o=function i$(e,t,n){return t.children.map(r=>{for(const o of n.children)if(e.shouldReuseRoute(r.value,o.value.snapshot))return ol(e,r,o);return ol(e,r)})}(e,t,n);return new Wo(r,o)}{if(e.shouldAttach(t.value)){const i=e.retrieve(t.value);if(null!==i){const s=i.route;return s.value._futureSnapshot=t.value,s.children=t.children.map(a=>ol(e,a)),s}}const r=function s$(e){return new ns(new An(e.url),new An(e.params),new An(e.queryParams),new An(e.fragment),new An(e.data),e.outlet,e.component,e)}(t.value),o=t.children.map(i=>ol(e,i));return new Wo(r,o)}}const Km="ngNavigationCancelingError";function fA(e,t){const{redirectTo:n,navigationBehaviorOptions:r}=ts(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,o=pA(!1,0,t);return o.url=n,o.navigationBehaviorOptions=r,o}function pA(e,t,n){const r=new Error("NavigationCancelingError: "+(e||""));return r[Km]=!0,r.cancellationCode=t,n&&(r.url=n),r}function gA(e){return e&&e[Km]}let mA=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275cmp=Sr({type:e,selectors:[["ng-component"]],standalone:!0,features:[cI],decls:1,vars:0,template:function(r,o){1&r&&$t(0,"router-outlet")},dependencies:[qm],encapsulation:2})}return e})();function Wm(e){const t=e.children&&e.children.map(Wm),n=t?{...e,children:t}:{...e};return!n.component&&!n.loadComponent&&(t||n.loadChildren)&&n.outlet&&n.outlet!==vt&&(n.component=mA),n}function io(e){return e.outlet||vt}function il(e){if(!e)return null;if(e.routeConfig?._injector)return e.routeConfig._injector;for(let t=e.parent;t;t=t.parent){const n=t.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}class p${constructor(t,n,r,o,i){this.routeReuseStrategy=t,this.futureState=n,this.currState=r,this.forwardEvent=o,this.inputBindingEnabled=i}activate(t){const n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,t),zm(this.futureState.root),this.activateChildRoutes(n,r,t)}deactivateChildRoutes(t,n,r){const o=ma(n);t.children.forEach(i=>{const s=i.value.outlet;this.deactivateRoutes(i,o[s],r),delete o[s]}),Object.values(o).forEach(i=>{this.deactivateRouteAndItsChildren(i,r)})}deactivateRoutes(t,n,r){const o=t.value,i=n?n.value:null;if(o===i)if(o.component){const s=r.getContext(o.outlet);s&&this.deactivateChildRoutes(t,n,s.children)}else this.deactivateChildRoutes(t,n,r);else i&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(t,n){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,n):this.deactivateRouteAndOutlet(t,n)}detachAndStoreRouteSubtree(t,n){const r=n.getContext(t.value.outlet),o=r&&t.value.component?r.children:n,i=ma(t);for(const s of Object.keys(i))this.deactivateRouteAndItsChildren(i[s],o);if(r&&r.outlet){const s=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:s,route:t,contexts:a})}}deactivateRouteAndOutlet(t,n){const r=n.getContext(t.value.outlet),o=r&&t.value.component?r.children:n,i=ma(t);for(const s of Object.keys(i))this.deactivateRouteAndItsChildren(i[s],o);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(t,n,r){const o=ma(n);t.children.forEach(i=>{this.activateRoutes(i,o[i.value.outlet],r),this.forwardEvent(new XH(i.value.snapshot))}),t.children.length&&this.forwardEvent(new QH(t.value.snapshot))}activateRoutes(t,n,r){const o=t.value,i=n?n.value:null;if(zm(o),o===i)if(o.component){const s=r.getOrCreateContext(o.outlet);this.activateChildRoutes(t,n,s.children)}else this.activateChildRoutes(t,n,r);else if(o.component){const s=r.getOrCreateContext(o.outlet);if(this.routeReuseStrategy.shouldAttach(o.snapshot)){const a=this.routeReuseStrategy.retrieve(o.snapshot);this.routeReuseStrategy.store(o.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),zm(a.route.value),this.activateChildRoutes(t,null,s.children)}else{const a=il(o.snapshot);s.attachRef=null,s.route=o,s.injector=a,s.outlet&&s.outlet.activateWith(o,s.injector),this.activateChildRoutes(t,null,s.children)}}else this.activateChildRoutes(t,null,r)}}class _A{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class Yd{constructor(t,n){this.component=t,this.route=n}}function g$(e,t,n){const r=e._root;return sl(r,t?t._root:null,n,[r.value])}function _a(e,t){const n=Symbol(),r=t.get(e,n);return r===n?"function"!=typeof e||function gt(e){return null!==nt(e)}(e)?t.get(e):e:r}function sl(e,t,n,r,o={canDeactivateChecks:[],canActivateChecks:[]}){const i=ma(t);return e.children.forEach(s=>{(function _$(e,t,n,r,o={canDeactivateChecks:[],canActivateChecks:[]}){const i=e.value,s=t?t.value:null,a=n?n.getContext(e.value.outlet):null;if(s&&i.routeConfig===s.routeConfig){const l=function y$(e,t,n){if("function"==typeof n)return n(e,t);switch(n){case"pathParamsChange":return!es(e.url,t.url);case"pathParamsOrQueryParamsChange":return!es(e.url,t.url)||!bo(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Gm(e,t)||!bo(e.queryParams,t.queryParams);default:return!Gm(e,t)}}(s,i,i.routeConfig.runGuardsAndResolvers);l?o.canActivateChecks.push(new _A(r)):(i.data=s.data,i._resolvedData=s._resolvedData),sl(e,t,i.component?a?a.children:null:n,r,o),l&&a&&a.outlet&&a.outlet.isActivated&&o.canDeactivateChecks.push(new Yd(a.outlet.component,s))}else s&&al(t,a,o),o.canActivateChecks.push(new _A(r)),sl(e,null,i.component?a?a.children:null:n,r,o)})(s,i[s.value.outlet],n,r.concat([s.value]),o),delete i[s.value.outlet]}),Object.entries(i).forEach(([s,a])=>al(a,n.getContext(s),o)),o}function al(e,t,n){const r=ma(e),o=e.value;Object.entries(r).forEach(([i,s])=>{al(s,o.component?t?t.children.getContext(i):null:t,n)}),n.canDeactivateChecks.push(new Yd(o.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,o))}function cl(e){return"function"==typeof e}function yA(e){return e instanceof Fd||"EmptyError"===e?.name}const Qd=Symbol("INITIAL_VALUE");function ya(){return br(e=>Ld(e.map(t=>t.pipe(yi(1),LT(Qd)))).pipe(be(t=>{for(const n of t)if(!0!==n){if(n===Qd)return Qd;if(!1===n||n instanceof pa)return n}return!0}),wo(t=>t!==Qd),yi(1)))}function vA(e){return function ze(...e){return pe(e)}(In(t=>{if(ts(t))throw fA(0,t)}),be(t=>!0===t))}class Jd{constructor(t){this.segmentGroup=t||null}}class CA{constructor(t){this.urlTree=t}}function va(e){return da(new Jd(e))}function EA(e){return da(new CA(e))}class U${constructor(t,n){this.urlSerializer=t,this.urlTree=n}noMatchError(t){return new Fe(4002,!1)}lineralizeSegments(t,n){let r=[],o=n.root;for(;;){if(r=r.concat(o.segments),0===o.numberOfChildren)return Xe(r);if(o.numberOfChildren>1||!o.children[vt])return da(new Fe(4e3,!1));o=o.children[vt]}}applyRedirectCommands(t,n,r){return this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),t,r)}applyRedirectCreateUrlTree(t,n,r,o){const i=this.createSegmentGroup(t,n.root,r,o);return new pa(i,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(t,n){const r={};return Object.entries(t).forEach(([o,i])=>{if("string"==typeof i&&i.startsWith(":")){const a=i.substring(1);r[o]=n[a]}else r[o]=i}),r}createSegmentGroup(t,n,r,o){const i=this.createSegments(t,n.segments,r,o);let s={};return Object.entries(n.children).forEach(([a,l])=>{s[a]=this.createSegmentGroup(t,l,r,o)}),new Vt(i,s)}createSegments(t,n,r,o){return n.map(i=>i.path.startsWith(":")?this.findPosParam(t,i,o):this.findOrReturn(i,r))}findPosParam(t,n,r){const o=r[n.path.substring(1)];if(!o)throw new Fe(4001,!1);return o}findOrReturn(t,n){let r=0;for(const o of n){if(o.path===t.path)return n.splice(r),o;r++}return t}}const Zm={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function B$(e,t,n,r,o){const i=Ym(e,t,n);return i.matched?(r=function c$(e,t){return e.providers&&!e._injector&&(e._injector=Tg(e.providers,t,`Route: ${e.path}`)),e._injector??t}(t,r),function x$(e,t,n,r){const o=t.canMatch;return o&&0!==o.length?Xe(o.map(s=>{const a=_a(s,e);return Ci(function I$(e){return e&&cl(e.canMatch)}(a)?a.canMatch(t,n):e.runInContext(()=>a(t,n)))})).pipe(ya(),vA()):Xe(!0)}(r,t,n).pipe(be(s=>!0===s?i:{...Zm}))):Xe(i)}function Ym(e,t,n){if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||n.length>0)?{...Zm}:{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};const o=(t.matcher||_H)(n,e,t);if(!o)return{...Zm};const i={};Object.entries(o.posParams??{}).forEach(([a,l])=>{i[a]=l.path});const s=o.consumed.length>0?{...i,...o.consumed[o.consumed.length-1].parameters}:i;return{matched:!0,consumedSegments:o.consumed,remainingSegments:n.slice(o.consumed.length),parameters:s,positionalParamSegments:o.posParams??{}}}function wA(e,t,n,r){return n.length>0&&function $$(e,t,n){return n.some(r=>Xd(e,t,r)&&io(r)!==vt)}(e,n,r)?{segmentGroup:new Vt(t,H$(r,new Vt(n,e.children))),slicedSegments:[]}:0===n.length&&function V$(e,t,n){return n.some(r=>Xd(e,t,r))}(e,n,r)?{segmentGroup:new Vt(e.segments,j$(e,0,n,r,e.children)),slicedSegments:n}:{segmentGroup:new Vt(e.segments,e.children),slicedSegments:n}}function j$(e,t,n,r,o){const i={};for(const s of r)if(Xd(e,n,s)&&!o[io(s)]){const a=new Vt([],{});i[io(s)]=a}return{...o,...i}}function H$(e,t){const n={};n[vt]=t;for(const r of e)if(""===r.path&&io(r)!==vt){const o=new Vt([],{});n[io(r)]=o}return n}function Xd(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path}class K${constructor(t,n,r,o,i,s,a){this.injector=t,this.configLoader=n,this.rootComponentType=r,this.config=o,this.urlTree=i,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.allowRedirects=!0,this.applyRedirects=new U$(this.urlSerializer,this.urlTree)}noMatchError(t){return new Fe(4002,!1)}recognize(){const t=wA(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,t,vt).pipe(Ko(n=>{if(n instanceof CA)return this.allowRedirects=!1,this.urlTree=n.urlTree,this.match(n.urlTree);throw n instanceof Jd?this.noMatchError(n):n}),be(n=>{const r=new Wd([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},vt,this.rootComponentType,null,{}),o=new Wo(r,n),i=new uA("",o),s=function FH(e,t,n=null,r=null){return JT(QT(e),t,n,r)}(r,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,i.url=this.urlSerializer.serialize(s),this.inheritParamsAndData(i._root),{state:i,tree:s}}))}match(t){return this.processSegmentGroup(this.injector,this.config,t.root,vt).pipe(Ko(r=>{throw r instanceof Jd?this.noMatchError(r):r}))}inheritParamsAndData(t){const n=t.value,r=lA(n,this.paramsInheritanceStrategy);n.params=Object.freeze(r.params),n.data=Object.freeze(r.data),t.children.forEach(o=>this.inheritParamsAndData(o))}processSegmentGroup(t,n,r,o){return 0===r.segments.length&&r.hasChildren()?this.processChildren(t,n,r):this.processSegment(t,n,r,r.segments,o,!0)}processChildren(t,n,r){const o=[];for(const i of Object.keys(r.children))"primary"===i?o.unshift(i):o.push(i);return kt(o).pipe(vi(i=>{const s=r.children[i],a=function h$(e,t){const n=e.filter(r=>io(r)===t);return n.push(...e.filter(r=>io(r)!==t)),n}(n,i);return this.processSegmentGroup(t,a,s,i)}),function fH(e,t){return Ce(function hH(e,t,n,r,o){return(i,s)=>{let a=n,l=t,h=0;i.subscribe(Me(s,f=>{const v=h++;l=a?e(l,f,v):(a=!0,f),r&&s.next(l)},o&&(()=>{a&&s.next(l),s.complete()})))}}(e,t,arguments.length>=2,!0))}((i,s)=>(i.push(...s),i)),Bd(null),function pH(e,t){const n=arguments.length>=2;return r=>r.pipe(e?wo((o,i)=>e(o,i,r)):Be,Pm(1),n?Bd(t):FT(()=>new Fd))}(),X(i=>{if(null===i)return va(r);const s=bA(i);return function W$(e){e.sort((t,n)=>t.value.outlet===vt?-1:n.value.outlet===vt?1:t.value.outlet.localeCompare(n.value.outlet))}(s),Xe(s)}))}processSegment(t,n,r,o,i,s){return kt(n).pipe(vi(a=>this.processSegmentAgainstRoute(a._injector??t,n,a,r,o,i,s).pipe(Ko(l=>{if(l instanceof Jd)return Xe(null);throw l}))),Xi(a=>!!a),Ko(a=>{if(yA(a))return function G$(e,t,n){return 0===t.length&&!e.children[n]}(r,o,i)?Xe([]):va(r);throw a}))}processSegmentAgainstRoute(t,n,r,o,i,s,a){return function z$(e,t,n,r){return!!(io(e)===r||r!==vt&&Xd(t,n,e))&&("**"===e.path||Ym(t,e,n).matched)}(r,o,i,s)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(t,o,r,i,s,a):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,o,n,r,i,s):va(o):va(o)}expandSegmentAgainstRouteUsingRedirect(t,n,r,o,i,s){return"**"===o.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,r,o,s):this.expandRegularSegmentAgainstRouteUsingRedirect(t,n,r,o,i,s)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,n,r,o){const i=this.applyRedirects.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?EA(i):this.applyRedirects.lineralizeSegments(r,i).pipe(X(s=>{const a=new Vt(s,{});return this.processSegment(t,n,a,s,o,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,n,r,o,i,s){const{matched:a,consumedSegments:l,remainingSegments:h,positionalParamSegments:f}=Ym(n,o,i);if(!a)return va(n);const v=this.applyRedirects.applyRedirectCommands(l,o.redirectTo,f);return o.redirectTo.startsWith("/")?EA(v):this.applyRedirects.lineralizeSegments(o,v).pipe(X(x=>this.processSegment(t,r,n,x.concat(h),s,!1)))}matchSegmentAgainstRoute(t,n,r,o,i,s){let a;if("**"===r.path){const l=o.length>0?jT(o).parameters:{};a=Xe({snapshot:new Wd(o,l,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,IA(r),io(r),r.component??r._loadedComponent??null,r,SA(r)),consumedSegments:[],remainingSegments:[]}),n.children={}}else a=B$(n,r,o,t).pipe(be(({matched:l,consumedSegments:h,remainingSegments:f,parameters:v})=>l?{snapshot:new Wd(h,v,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,IA(r),io(r),r.component??r._loadedComponent??null,r,SA(r)),consumedSegments:h,remainingSegments:f}:null));return a.pipe(br(l=>null===l?va(n):this.getChildConfig(t=r._injector??t,r,o).pipe(br(({routes:h})=>{const f=r._loadedInjector??t,{snapshot:v,consumedSegments:x,remainingSegments:W}=l,{segmentGroup:ne,slicedSegments:ae}=wA(n,x,W,h);if(0===ae.length&&ne.hasChildren())return this.processChildren(f,h,ne).pipe(be(Ae=>null===Ae?null:[new Wo(v,Ae)]));if(0===h.length&&0===ae.length)return Xe([new Wo(v,[])]);const _e=io(r)===i;return this.processSegment(f,h,ne,ae,_e?vt:i,!0).pipe(be(Ae=>[new Wo(v,Ae)]))}))))}getChildConfig(t,n,r){return n.children?Xe({routes:n.children,injector:t}):n.loadChildren?void 0!==n._loadedRoutes?Xe({routes:n._loadedRoutes,injector:n._loadedInjector}):function N$(e,t,n,r){const o=t.canLoad;return void 0===o||0===o.length?Xe(!0):Xe(o.map(s=>{const a=_a(s,e);return Ci(function C$(e){return e&&cl(e.canLoad)}(a)?a.canLoad(t,n):e.runInContext(()=>a(t,n)))})).pipe(ya(),vA())}(t,n,r).pipe(X(o=>o?this.configLoader.loadChildren(t,n).pipe(In(i=>{n._loadedRoutes=i.routes,n._loadedInjector=i.injector})):function F$(e){return da(pA(!1,3))}())):Xe({routes:[],injector:t})}}function Z$(e){const t=e.value.routeConfig;return t&&""===t.path}function bA(e){const t=[],n=new Set;for(const r of e){if(!Z$(r)){t.push(r);continue}const o=t.find(i=>r.value.routeConfig===i.value.routeConfig);void 0!==o?(o.children.push(...r.children),n.add(o)):t.push(r)}for(const r of n){const o=bA(r.children);t.push(new Wo(r.value,o))}return t.filter(r=>!n.has(r))}function IA(e){return e.data||{}}function SA(e){return e.resolve||{}}function TA(e){return"string"==typeof e.title||null===e.title}function Qm(e){return br(t=>{const n=e(t);return n?kt(n).pipe(be(()=>t)):Xe(t)})}const Ca=new Ve("ROUTES");let Jm=(()=>{class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=Ze(nS)}loadComponent(n){if(this.componentLoaders.get(n))return this.componentLoaders.get(n);if(n._loadedComponent)return Xe(n._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(n);const r=Ci(n.loadComponent()).pipe(be(AA),In(i=>{this.onLoadEndListener&&this.onLoadEndListener(n),n._loadedComponent=i}),ha(()=>{this.componentLoaders.delete(n)})),o=new xT(r,()=>new T).pipe(km());return this.componentLoaders.set(n,o),o}loadChildren(n,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Xe({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const i=function nV(e,t,n,r){return Ci(e.loadChildren()).pipe(be(AA),X(o=>o instanceof sI||Array.isArray(o)?Xe(o):kt(t.compileModuleAsync(o))),be(o=>{r&&r(e);let i,s,a=!1;return Array.isArray(o)?(s=o,!0):(i=o.create(n).injector,s=i.get(Ca,[],{optional:!0,self:!0}).flat()),{routes:s.map(Wm),injector:i}}))}(r,this.compiler,n,this.onLoadEndListener).pipe(ha(()=>{this.childrenLoaders.delete(r)})),s=new xT(i,()=>new T).pipe(km());return this.childrenLoaders.set(r,s),s}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function AA(e){return function rV(e){return e&&"object"==typeof e&&"default"in e}(e)?e.default:e}let eh=(()=>{class e{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new T,this.transitionAbortSubject=new T,this.configLoader=Ze(Jm),this.environmentInjector=Ze(Or),this.urlSerializer=Ze(Qc),this.rootContexts=Ze(rl),this.inputBindingEnabled=null!==Ze(Zd,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Xe(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=o=>this.events.next(new ZH(o)),this.configLoader.onLoadStartListener=o=>this.events.next(new WH(o))}complete(){this.transitions?.complete()}handleNavigationRequest(n){const r=++this.navigationId;this.transitions?.next({...this.transitions.value,...n,id:r})}setupNavigations(n,r,o){return this.transitions=new An({id:0,currentUrlTree:r,currentRawUrl:r,currentBrowserUrl:r,extractedUrl:n.urlHandlingStrategy.extract(r),urlAfterRedirects:n.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:tl,restoredState:null,currentSnapshot:o.snapshot,targetSnapshot:null,currentRouterState:o,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(wo(i=>0!==i.id),be(i=>({...i,extractedUrl:n.urlHandlingStrategy.extract(i.rawUrl)})),br(i=>{this.currentTransition=i;let s=!1,a=!1;return Xe(i).pipe(In(l=>{this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),br(l=>{const h=l.currentBrowserUrl.toString(),f=!n.navigated||l.extractedUrl.toString()!==h||h!==l.currentUrlTree.toString();if(!f&&"reload"!==(l.extras.onSameUrlNavigation??n.onSameUrlNavigation)){const x="";return this.events.next(new ga(l.id,this.urlSerializer.serialize(l.rawUrl),x,0)),l.resolve(null),ye}if(n.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return Xe(l).pipe(br(x=>{const W=this.transitions?.getValue();return this.events.next(new qd(x.id,this.urlSerializer.serialize(x.extractedUrl),x.source,x.restoredState)),W!==this.transitions?.getValue()?ye:Promise.resolve(x)}),function Y$(e,t,n,r,o,i){return X(s=>function q$(e,t,n,r,o,i,s="emptyOnly"){return new K$(e,t,n,r,o,s,i).recognize()}(e,t,n,r,s.extractedUrl,o,i).pipe(be(({state:a,tree:l})=>({...s,targetSnapshot:a,urlAfterRedirects:l}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,n.config,this.urlSerializer,n.paramsInheritanceStrategy),In(x=>{i.targetSnapshot=x.targetSnapshot,i.urlAfterRedirects=x.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:x.urlAfterRedirects};const W=new oA(x.id,this.urlSerializer.serialize(x.extractedUrl),this.urlSerializer.serialize(x.urlAfterRedirects),x.targetSnapshot);this.events.next(W)}));if(f&&n.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){const{id:x,extractedUrl:W,source:ne,restoredState:ae,extras:_e}=l,Ae=new qd(x,this.urlSerializer.serialize(W),ne,ae);this.events.next(Ae);const ve=cA(0,this.rootComponentType).snapshot;return this.currentTransition=i={...l,targetSnapshot:ve,urlAfterRedirects:W,extras:{..._e,skipLocationChange:!1,replaceUrl:!1}},Xe(i)}{const x="";return this.events.next(new ga(l.id,this.urlSerializer.serialize(l.extractedUrl),x,1)),l.resolve(null),ye}}),In(l=>{const h=new zH(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(h)}),be(l=>(this.currentTransition=i={...l,guards:g$(l.targetSnapshot,l.currentSnapshot,this.rootContexts)},i)),function T$(e,t){return X(n=>{const{targetSnapshot:r,currentSnapshot:o,guards:{canActivateChecks:i,canDeactivateChecks:s}}=n;return 0===s.length&&0===i.length?Xe({...n,guardsResult:!0}):function A$(e,t,n,r){return kt(e).pipe(X(o=>function P$(e,t,n,r,o){const i=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return i&&0!==i.length?Xe(i.map(a=>{const l=il(t)??o,h=_a(a,l);return Ci(function b$(e){return e&&cl(e.canDeactivate)}(h)?h.canDeactivate(e,t,n,r):l.runInContext(()=>h(e,t,n,r))).pipe(Xi())})).pipe(ya()):Xe(!0)}(o.component,o.route,n,t,r)),Xi(o=>!0!==o,!0))}(s,r,o,e).pipe(X(a=>a&&function v$(e){return"boolean"==typeof e}(a)?function D$(e,t,n,r){return kt(t).pipe(vi(o=>Ud(function R$(e,t){return null!==e&&t&&t(new YH(e)),Xe(!0)}(o.route.parent,r),function M$(e,t){return null!==e&&t&&t(new JH(e)),Xe(!0)}(o.route,r),function k$(e,t,n){const r=t[t.length-1],i=t.slice(0,t.length-1).reverse().map(s=>function m$(e){const t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(s)).filter(s=>null!==s).map(s=>NT(()=>Xe(s.guards.map(l=>{const h=il(s.node)??n,f=_a(l,h);return Ci(function w$(e){return e&&cl(e.canActivateChild)}(f)?f.canActivateChild(r,e):h.runInContext(()=>f(r,e))).pipe(Xi())})).pipe(ya())));return Xe(i).pipe(ya())}(e,o.path,n),function O$(e,t,n){const r=t.routeConfig?t.routeConfig.canActivate:null;if(!r||0===r.length)return Xe(!0);const o=r.map(i=>NT(()=>{const s=il(t)??n,a=_a(i,s);return Ci(function E$(e){return e&&cl(e.canActivate)}(a)?a.canActivate(t,e):s.runInContext(()=>a(t,e))).pipe(Xi())}));return Xe(o).pipe(ya())}(e,o.route,n))),Xi(o=>!0!==o,!0))}(r,i,e,t):Xe(a)),be(a=>({...n,guardsResult:a})))})}(this.environmentInjector,l=>this.events.next(l)),In(l=>{if(i.guardsResult=l.guardsResult,ts(l.guardsResult))throw fA(0,l.guardsResult);const h=new GH(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(h)}),wo(l=>!!l.guardsResult||(this.cancelNavigationTransition(l,"",3),!1)),Qm(l=>{if(l.guards.canActivateChecks.length)return Xe(l).pipe(In(h=>{const f=new qH(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}),br(h=>{let f=!1;return Xe(h).pipe(function Q$(e,t){return X(n=>{const{targetSnapshot:r,guards:{canActivateChecks:o}}=n;if(!o.length)return Xe(n);let i=0;return kt(o).pipe(vi(s=>function J$(e,t,n,r){const o=e.routeConfig,i=e._resolve;return void 0!==o?.title&&!TA(o)&&(i[Zc]=o.title),function X$(e,t,n,r){const o=function eV(e){return[...Object.keys(e),...Object.getOwnPropertySymbols(e)]}(e);if(0===o.length)return Xe({});const i={};return kt(o).pipe(X(s=>function tV(e,t,n,r){const o=il(t)??r,i=_a(e,o);return Ci(i.resolve?i.resolve(t,n):o.runInContext(()=>i(t,n)))}(e[s],t,n,r).pipe(Xi(),In(a=>{i[s]=a}))),Pm(1),function gH(e){return be(()=>e)}(i),Ko(s=>yA(s)?ye:da(s)))}(i,e,t,r).pipe(be(s=>(e._resolvedData=s,e.data=lA(e,n).resolve,o&&TA(o)&&(e.data[Zc]=o.title),null)))}(s.route,r,e,t)),In(()=>i++),Pm(1),X(s=>i===o.length?Xe(n):ye))})}(n.paramsInheritanceStrategy,this.environmentInjector),In({next:()=>f=!0,complete:()=>{f||this.cancelNavigationTransition(h,"",2)}}))}),In(h=>{const f=new KH(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}))}),Qm(l=>{const h=f=>{const v=[];f.routeConfig?.loadComponent&&!f.routeConfig._loadedComponent&&v.push(this.configLoader.loadComponent(f.routeConfig).pipe(In(x=>{f.component=x}),be(()=>{})));for(const x of f.children)v.push(...h(x));return v};return Ld(h(l.targetSnapshot.root)).pipe(Bd(),yi(1))}),Qm(()=>this.afterPreactivation()),be(l=>{const h=function o$(e,t,n){const r=ol(e,t._root,n?n._root:void 0);return new aA(r,t)}(n.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=i={...l,targetRouterState:h},i}),In(()=>{this.events.next(new Bm)}),((e,t,n,r)=>be(o=>(new p$(t,o.targetRouterState,o.currentRouterState,n,r).activate(e),o)))(this.rootContexts,n.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),yi(1),In({next:l=>{s=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Ei(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),n.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{s=!0}}),UT(this.transitionAbortSubject.pipe(In(l=>{throw l}))),ha(()=>{s||a||this.cancelNavigationTransition(i,"",1),this.currentNavigation?.id===i.id&&(this.currentNavigation=null)}),Ko(l=>{if(a=!0,gA(l))this.events.next(new nl(i.id,this.urlSerializer.serialize(i.extractedUrl),l.message,l.cancellationCode)),function a$(e){return gA(e)&&ts(e.url)}(l)?this.events.next(new jm(l.url)):i.resolve(!1);else{this.events.next(new Kd(i.id,this.urlSerializer.serialize(i.extractedUrl),l,i.targetSnapshot??void 0));try{i.resolve(n.errorHandler(l))}catch(h){i.reject(h)}}return ye}))}))}cancelNavigationTransition(n,r,o){const i=new nl(n.id,this.urlSerializer.serialize(n.extractedUrl),r,o);this.events.next(i),n.resolve(!1)}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function DA(e){return e!==tl}let MA=(()=>{class e{buildTitle(n){let r,o=n.root;for(;void 0!==o;)r=this.getResolvedTitleForRoute(o)??r,o=o.children.find(i=>i.outlet===vt);return r}getResolvedTitleForRoute(n){return n.data[Zc]}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=de({token:e,factory:function(){return Ze(oV)},providedIn:"root"})}return e})(),oV=(()=>{class e extends MA{constructor(n){super(),this.title=n}updateTitle(n){const r=this.buildTitle(n);void 0!==r&&this.title.setTitle(r)}static#e=this.\u0275fac=function(r){return new(r||e)(qe(ST))};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),iV=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=de({token:e,factory:function(){return Ze(aV)},providedIn:"root"})}return e})();class sV{shouldDetach(t){return!1}store(t,n){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,n){return t.routeConfig===n.routeConfig}}let aV=(()=>{class e extends sV{static#e=this.\u0275fac=function(){let n;return function(o){return(n||(n=function Nn(e){return Po(()=>{const t=e.prototype.constructor,n=t[No]||Qf(t),r=Object.prototype;let o=Object.getPrototypeOf(e.prototype).constructor;for(;o&&o!==r;){const i=o[No]||Qf(o);if(i&&i!==n)return i;o=Object.getPrototypeOf(o)}return i=>new i})}(e)))(o||e)}}();static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const th=new Ve("",{providedIn:"root",factory:()=>({})});let cV=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=de({token:e,factory:function(){return Ze(lV)},providedIn:"root"})}return e})(),lV=(()=>{class e{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,r){return n}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var ll=function(e){return e[e.COMPLETE=0]="COMPLETE",e[e.FAILED=1]="FAILED",e[e.REDIRECTING=2]="REDIRECTING",e}(ll||{});function RA(e,t){e.events.pipe(wo(n=>n instanceof Ei||n instanceof nl||n instanceof Kd||n instanceof ga),be(n=>n instanceof Ei||n instanceof ga?ll.COMPLETE:n instanceof nl&&(0===n.code||1===n.code)?ll.REDIRECTING:ll.FAILED),wo(n=>n!==ll.REDIRECTING),yi(1)).subscribe(()=>{t()})}function uV(e){throw e}function dV(e,t,n){return t.parse("/")}const hV={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},fV={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let ir=(()=>{class e{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.location.getState()?.\u0275routerPageId??this.currentPageId}get events(){return this._events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=Ze(tS),this.isNgZoneEnabled=!1,this._events=new T,this.options=Ze(th,{optional:!0})||{},this.pendingTasks=Ze(hd),this.errorHandler=this.options.errorHandler||uV,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||dV,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=Ze(cV),this.routeReuseStrategy=Ze(iV),this.titleStrategy=Ze(MA),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=Ze(Ca,{optional:!0})?.flat()??[],this.navigationTransitions=Ze(eh),this.urlSerializer=Ze(Qc),this.location=Ze(zc),this.componentInputBindingEnabled=!!Ze(Zd,{optional:!0}),this.eventsSubscription=new H,this.isNgZoneEnabled=Ze(Wt)instanceof Wt&&Wt.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new pa,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=cA(0,null),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe(n=>{this.lastSuccessfulId=n.id,this.currentPageId=this.browserPageId},n=>{this.console.warn(`Unhandled Navigation Error: ${n}`)}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const n=this.navigationTransitions.events.subscribe(r=>{try{const{currentTransition:o}=this.navigationTransitions;if(null===o)return void(OA(r)&&this._events.next(r));if(r instanceof qd)DA(o.source)&&(this.browserUrlTree=o.extractedUrl);else if(r instanceof ga)this.rawUrlTree=o.rawUrl;else if(r instanceof oA){if("eager"===this.urlUpdateStrategy){if(!o.extras.skipLocationChange){const i=this.urlHandlingStrategy.merge(o.urlAfterRedirects,o.rawUrl);this.setBrowserUrl(i,o)}this.browserUrlTree=o.urlAfterRedirects}}else if(r instanceof Bm)this.currentUrlTree=o.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(o.urlAfterRedirects,o.rawUrl),this.routerState=o.targetRouterState,"deferred"===this.urlUpdateStrategy&&(o.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,o),this.browserUrlTree=o.urlAfterRedirects);else if(r instanceof nl)0!==r.code&&1!==r.code&&(this.navigated=!0),(3===r.code||2===r.code)&&this.restoreHistory(o);else if(r instanceof jm){const i=this.urlHandlingStrategy.merge(r.url,o.currentRawUrl),s={skipLocationChange:o.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||DA(o.source)};this.scheduleNavigation(i,tl,null,s,{resolve:o.resolve,reject:o.reject,promise:o.promise})}r instanceof Kd&&this.restoreHistory(o,!0),r instanceof Ei&&(this.navigated=!0),OA(r)&&this._events.next(r)}catch(o){this.navigationTransitions.transitionAbortSubject.next(o)}});this.eventsSubscription.add(n)}resetRootComponentType(n){this.routerState.root.component=n,this.navigationTransitions.rootComponentType=n}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const n=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),tl,n)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(n=>{const r="popstate"===n.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{this.navigateToSyncWithBrowser(n.url,r,n.state)},0)}))}navigateToSyncWithBrowser(n,r,o){const i={replaceUrl:!0},s=o?.navigationId?o:null;if(o){const l={...o};delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(i.state=l)}const a=this.parseUrl(n);this.scheduleNavigation(a,r,s,i)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(n){this.config=n.map(Wm),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(n,r={}){const{relativeTo:o,queryParams:i,fragment:s,queryParamsHandling:a,preserveFragment:l}=r,h=l?this.currentUrlTree.fragment:s;let v,f=null;switch(a){case"merge":f={...this.currentUrlTree.queryParams,...i};break;case"preserve":f=this.currentUrlTree.queryParams;break;default:f=i||null}null!==f&&(f=this.removeEmptyProps(f));try{v=QT(o?o.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof n[0]||!n[0].startsWith("/"))&&(n=[]),v=this.currentUrlTree.root}return JT(v,n,f,h??null)}navigateByUrl(n,r={skipLocationChange:!1}){const o=ts(n)?n:this.parseUrl(n),i=this.urlHandlingStrategy.merge(o,this.rawUrlTree);return this.scheduleNavigation(i,tl,null,r)}navigate(n,r={skipLocationChange:!1}){return function pV(e){for(let t=0;t<e.length;t++)if(null==e[t])throw new Fe(4008,!1)}(n),this.navigateByUrl(this.createUrlTree(n,r),r)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){let r;try{r=this.urlSerializer.parse(n)}catch(o){r=this.malformedUriErrorHandler(o,this.urlSerializer,n)}return r}isActive(n,r){let o;if(o=!0===r?{...hV}:!1===r?{...fV}:r,ts(n))return $T(this.currentUrlTree,n,o);const i=this.parseUrl(n);return $T(this.currentUrlTree,i,o)}removeEmptyProps(n){return Object.keys(n).reduce((r,o)=>{const i=n[o];return null!=i&&(r[o]=i),r},{})}scheduleNavigation(n,r,o,i,s){if(this.disposed)return Promise.resolve(!1);let a,l,h;s?(a=s.resolve,l=s.reject,h=s.promise):h=new Promise((v,x)=>{a=v,l=x});const f=this.pendingTasks.add();return RA(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(f))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:o,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,currentBrowserUrl:this.browserUrlTree,rawUrl:n,extras:i,resolve:a,reject:l,promise:h,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),h.catch(v=>Promise.reject(v))}setBrowserUrl(n,r){const o=this.urlSerializer.serialize(n);if(this.location.isCurrentPathEqualTo(o)||r.extras.replaceUrl){const s={...r.extras.state,...this.generateNgRouterState(r.id,this.browserPageId)};this.location.replaceState(o,"",s)}else{const i={...r.extras.state,...this.generateNgRouterState(r.id,this.browserPageId+1)};this.location.go(o,"",i)}}restoreHistory(n,r=!1){if("computed"===this.canceledNavigationResolution){const i=this.currentPageId-this.browserPageId;0!==i?this.location.historyGo(i):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===i&&(this.resetState(n),this.browserUrlTree=n.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=n.currentRouterState,this.currentUrlTree=n.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(n,r){return"computed"===this.canceledNavigationResolution?{navigationId:n,\u0275routerPageId:r}:{navigationId:n}}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function OA(e){return!(e instanceof Bm||e instanceof jm)}let ul=(()=>{class e{constructor(n,r,o,i,s,a){this.router=n,this.route=r,this.tabIndexAttribute=o,this.renderer=i,this.el=s,this.locationStrategy=a,this.href=null,this.commands=null,this.onChanges=new T,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;const l=s.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===l||"area"===l,this.isAnchorElement?this.subscription=n.events.subscribe(h=>{h instanceof Ei&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(n){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",n)}ngOnChanges(n){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(n){null!=n?(this.commands=Array.isArray(n)?n:[n],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(n,r,o,i,s){return!!(null===this.urlTree||this.isAnchorElement&&(0!==n||r||o||i||s||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const n=null===this.href?null:function iE(e,t,n){return function XP(e,t){return"src"===t&&("embed"===e||"frame"===e||"iframe"===e||"media"===e||"script"===e)||"href"===t&&("base"===e||"link"===e)?oE:Ou}(t,n)(e)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",n)}applyAttributeValue(n,r){const o=this.renderer,i=this.el.nativeElement;null!==r?o.setAttribute(i,n,r):o.removeAttribute(i,n)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static#e=this.\u0275fac=function(r){return new(r||e)(Pe(ir),Pe(ns),ac("tabindex"),Pe(Bo),Pe(er),Pe(Ji))};static#t=this.\u0275dir=lt({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(r,o){1&r&&fn("click",function(s){return o.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),2&r&&Jr("target",o.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:["preserveFragment","preserveFragment",ca],skipLocationChange:["skipLocationChange","skipLocationChange",ca],replaceUrl:["replaceUrl","replaceUrl",ca],routerLink:"routerLink"},standalone:!0,features:[_w,Ar]})}return e})(),kA=(()=>{class e{get isActive(){return this._isActive}constructor(n,r,o,i,s){this.router=n,this.element=r,this.renderer=o,this.cdr=i,this.link=s,this.classes=[],this._isActive=!1,this.routerLinkActiveOptions={exact:!1},this.isActiveChange=new an,this.routerEventsSubscription=n.events.subscribe(a=>{a instanceof Ei&&this.update()})}ngAfterContentInit(){Xe(this.links.changes,Xe(null)).pipe(he()).subscribe(n=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();const n=[...this.links.toArray(),this.link].filter(r=>!!r).map(r=>r.onChanges);this.linkInputChangesSubscription=kt(n).pipe(he()).subscribe(r=>{this._isActive!==this.isLinkActive(this.router)(r)&&this.update()})}set routerLinkActive(n){const r=Array.isArray(n)?n:n.split(" ");this.classes=r.filter(o=>!!o)}ngOnChanges(n){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||queueMicrotask(()=>{const n=this.hasActiveLinks();this._isActive!==n&&(this._isActive=n,this.cdr.markForCheck(),this.classes.forEach(r=>{n?this.renderer.addClass(this.element.nativeElement,r):this.renderer.removeClass(this.element.nativeElement,r)}),n&&void 0!==this.ariaCurrentWhenActive?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this.isActiveChange.emit(n))})}isLinkActive(n){const r=function gV(e){return!!e.paths}(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return o=>!!o.urlTree&&n.isActive(o.urlTree,r)}hasActiveLinks(){const n=this.isLinkActive(this.router);return this.link&&n(this.link)||this.links.some(n)}static#e=this.\u0275fac=function(r){return new(r||e)(Pe(ir),Pe(er),Pe(Bo),Pe(md),Pe(ul,8))};static#t=this.\u0275dir=lt({type:e,selectors:[["","routerLinkActive",""]],contentQueries:function(r,o,i){if(1&r&&function NI(e,t,n,r){const o=At();if(o.firstCreatePass){const i=Pn();LI(o,new OI(t,n,r),i.index),function iU(e,t){const n=e.contentQueries||(e.contentQueries=[]);t!==(n.length?n[n.length-1]:-1)&&n.push(e.queries.length-1,t)}(o,e),2==(2&n)&&(o.staticContentQueries=!0)}xI(o,Le(),n)}(i,ul,5),2&r){let s;xg(s=Lg())&&(o.links=s)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],standalone:!0,features:[Ar]})}return e})();class PA{}let mV=(()=>{class e{constructor(n,r,o,i,s){this.router=n,this.injector=o,this.preloadingStrategy=i,this.loader=s}setUpPreloading(){this.subscription=this.router.events.pipe(wo(n=>n instanceof Ei),vi(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(n,r){const o=[];for(const i of r){i.providers&&!i._injector&&(i._injector=Tg(i.providers,n,`Route: ${i.path}`));const s=i._injector??n,a=i._loadedInjector??s;(i.loadChildren&&!i._loadedRoutes&&void 0===i.canLoad||i.loadComponent&&!i._loadedComponent)&&o.push(this.preloadConfig(s,i)),(i.children||i._loadedRoutes)&&o.push(this.processRoutes(a,i.children??i._loadedRoutes))}return kt(o).pipe(he())}preloadConfig(n,r){return this.preloadingStrategy.preload(r,()=>{let o;o=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(n,r):Xe(null);const i=o.pipe(X(s=>null===s?Xe(void 0):(r._loadedRoutes=s.routes,r._loadedInjector=s.injector,this.processRoutes(s.injector??n,s.routes))));return r.loadComponent&&!r._loadedComponent?kt([i,this.loader.loadComponent(r)]).pipe(he()):i})}static#e=this.\u0275fac=function(r){return new(r||e)(qe(ir),qe(nS),qe(Or),qe(PA),qe(Jm))};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const Xm=new Ve("");let NA=(()=>{class e{constructor(n,r,o,i,s={}){this.urlSerializer=n,this.transitions=r,this.viewportScroller=o,this.zone=i,this.options=s,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},s.scrollPositionRestoration=s.scrollPositionRestoration||"disabled",s.anchorScrolling=s.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof qd?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=n.navigationTrigger,this.restoredId=n.restoredState?n.restoredState.navigationId:0):n instanceof Ei?(this.lastId=n.id,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.urlAfterRedirects).fragment)):n instanceof ga&&0===n.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof iA&&(n.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(n.position):n.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(n.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(n,r){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new iA(n,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static#e=this.\u0275fac=function(r){!function zE(){throw new Error("invalid")}()};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac})}return e})();function Zo(e,t){return{\u0275kind:e,\u0275providers:t}}function LA(){const e=Ze(yr);return t=>{const n=e.get(aa);if(t!==n.components[0])return;const r=e.get(ir),o=e.get(FA);1===e.get(e_)&&r.initialNavigation(),e.get(UA,null,mt.Optional)?.setUpPreloading(),e.get(Xm,null,mt.Optional)?.init(),r.resetRootComponentType(n.componentTypes[0]),o.closed||(o.next(),o.complete(),o.unsubscribe())}}const FA=new Ve("",{factory:()=>new T}),e_=new Ve("",{providedIn:"root",factory:()=>1}),UA=new Ve("");function CV(e){return Zo(0,[{provide:UA,useExisting:mV},{provide:PA,useExisting:e}])}const BA=new Ve("ROUTER_FORROOT_GUARD"),wV=[zc,{provide:Qc,useClass:Nm},ir,rl,{provide:ns,useFactory:function xA(e){return e.routerState.root},deps:[ir]},Jm,[]];function bV(){return new lS("Router",ir)}let jA=(()=>{class e{constructor(n){}static forRoot(n,r){return{ngModule:e,providers:[wV,[],{provide:Ca,multi:!0,useValue:n},{provide:BA,useFactory:AV,deps:[[ir,new Hi,new uc]]},{provide:th,useValue:r||{}},r?.useHash?{provide:Ji,useClass:B2}:{provide:Ji,useClass:BS},{provide:Xm,useFactory:()=>{const e=Ze(tj),t=Ze(Wt),n=Ze(th),r=Ze(eh),o=Ze(Qc);return n.scrollOffset&&e.setOffset(n.scrollOffset),new NA(o,r,e,t,n)}},r?.preloadingStrategy?CV(r.preloadingStrategy).\u0275providers:[],{provide:lS,multi:!0,useFactory:bV},r?.initialNavigation?DV(r):[],r?.bindToComponentInputs?Zo(8,[hA,{provide:Zd,useExisting:hA}]).\u0275providers:[],[{provide:HA,useFactory:LA},{provide:Yg,multi:!0,useExisting:HA}]]}}static forChild(n){return{ngModule:e,providers:[{provide:Ca,multi:!0,useValue:n}]}}static#e=this.\u0275fac=function(r){return new(r||e)(qe(BA,8))};static#t=this.\u0275mod=Bn({type:e});static#n=this.\u0275inj=Se({})}return e})();function AV(e){return"guarded"}function DV(e){return["disabled"===e.initialNavigation?Zo(3,[{provide:$g,multi:!0,useFactory:()=>{const t=Ze(ir);return()=>{t.setUpLocationChangeListener()}}},{provide:e_,useValue:2}]).\u0275providers:[],"enabledBlocking"===e.initialNavigation?Zo(2,[{provide:e_,useValue:0},{provide:$g,multi:!0,deps:[yr],useFactory:t=>{const n=t.get(F2,Promise.resolve());return()=>n.then(()=>new Promise(r=>{const o=t.get(ir),i=t.get(FA);RA(o,()=>{r(!0)}),t.get(eh).afterPreactivation=()=>(r(!0),i.closed?Xe(void 0):i),o.initialNavigation()}))}}]).\u0275providers:[]]}const HA=new Ve("");let Ea=(()=>{class e{constructor(){this.items=[],this.basketLength=new An(0),this.basketLength$=this.basketLength.asObservable()}updateBasketLength(){this.basketLength.next(this.items.length)}removeFromBasket(n){this.items=this.items.filter(r=>r.tempId!==n),this.updateBasketLength()}emptyBasket(){this.items=[],this.updateBasketLength()}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var on=S(8593),Er=S(6097);class RV{static getInteractionStatusFromEvent(t,n){switch(t.eventType){case Er.t.LOGIN_START:return on.$H.Login;case Er.t.SSO_SILENT_START:return on.$H.SsoSilent;case Er.t.ACQUIRE_TOKEN_START:if(t.interactionType===on.s_.Redirect||t.interactionType===on.s_.Popup)return on.$H.AcquireToken;break;case Er.t.HANDLE_REDIRECT_START:return on.$H.HandleRedirect;case Er.t.LOGOUT_START:return on.$H.Logout;case Er.t.SSO_SILENT_SUCCESS:case Er.t.SSO_SILENT_FAILURE:if(n&&n!==on.$H.SsoSilent)break;return on.$H.None;case Er.t.LOGOUT_END:if(n&&n!==on.$H.Logout)break;return on.$H.None;case Er.t.HANDLE_REDIRECT_END:if(n&&n!==on.$H.HandleRedirect)break;return on.$H.None;case Er.t.LOGIN_SUCCESS:case Er.t.LOGIN_FAILURE:case Er.t.ACQUIRE_TOKEN_SUCCESS:case Er.t.ACQUIRE_TOKEN_FAILURE:case Er.t.RESTORE_FROM_BFCACHE:if(t.interactionType===on.s_.Redirect||t.interactionType===on.s_.Popup){if(n&&n!==on.$H.Login&&n!==on.$H.AcquireToken)break;return on.$H.None}}return null}}var OV=S(3325),kV=S(7581),PV=S(5291);const t_={now:()=>(t_.delegate||Date).now(),delegate:void 0};class NV extends T{constructor(t=1/0,n=1/0,r=t_){super(),this._bufferSize=t,this._windowTime=n,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=n===1/0,this._bufferSize=Math.max(1,t),this._windowTime=Math.max(1,n)}next(t){const{isStopped:n,_buffer:r,_infiniteTimeWindow:o,_timestampProvider:i,_windowTime:s}=this;n||(r.push(t),!o&&r.push(i.now()+s)),this._trimBuffer(),super.next(t)}_subscribe(t){this._throwIfClosed(),this._trimBuffer();const n=this._innerSubscribe(t),{_infiniteTimeWindow:r,_buffer:o}=this,i=o.slice();for(let s=0;s<i.length&&!t.closed;s+=r?1:2)t.next(i[s]);return this._checkFinalizedStatuses(t),n}_trimBuffer(){const{_bufferSize:t,_timestampProvider:n,_buffer:r,_infiniteTimeWindow:o}=this,i=(o?1:2)*t;if(t<1/0&&i<r.length&&r.splice(0,r.length-i),!o){const s=n.now();let a=0;for(let l=1;l<r.length&&r[l]<=s;l+=2)a=l;a&&r.splice(0,a+1)}}}const $A="@azure/msal-angular",n_="3.0.8",nh=new Ve("MSAL_INSTANCE"),VA=new Ve("MSAL_GUARD_CONFIG"),xV=new Ve("MSAL_INTERCEPTOR_CONFIG"),LV=new Ve("MSAL_BROADCAST_CONFIG");let r_,dl=(()=>{class e{constructor(n,r){this.instance=n,this.location=r;const o=this.location.path(!0).split("#").pop();o&&(this.redirectHash=`#${o}`),this.instance.initializeWrapperLibrary(on.lA.Angular,n_)}initialize(){return kt(this.instance.initialize())}acquireTokenPopup(n){return kt(this.instance.acquireTokenPopup(n))}acquireTokenRedirect(n){return kt(this.instance.acquireTokenRedirect(n))}acquireTokenSilent(n){return kt(this.instance.acquireTokenSilent(n))}handleRedirectObservable(n){return kt(this.instance.initialize().then(()=>this.instance.handleRedirectPromise(n||this.redirectHash)))}loginPopup(n){return kt(this.instance.loginPopup(n))}loginRedirect(n){return kt(this.instance.loginRedirect(n))}logout(n){return kt(this.instance.logout(n))}logoutRedirect(n){return kt(this.instance.logoutRedirect(n))}logoutPopup(n){return kt(this.instance.logoutPopup(n))}ssoSilent(n){return kt(this.instance.ssoSilent(n))}getLogger(){return this.logger||(this.logger=this.instance.getLogger().clone($A,n_)),this.logger}setLogger(n){this.logger=n.clone($A,n_),this.instance.setLogger(n)}}return e.\u0275fac=function(n){return new(n||e)(qe(nh),qe(zc))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})(),zA=(()=>{class e{constructor(n,r,o){this.msalInstance=n,this.authService=r,this.msalBroadcastConfig=o,this.msalBroadcastConfig&&this.msalBroadcastConfig.eventsToReplay>0?(this.authService.getLogger().verbose(`BroadcastService - eventsToReplay set on BroadcastConfig, replaying the last ${this.msalBroadcastConfig.eventsToReplay} events`),this._msalSubject=new NV(this.msalBroadcastConfig.eventsToReplay)):this._msalSubject=new T,this.msalSubject$=this._msalSubject.asObservable(),this._inProgress=new An(on.$H.Startup),this.inProgress$=this._inProgress.asObservable(),this.msalInstance.addEventCallback(i=>{this._msalSubject.next(i);const s=RV.getInteractionStatusFromEvent(i,this._inProgress.value);null!==s&&(this.authService.getLogger().verbose(`BroadcastService - ${i.eventType} results in setting inProgress from ${this._inProgress.value} to ${s}`),this._inProgress.next(s))})}}return e.\u0275fac=function(n){return new(n||e)(qe(nh),qe(dl),qe(LV,8))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})(),FV=(()=>{class e{constructor(n,r,o,i,s){this.msalGuardConfig=n,this.msalBroadcastService=r,this.authService=o,this.location=i,this.router=s,this.msalBroadcastService.inProgress$.subscribe()}parseUrl(n){return this.router.parseUrl(n)}getDestinationUrl(n){this.authService.getLogger().verbose("Guard - getting destination url");const r=document.getElementsByTagName("base"),o=this.location.normalize(r.length?r[0].href:window.location.origin),i=this.location.prepareExternalUrl(n);return i.startsWith("#")?(this.authService.getLogger().verbose("Guard - destination by hash routing"),`${o}/${i}`):`${o}${n}`}loginInteractively(n){const r="function"==typeof this.msalGuardConfig.authRequest?this.msalGuardConfig.authRequest(this.authService,n):{...this.msalGuardConfig.authRequest};if(this.msalGuardConfig.interactionType===on.s_.Popup)return this.authService.getLogger().verbose("Guard - logging in by popup"),this.authService.loginPopup(r).pipe(be(i=>(this.authService.getLogger().verbose("Guard - login by popup successful, can activate, setting active account"),this.authService.instance.setActiveAccount(i.account),!0)));this.authService.getLogger().verbose("Guard - logging in by redirect");const o=this.getDestinationUrl(n.url);return this.authService.loginRedirect({redirectStartPage:o,...r}).pipe(be(()=>!1))}activateHelper(n){if(this.msalGuardConfig.interactionType!==on.s_.Popup&&this.msalGuardConfig.interactionType!==on.s_.Redirect)throw new OV.WK("invalid_interaction_type","Invalid interaction type provided to MSAL Guard. InteractionType.Popup or InteractionType.Redirect must be provided in the MsalGuardConfiguration");if(this.authService.getLogger().verbose("MSAL Guard activated"),!(typeof window<"u"))return this.authService.getLogger().info("Guard - window is undefined, MSAL does not support server-side token acquisition"),Xe(!0);if(kV.G.hashContainsKnownProperties(window.location.hash)&&PV.zd()&&!this.authService.instance.getConfiguration().system.allowRedirectInIframe)return this.authService.getLogger().warning("Guard - redirectUri set to page with MSAL Guard. It is recommended to not set redirectUri to a page that requires authentication."),Xe(!1);this.msalGuardConfig.loginFailedRoute&&(this.loginFailedRoute=this.parseUrl(this.msalGuardConfig.loginFailedRoute));const r=this.location.path(!0);return this.authService.initialize().pipe(vi(()=>this.authService.handleRedirectObservable()),vi(()=>{if(!this.authService.instance.getAllAccounts().length)return n?(this.authService.getLogger().verbose("Guard - no accounts retrieved, log in required to activate"),this.loginInteractively(n)):(this.authService.getLogger().verbose("Guard - no accounts retrieved, no state, cannot load"),Xe(!1));if(this.authService.getLogger().verbose("Guard - at least 1 account exists, can activate or load"),n){const o=this.includesCode(n.url),i=!!n.root&&!!n.root.fragment&&this.includesCode(`#${n.root.fragment}`),s=0===this.location.prepareExternalUrl(n.url).indexOf("#");if(o&&(i||s))return this.authService.getLogger().info("Guard - Hash contains known code response, stopping navigation."),r.indexOf("#")>-1?Xe(this.parseUrl(this.location.path())):Xe(this.parseUrl(""))}return Xe(!0)}),Ko(o=>(this.authService.getLogger().error("Guard - error while logging in, unable to activate"),this.authService.getLogger().errorPii(`Guard - error: ${o.message}`),this.loginFailedRoute&&n?(this.authService.getLogger().verbose("Guard - loginFailedRoute set, redirecting"),Xe(this.loginFailedRoute)):Xe(!1))))}includesCode(n){return n.lastIndexOf("/code")>-1&&n.lastIndexOf("/code")===n.length-5||n.indexOf("#code=")>-1||n.indexOf("&code=")>-1}canActivate(n,r){return this.authService.getLogger().verbose("Guard - canActivate"),this.activateHelper(r)}canActivateChild(n,r){return this.authService.getLogger().verbose("Guard - canActivateChild"),this.activateHelper(r)}canMatch(){return this.authService.getLogger().verbose("Guard - canLoad"),this.activateHelper()}}return e.\u0275fac=function(n){return new(n||e)(qe(VA),qe(zA),qe(dl),qe(zc),qe(ir))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})(),UV=(()=>{class e{static forRoot(n,r,o){return{ngModule:e,providers:[{provide:nh,useValue:n},{provide:VA,useValue:r},{provide:xV,useValue:o},dl]}}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Bn({type:e}),e.\u0275inj=Se({providers:[FV,zA],imports:[oT]}),e})(),rh=(()=>{class e{constructor(n){this.msalService=n,this.isAuthenticated=new An(!1),this.isAuthenticated$=this.isAuthenticated.asObservable(),this.userName=new An("Guest"),this.userName$=this.userName.asObservable(),this.jwt="USER_TOKEN";let r=this.msalService.initialize();this.checkIfUserStillLoggedIn()||r.subscribe(()=>{this.msalService.instance.handleRedirectPromise().then(o=>{null!==o&&(this.isAuthenticated.next(!0),this.userName.next(o.account.idTokenClaims.given_name||"Guest"),localStorage.setItem(this.jwt,JSON.stringify(o.idTokenClaims)))}).catch(o=>{console.log("Authentication error:",o)})})}checkIfUserStillLoggedIn(){let n=localStorage.getItem(this.jwt);return!!n&&(this.userName.next(JSON.parse(n).given_name),this.isAuthenticated.next(!0),!0)}login(){this.msalService.loginRedirect()}logout(){this.msalService.logoutRedirect(),this.isAuthenticated.next(!1),localStorage.removeItem(this.jwt)}static#e=this.\u0275fac=function(r){return new(r||e)(qe(dl))};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();try{r_=typeof Intl<"u"&&Intl.v8BreakIterator}catch{r_=!1}let hl,GA=(()=>{class e{constructor(n){this._platformId=n,this.isBrowser=this._platformId?function ej(e){return e===iT}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!r_)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}static#e=this.\u0275fac=function(r){return new(r||e)(qe(fi))};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function oh(e){return function BV(){if(null==hl&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>hl=!0}))}finally{hl=hl||!1}return hl}()?e:!!e.capture}function KA(e){return Array.isArray(e)?e:[e]}class QV extends H{constructor(t,n){super()}schedule(t,n=0){return this}}const sh={setInterval(e,t,...n){const{delegate:r}=sh;return r?.setInterval?r.setInterval(e,t,...n):setInterval(e,t,...n)},clearInterval(e){const{delegate:t}=sh;return(t?.clearInterval||clearInterval)(e)},delegate:void 0};class fl{constructor(t,n=fl.now){this.schedulerActionCtor=t,this.now=n}schedule(t,n=0,r){return new this.schedulerActionCtor(this,t).schedule(r,n)}}fl.now=t_.now;const e3=new class XV extends fl{constructor(t,n=fl.now){super(t,n),this.actions=[],this._active=!1}flush(t){const{actions:n}=this;if(this._active)return void n.push(t);let r;this._active=!0;do{if(r=t.execute(t.state,t.delay))break}while(t=n.shift());if(this._active=!1,r){for(;t=n.shift();)t.unsubscribe();throw r}}}(class JV extends QV{constructor(t,n){super(t,n),this.scheduler=t,this.work=n,this.pending=!1}schedule(t,n=0){var r;if(this.closed)return this;this.state=t;const o=this.id,i=this.scheduler;return null!=o&&(this.id=this.recycleAsyncId(i,o,n)),this.pending=!0,this.delay=n,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(i,this.id,n),this}requestAsyncId(t,n,r=0){return sh.setInterval(t.flush.bind(t,this),r)}recycleAsyncId(t,n,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return n;null!=n&&sh.clearInterval(n)}execute(t,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(t,n);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,n){let o,r=!1;try{this.work(t)}catch(i){r=!0,o=i||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),o}unsubscribe(){if(!this.closed){const{id:t,scheduler:n}=this,{actions:r}=n;this.work=this.state=this.scheduler=null,this.pending=!1,$(r,this),null!=t&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null,super.unsubscribe()}}}),ZA=new Set;let os,n3=(()=>{class e{constructor(n,r){this._platform=n,this._nonce=r,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):o3}matchMedia(n){return(this._platform.WEBKIT||this._platform.BLINK)&&function r3(e,t){if(!ZA.has(e))try{os||(os=document.createElement("style"),t&&(os.nonce=t),os.setAttribute("type","text/css"),document.head.appendChild(os)),os.sheet&&(os.sheet.insertRule(`@media ${e} {body{ }}`,0),ZA.add(e))}catch(n){console.error(n)}}(n,this._nonce),this._matchMedia(n)}static#e=this.\u0275fac=function(r){return new(r||e)(qe(GA),qe(Rp,8))};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function o3(e){return{matches:"all"===e||""===e,media:e,addListener:()=>{},removeListener:()=>{}}}let s3=(()=>{class e{constructor(n,r){this._mediaMatcher=n,this._zone=r,this._queries=new Map,this._destroySubject=new T}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(n){return YA(KA(n)).some(o=>this._registerQuery(o).mql.matches)}observe(n){let i=Ld(YA(KA(n)).map(s=>this._registerQuery(s).observable));return i=Ud(i.pipe(yi(1)),i.pipe(function YV(e){return wo((t,n)=>e<=n)}(1),function t3(e,t=e3){return Ce((n,r)=>{let o=null,i=null,s=null;const a=()=>{if(o){o.unsubscribe(),o=null;const h=i;i=null,r.next(h)}};function l(){const h=s+e,f=t.now();if(f<h)return o=this.schedule(void 0,h-f),void r.add(o);a()}n.subscribe(Me(r,h=>{i=h,s=t.now(),o||(o=t.schedule(l,e),r.add(o))},()=>{a(),r.complete()},void 0,()=>{i=o=null}))})}(0))),i.pipe(be(s=>{const a={matches:!1,breakpoints:{}};return s.forEach(({matches:l,query:h})=>{a.matches=a.matches||l,a.breakpoints[h]=l}),a}))}_registerQuery(n){if(this._queries.has(n))return this._queries.get(n);const r=this._mediaMatcher.matchMedia(n),i={observable:new G(s=>{const a=l=>this._zone.run(()=>s.next(l));return r.addListener(a),()=>{r.removeListener(a)}}).pipe(LT(r),be(({matches:s})=>({query:n,matches:s})),UT(this._destroySubject)),mql:r};return this._queries.set(n,i),i}static#e=this.\u0275fac=function(r){return new(r||e)(qe(n3),qe(Wt))};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function YA(e){return e.map(t=>t.split(",")).reduce((t,n)=>t.concat(n)).map(t=>t.trim())}const e0="cdk-high-contrast-black-on-white",t0="cdk-high-contrast-white-on-black",i_="cdk-high-contrast-active";let _3=(()=>{class e{constructor(n,r){this._platform=n,this._document=r,this._breakpointSubscription=Ze(s3).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const n=this._document.createElement("div");n.style.backgroundColor="rgb(1,2,3)",n.style.position="absolute",this._document.body.appendChild(n);const r=this._document.defaultView||window,o=r&&r.getComputedStyle?r.getComputedStyle(n):null,i=(o&&o.backgroundColor||"").replace(/ /g,"");switch(n.remove(),i){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const n=this._document.body.classList;n.remove(i_,e0,t0),this._hasCheckedHighContrastMode=!0;const r=this.getHighContrastMode();1===r?n.add(i_,e0):2===r&&n.add(i_,t0)}}static#e=this.\u0275fac=function(r){return new(r||e)(qe(GA),qe(pn))};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),n0=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275mod=Bn({type:e});static#n=this.\u0275inj=Se({})}return e})();const E3=new Ve("mat-sanity-checks",{providedIn:"root",factory:function C3(){return!0}});let s0=(()=>{class e{constructor(n,r,o){this._sanityChecks=r,this._document=o,this._hasDoneGlobalChecks=!1,n._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(n){return!function $V(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[n])}static#e=this.\u0275fac=function(r){return new(r||e)(qe(_3),qe(E3,8),qe(pn))};static#t=this.\u0275mod=Bn({type:e});static#n=this.\u0275inj=Se({imports:[n0,n0]})}return e})();function w3(e,t){return class extends e{get color(){return this._color}set color(n){const r=n||this.defaultColor;r!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),r&&this._elementRef.nativeElement.classList.add(`mat-${r}`),this._color=r)}constructor(...n){super(...n),this.defaultColor=t,this.color=t}}}const a0=oh({passive:!0,capture:!0});class S3{constructor(){this._events=new Map,this._delegateEventHandler=t=>{const n=function HV(e){return e.composedPath?e.composedPath()[0]:e.target}(t);n&&this._events.get(t.type)?.forEach((r,o)=>{(o===n||o.contains(n))&&r.forEach(i=>i.handleEvent(t))})}}addHandler(t,n,r,o){const i=this._events.get(n);if(i){const s=i.get(r);s?s.add(o):i.set(r,new Set([o]))}else this._events.set(n,new Map([[r,new Set([o])]])),t.runOutsideAngular(()=>{document.addEventListener(n,this._delegateEventHandler,a0)})}removeHandler(t,n,r){const o=this._events.get(t);if(!o)return;const i=o.get(n);i&&(i.delete(r),0===i.size&&o.delete(n),0===o.size&&(this._events.delete(t),document.removeEventListener(t,this._delegateEventHandler,a0)))}}class s_{static#e=this._eventManager=new S3;constructor(t,n,r,o){this._target=t,this._ngZone=n,this._platform=o,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,o.isBrowser&&(this._containerElement=WA(r))}fadeInRipple(t,n,r={}){const o=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),i={...c0,...r.animation},s=r.radius||function A3(e,t,n){const r=Math.max(Math.abs(e-n.left),Math.abs(e-n.right)),o=Math.max(Math.abs(t-n.top),Math.abs(t-n.bottom));return Math.sqrt(r*r+o*o)}(t,n,o),a=t-o.left,l=n-o.top,h=i.enterDuration,f=document.createElement("div");f.classList.add("mat-ripple-element"),f.style.left=a-s+"px",f.style.top=l-s+"px",f.style.height=2*s+"px",f.style.width=2*s+"px",null!=r.color&&(f.style.backgroundColor=r.color),f.style.transitionDuration=`${h}ms`,this._containerElement.appendChild(f);const v=window.getComputedStyle(f),W=v.transitionDuration,ne="none"===v.transitionProperty||"0s"===W||"0s, 0s"===W||0===o.width&&0===o.height,ae=new I3(this,f,r,ne);f.style.transform="scale3d(1, 1, 1)",ae.state=0,r.persistent||(this._mostRecentTransientRipple=ae);return!ne&&(h||i.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const Ae=()=>this._finishRippleTransition(ae),ve=()=>this._destroyRipple(ae);f.addEventListener("transitionend",Ae),f.addEventListener("transitioncancel",ve)}),this._activeRipples.set(ae,null),(ne||!h)&&this._finishRippleTransition(ae),ae}fadeOutRipple(t){if(2===t.state||3===t.state)return;const n=t.element,r={...c0,...t.config.animation};n.style.transitionDuration=`${r.exitDuration}ms`,n.style.opacity="0",t.state=2,(t._animationForciblyDisabledThroughCss||!r.exitDuration)&&this._finishRippleTransition(t)}fadeOutAll(){this._getActiveRipples().forEach(t=>t.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(t=>{t.config.persistent||t.fadeOut()})}setupTriggerEvents(t){const n=WA(t);!this._platform.isBrowser||!n||n===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=n,u0.forEach(r=>{s_._eventManager.addHandler(this._ngZone,r,n,this)}))}handleEvent(t){"mousedown"===t.type?this._onMousedown(t):"touchstart"===t.type?this._onTouchStart(t):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{d0.forEach(n=>{this._triggerElement.addEventListener(n,this,l0)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(t){0===t.state?this._startFadeOutTransition(t):2===t.state&&this._destroyRipple(t)}_startFadeOutTransition(t){const n=t===this._mostRecentTransientRipple,{persistent:r}=t.config;t.state=1,!r&&(!n||!this._isPointerDown)&&t.fadeOut()}_destroyRipple(t){const n=this._activeRipples.get(t)??null;this._activeRipples.delete(t),this._activeRipples.size||(this._containerRect=null),t===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),t.state=3,null!==n&&(t.element.removeEventListener("transitionend",n.onTransitionEnd),t.element.removeEventListener("transitioncancel",n.onTransitionCancel)),t.element.remove()}_onMousedown(t){const n=function p3(e){return 0===e.buttons||0===e.detail}(t),r=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!n&&!r&&(this._isPointerDown=!0,this.fadeInRipple(t.clientX,t.clientY,this._target.rippleConfig))}_onTouchStart(t){if(!this._target.rippleDisabled&&!function g3(e){const t=e.touches&&e.touches[0]||e.changedTouches&&e.changedTouches[0];return!(!t||-1!==t.identifier||null!=t.radiusX&&1!==t.radiusX||null!=t.radiusY&&1!==t.radiusY)}(t)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const n=t.changedTouches;if(n)for(let r=0;r<n.length;r++)this.fadeInRipple(n[r].clientX,n[r].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(t=>{!t.config.persistent&&(1===t.state||t.config.terminateOnPointerUp&&0===t.state)&&t.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const t=this._triggerElement;t&&(u0.forEach(n=>s_._eventManager.removeHandler(n,t,this)),this._pointerUpEventsRegistered&&d0.forEach(n=>t.removeEventListener(n,this,l0)))}}function h0(...e){const t=Gt(e),{args:n,keys:r}=RT(e),o=new G(i=>{const{length:s}=n;if(!s)return void i.complete();const a=new Array(s);let l=s,h=s;for(let f=0;f<s;f++){let v=!1;vn(n[f]).subscribe(Me(i,x=>{v||(v=!0,h--),a[f]=x},()=>l--,void 0,()=>{(!l||!v)&&(h||i.next(r?kT(r,a):a),i.complete())}))}});return t?o.pipe(OT(t)):o}class ah{}class ch{}class So{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?"string"==typeof t?this.lazyInit=()=>{this.headers=new Map,t.split("\n").forEach(n=>{const r=n.indexOf(":");if(r>0){const o=n.slice(0,r),i=o.toLowerCase(),s=n.slice(r+1).trim();this.maybeSetNormalizedName(o,i),this.headers.has(i)?this.headers.get(i).push(s):this.headers.set(i,[s])}})}:typeof Headers<"u"&&t instanceof Headers?(this.headers=new Map,t.forEach((n,r)=>{this.setHeaderEntries(r,n)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(t).forEach(([n,r])=>{this.setHeaderEntries(n,r)})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const n=this.headers.get(t.toLowerCase());return n&&n.length>0?n[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,n){return this.clone({name:t,value:n,op:"a"})}set(t,n){return this.clone({name:t,value:n,op:"s"})}delete(t,n){return this.clone({name:t,value:n,op:"d"})}maybeSetNormalizedName(t,n){this.normalizedNames.has(n)||this.normalizedNames.set(n,t)}init(){this.lazyInit&&(this.lazyInit instanceof So?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(n=>{this.headers.set(n,t.headers.get(n)),this.normalizedNames.set(n,t.normalizedNames.get(n))})}clone(t){const n=new So;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof So?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([t]),n}applyUpdate(t){const n=t.name.toLowerCase();switch(t.op){case"a":case"s":let r=t.value;if("string"==typeof r&&(r=[r]),0===r.length)return;this.maybeSetNormalizedName(t.name,n);const o=("a"===t.op?this.headers.get(n):void 0)||[];o.push(...r),this.headers.set(n,o);break;case"d":const i=t.value;if(i){let s=this.headers.get(n);if(!s)return;s=s.filter(a=>-1===i.indexOf(a)),0===s.length?(this.headers.delete(n),this.normalizedNames.delete(n)):this.headers.set(n,s)}else this.headers.delete(n),this.normalizedNames.delete(n)}}setHeaderEntries(t,n){const r=(Array.isArray(n)?n:[n]).map(i=>i.toString()),o=t.toLowerCase();this.headers.set(o,r),this.maybeSetNormalizedName(t,o)}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(n=>t(this.normalizedNames.get(n),this.headers.get(n)))}}class D3{encodeKey(t){return f0(t)}encodeValue(t){return f0(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}const R3=/%(\d[a-f0-9])/gi,O3={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function f0(e){return encodeURIComponent(e).replace(R3,(t,n)=>O3[n]??t)}function lh(e){return`${e}`}class wi{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new D3,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function M3(e,t){const n=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(o=>{const i=o.indexOf("="),[s,a]=-1==i?[t.decodeKey(o),""]:[t.decodeKey(o.slice(0,i)),t.decodeValue(o.slice(i+1))],l=n.get(s)||[];l.push(a),n.set(s,l)}),n}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(n=>{const r=t.fromObject[n],o=Array.isArray(r)?r.map(lh):[lh(r)];this.map.set(n,o)})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const n=this.map.get(t);return n?n[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,n){return this.clone({param:t,value:n,op:"a"})}appendAll(t){const n=[];return Object.keys(t).forEach(r=>{const o=t[r];Array.isArray(o)?o.forEach(i=>{n.push({param:r,value:i,op:"a"})}):n.push({param:r,value:o,op:"a"})}),this.clone(n)}set(t,n){return this.clone({param:t,value:n,op:"s"})}delete(t,n){return this.clone({param:t,value:n,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const n=this.encoder.encodeKey(t);return this.map.get(t).map(r=>n+"="+this.encoder.encodeValue(r)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const n=new wi({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(t),n}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const n=("a"===t.op?this.map.get(t.param):void 0)||[];n.push(lh(t.value)),this.map.set(t.param,n);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let r=this.map.get(t.param)||[];const o=r.indexOf(lh(t.value));-1!==o&&r.splice(o,1),r.length>0?this.map.set(t.param,r):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}class k3{constructor(){this.map=new Map}set(t,n){return this.map.set(t,n),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}}function p0(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer}function g0(e){return typeof Blob<"u"&&e instanceof Blob}function m0(e){return typeof FormData<"u"&&e instanceof FormData}class gl{constructor(t,n,r,o){let i;if(this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function P3(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||o?(this.body=void 0!==r?r:null,i=o):i=r,i&&(this.reportProgress=!!i.reportProgress,this.withCredentials=!!i.withCredentials,i.responseType&&(this.responseType=i.responseType),i.headers&&(this.headers=i.headers),i.context&&(this.context=i.context),i.params&&(this.params=i.params)),this.headers||(this.headers=new So),this.context||(this.context=new k3),this.params){const s=this.params.toString();if(0===s.length)this.urlWithParams=n;else{const a=n.indexOf("?");this.urlWithParams=n+(-1===a?"?":a<n.length-1?"&":"")+s}}else this.params=new wi,this.urlWithParams=n}serializeBody(){return null===this.body?null:p0(this.body)||g0(this.body)||m0(this.body)||function N3(e){return typeof URLSearchParams<"u"&&e instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof wi?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||m0(this.body)?null:g0(this.body)?this.body.type||null:p0(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof wi?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(t={}){const n=t.method||this.method,r=t.url||this.url,o=t.responseType||this.responseType,i=void 0!==t.body?t.body:this.body,s=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,a=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let l=t.headers||this.headers,h=t.params||this.params;const f=t.context??this.context;return void 0!==t.setHeaders&&(l=Object.keys(t.setHeaders).reduce((v,x)=>v.set(x,t.setHeaders[x]),l)),t.setParams&&(h=Object.keys(t.setParams).reduce((v,x)=>v.set(x,t.setParams[x]),h)),new gl(n,r,i,{params:h,headers:l,context:f,reportProgress:a,responseType:o,withCredentials:s})}}var ba=function(e){return e[e.Sent=0]="Sent",e[e.UploadProgress=1]="UploadProgress",e[e.ResponseHeader=2]="ResponseHeader",e[e.DownloadProgress=3]="DownloadProgress",e[e.Response=4]="Response",e[e.User=5]="User",e}(ba||{});class a_{constructor(t,n=200,r="OK"){this.headers=t.headers||new So,this.status=void 0!==t.status?t.status:n,this.statusText=t.statusText||r,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class c_ extends a_{constructor(t={}){super(t),this.type=ba.ResponseHeader}clone(t={}){return new c_({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class Ia extends a_{constructor(t={}){super(t),this.type=ba.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new Ia({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class _0 extends a_{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function l_(e,t){return{body:t,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}let uh=(()=>{class e{constructor(n){this.handler=n}request(n,r,o={}){let i;if(n instanceof gl)i=n;else{let l,h;l=o.headers instanceof So?o.headers:new So(o.headers),o.params&&(h=o.params instanceof wi?o.params:new wi({fromObject:o.params})),i=new gl(n,r,void 0!==o.body?o.body:null,{headers:l,context:o.context,params:h,reportProgress:o.reportProgress,responseType:o.responseType||"json",withCredentials:o.withCredentials})}const s=Xe(i).pipe(vi(l=>this.handler.handle(l)));if(n instanceof gl||"events"===o.observe)return s;const a=s.pipe(wo(l=>l instanceof Ia));switch(o.observe||"body"){case"body":switch(i.responseType){case"arraybuffer":return a.pipe(be(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe(be(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe(be(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));default:return a.pipe(be(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${o.observe}}`)}}delete(n,r={}){return this.request("DELETE",n,r)}get(n,r={}){return this.request("GET",n,r)}head(n,r={}){return this.request("HEAD",n,r)}jsonp(n,r){return this.request("JSONP",n,{params:(new wi).append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(n,r={}){return this.request("OPTIONS",n,r)}patch(n,r,o={}){return this.request("PATCH",n,l_(o,r))}post(n,r,o={}){return this.request("POST",n,l_(o,r))}put(n,r,o={}){return this.request("PUT",n,l_(o,r))}static#e=this.\u0275fac=function(r){return new(r||e)(qe(ah))};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac})}return e})();function C0(e,t){return t(e)}function L3(e,t){return(n,r)=>t.intercept(n,{handle:o=>e(o,r)})}const U3=new Ve(""),ml=new Ve(""),E0=new Ve("");function B3(){let e=null;return(t,n)=>{null===e&&(e=(Ze(U3,{optional:!0})??[]).reduceRight(L3,C0));const r=Ze(hd),o=r.add();return e(t,n).pipe(ha(()=>r.remove(o)))}}let w0=(()=>{class e extends ah{constructor(n,r){super(),this.backend=n,this.injector=r,this.chain=null,this.pendingTasks=Ze(hd)}handle(n){if(null===this.chain){const o=Array.from(new Set([...this.injector.get(ml),...this.injector.get(E0,[])]));this.chain=o.reduceRight((i,s)=>function F3(e,t,n){return(r,o)=>n.runInContext(()=>t(r,i=>e(i,o)))}(i,s,this.injector),C0)}const r=this.pendingTasks.add();return this.chain(n,o=>this.backend.handle(o)).pipe(ha(()=>this.pendingTasks.remove(r)))}static#e=this.\u0275fac=function(r){return new(r||e)(qe(ch),qe(Or))};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac})}return e})();const V3=/^\)\]\}',?\n/;let I0=(()=>{class e{constructor(n){this.xhrFactory=n}handle(n){if("JSONP"===n.method)throw new Fe(-2800,!1);const r=this.xhrFactory;return(r.\u0275loadImpl?kt(r.\u0275loadImpl()):Xe(null)).pipe(br(()=>new G(i=>{const s=r.build();if(s.open(n.method,n.urlWithParams),n.withCredentials&&(s.withCredentials=!0),n.headers.forEach((ae,_e)=>s.setRequestHeader(ae,_e.join(","))),n.headers.has("Accept")||s.setRequestHeader("Accept","application/json, text/plain, */*"),!n.headers.has("Content-Type")){const ae=n.detectContentTypeHeader();null!==ae&&s.setRequestHeader("Content-Type",ae)}if(n.responseType){const ae=n.responseType.toLowerCase();s.responseType="json"!==ae?ae:"text"}const a=n.serializeBody();let l=null;const h=()=>{if(null!==l)return l;const ae=s.statusText||"OK",_e=new So(s.getAllResponseHeaders()),Ae=function z3(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(s)||n.url;return l=new c_({headers:_e,status:s.status,statusText:ae,url:Ae}),l},f=()=>{let{headers:ae,status:_e,statusText:Ae,url:ve}=h(),Ue=null;204!==_e&&(Ue=typeof s.response>"u"?s.responseText:s.response),0===_e&&(_e=Ue?200:0);let We=_e>=200&&_e<300;if("json"===n.responseType&&"string"==typeof Ue){const Qe=Ue;Ue=Ue.replace(V3,"");try{Ue=""!==Ue?JSON.parse(Ue):null}catch(et){Ue=Qe,We&&(We=!1,Ue={error:et,text:Ue})}}We?(i.next(new Ia({body:Ue,headers:ae,status:_e,statusText:Ae,url:ve||void 0})),i.complete()):i.error(new _0({error:Ue,headers:ae,status:_e,statusText:Ae,url:ve||void 0}))},v=ae=>{const{url:_e}=h(),Ae=new _0({error:ae,status:s.status||0,statusText:s.statusText||"Unknown Error",url:_e||void 0});i.error(Ae)};let x=!1;const W=ae=>{x||(i.next(h()),x=!0);let _e={type:ba.DownloadProgress,loaded:ae.loaded};ae.lengthComputable&&(_e.total=ae.total),"text"===n.responseType&&s.responseText&&(_e.partialText=s.responseText),i.next(_e)},ne=ae=>{let _e={type:ba.UploadProgress,loaded:ae.loaded};ae.lengthComputable&&(_e.total=ae.total),i.next(_e)};return s.addEventListener("load",f),s.addEventListener("error",v),s.addEventListener("timeout",v),s.addEventListener("abort",v),n.reportProgress&&(s.addEventListener("progress",W),null!==a&&s.upload&&s.upload.addEventListener("progress",ne)),s.send(a),i.next({type:ba.Sent}),()=>{s.removeEventListener("error",v),s.removeEventListener("abort",v),s.removeEventListener("load",f),s.removeEventListener("timeout",v),n.reportProgress&&(s.removeEventListener("progress",W),null!==a&&s.upload&&s.upload.removeEventListener("progress",ne)),s.readyState!==s.DONE&&s.abort()}})))}static#e=this.\u0275fac=function(r){return new(r||e)(qe(aT))};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac})}return e})();const u_=new Ve("XSRF_ENABLED"),S0=new Ve("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),T0=new Ve("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class A0{}let K3=(()=>{class e{constructor(n,r,o){this.doc=n,this.platform=r,this.cookieName=o,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const n=this.doc.cookie||"";return n!==this.lastCookieString&&(this.parseCount++,this.lastToken=ZS(n,this.cookieName),this.lastCookieString=n),this.lastToken}static#e=this.\u0275fac=function(r){return new(r||e)(qe(pn),qe(fi),qe(S0))};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac})}return e})();function W3(e,t){const n=e.url.toLowerCase();if(!Ze(u_)||"GET"===e.method||"HEAD"===e.method||n.startsWith("http://")||n.startsWith("https://"))return t(e);const r=Ze(A0).getToken(),o=Ze(T0);return null!=r&&!e.headers.has(o)&&(e=e.clone({headers:e.headers.set(o,r)})),t(e)}var bi=function(e){return e[e.Interceptors=0]="Interceptors",e[e.LegacyInterceptors=1]="LegacyInterceptors",e[e.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",e[e.NoXsrfProtection=3]="NoXsrfProtection",e[e.JsonpSupport=4]="JsonpSupport",e[e.RequestsMadeViaParent=5]="RequestsMadeViaParent",e[e.Fetch=6]="Fetch",e}(bi||{});function Z3(...e){const t=[uh,I0,w0,{provide:ah,useExisting:w0},{provide:ch,useExisting:I0},{provide:ml,useValue:W3,multi:!0},{provide:u_,useValue:!0},{provide:A0,useClass:K3}];for(const n of e)t.push(...n.\u0275providers);return function bp(e){return{\u0275providers:e}}(t)}const D0=new Ve("LEGACY_INTERCEPTOR_FN");function Y3(){return function is(e,t){return{\u0275kind:e,\u0275providers:t}}(bi.LegacyInterceptors,[{provide:D0,useFactory:B3},{provide:ml,useExisting:D0,multi:!0}])}let Q3=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275mod=Bn({type:e});static#n=this.\u0275inj=Se({providers:[Z3(Y3())]})}return e})();const rz=["*"];let hh;function _l(e){return function oz(){if(void 0===hh&&(hh=null,typeof window<"u")){const e=window;void 0!==e.trustedTypes&&(hh=e.trustedTypes.createPolicy("angular#components",{createHTML:t=>t}))}return hh}()?.createHTML(e)||e}function M0(e){return Error(`Unable to find icon with the name "${e}"`)}function R0(e){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${e}".`)}function O0(e){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${e}".`)}class ss{constructor(t,n,r){this.url=t,this.svgText=n,this.options=r}}let fh=(()=>{class e{constructor(n,r,o,i){this._httpClient=n,this._sanitizer=r,this._errorHandler=i,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=o}addSvgIcon(n,r,o){return this.addSvgIconInNamespace("",n,r,o)}addSvgIconLiteral(n,r,o){return this.addSvgIconLiteralInNamespace("",n,r,o)}addSvgIconInNamespace(n,r,o,i){return this._addSvgIconConfig(n,r,new ss(o,null,i))}addSvgIconResolver(n){return this._resolvers.push(n),this}addSvgIconLiteralInNamespace(n,r,o,i){const s=this._sanitizer.sanitize(xn.HTML,o);if(!s)throw O0(o);const a=_l(s);return this._addSvgIconConfig(n,r,new ss("",a,i))}addSvgIconSet(n,r){return this.addSvgIconSetInNamespace("",n,r)}addSvgIconSetLiteral(n,r){return this.addSvgIconSetLiteralInNamespace("",n,r)}addSvgIconSetInNamespace(n,r,o){return this._addSvgIconSetConfig(n,new ss(r,null,o))}addSvgIconSetLiteralInNamespace(n,r,o){const i=this._sanitizer.sanitize(xn.HTML,r);if(!i)throw O0(r);const s=_l(i);return this._addSvgIconSetConfig(n,new ss("",s,o))}registerFontClassAlias(n,r=n){return this._fontCssClassesByAlias.set(n,r),this}classNameForFontAlias(n){return this._fontCssClassesByAlias.get(n)||n}setDefaultFontSetClass(...n){return this._defaultFontSetClass=n,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(n){const r=this._sanitizer.sanitize(xn.RESOURCE_URL,n);if(!r)throw R0(n);const o=this._cachedIconsByUrl.get(r);return o?Xe(ph(o)):this._loadSvgIconFromConfig(new ss(n,null)).pipe(In(i=>this._cachedIconsByUrl.set(r,i)),be(i=>ph(i)))}getNamedSvgIcon(n,r=""){const o=k0(r,n);let i=this._svgIconConfigs.get(o);if(i)return this._getSvgFromConfig(i);if(i=this._getIconConfigFromResolvers(r,n),i)return this._svgIconConfigs.set(o,i),this._getSvgFromConfig(i);const s=this._iconSetConfigs.get(r);return s?this._getSvgFromIconSetConfigs(n,s):da(M0(o))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(n){return n.svgText?Xe(ph(this._svgElementFromConfig(n))):this._loadSvgIconFromConfig(n).pipe(be(r=>ph(r)))}_getSvgFromIconSetConfigs(n,r){const o=this._extractIconWithNameFromAnySet(n,r);return o?Xe(o):h0(r.filter(s=>!s.svgText).map(s=>this._loadSvgIconSetFromConfig(s).pipe(Ko(a=>{const h=`Loading icon set URL: ${this._sanitizer.sanitize(xn.RESOURCE_URL,s.url)} failed: ${a.message}`;return this._errorHandler.handleError(new Error(h)),Xe(null)})))).pipe(be(()=>{const s=this._extractIconWithNameFromAnySet(n,r);if(!s)throw M0(n);return s}))}_extractIconWithNameFromAnySet(n,r){for(let o=r.length-1;o>=0;o--){const i=r[o];if(i.svgText&&i.svgText.toString().indexOf(n)>-1){const s=this._svgElementFromConfig(i),a=this._extractSvgIconFromSet(s,n,i.options);if(a)return a}}return null}_loadSvgIconFromConfig(n){return this._fetchIcon(n).pipe(In(r=>n.svgText=r),be(()=>this._svgElementFromConfig(n)))}_loadSvgIconSetFromConfig(n){return n.svgText?Xe(null):this._fetchIcon(n).pipe(In(r=>n.svgText=r))}_extractSvgIconFromSet(n,r,o){const i=n.querySelector(`[id="${r}"]`);if(!i)return null;const s=i.cloneNode(!0);if(s.removeAttribute("id"),"svg"===s.nodeName.toLowerCase())return this._setSvgAttributes(s,o);if("symbol"===s.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(s),o);const a=this._svgElementFromString(_l("<svg></svg>"));return a.appendChild(s),this._setSvgAttributes(a,o)}_svgElementFromString(n){const r=this._document.createElement("DIV");r.innerHTML=n;const o=r.querySelector("svg");if(!o)throw Error("<svg> tag not found");return o}_toSvgElement(n){const r=this._svgElementFromString(_l("<svg></svg>")),o=n.attributes;for(let i=0;i<o.length;i++){const{name:s,value:a}=o[i];"id"!==s&&r.setAttribute(s,a)}for(let i=0;i<n.childNodes.length;i++)n.childNodes[i].nodeType===this._document.ELEMENT_NODE&&r.appendChild(n.childNodes[i].cloneNode(!0));return r}_setSvgAttributes(n,r){return n.setAttribute("fit",""),n.setAttribute("height","100%"),n.setAttribute("width","100%"),n.setAttribute("preserveAspectRatio","xMidYMid meet"),n.setAttribute("focusable","false"),r&&r.viewBox&&n.setAttribute("viewBox",r.viewBox),n}_fetchIcon(n){const{url:r,options:o}=n,i=o?.withCredentials??!1;if(!this._httpClient)throw function iz(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==r)throw Error(`Cannot fetch icon from URL "${r}".`);const s=this._sanitizer.sanitize(xn.RESOURCE_URL,r);if(!s)throw R0(r);const a=this._inProgressUrlFetches.get(s);if(a)return a;const l=this._httpClient.get(s,{responseType:"text",withCredentials:i}).pipe(be(h=>_l(h)),ha(()=>this._inProgressUrlFetches.delete(s)),ja());return this._inProgressUrlFetches.set(s,l),l}_addSvgIconConfig(n,r,o){return this._svgIconConfigs.set(k0(n,r),o),this}_addSvgIconSetConfig(n,r){const o=this._iconSetConfigs.get(n);return o?o.push(r):this._iconSetConfigs.set(n,[r]),this}_svgElementFromConfig(n){if(!n.svgElement){const r=this._svgElementFromString(n.svgText);this._setSvgAttributes(r,n.options),n.svgElement=r}return n.svgElement}_getIconConfigFromResolvers(n,r){for(let o=0;o<this._resolvers.length;o++){const i=this._resolvers[o](r,n);if(i)return az(i)?new ss(i.url,null,i.options):new ss(i,null)}}static#e=this.\u0275fac=function(r){return new(r||e)(qe(uh,8),qe(Om),qe(pn,8),qe(Ur))};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function ph(e){return e.cloneNode(!0)}function k0(e,t){return e+":"+t}function az(e){return!(!e.url||!e.options)}const cz=w3(class{constructor(e){this._elementRef=e}}),lz=new Ve("MAT_ICON_DEFAULT_OPTIONS"),uz=new Ve("mat-icon-location",{providedIn:"root",factory:function dz(){const e=Ze(pn),t=e?e.location:null;return{getPathname:()=>t?t.pathname+t.search:""}}}),P0=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],hz=P0.map(e=>`[${e}]`).join(", "),fz=/^url\(['"]?#(.*?)['"]?\)$/;let pz=(()=>{class e extends cz{get inline(){return this._inline}set inline(n){this._inline=function WV(e){return null!=e&&"false"!=`${e}`}(n)}get svgIcon(){return this._svgIcon}set svgIcon(n){n!==this._svgIcon&&(n?this._updateSvgIcon(n):this._svgIcon&&this._clearSvgElement(),this._svgIcon=n)}get fontSet(){return this._fontSet}set fontSet(n){const r=this._cleanupFontValue(n);r!==this._fontSet&&(this._fontSet=r,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(n){const r=this._cleanupFontValue(n);r!==this._fontIcon&&(this._fontIcon=r,this._updateFontIconClasses())}constructor(n,r,o,i,s,a){super(n),this._iconRegistry=r,this._location=i,this._errorHandler=s,this._inline=!1,this._previousFontSetClass=[],this._currentIconFetch=H.EMPTY,a&&(a.color&&(this.color=this.defaultColor=a.color),a.fontSet&&(this.fontSet=a.fontSet)),o||n.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(n){if(!n)return["",""];const r=n.split(":");switch(r.length){case 1:return["",r[0]];case 2:return r;default:throw Error(`Invalid icon name: "${n}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const n=this._elementsWithExternalReferences;if(n&&n.size){const r=this._location.getPathname();r!==this._previousPath&&(this._previousPath=r,this._prependPathToReferences(r))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(n){this._clearSvgElement();const r=this._location.getPathname();this._previousPath=r,this._cacheChildrenWithExternalReferences(n),this._prependPathToReferences(r),this._elementRef.nativeElement.appendChild(n)}_clearSvgElement(){const n=this._elementRef.nativeElement;let r=n.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();r--;){const o=n.childNodes[r];(1!==o.nodeType||"svg"===o.nodeName.toLowerCase())&&o.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const n=this._elementRef.nativeElement,r=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(o=>o.length>0);this._previousFontSetClass.forEach(o=>n.classList.remove(o)),r.forEach(o=>n.classList.add(o)),this._previousFontSetClass=r,this.fontIcon!==this._previousFontIconClass&&!r.includes("mat-ligature-font")&&(this._previousFontIconClass&&n.classList.remove(this._previousFontIconClass),this.fontIcon&&n.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(n){return"string"==typeof n?n.trim().split(" ")[0]:n}_prependPathToReferences(n){const r=this._elementsWithExternalReferences;r&&r.forEach((o,i)=>{o.forEach(s=>{i.setAttribute(s.name,`url('${n}#${s.value}')`)})})}_cacheChildrenWithExternalReferences(n){const r=n.querySelectorAll(hz),o=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let i=0;i<r.length;i++)P0.forEach(s=>{const a=r[i],l=a.getAttribute(s),h=l?l.match(fz):null;if(h){let f=o.get(a);f||(f=[],o.set(a,f)),f.push({name:s,value:h[1]})}})}_updateSvgIcon(n){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),n){const[r,o]=this._splitIconName(n);r&&(this._svgNamespace=r),o&&(this._svgName=o),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(o,r).pipe(yi(1)).subscribe(i=>this._setSvgElement(i),i=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${r}:${o}! ${i.message}`))})}}static#e=this.\u0275fac=function(r){return new(r||e)(Pe(er),Pe(fh),ac("aria-hidden"),Pe(uz),Pe(Ur),Pe(lz,8))};static#t=this.\u0275cmp=Sr({type:e,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:8,hostBindings:function(r,o){2&r&&(Jr("data-mat-icon-type",o._usingFontIcon()?"font":"svg")("data-mat-icon-name",o._svgName||o.fontIcon)("data-mat-icon-namespace",o._svgNamespace||o.fontSet)("fontIcon",o._usingFontIcon()?o.fontIcon:null),Oc("mat-icon-inline",o.inline)("mat-icon-no-color","primary"!==o.color&&"accent"!==o.color&&"warn"!==o.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[jt],ngContentSelectors:rz,decls:1,vars:0,template:function(r,o){1&r&&(function Hw(e){const t=Le()[hn][jn];if(!t.projection){const r=t.projection=lc(e?e.length:1,null),o=r.slice();let i=t.child;for(;null!==i;){const s=e?I1(i,e):0;null!==s&&(o[s]?o[s].projectionNext=i:r[s]=i,o[s]=i),i=i.next}}}(),function $w(e,t=0,n){const r=Le(),o=At(),i=qs(o,bt+e,16,null,n||null);null===i.projection&&(i.projection=t),Bf(),(!r[xo]||Is())&&32!=(32&i.flags)&&function EP(e,t,n){GC(t[ht],0,t,n,hp(e,n,t),BC(n.parent||t[jn],n,t))}(o,r,i)}(0))},styles:["mat-icon,mat-icon.mat-primary,mat-icon.mat-accent,mat-icon.mat-warn{color:var(--mat-icon-color)}.mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0})}return e})(),gz=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275mod=Bn({type:e});static#n=this.\u0275inj=Se({imports:[s0,s0]})}return e})();function mz(e,t){if(1&e){const n=Ki();Je(0,"div",14),fn("click",function(){return Fi(n),Ui(Pr().login())}),Je(1,"span",9),yt(2," Hello Guest "),it(),Je(3,"span",10),yt(4," Sign in "),it()()}}function _z(e,t){if(1&e){const n=Ki();Je(0,"div",14),fn("click",function(){return Fi(n),Ui(Pr().logout())}),Je(1,"span",9),yt(2),it(),Je(3,"span",10),yt(4," Sign out "),it()()}if(2&e){const n=Pr();st(2),$o(" Hello ",n.userName," ")}}function yz(e,t){1&e&&(Je(0,"div",15)(1,"div",8)(2,"span",9),yt(3," Returns "),it(),Je(4,"span",10),yt(5," & Orders "),it()()())}function vz(e,t){if(1&e){const n=Ki();Je(0,"div",14),fn("click",function(){return Fi(n),Ui(Pr().login())}),Je(1,"div",8)(2,"span",9),yt(3," Returns "),it(),Je(4,"span",10),yt(5," & Orders "),it()()()}}let gh=(()=>{class e{constructor(n,r){this._basketService=n,this._authService=r,this.basketItems=0,this.isAuthenticated=!1,this.userName=""}ngOnInit(){this._basketService.basketLength$.subscribe(n=>{this.basketItems=n}),this._authService.isAuthenticated$.subscribe(n=>{this.isAuthenticated=n}),this._authService.userName$.subscribe(n=>{this.userName=n})}login(){this._authService.login()}logout(){this._authService.logout()}static#e=this.\u0275fac=function(r){return new(r||e)(Pe(Ea),Pe(rh))};static#t=this.\u0275cmp=Sr({type:e,selectors:[["app-header"]],decls:20,vars:5,consts:[[1,"header"],["routerLink","/home","src","assets/images/amazon_logo.png",1,"header__logo"],[1,"header__search"],["type","text",1,"header__searchInput"],["fontIcon","search",1,"header__searchIcon"],[1,"header__nav"],["class","header__option",3,"click",4,"ngIf"],["routerLink","/orders","class","header__option",4,"ngIf"],[1,"header__option"],[1,"header__optionLineOne"],[1,"header__optionLineTwo"],["routerLink","/checkout",1,"header__optionBasket"],["fontIcon","shopping_basket"],[1,"header__optionLineTwo","header__basketCount"],[1,"header__option",3,"click"],["routerLink","/orders",1,"header__option"]],template:function(r,o){1&r&&(Je(0,"div",0),$t(1,"img",1),Je(2,"div",2),$t(3,"input",3)(4,"mat-icon",4),it(),Je(5,"div",5),tr(6,mz,5,0,"div",6),tr(7,_z,5,1,"div",6),tr(8,yz,6,0,"div",7),tr(9,vz,6,0,"div",6),Je(10,"div",8)(11,"div",8)(12,"span",9),yt(13," Your "),it(),Je(14,"span",10),yt(15," Prime "),it()()(),Je(16,"div",11),$t(17,"mat-icon",12),Je(18,"span",13),yt(19),it()()()()),2&r&&(st(6),Et("ngIf",!o.isAuthenticated),st(1),Et("ngIf",o.isAuthenticated),st(1),Et("ngIf",o.isAuthenticated),st(1),Et("ngIf",!o.isAuthenticated),st(10),to(o.basketItems))},dependencies:[ua,ul,pz],styles:[".header[_ngcontent-%COMP%]{height:60px;display:flex;background-color:#131921;position:sticky;align-items:center;top:0;z-index:100}.header__logo[_ngcontent-%COMP%]{width:100px;object-fit:contain;margin:12px 20px 0;cursor:pointer}.header__search[_ngcontent-%COMP%]{display:flex;flex:1;align-items:center;border-radius:24px}.header__searchInput[_ngcontent-%COMP%]{height:12px;padding:10px;border:none;width:100%}.header__searchIcon[_ngcontent-%COMP%]{padding:5px;height:22px!important;background-color:#cd9042}.header__optionLineOne[_ngcontent-%COMP%]{font-size:10px}.header__optionLineTwo[_ngcontent-%COMP%]{font-size:13px;font-weight:800}.header__nav[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly}.header__option[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:10px;margin-right:10px;color:#fff;cursor:pointer}.header__optionBasket[_ngcontent-%COMP%]{display:flex;color:#fff;align-items:center;cursor:pointer}.header__basketCount[_ngcontent-%COMP%]{margin-left:10px;margin-right:10px}"]})}return e})();var ge=S(5861);let Cz=(()=>{class e{constructor(n){this.http=n,this.apiBaseUrl="https://amazoncloneapi.azurewebsites.net"}getProductData(n){return this.http.get(this.apiBaseUrl+`/api/product/getproduct?productId=${n}`,{responseType:"json"})}getProductImage(n){return this.http.get(`${this.apiBaseUrl}/api/product/getproductimage?blobName=${n}`,{responseType:"blob"})}static#e=this.\u0275fac=function(r){return new(r||e)(qe(uh))};static#t=this.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function Ez(e,t){if(1&e&&(Je(0,"p"),yt(1),Bc(2,"slice"),it()),2&e){const n=Pr(2);st(1),to(n.title.length>75?EI(2,1,n.title,0,75)+"...":n.title)}}function wz(e,t){if(1&e){const n=Ki();Je(0,"div",1),$t(1,"img",2),Je(2,"div",3),tr(3,Ez,3,5,"p",4),it(),Je(4,"div",5)(5,"small"),yt(6,"$"),it(),Je(7,"strong"),yt(8),it()(),$t(9,"div",6),Je(10,"button",7),fn("click",function(){return Fi(n),Ui(Pr().addItemToBasket())}),yt(11,"Add to Basket"),it()()}if(2&e){const n=Pr();st(1),Et("src",n.imageSrc,Ou),st(2),Et("ngIf",n.title),st(5),to(n.price),st(1),Et("innerHTML",n.starHtml,Ru)}}let bz=(()=>{class e{constructor(n,r){this._productService=n,this._basketService=r,this.productId=0,this.isDataLoaded=!1,this.imageSrc="",this.starHtml=""}ngOnInit(){var n=this;return(0,ge.Z)(function*(){yield n._productService.getProductData(n.convertIdToProduct(n.productId)).subscribe(r=>{n.productIdDB=r.id,n.productName=r.name,n.title=r.description,n.price=r.price,n.productRating=r.star,n.starsToStarHtml(r.star),n.renderProductImage(r.image_name),n.isDataLoaded=!0},r=>{console.log("Product data not fetched. Please check Azure App service. Error details: "+r.message)})})()}renderProductImage(n=""){var r=this;return(0,ge.Z)(function*(){yield r._productService.getProductImage(n).subscribe(o=>{const i=new FileReader;i.onloadend=()=>{r.imageSrc=i.result},i.readAsDataURL(o)})})()}starsToStarHtml(n=0){for(var r=0;r<n;r++)this.starHtml+="<span>\u2b50</span>"}convertIdToProduct(n){const r="prod10";return n>=0&&n<=9?r+"0"+n:r+n}addItemToBasket(){var n={tempId:"P"+Math.ceil(1e5*Math.random()),title:this.title,imageSrc:this.imageSrc,price:this.price,star:this.productRating};this._basketService.items.push(n),this._basketService.updateBasketLength()}static#e=this.\u0275fac=function(r){return new(r||e)(Pe(Cz),Pe(Ea))};static#t=this.\u0275cmp=Sr({type:e,selectors:[["app-product"]],inputs:{productId:"productId"},decls:1,vars:1,consts:[["class","product",4,"ngIf"],[1,"product"],["alt","Image",1,"product_image",3,"src"],[1,"product__info"],[4,"ngIf"],[1,"product__price"],[1,"product__rating",3,"innerHTML"],[3,"click"]],template:function(r,o){1&r&&tr(0,wz,12,4,"div",0),2&r&&Et("ngIf",o.isDataLoaded)},dependencies:[ua,rT],styles:[".product[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin:10px;padding:20px;width:100%;max-height:400px;min-width:180px;background-color:#fff;z-index:1}.product[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{max-height:200px;width:100%;object-fit:contain;margin-bottom:15px}.product__info[_ngcontent-%COMP%]{max-height:100px;margin:20px}.product[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{background:#f0c14b;border:1px solid;margin-top:10px;border-color:#a88734 #9c7e31 #846a29;color:#111;cursor:pointer}.product__price[_ngcontent-%COMP%]{margin-top:5px}.product__rating[_ngcontent-%COMP%]{display:inline-block;margin-bottom:5px}"]})}return e})(),N0=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275cmp=Sr({type:e,selectors:[["app-home"]],decls:23,vars:12,consts:[[1,"home"],[1,"home__container"],[2,"color","white","background","black","text-align","center"],["src","assets\\images\\amazon_ad\\amazon_prime_adv.png",1,"home__advertImage"],[1,"home__row"],[3,"productId"]],template:function(r,o){1&r&&($t(0,"app-header"),Je(1,"div",0)(2,"div",1)(3,"h4",2),yt(4," Hi Guys, Zahid Here!! Some features here won't work as expected since I am using the Azure's \"FREE TIER\" plans. Sorry about that! \u270c\ufe0f."),$t(5,"br"),it(),$t(6,"img",3),Je(7,"div",4),$t(8,"app-product",5)(9,"app-product",5)(10,"app-product",5),it(),Je(11,"div",4),$t(12,"app-product",5)(13,"app-product",5)(14,"app-product",5),it(),Je(15,"div",4),$t(16,"app-product",5)(17,"app-product",5)(18,"app-product",5),it(),Je(19,"div",4),$t(20,"app-product",5)(21,"app-product",5)(22,"app-product",5),it()()()),2&r&&(st(8),Et("productId",2),st(1),Et("productId",4),st(1),Et("productId",1),st(2),Et("productId",3),st(1),Et("productId",6),st(1),Et("productId",10),st(2),Et("productId",5),st(1),Et("productId",7),st(1),Et("productId",8),st(2),Et("productId",9),st(1),Et("productId",11),st(1),Et("productId",12))},dependencies:[gh,bz],styles:[".home[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-left:auto;margin-right:auto;max-width:1500px}.home__advertImage[_ngcontent-%COMP%]{width:100%;z-index:-1;margin-bottom:-150px;-webkit-mask-image:linear-gradient(to bottom,rgba(255,255,255,1),rgba(255,255,255,0));mask-image:linear-gradient(to bottom,rgba(255,255,255,1),rgba(255,255,255,0))}.home__row[_ngcontent-%COMP%]{display:flex;justify-content:center;max-height:1500px;max-width:1500px;z-index:1}.home__row[_ngcontent-%COMP%] > app-product[_ngcontent-%COMP%]{display:flex;max-width:1500px;z-index:1}"]})}return e})(),Iz=(()=>{class e{constructor(n,r,o){this._basketService=n,this._authService=r,this.router=o,this.amount=0,this.basketLength=0,this.isUserAuthenticated=!1}ngOnInit(){this._basketService.basketLength$.subscribe(n=>{this.basketLength=n,this.amount=0;var r=this._basketService.items.map(i=>i.price);for(var o in r)this.amount+=parseFloat(r[o])}),this._authService.isAuthenticated$.subscribe(n=>{this.isUserAuthenticated=n})}redirectToPaymentOrSignIn(){this.isUserAuthenticated?this.router.navigateByUrl("/payment"):this._authService.login()}static#e=this.\u0275fac=function(r){return new(r||e)(Pe(Ea),Pe(rh),Pe(ir))};static#t=this.\u0275cmp=Sr({type:e,selectors:[["app-subtotal"]],decls:11,vars:4,consts:[[1,"subtotal"],[1,"subtotal__gift"],["type","checkbox"],[3,"click"]],template:function(r,o){1&r&&(Je(0,"div",0)(1,"p"),yt(2),Je(3,"strong"),yt(4),Bc(5,"currency"),it()(),Je(6,"small",1),$t(7,"input",2),yt(8," This order contains a gift "),it(),Je(9,"button",3),fn("click",function(){return o.redirectToPaymentOrSignIn()}),yt(10," Proceed to Checkout "),it()()),2&r&&(st(2),$o(" Subtotal (",o.basketLength," items): "),st(2),to(cd(5,2,o.amount)))},dependencies:[kd],styles:[".subtotal[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;width:300px;height:120px;padding:20px;background-color:#f3f3f3;border:1px solid #dddddd;border-radius:3px;margin-left:10px}.subtotal__gift[_ngcontent-%COMP%]{display:flex;align-items:center}.subtotal__gift[_ngcontent-%COMP%] > input[_ngcontent-%COMP%]{margin-right:5px}.subtotal[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{background:#f0c14b;border-radius:2px;width:100%;height:30px;border:1px solid;margin-top:10px;border-color:#a88734 #9c7e31 #846a29;color:#111;cursor:pointer}"]})}return e})(),d_=(()=>{class e{constructor(){this.onDelete=new an,this.isBtnHidden=!1,this.imageSrc="",this.starHtml=""}ngOnInit(){this.renderProductDetails()}renderProductDetails(){this.tempId=this.item.tempId,this.title=this.item.title,this.imageSrc=this.item.imageSrc,this.price=this.item.price;for(var n=0;n<this.item.star;n++)this.starHtml+="<span>\u2b50</span>"}deleteProduct(){this.onDelete.emit(this.tempId)}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275cmp=Sr({type:e,selectors:[["app-checkout-products"]],inputs:{item:"item",isBtnHidden:"isBtnHidden"},outputs:{onDelete:"onDelete"},decls:13,vars:5,consts:[[1,"checkout_product"],[1,"checkout__image",3,"src"],[1,"checkout__details"],[1,"checkout__itemTitle"],[1,"checkout__price"],[1,"checkout__rating",3,"innerHTML"],["type","button",3,"hidden","click"]],template:function(r,o){1&r&&(Je(0,"div",0),$t(1,"img",1),Je(2,"div",2)(3,"p",3),yt(4),it(),Je(5,"div",4)(6,"small"),yt(7,"$"),it(),Je(8,"strong"),yt(9),it()(),$t(10,"div",5),Je(11,"button",6),fn("click",function(){return o.deleteProduct()}),yt(12," Remove from basket "),it()()()),2&r&&(st(1),Et("src",o.imageSrc,Ou),st(3),$o(" ",o.title," "),st(5),to(o.price),st(1),Et("innerHTML",o.starHtml,Ru),st(1),Et("hidden",o.isBtnHidden))},styles:[".checkout_product[_ngcontent-%COMP%]{display:flex;margin-top:20px;margin-bottom:20px}.checkout_items[_ngcontent-%COMP%]{display:flex;flex-direction:column}.checkout__image[_ngcontent-%COMP%]{width:200px;height:auto;margin-right:10px}.checkout__details[_ngcontent-%COMP%]{padding-left:20px}.checkout__image[_ngcontent-%COMP%]{object-fit:contain;width:180px;height:180px}.checkout__itemTitle[_ngcontent-%COMP%]{font-size:17px;font-weight:800}.checkout__details[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{background:#f0c14b;border:1px solid;margin-top:10px;border-color:#a88734 #9c7e31 #846a29;color:#111}"]})}return e})();function Sz(e,t){if(1&e){const n=Ki();Je(0,"div")(1,"app-checkout-products",6),fn("onDelete",function(o){return Fi(n),Ui(Pr().deleteProduct(o))}),it()()}if(2&e){const n=t.$implicit;st(1),Et("item",n)}}let Tz=(()=>{class e{constructor(n,r){this._basketService=n,this._authService=r,this.items=[],this.userName="Guest"}ngOnInit(){this.items=this._basketService.items,this._authService.userName$.subscribe(n=>{this.userName=n})}deleteProduct(n){this.items=this.items.filter(r=>r.tempId!==n),this._basketService.removeFromBasket(n)}static#e=this.\u0275fac=function(r){return new(r||e)(Pe(Ea),Pe(rh))};static#t=this.\u0275cmp=Sr({type:e,selectors:[["app-checkout"]],decls:12,vars:2,consts:[[1,"checkout"],[1,"checkout__left"],["src","assets/images/amazon_ad/checkout_ad.jpg","alt","",1,"checkout__ad"],[1,"checkout__title"],[4,"ngFor","ngForOf"],[1,"checkout__right"],[1,"item",3,"item","onDelete"]],template:function(r,o){1&r&&($t(0,"app-header"),Je(1,"div",0)(2,"div",1),$t(3,"img",2),Je(4,"div")(5,"h1"),yt(6),it(),Je(7,"h2",3),yt(8," Your Shopping Basket "),it(),tr(9,Sz,2,1,"div",4),it()(),Je(10,"div",5),$t(11,"app-subtotal"),it()()),2&r&&(st(6),$o(" Hello ",o.userName,", "),st(3),Et("ngForOf",o.items))},dependencies:[Od,gh,Iz,d_],styles:[".checkout[_ngcontent-%COMP%]{display:flex;padding:20px;background-color:#fff;height:max-content}.checkout__ad[_ngcontent-%COMP%]{width:100%;margin-bottom:10px;border-radius:3px}.checkout__title[_ngcontent-%COMP%]{margin-right:10px;padding:10px;border-bottom:1px solid lightgray}"]})}return e})();var x0="https://js.stripe.com/v3",Az=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,L0="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",F0=function(t){var n=t&&!t.advancedFraudSignals?"?advancedFraudSignals=false":"",r=document.createElement("script");r.src="".concat(x0).concat(n);var o=document.head||document.body;if(!o)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return o.appendChild(r),r},yl=null,mh=null,_h=null,U0=Promise.resolve().then(function(){return t=null,null!==yl?yl:(yl=new Promise(function(n,r){if(typeof window>"u"||typeof document>"u")n(null);else if(window.Stripe&&t&&console.warn(L0),window.Stripe)n(window.Stripe);else try{var o=function(){for(var t=document.querySelectorAll('script[src^="'.concat(x0,'"]')),n=0;n<t.length;n++){var r=t[n];if(Az.test(r.src))return r}return null}();if(o&&t)console.warn(L0);else if(o){if(o&&null!==_h&&null!==mh){var i;o.removeEventListener("load",_h),o.removeEventListener("error",mh),null===(i=o.parentNode)||void 0===i||i.removeChild(o),o=F0(t)}}else o=F0(t);_h=function(t,n){return function(){window.Stripe?t(window.Stripe):n(new Error("Stripe.js not available"))}}(n,r),mh=function(t){return function(){t(new Error("Failed to load Stripe.js"))}}(r),o.addEventListener("load",_h),o.addEventListener("error",mh)}catch(s){return void r(s)}})).catch(function(n){return yl=null,Promise.reject(n)});var t}),B0=!1;function j0(e,t){return function(){return e.apply(t,arguments)}}U0.catch(function(e){B0||console.warn(e)});const{toString:xz}=Object.prototype,{getPrototypeOf:h_}=Object,yh=(e=Object.create(null),t=>{const n=xz.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())}),To=e=>(e=e.toLowerCase(),t=>yh(t)===e),vh=e=>t=>typeof t===e,{isArray:Sa}=Array,vl=vh("undefined");var e;const H0=To("ArrayBuffer"),Uz=vh("string"),$r=vh("function"),$0=vh("number"),Ch=e=>null!==e&&"object"==typeof e,Eh=e=>{if("object"!==yh(e))return!1;const t=h_(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)},jz=To("Date"),Hz=To("File"),$z=To("Blob"),Vz=To("FileList"),qz=To("URLSearchParams");function Cl(e,t,{allOwnKeys:n=!1}={}){if(null===e||typeof e>"u")return;let r,o;if("object"!=typeof e&&(e=[e]),Sa(e))for(r=0,o=e.length;r<o;r++)t.call(null,e[r],r,e);else{const i=n?Object.getOwnPropertyNames(e):Object.keys(e),s=i.length;let a;for(r=0;r<s;r++)a=i[r],t.call(null,e[a],a,e)}}function V0(e,t){t=t.toLowerCase();const n=Object.keys(e);let o,r=n.length;for(;r-- >0;)if(o=n[r],t===o.toLowerCase())return o;return null}const z0=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,G0=e=>!vl(e)&&e!==z0,e4=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&h_(Uint8Array)),r4=To("HTMLFormElement"),q0=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),s4=To("RegExp"),K0=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};Cl(n,(o,i)=>{let s;!1!==(s=t(o,i,e))&&(r[i]=s||o)}),Object.defineProperties(e,r)},p_="abcdefghijklmnopqrstuvwxyz",W0="0123456789",Z0={DIGIT:W0,ALPHA:p_,ALPHA_DIGIT:p_+p_.toUpperCase()+W0},p4=To("AsyncFunction"),Ne={isArray:Sa,isArrayBuffer:H0,isBuffer:function Lz(e){return null!==e&&!vl(e)&&null!==e.constructor&&!vl(e.constructor)&&$r(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&("function"==typeof FormData&&e instanceof FormData||$r(e.append)&&("formdata"===(t=yh(e))||"object"===t&&$r(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function Fz(e){let t;return t=typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&H0(e.buffer),t},isString:Uz,isNumber:$0,isBoolean:e=>!0===e||!1===e,isObject:Ch,isPlainObject:Eh,isUndefined:vl,isDate:jz,isFile:Hz,isBlob:$z,isRegExp:s4,isFunction:$r,isStream:e=>Ch(e)&&$r(e.pipe),isURLSearchParams:qz,isTypedArray:e4,isFileList:Vz,forEach:Cl,merge:function f_(){const{caseless:e}=G0(this)&&this||{},t={},n=(r,o)=>{const i=e&&V0(t,o)||o;t[i]=Eh(t[i])&&Eh(r)?f_(t[i],r):Eh(r)?f_({},r):Sa(r)?r.slice():r};for(let r=0,o=arguments.length;r<o;r++)arguments[r]&&Cl(arguments[r],n);return t},extend:(e,t,n,{allOwnKeys:r}={})=>(Cl(t,(o,i)=>{e[i]=n&&$r(o)?j0(o,n):o},{allOwnKeys:r}),e),trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,r)=>{let o,i,s;const a={};if(t=t||{},null==e)return t;do{for(o=Object.getOwnPropertyNames(e),i=o.length;i-- >0;)s=o[i],(!r||r(s,e,t))&&!a[s]&&(t[s]=e[s],a[s]=!0);e=!1!==n&&h_(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:yh,kindOfTest:To,endsWith:(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length);const r=e.indexOf(t,n-=t.length);return-1!==r&&r===n},toArray:e=>{if(!e)return null;if(Sa(e))return e;let t=e.length;if(!$0(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},forEachEntry:(e,t)=>{const r=(e&&e[Symbol.iterator]).call(e);let o;for(;(o=r.next())&&!o.done;){const i=o.value;t.call(e,i[0],i[1])}},matchAll:(e,t)=>{let n;const r=[];for(;null!==(n=e.exec(t));)r.push(n);return r},isHTMLForm:r4,hasOwnProperty:q0,hasOwnProp:q0,reduceDescriptors:K0,freezeMethods:e=>{K0(e,(t,n)=>{if($r(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;if($r(e[n])){if(t.enumerable=!1,"writable"in t)return void(t.writable=!1);t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},toObjectSet:(e,t)=>{const n={},r=o=>{o.forEach(i=>{n[i]=!0})};return Sa(e)?r(e):r(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,o){return r.toUpperCase()+o}),noop:()=>{},toFiniteNumber:(e,t)=>(e=+e,Number.isFinite(e)?e:t),findKey:V0,global:z0,isContextDefined:G0,ALPHABET:Z0,generateString:(e=16,t=Z0.ALPHA_DIGIT)=>{let n="";const{length:r}=t;for(;e--;)n+=t[Math.random()*r|0];return n},isSpecCompliantForm:function h4(e){return!!(e&&$r(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])},toJSONObject:e=>{const t=new Array(10),n=(r,o)=>{if(Ch(r)){if(t.indexOf(r)>=0)return;if(!("toJSON"in r)){t[o]=r;const i=Sa(r)?[]:{};return Cl(r,(s,a)=>{const l=n(s,o+1);!vl(l)&&(i[a]=l)}),t[o]=void 0,i}}return r};return n(e,0)},isAsyncFn:p4,isThenable:e=>e&&(Ch(e)||$r(e))&&$r(e.then)&&$r(e.catch)};function Ta(e,t,n,r,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),o&&(this.response=o)}Ne.inherits(Ta,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ne.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const Y0=Ta.prototype,Q0={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Q0[e]={value:e}}),Object.defineProperties(Ta,Q0),Object.defineProperty(Y0,"isAxiosError",{value:!0}),Ta.from=(e,t,n,r,o,i)=>{const s=Object.create(Y0);return Ne.toFlatObject(e,s,function(l){return l!==Error.prototype},a=>"isAxiosError"!==a),Ta.call(s,e.message,t,n,r,o),s.cause=e,s.name=e.name,i&&Object.assign(s,i),s};const zt=Ta;function g_(e){return Ne.isPlainObject(e)||Ne.isArray(e)}function X0(e){return Ne.endsWith(e,"[]")?e.slice(0,-2):e}function eD(e,t,n){return e?e.concat(t).map(function(o,i){return o=X0(o),!n&&i?"["+o+"]":o}).join(n?".":""):t}const m4=Ne.toFlatObject(Ne,{},null,function(t){return/^is[A-Z]/.test(t)}),wh=function _4(e,t,n){if(!Ne.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const r=(n=Ne.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(ae,_e){return!Ne.isUndefined(_e[ae])})).metaTokens,o=n.visitor||f,i=n.dots,s=n.indexes,l=(n.Blob||typeof Blob<"u"&&Blob)&&Ne.isSpecCompliantForm(t);if(!Ne.isFunction(o))throw new TypeError("visitor must be a function");function h(ne){if(null===ne)return"";if(Ne.isDate(ne))return ne.toISOString();if(!l&&Ne.isBlob(ne))throw new zt("Blob is not supported. Use a Buffer instead.");return Ne.isArrayBuffer(ne)||Ne.isTypedArray(ne)?l&&"function"==typeof Blob?new Blob([ne]):Buffer.from(ne):ne}function f(ne,ae,_e){let Ae=ne;if(ne&&!_e&&"object"==typeof ne)if(Ne.endsWith(ae,"{}"))ae=r?ae:ae.slice(0,-2),ne=JSON.stringify(ne);else if(Ne.isArray(ne)&&function g4(e){return Ne.isArray(e)&&!e.some(g_)}(ne)||(Ne.isFileList(ne)||Ne.endsWith(ae,"[]"))&&(Ae=Ne.toArray(ne)))return ae=X0(ae),Ae.forEach(function(Ue,We){!Ne.isUndefined(Ue)&&null!==Ue&&t.append(!0===s?eD([ae],We,i):null===s?ae:ae+"[]",h(Ue))}),!1;return!!g_(ne)||(t.append(eD(_e,ae,i),h(ne)),!1)}const v=[],x=Object.assign(m4,{defaultVisitor:f,convertValue:h,isVisitable:g_});if(!Ne.isObject(e))throw new TypeError("data must be an object");return function W(ne,ae){if(!Ne.isUndefined(ne)){if(-1!==v.indexOf(ne))throw Error("Circular reference detected in "+ae.join("."));v.push(ne),Ne.forEach(ne,function(Ae,ve){!0===(!(Ne.isUndefined(Ae)||null===Ae)&&o.call(t,Ae,Ne.isString(ve)?ve.trim():ve,ae,x))&&W(Ae,ae?ae.concat(ve):[ve])}),v.pop()}}(e),t};function tD(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function nD(e,t){this._pairs=[],e&&wh(e,this,t)}const rD=nD.prototype;rD.append=function(t,n){this._pairs.push([t,n])},rD.toString=function(t){const n=t?function(r){return t.call(this,r,tD)}:tD;return this._pairs.map(function(o){return n(o[0])+"="+n(o[1])},"").join("&")};const oD=nD;function y4(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function iD(e,t,n){if(!t)return e;const r=n&&n.encode||y4,o=n&&n.serialize;let i;if(i=o?o(t,n):Ne.isURLSearchParams(t)?t.toString():new oD(t,n).toString(r),i){const s=e.indexOf("#");-1!==s&&(e=e.slice(0,s)),e+=(-1===e.indexOf("?")?"?":"&")+i}return e}const sD=class v4{constructor(){this.handlers=[]}use(t,n,r){return this.handlers.push({fulfilled:t,rejected:n,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Ne.forEach(this.handlers,function(r){null!==r&&t(r)})}},aD={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},C4={isBrowser:!0,classes:{URLSearchParams:typeof URLSearchParams<"u"?URLSearchParams:oD,FormData:typeof FormData<"u"?FormData:null,Blob:typeof Blob<"u"?Blob:null},protocols:["http","https","file","blob","url","data"]},cD=typeof window<"u"&&typeof document<"u",E4=(e=>cD&&["ReactNative","NativeScript","NS"].indexOf(e)<0)(typeof navigator<"u"&&navigator.product),w4=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,Ao={...E,...C4},lD=function T4(e){function t(n,r,o,i){let s=n[i++];const a=Number.isFinite(+s),l=i>=n.length;return s=!s&&Ne.isArray(o)?o.length:s,l?(o[s]=Ne.hasOwnProp(o,s)?[o[s],r]:r,!a):((!o[s]||!Ne.isObject(o[s]))&&(o[s]=[]),t(n,r,o[s],i)&&Ne.isArray(o[s])&&(o[s]=function S4(e){const t={},n=Object.keys(e);let r;const o=n.length;let i;for(r=0;r<o;r++)i=n[r],t[i]=e[i];return t}(o[s])),!a)}if(Ne.isFormData(e)&&Ne.isFunction(e.entries)){const n={};return Ne.forEachEntry(e,(r,o)=>{t(function I4(e){return Ne.matchAll(/\w+|\[(\w*)]/g,e).map(t=>"[]"===t[0]?"":t[1]||t[0])}(r),o,n,0)}),n}return null},m_={transitional:aD,adapter:["xhr","http"],transformRequest:[function(t,n){const r=n.getContentType()||"",o=r.indexOf("application/json")>-1,i=Ne.isObject(t);if(i&&Ne.isHTMLForm(t)&&(t=new FormData(t)),Ne.isFormData(t))return o&&o?JSON.stringify(lD(t)):t;if(Ne.isArrayBuffer(t)||Ne.isBuffer(t)||Ne.isStream(t)||Ne.isFile(t)||Ne.isBlob(t))return t;if(Ne.isArrayBufferView(t))return t.buffer;if(Ne.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let a;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return function b4(e,t){return wh(e,new Ao.classes.URLSearchParams,Object.assign({visitor:function(n,r,o,i){return Ao.isNode&&Ne.isBuffer(n)?(this.append(r,n.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},t))}(t,this.formSerializer).toString();if((a=Ne.isFileList(t))||r.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return wh(a?{"files[]":t}:t,l&&new l,this.formSerializer)}}return i||o?(n.setContentType("application/json",!1),function A4(e,t,n){if(Ne.isString(e))try{return(t||JSON.parse)(e),Ne.trim(e)}catch(r){if("SyntaxError"!==r.name)throw r}return(n||JSON.stringify)(e)}(t)):t}],transformResponse:[function(t){const n=this.transitional||m_.transitional,r=n&&n.forcedJSONParsing,o="json"===this.responseType;if(t&&Ne.isString(t)&&(r&&!this.responseType||o)){const s=!(n&&n.silentJSONParsing)&&o;try{return JSON.parse(t)}catch(a){if(s)throw"SyntaxError"===a.name?zt.from(a,zt.ERR_BAD_RESPONSE,this,null,this.response):a}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ao.classes.FormData,Blob:Ao.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ne.forEach(["delete","get","head","post","put","patch"],e=>{m_.headers[e]={}});const __=m_,D4=Ne.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),uD=Symbol("internals");function El(e){return e&&String(e).trim().toLowerCase()}function bh(e){return!1===e||null==e?e:Ne.isArray(e)?e.map(bh):String(e)}function y_(e,t,n,r,o){if(Ne.isFunction(r))return r.call(this,t,n);if(o&&(t=n),Ne.isString(t)){if(Ne.isString(r))return-1!==t.indexOf(r);if(Ne.isRegExp(r))return r.test(t)}}class Ih{constructor(t){t&&this.set(t)}set(t,n,r){const o=this;function i(a,l,h){const f=El(l);if(!f)throw new Error("header name must be a non-empty string");const v=Ne.findKey(o,f);(!v||void 0===o[v]||!0===h||void 0===h&&!1!==o[v])&&(o[v||l]=bh(a))}const s=(a,l)=>Ne.forEach(a,(h,f)=>i(h,f,l));return Ne.isPlainObject(t)||t instanceof this.constructor?s(t,n):Ne.isString(t)&&(t=t.trim())&&!(e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))(t)?s((e=>{const t={};let n,r,o;return e&&e.split("\n").forEach(function(s){o=s.indexOf(":"),n=s.substring(0,o).trim().toLowerCase(),r=s.substring(o+1).trim(),!(!n||t[n]&&D4[n])&&("set-cookie"===n?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t})(t),n):null!=t&&i(n,t,r),this}get(t,n){if(t=El(t)){const r=Ne.findKey(this,t);if(r){const o=this[r];if(!n)return o;if(!0===n)return function R4(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}(o);if(Ne.isFunction(n))return n.call(this,o,r);if(Ne.isRegExp(n))return n.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=El(t)){const r=Ne.findKey(this,t);return!(!r||void 0===this[r]||n&&!y_(0,this[r],r,n))}return!1}delete(t,n){const r=this;let o=!1;function i(s){if(s=El(s)){const a=Ne.findKey(r,s);a&&(!n||y_(0,r[a],a,n))&&(delete r[a],o=!0)}}return Ne.isArray(t)?t.forEach(i):i(t),o}clear(t){const n=Object.keys(this);let r=n.length,o=!1;for(;r--;){const i=n[r];(!t||y_(0,this[i],i,t,!0))&&(delete this[i],o=!0)}return o}normalize(t){const n=this,r={};return Ne.forEach(this,(o,i)=>{const s=Ne.findKey(r,i);if(s)return n[s]=bh(o),void delete n[i];const a=t?function k4(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,r)=>n.toUpperCase()+r)}(i):String(i).trim();a!==i&&delete n[i],n[a]=bh(o),r[a]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return Ne.forEach(this,(r,o)=>{null!=r&&!1!==r&&(n[o]=t&&Ne.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const r=new this(t);return n.forEach(o=>r.set(o)),r}static accessor(t){const r=(this[uD]=this[uD]={accessors:{}}).accessors,o=this.prototype;function i(s){const a=El(s);r[a]||(function P4(e,t){const n=Ne.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(o,i,s){return this[r].call(this,t,o,i,s)},configurable:!0})})}(o,s),r[a]=!0)}return Ne.isArray(t)?t.forEach(i):i(t),this}}Ih.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Ne.reduceDescriptors(Ih.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(r){this[n]=r}}}),Ne.freezeMethods(Ih);const Yo=Ih;function v_(e,t){const n=this||__,r=t||n,o=Yo.from(r.headers);let i=r.data;return Ne.forEach(e,function(a){i=a.call(n,i,o.normalize(),t?t.status:void 0)}),o.normalize(),i}function dD(e){return!(!e||!e.__CANCEL__)}function hD(e,t,n){zt.call(this,e??"canceled",zt.ERR_CANCELED,t,n),this.name="CanceledError"}Ne.inherits(hD,zt,{__CANCEL__:!0});const Sh=hD,x4=Ao.hasStandardBrowserEnv?{write(e,t,n,r,o,i){const s=[e+"="+encodeURIComponent(t)];Ne.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),Ne.isString(r)&&s.push("path="+r),Ne.isString(o)&&s.push("domain="+o),!0===i&&s.push("secure"),document.cookie=s.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function fD(e,t){return e&&!function L4(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}(t)?function F4(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const U4=Ao.hasStandardBrowserEnv?function(){const t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");let r;function o(i){let s=i;return t&&(n.setAttribute("href",s),s=n.href),n.setAttribute("href",s),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return r=o(window.location.href),function(s){const a=Ne.isString(s)?o(s):s;return a.protocol===r.protocol&&a.host===r.host}}():function(){return!0};function pD(e,t){let n=0;const r=function j4(e,t){e=e||10;const n=new Array(e),r=new Array(e);let s,o=0,i=0;return t=void 0!==t?t:1e3,function(l){const h=Date.now(),f=r[i];s||(s=h),n[o]=l,r[o]=h;let v=i,x=0;for(;v!==o;)x+=n[v++],v%=e;if(o=(o+1)%e,o===i&&(i=(i+1)%e),h-s<t)return;const W=f&&h-f;return W?Math.round(1e3*x/W):void 0}}(50,250);return o=>{const i=o.loaded,s=o.lengthComputable?o.total:void 0,a=i-n,l=r(a);n=i;const f={loaded:i,total:s,progress:s?i/s:void 0,bytes:a,rate:l||void 0,estimated:l&&s&&i<=s?(s-i)/l:void 0,event:o};f[t?"download":"upload"]=!0,e(f)}}const C_={http:null,xhr:typeof XMLHttpRequest<"u"&&function(e){return new Promise(function(n,r){let o=e.data;const i=Yo.from(e.headers).normalize();let l,f,{responseType:s,withXSRFToken:a}=e;function h(){e.cancelToken&&e.cancelToken.unsubscribe(l),e.signal&&e.signal.removeEventListener("abort",l)}if(Ne.isFormData(o))if(Ao.hasStandardBrowserEnv||Ao.hasStandardBrowserWebWorkerEnv)i.setContentType(!1);else if(!1!==(f=i.getContentType())){const[ae,..._e]=f?f.split(";").map(Ae=>Ae.trim()).filter(Boolean):[];i.setContentType([ae||"multipart/form-data",..._e].join("; "))}let v=new XMLHttpRequest;if(e.auth){const ae=e.auth.username||"",_e=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";i.set("Authorization","Basic "+btoa(ae+":"+_e))}const x=fD(e.baseURL,e.url);function W(){if(!v)return;const ae=Yo.from("getAllResponseHeaders"in v&&v.getAllResponseHeaders());(function N4(e,t,n){const r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(new zt("Request failed with status code "+n.status,[zt.ERR_BAD_REQUEST,zt.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)})(function(Ue){n(Ue),h()},function(Ue){r(Ue),h()},{data:s&&"text"!==s&&"json"!==s?v.response:v.responseText,status:v.status,statusText:v.statusText,headers:ae,config:e,request:v}),v=null}if(v.open(e.method.toUpperCase(),iD(x,e.params,e.paramsSerializer),!0),v.timeout=e.timeout,"onloadend"in v?v.onloadend=W:v.onreadystatechange=function(){!v||4!==v.readyState||0===v.status&&(!v.responseURL||0!==v.responseURL.indexOf("file:"))||setTimeout(W)},v.onabort=function(){v&&(r(new zt("Request aborted",zt.ECONNABORTED,e,v)),v=null)},v.onerror=function(){r(new zt("Network Error",zt.ERR_NETWORK,e,v)),v=null},v.ontimeout=function(){let _e=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded";e.timeoutErrorMessage&&(_e=e.timeoutErrorMessage),r(new zt(_e,(e.transitional||aD).clarifyTimeoutError?zt.ETIMEDOUT:zt.ECONNABORTED,e,v)),v=null},Ao.hasStandardBrowserEnv&&(a&&Ne.isFunction(a)&&(a=a(e)),a||!1!==a&&U4(x))){const ae=e.xsrfHeaderName&&e.xsrfCookieName&&x4.read(e.xsrfCookieName);ae&&i.set(e.xsrfHeaderName,ae)}void 0===o&&i.setContentType(null),"setRequestHeader"in v&&Ne.forEach(i.toJSON(),function(_e,Ae){v.setRequestHeader(Ae,_e)}),Ne.isUndefined(e.withCredentials)||(v.withCredentials=!!e.withCredentials),s&&"json"!==s&&(v.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&v.addEventListener("progress",pD(e.onDownloadProgress,!0)),"function"==typeof e.onUploadProgress&&v.upload&&v.upload.addEventListener("progress",pD(e.onUploadProgress)),(e.cancelToken||e.signal)&&(l=ae=>{v&&(r(!ae||ae.type?new Sh(null,e,v):ae),v.abort(),v=null)},e.cancelToken&&e.cancelToken.subscribe(l),e.signal&&(e.signal.aborted?l():e.signal.addEventListener("abort",l)));const ne=function B4(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(x);ne&&-1===Ao.protocols.indexOf(ne)?r(new zt("Unsupported protocol "+ne+":",zt.ERR_BAD_REQUEST,e)):v.send(o||null)})}};Ne.forEach(C_,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const gD=e=>`- ${e}`,$4=e=>Ne.isFunction(e)||null===e||!1===e,mD_getAdapter=e=>{e=Ne.isArray(e)?e:[e];const{length:t}=e;let n,r;const o={};for(let i=0;i<t;i++){let s;if(n=e[i],r=n,!$4(n)&&(r=C_[(s=String(n)).toLowerCase()],void 0===r))throw new zt(`Unknown adapter '${s}'`);if(r)break;o[s||"#"+i]=r}if(!r){const i=Object.entries(o).map(([a,l])=>`adapter ${a} `+(!1===l?"is not supported by the environment":"is not available in the build"));let s=t?i.length>1?"since :\n"+i.map(gD).join("\n"):" "+gD(i[0]):"as no adapter specified";throw new zt("There is no suitable adapter to dispatch the request "+s,"ERR_NOT_SUPPORT")}return r};function E_(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Sh(null,e)}function _D(e){return E_(e),e.headers=Yo.from(e.headers),e.data=v_.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1),mD_getAdapter(e.adapter||__.adapter)(e).then(function(r){return E_(e),r.data=v_.call(e,e.transformResponse,r),r.headers=Yo.from(r.headers),r},function(r){return dD(r)||(E_(e),r&&r.response&&(r.response.data=v_.call(e,e.transformResponse,r.response),r.response.headers=Yo.from(r.response.headers))),Promise.reject(r)})}const yD=e=>e instanceof Yo?e.toJSON():e;function Aa(e,t){t=t||{};const n={};function r(h,f,v){return Ne.isPlainObject(h)&&Ne.isPlainObject(f)?Ne.merge.call({caseless:v},h,f):Ne.isPlainObject(f)?Ne.merge({},f):Ne.isArray(f)?f.slice():f}function o(h,f,v){return Ne.isUndefined(f)?Ne.isUndefined(h)?void 0:r(void 0,h,v):r(h,f,v)}function i(h,f){if(!Ne.isUndefined(f))return r(void 0,f)}function s(h,f){return Ne.isUndefined(f)?Ne.isUndefined(h)?void 0:r(void 0,h):r(void 0,f)}function a(h,f,v){return v in t?r(h,f):v in e?r(void 0,h):void 0}const l={url:i,method:i,data:i,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,withXSRFToken:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:a,headers:(h,f)=>o(yD(h),yD(f),!0)};return Ne.forEach(Object.keys(Object.assign({},e,t)),function(f){const v=l[f]||o,x=v(e[f],t[f],f);Ne.isUndefined(x)&&v!==a||(n[f]=x)}),n}const w_={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{w_[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const CD={};w_.transitional=function(t,n,r){function o(i,s){return"[Axios v1.6.2] Transitional option '"+i+"'"+s+(r?". "+r:"")}return(i,s,a)=>{if(!1===t)throw new zt(o(s," has been removed"+(n?" in "+n:"")),zt.ERR_DEPRECATED);return n&&!CD[s]&&(CD[s]=!0,console.warn(o(s," has been deprecated since v"+n+" and will be removed in the near future"))),!t||t(i,s,a)}};const b_={assertOptions:function V4(e,t,n){if("object"!=typeof e)throw new zt("options must be an object",zt.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let o=r.length;for(;o-- >0;){const i=r[o],s=t[i];if(s){const a=e[i],l=void 0===a||s(a,i,e);if(!0!==l)throw new zt("option "+i+" must be "+l,zt.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new zt("Unknown option "+i,zt.ERR_BAD_OPTION)}},validators:w_},Ii=b_.validators;class Th{constructor(t){this.defaults=t,this.interceptors={request:new sD,response:new sD}}request(t,n){"string"==typeof t?(n=n||{}).url=t:n=t||{},n=Aa(this.defaults,n);const{transitional:r,paramsSerializer:o,headers:i}=n;void 0!==r&&b_.assertOptions(r,{silentJSONParsing:Ii.transitional(Ii.boolean),forcedJSONParsing:Ii.transitional(Ii.boolean),clarifyTimeoutError:Ii.transitional(Ii.boolean)},!1),null!=o&&(Ne.isFunction(o)?n.paramsSerializer={serialize:o}:b_.assertOptions(o,{encode:Ii.function,serialize:Ii.function},!0)),n.method=(n.method||this.defaults.method||"get").toLowerCase();let s=i&&Ne.merge(i.common,i[n.method]);i&&Ne.forEach(["delete","get","head","post","put","patch","common"],ne=>{delete i[ne]}),n.headers=Yo.concat(s,i);const a=[];let l=!0;this.interceptors.request.forEach(function(ae){"function"==typeof ae.runWhen&&!1===ae.runWhen(n)||(l=l&&ae.synchronous,a.unshift(ae.fulfilled,ae.rejected))});const h=[];this.interceptors.response.forEach(function(ae){h.push(ae.fulfilled,ae.rejected)});let f,x,v=0;if(!l){const ne=[_D.bind(this),void 0];for(ne.unshift.apply(ne,a),ne.push.apply(ne,h),x=ne.length,f=Promise.resolve(n);v<x;)f=f.then(ne[v++],ne[v++]);return f}x=a.length;let W=n;for(v=0;v<x;){const ne=a[v++],ae=a[v++];try{W=ne(W)}catch(_e){ae.call(this,_e);break}}try{f=_D.call(this,W)}catch(ne){return Promise.reject(ne)}for(v=0,x=h.length;v<x;)f=f.then(h[v++],h[v++]);return f}getUri(t){return iD(fD((t=Aa(this.defaults,t)).baseURL,t.url),t.params,t.paramsSerializer)}}Ne.forEach(["delete","get","head","options"],function(t){Th.prototype[t]=function(n,r){return this.request(Aa(r||{},{method:t,url:n,data:(r||{}).data}))}}),Ne.forEach(["post","put","patch"],function(t){function n(r){return function(i,s,a){return this.request(Aa(a||{},{method:t,headers:r?{"Content-Type":"multipart/form-data"}:{},url:i,data:s}))}}Th.prototype[t]=n(),Th.prototype[t+"Form"]=n(!0)});const Ah=Th;class I_{constructor(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const r=this;this.promise.then(o=>{if(!r._listeners)return;let i=r._listeners.length;for(;i-- >0;)r._listeners[i](o);r._listeners=null}),this.promise.then=o=>{let i;const s=new Promise(a=>{r.subscribe(a),i=a}).then(o);return s.cancel=function(){r.unsubscribe(i)},s},t(function(i,s,a){r.reason||(r.reason=new Sh(i,s,a),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){this.reason?t(this.reason):this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);-1!==n&&this._listeners.splice(n,1)}static source(){let t;return{token:new I_(function(o){t=o}),cancel:t}}}const z4=I_,S_={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(S_).forEach(([e,t])=>{S_[t]=e});const K4=S_,yn=function ED(e){const t=new Ah(e),n=j0(Ah.prototype.request,t);return Ne.extend(n,Ah.prototype,t,{allOwnKeys:!0}),Ne.extend(n,t,null,{allOwnKeys:!0}),n.create=function(o){return ED(Aa(e,o))},n}(__);yn.Axios=Ah,yn.CanceledError=Sh,yn.CancelToken=z4,yn.isCancel=dD,yn.VERSION="1.6.2",yn.toFormData=wh,yn.AxiosError=zt,yn.Cancel=yn.CanceledError,yn.all=function(t){return Promise.all(t)},yn.spread=function G4(e){return function(n){return e.apply(null,n)}},yn.isAxiosError=function q4(e){return Ne.isObject(e)&&!0===e.isAxiosError},yn.mergeConfig=Aa,yn.AxiosHeaders=Yo,yn.formToJSON=e=>lD(Ne.isHTMLForm(e)?new FormData(e):e),yn.getAdapter=mD_getAdapter,yn.HttpStatusCode=K4,yn.default=yn;const Dh=yn;function Dn(e){return typeof e<"u"&&null!==e}function xr(e,t){if(!Dn(e)||"object"!=typeof e)return!1;for(const n of t)if(!W4(e,n))return!1;return!0}function W4(e,t){return Dn(e)&&"object"==typeof e&&t in e}const Da=new WeakMap,Mh=new WeakMap;class Rh{constructor(){this.onabort=null,Da.set(this,[]),Mh.set(this,!1)}get aborted(){if(!Mh.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");return Mh.get(this)}static get none(){return new Rh}addEventListener(t,n){if(!Da.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");Da.get(this).push(n)}removeEventListener(t,n){if(!Da.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");const r=Da.get(this),o=r.indexOf(n);o>-1&&r.splice(o,1)}dispatchEvent(t){throw new Error("This is a stub dispatchEvent implementation that should not be used.  It only exists for type-checking purposes.")}}function wD(e){if(e.aborted)return;e.onabort&&e.onabort.call(e);const t=Da.get(e);t&&t.slice().forEach(n=>{n.call(e,{type:"abort"})}),Mh.set(e,!0)}class sr extends Error{constructor(t){super(t),this.name="AbortError"}}class bD{constructor(t){if(this._signal=new Rh,t){Array.isArray(t)||(t=arguments);for(const n of t)n.aborted?this.abort():n.addEventListener("abort",()=>{this.abort()})}}get signal(){return this._signal}abort(){wD(this._signal)}static timeout(t){const n=new Rh,r=setTimeout(wD,t,n);return"function"==typeof r.unref&&r.unref(),n}}var je=S(4588);const we={associatedLinkName:"associated-link-name",partitionKey:"x-opt-partition-key",sequenceNumber:"x-opt-sequence-number",enqueueSequenceNumber:"x-opt-enqueue-sequence-number",enqueuedTime:"x-opt-enqueued-time",scheduledEnqueueTime:"x-opt-scheduled-enqueue-time",offset:"x-opt-offset",lockedUntil:"x-opt-locked-until",partitionIdName:"x-opt-partition-id",publisher:"x-opt-publisher-name",viaPartitionKey:"x-opt-via-partition-key",deadLetterSource:"x-opt-deadletter-source",messageState:"x-opt-message-state",enqueuedTimeAnnotation:"amqp.annotation.x-opt-enqueued-time",offsetAnnotation:"amqp.annotation.x-opt-offset",sequenceNumberAnnotation:"amqp.annotation.x-opt-sequence-number",guidSize:16,message:"message",error:"error",statusCode:"status-code",statusDescription:"status-description",errorCondition:"error-condition",management:"$management",partition:"partition",partitionId:"partitionId",readOperation:"READ",TLS:"tls",establishConnection:"establishConnection",defaultConsumerGroup:"$default",eventHub:"eventhub",cbsEndpoint:"$cbs",cbsReplyTo:"cbs",operationPutToken:"put-token",aadEventHubsAudience:"https://eventhubs.azure.net/",aadEventHubsScope:"https://eventhubs.azure.net//.default",aadServiceBusAudience:"https://servicebus.azure.net/",aadServiceBusScope:"https://servicebus.azure.net//.default",maxUserAgentLength:512,vendorString:"com.microsoft",attachEpoch:"com.microsoft:epoch",receiverIdentifierName:"com.microsoft:receiver-name",enableReceiverRuntimeMetricName:"com.microsoft:enable-receiver-runtime-metric",timespan:"com.microsoft:timespan",uri:"com.microsoft:uri",dateTimeOffset:"com.microsoft:datetime-offset",sessionFilterName:"com.microsoft:session-filter",receiverError:"receiver_error",senderError:"sender_error",sessionError:"session_error",connectionError:"connection_error",defaultOperationTimeoutInMs:6e4,defaultConnectionIdleTimeoutInMs:6e4,managementRequestKey:"managementRequest",negotiateCbsKey:"negotiateCbs",negotiateClaim:"negotiateClaim",ensureContainerAndBlob:"ensureContainerAndBlob",defaultPrefetchCount:1e3,reconnectLimit:100,maxMessageIdLength:128,maxPartitionKeyLength:128,maxSessionIdLength:128,pathDelimiter:"/",ruleNameMaximumLength:50,maximumSqlFilterStatementLength:1024,maximumSqlRuleActionStatementLength:1024,maxDeadLetterReasonLength:4096,maxDurationValue:922337203685477,minDurationValue:-922337203685477,maxAbsoluteExpiryTime:new Date("9999-12-31T07:59:59.000Z").getTime(),aadTokenValidityMarginInMs:5e3,connectionReconnectDelay:300,defaultMaxRetries:3,defaultMaxRetriesForConnection:150,defaultDelayBetweenOperationRetriesInMs:3e4,defaultMaxDelayForExponentialRetryInMs:9e4,receiverSettleMode:"receiver-settle-mode",dispositionStatus:"disposition-status",fromSequenceNumber:"from-sequence-number",messageCount:"message-count",lockTokens:"lock-tokens",messageIdMapKey:"message-id",sequenceNumberMapKey:"sequence-number",lockTokenMapKey:"lock-token",sessionIdMapKey:"session-id",sequenceNumbers:"sequence-numbers",deadLetterReason:"deadletter-reason",deadLetterDescription:"deadletter-description",propertiesToModify:"properties-to-modify",deadLetterName:"com.microsoft:dead-letter",trackingId:"com.microsoft:tracking-id",serverTimeout:"com.microsoft:server-timeout",operations:{putToken:"put-token",read:"READ",cancelScheduledMessage:"com.microsoft:cancel-scheduled-message",scheduleMessage:"com.microsoft:schedule-message",renewLock:"com.microsoft:renew-lock",peekMessage:"com.microsoft:peek-message",receiveBySequenceNumber:"com.microsoft:receive-by-sequence-number",updateDisposition:"com.microsoft:update-disposition",renewSessionLock:"com.microsoft:renew-session-lock",setSessionState:"com.microsoft:set-session-state",getSessionState:"com.microsoft:get-session-state",enumerateSessions:"com.microsoft:get-message-sessions",addRule:"com.microsoft:add-rule",removeRule:"com.microsoft:remove-rule",enumerateRules:"com.microsoft:enumerate-rules"},descriptorCodes:{ruleDescriptionList:1335734829060,sqlFilterList:83483426822,correlationFilterList:83483426825,sqlRuleActionList:1335734829062,trueFilterList:83483426823,falseFilterList:83483426824}},Do="The operation was aborted.",ID=typeof process<"u"&&process.env&&process.env.DEBUG||void 0;let SD,T_=[],A_=[];const Oh=[];ID&&D_(ID);const TD=Object.assign(e=>AD(e),{enable:D_,enabled:M_,disable:function Y4(){const e=SD||"";return D_(""),e},log:function Z4(...e){if(e.length>0){const t=String(e[0]);t.includes(":error")?console.error(...e):t.includes(":warning")?console.warn(...e):t.includes(":info")?console.info(...e):(t.includes(":verbose"),console.debug(...e))}}});function D_(e){SD=e,T_=[],A_=[];const t=/\*/g,n=e.split(",").map(r=>r.trim().replace(t,".*?"));for(const r of n)r.startsWith("-")?A_.push(new RegExp(`^${r.substr(1)}$`)):T_.push(new RegExp(`^${r}$`));for(const r of Oh)r.enabled=M_(r.namespace)}function M_(e){if(e.endsWith("*"))return!0;for(const t of A_)if(t.test(e))return!1;for(const t of T_)if(t.test(e))return!0;return!1}function AD(e){const t=Object.assign(function n(...r){t.enabled&&(r.length>0&&(r[0]=`${e} ${r[0]}`),t.log(...r))},{enabled:M_(e),destroy:Q4,log:TD.log,namespace:e,extend:J4});return Oh.push(t),t}function Q4(){const e=Oh.indexOf(this);return e>=0&&(Oh.splice(e,1),!0)}function J4(e){const t=AD(`${this.namespace}:${e}`);return t.log=this.log,t}const wl=TD,DD=new Set,kh=typeof process<"u"&&process.env&&process.env.AZURE_LOG_LEVEL||void 0;let Ph;const R_=wl("azure");R_.log=(...e)=>{wl.log(...e)};const O_=["verbose","info","warning","error"];kh&&(PD(kh)?function X4(e){if(e&&!PD(e))throw new Error(`Unknown log level '${e}'. Acceptable values: ${O_.join(",")}`);Ph=e;const t=[];for(const n of DD)kD(n)&&t.push(n.namespace);wl.enable(t.join(","))}(kh):console.error(`AZURE_LOG_LEVEL set to unknown log level '${kh}'; logging is not enabled. Acceptable values: ${O_.join(", ")}.`));const MD={verbose:400,info:300,warning:200,error:100};function RD(e){const t=R_.extend(e);return OD(R_,t),{error:Nh(t,"error"),warning:Nh(t,"warning"),info:Nh(t,"info"),verbose:Nh(t,"verbose")}}function OD(e,t){t.log=(...n)=>{e.log(...n)}}function Nh(e,t){const n=Object.assign(e.extend(t),{level:t});if(OD(e,n),kD(n)){const r=wl.disable();wl.enable(r+","+n.namespace)}return DD.add(n),n}function kD(e){return!!(Ph&&MD[e.level]<=MD[Ph])}function PD(e){return O_.includes(e)}const It=RD("core-amqp");function k_(e){xr(e,["stack"])&&It.verbose(e.stack)}function ND(e){e.tid&&clearTimeout(e.tid),e.abortSignal&&e.abortListener&&e.abortSignal.removeEventListener("abort",e.abortListener)}const r8="The delay was aborted.";function bl(e,t){let n;const{abortSignal:r,abortErrorMsg:o}=t??{};return function n8(e,t){const{cleanupBeforeAbort:n,abortSignal:r,abortErrorMsg:o}=t??{};return new Promise((i,s)=>{function a(){s(new sr(o??"The operation was aborted."))}function l(){r?.removeEventListener("abort",h)}function h(){n?.(),l(),a()}if(r?.aborted)return a();try{e(f=>{l(),i(f)},f=>{l(),s(f)})}catch(f){s(f)}r?.addEventListener("abort",h)})}(i=>{n=setTimeout(i,e)},{cleanupBeforeAbort:()=>clearTimeout(n),abortSignal:r,abortErrorMsg:o??r8})}var P_;const xD=typeof process<"u"&&!!process.version&&!(null===(P_=process.versions)||void 0===P_||!P_.node);function N_(e){const t={},n=e.trim().split(";");for(let r of n){if(r=r.trim(),""===r)continue;const o=r.indexOf("=");if(-1===o)throw new Error("Connection string malformed: each part of the connection string must have an `=` assignment.");const i=r.substring(0,o).trim();if(""===i)throw new Error("Connection string malformed: missing key for assignment");const s=r.substring(o+1).trim();t[i]=s}return t}const Ma=new class e8{constructor(){this._keyMap=new Map,this._executionRunningSet=new Set}acquire(t,n,r){var o;const{abortSignal:i,timeoutInMs:s}=r;if(i?.aborted)return Promise.reject(new sr(Do));const a=null!==(o=this._keyMap.get(t))&&void 0!==o?o:[];this._keyMap.set(t,a);const{promise:l,rejecter:h,resolver:f}=function t8(){let e,t;return{promise:new Promise((r,o)=>{e=r,t=o}),resolver:e,rejecter:t}}(),v={reject:h,resolve:f,task:n};if("number"==typeof s){const x=setTimeout(()=>{this._removeTaskDetails(t,v),h(new je.S$(`The task timed out waiting to acquire a lock for ${t}`))},s);v.tid=x}if(i){const x=()=>{this._removeTaskDetails(t,v),h(new sr(Do))};i.addEventListener("abort",x),v.abortSignal=i,v.abortListener=x}return a.push(v),It.verbose(`Called acquire() for lock "${t}". Lock "${t}" has ${a.length} pending tasks.`),this._execute(t),l}_execute(t){var n=this;return(0,ge.Z)(function*(){if(n._executionRunningSet.has(t))return;const r=n._keyMap.get(t);if(r&&r.length){for(n._executionRunningSet.add(t);r.length;){const o=r.shift();if(o){try{It.verbose(`Acquired lock for "${t}", invoking task.`),ND(o);const i=yield o.task();o.resolve(i)}catch(i){o.reject(i)}It.verbose(`Task completed for lock "${t}". Lock "${t}" has ${r.length} pending tasks.`)}}n._executionRunningSet.delete(t),n._keyMap.delete(t)}})()}_removeTaskDetails(t,n){const r=this._keyMap.get(t);if(!r||!r.length)return;const o=r.indexOf(n);if(-1!==o){const[i]=r.splice(o,1);ND(i)}}};function L_(){return L_=(0,ge.Z)(function*(e,t,n,r){if(yield bl(e,{abortSignal:t,abortErrorMsg:n}),void 0!==r)return r}),L_.apply(this,arguments)}function F_(e){return"string"==typeof e}const LD={create(e,t){const n=N_(e=String(e));if(!n.Endpoint)throw new TypeError("Missing Endpoint in Connection String.");n.Endpoint.endsWith("/")||(n.Endpoint+="/");const r={connectionString:e,endpoint:n.Endpoint,host:n&&n.Endpoint?(n.Endpoint.match(".*://([^/]*)")||[])[1]:"",sharedAccessKeyName:n.SharedAccessKeyName,sharedAccessKey:n.SharedAccessKey};return(t||n.EntityPath)&&(r.entityPath=t||n.EntityPath),r},validate(e,t){if(t||(t={}),!e)throw new TypeError("Missing configuration");if(!e.endpoint)throw new TypeError("Missing 'endpoint' in configuration");if(e.endpoint=String(e.endpoint),!e.host)throw new TypeError("Missing 'host' in configuration");if(e.host=String(e.host),t.isEntityPathRequired&&!e.entityPath)throw new TypeError("Missing 'entityPath' in configuration");if(Dn(e.entityPath)&&(e.entityPath=String(e.entityPath)),!function s8(e){return null!=e.match(/;{0,1}SharedAccessSignature=SharedAccessSignature /)}(e.connectionString)){if(!e.sharedAccessKeyName)throw new TypeError("Missing 'sharedAccessKeyName' in configuration");if(e.sharedAccessKeyName=String(e.sharedAccessKeyName),!e.sharedAccessKey)throw new TypeError("Missing 'sharedAccessKey' in configuration");e.sharedAccessKey=String(e.sharedAccessKey)}}};function xh(e){return xr(e,["name","key"])&&"string"==typeof e.key&&"string"==typeof e.name}function U_(e){return xr(e,["signature"])&&"string"==typeof e.signature}function B_(){return B_=(0,ge.Z)(function*(e,t){const n=new TextEncoder,r={name:"HMAC",hash:{name:"SHA-256"}},o=yield globalThis.crypto.subtle.importKey("raw",n.encode(e),r,!1,["sign","verify"]),i=yield globalThis.crypto.subtle.sign(r,o,n.encode(t)),s=btoa(String.fromCharCode(...new Uint8Array(i)));return encodeURIComponent(s)}),B_.apply(this,arguments)}function FD(e){return xh(e)||U_(e)?new j_(e):new j_("sharedAccessKeyName"in e&&"sharedAccessKey"in e?{name:e.sharedAccessKeyName,key:e.sharedAccessKey}:{signature:e.sharedAccessSignature})}class j_{get isSasTokenProvider(){return!0}constructor(t){this._credential=t}getToken(t){var n=this;return(0,ge.Z)(function*(){return xh(n._credential)?function c8(e,t,n,r){return H_.apply(this,arguments)}(n._credential.name,n._credential.key,Math.floor(Date.now()/1e3)+3600,t):{token:n._credential.signature,expiresOnTimestamp:0}})()}}function H_(){return H_=(0,ge.Z)(function*(e,t,n,r){r=encodeURIComponent(r),e=encodeURIComponent(e);const o=r+"\n"+n,i=yield function a8(e,t){return B_.apply(this,arguments)}(t,o);return{token:`SharedAccessSignature sr=${r}&sig=${i}&se=${n}&skn=${e}`,expiresOnTimestamp:n}}),H_.apply(this,arguments)}const ar=Si("service-bus"),Ie=Si("service-bus:receiver"),Ut=Si("service-bus:sender"),l8=Si("service-bus:rulemanager"),Dt=Si("service-bus:connection"),Il=(Si("service-bus:administration"),Si("service-bus:messages")),mn=Si("service-bus:management");function Si(e){const t=RD(e);return t.logError=(n,...r)=>{let o;o=function d8(e){return null!=e&&null!=e.name}(n)&&"AbortError"===n.name?t.info:t.warning,r.push(":",n),o(...r),n&&n.stack&&t.verbose(n.stack)},t}const h8=Math.pow(2,31)-1;function BD(){return typeof self>"u"?"":self.navigator.appVersion}function Ra(e){return!!function g8(e){return!("object"!=typeof e||null===e||Array.isArray(e)||e instanceof RegExp||e instanceof Date)}(e)&&("string"==typeof e.name&&"string"==typeof e.message)}var jD=function(e){return e[e["com.microsoft:timeout"]=408]="com.microsoft:timeout",e[e["amqp:not-found"]=404]="amqp:not-found",e[e["amqp:not-implemented"]=501]="amqp:not-implemented",e[e["com.microsoft:entity-already-exists"]=409]="com.microsoft:entity-already-exists",e[e["com.microsoft:message-lock-lost"]=410]="com.microsoft:message-lock-lost",e[e["com.microsoft:session-lock-lost"]=410]="com.microsoft:session-lock-lost",e[e["com.microsoft:no-matching-subscription"]=500]="com.microsoft:no-matching-subscription",e[e["amqp:link:message-size-exceeded"]=403]="amqp:link:message-size-exceeded",e[e["com.microsoft:server-busy"]=503]="com.microsoft:server-busy",e[e["com.microsoft:argument-error"]=400]="com.microsoft:argument-error",e[e["com.microsoft:argument-out-of-range"]=400]="com.microsoft:argument-out-of-range",e[e["com.microsoft:store-lock-lost"]=410]="com.microsoft:store-lock-lost",e[e["com.microsoft:session-cannot-be-locked"]=410]="com.microsoft:session-cannot-be-locked",e[e["com.microsoft:partition-not-owned"]=410]="com.microsoft:partition-not-owned",e[e["com.microsoft:entity-disabled"]=400]="com.microsoft:entity-disabled",e[e["com.microsoft:publisher-revoked"]=401]="com.microsoft:publisher-revoked",e[e["amqp:link:stolen"]=410]="amqp:link:stolen",e[e["amqp:not-allowed"]=400]="amqp:not-allowed",e[e["amqp:unauthorized-access"]=401]="amqp:unauthorized-access",e[e["amqp:resource-limit-exceeded"]=403]="amqp:resource-limit-exceeded",e}(jD||{}),Oa=function(e){return e["com.microsoft:address-already-in-use"]="AddressAlreadyInUseError",e["com.microsoft:store-lock-lost"]="StoreLockLostError",e["com.microsoft:no-matching-subscription"]="NoMatchingSubscriptionError",e["com.microsoft:partition-not-owned"]="PartitionNotOwnedError",e["com.microsoft:publisher-revoked"]="PublisherRevokedError",e["com.microsoft:entity-already-exists"]="MessagingEntityAlreadyExistsError",e["com.microsoft:entity-disabled"]="MessagingEntityDisabledError",e["com.microsoft:message-lock-lost"]="MessageLockLostError",e["com.microsoft:session-lock-lost"]="SessionLockLostError",e["com.microsoft:session-cannot-be-locked"]="SessionCannotBeLockedError",e["amqp:internal-error"]="InternalServerError",e["amqp:not-found"]="ServiceCommunicationError",e["com.microsoft:message-not-found"]="MessageNotFoundError",e["com.microsoft:relay-not-found"]="RelayNotFoundError",e["amqp:not-implemented"]="NotImplementedError",e["amqp:not-allowed"]="InvalidOperationError",e["amqp:resource-limit-exceeded"]="QuotaExceededError",e["amqp:unauthorized-access"]="UnauthorizedError",e["com.microsoft:auth-failed"]="UnauthorizedError",e["com.microsoft:timeout"]="ServiceUnavailableError",e["com.microsoft:message-wait-timeout"]="MessageWaitTimeout",e["com.microsoft:argument-out-of-range"]="ArgumentOutOfRangeError",e["amqp:precondition-failed"]="PreconditionFailedError",e["com.microsoft:precondition-failed"]="PreconditionFailedError",e["amqp:decode-error"]="DecodeError",e["amqp:invalid-field"]="InvalidFieldError",e["amqp:resource-locked"]="ResourceLockedError",e["amqp:resource-deleted"]="ResourceDeletedError",e["amqp:illegal-state"]="IllegalStateError",e["amqp:frame-size-too-small"]="FrameSizeTooSmallError",e["amqp:link:detach-forced"]="DetachForcedError",e["amqp:link:transfer-limit-exceeded"]="TransferLimitExceededError",e["amqp:link:message-size-exceeded"]="MessageTooLargeError",e["amqp:link:redirect"]="LinkRedirectError",e["amqp:link:stolen"]="ReceiverDisconnectedError",e["amqp:session:window-violation"]="SessionWindowViolationError",e["amqp:session:errant-link"]="ErrantLinkError",e["amqp:session:handle-in-use"]="HandleInUseError",e["amqp:session:unattached-handle"]="UnattachedHandleError",e["amqp:connection:forced"]="ConnectionForcedError",e["amqp:connection:framing-error"]="FramingError",e["amqp:connection:redirect"]="ConnectionRedirectError",e["com.microsoft:server-busy"]="ServerBusyError",e["com.microsoft:argument-error"]="ArgumentError",e["com.microsoft:operation-cancelled"]="OperationCancelledError",e["client.sender:not-enough-link-credit"]="SenderBusyError",e["client.sender:link-not-ready"]="SenderNotReadyError",e["system:error"]="SystemError",e}(Oa||{}),Mo=function(e){return e.AddressAlreadyInUseError="com.microsoft:address-already-in-use",e.StoreLockLostError="com.microsoft:store-lock-lost",e.NoMatchingSubscriptionError="com.microsoft:no-matching-subscription",e.PartitionNotOwnedError="com.microsoft:partition-not-owned",e.PublisherRevokedError="com.microsoft:publisher-revoked",e.MessagingEntityAlreadyExistsError="com.microsoft:entity-already-exists",e.MessagingEntityDisabledError="com.microsoft:entity-disabled",e.MessageLockLostError="com.microsoft:message-lock-lost",e.SessionLockLostError="com.microsoft:session-lock-lost",e.SessionCannotBeLockedError="com.microsoft:session-cannot-be-locked",e.InternalServerError="amqp:internal-error",e.ServiceCommunicationError="amqp:not-found",e.MessageNotFoundError="com.microsoft:message-not-found",e.RelayNotFoundError="com.microsoft:relay-not-found",e.NotImplementedError="amqp:not-implemented",e.InvalidOperationError="amqp:not-allowed",e.QuotaExceededError="amqp:resource-limit-exceeded",e.UnauthorizedError="amqp:unauthorized-access",e.ServiceUnavailableError="com.microsoft:timeout",e.MessageWaitTimeout="com.microsoft:message-wait-timeout",e.ArgumentOutOfRangeError="com.microsoft:argument-out-of-range",e.PreconditionFailedError="amqp:precondition-failed",e.DecodeError="amqp:decode-error",e.InvalidFieldError="amqp:invalid-field",e.ResourceLockedError="amqp:resource-locked",e.ResourceDeletedError="amqp:resource-deleted",e.IllegalStateError="amqp:illegal-state",e.FrameSizeTooSmallError="amqp:frame-size-too-small",e.DetachForcedError="amqp:link:detach-forced",e.TransferLimitExceededError="amqp:link:transfer-limit-exceeded",e.MessageTooLargeError="amqp:link:message-size-exceeded",e.LinkRedirectError="amqp:link:redirect",e.ReceiverDisconnectedError="amqp:link:stolen",e.SessionWindowViolationError="amqp:session:window-violation",e.ErrantLinkError="amqp:session:errant-link",e.HandleInUseError="amqp:session:handle-in-use",e.UnattachedHandleError="amqp:session:unattached-handle",e.ConnectionForcedError="amqp:connection:forced",e.FramingError="amqp:connection:framing-error",e.ConnectionRedirectError="amqp:connection:redirect",e.ServerBusyError="com.microsoft:server-busy",e.ArgumentError="com.microsoft:argument-error",e.OperationCancelledError="com.microsoft:operation-cancelled",e.SenderBusyError="client.sender:not-enough-link-credit",e.SenderNotReadyError="client.sender:link-not-ready",e.SystemError="system:error",e}(Mo||{});const m8=["address","code","errno","info","port","stack","syscall"];class Sl extends Error{constructor(t,n){if(super(t),this.name="MessagingError",this.retryable=!0,n)for(const r of m8)null!=n[r]&&(this[r]=n[r])}}const $_=["InternalServerError","ServerBusyError","ServiceUnavailableError","OperationCancelledError","UnauthorizedError","OperationTimeoutError","SenderBusyError","SenderNotReadyError","MessagingError","DetachForcedError","ConnectionForcedError","TransferLimitExceededError","InsufficientCreditError"];var HD=function(e){return e.ENOTFOUND="amqp:not-found",e.EBUSY="com.microsoft:server-busy",e.ECONNREFUSED="amqp:connection:forced",e.ETIMEDOUT="com.microsoft:timeout",e.ECONNRESET="com.microsoft:timeout",e.ENETDOWN="com.microsoft:timeout",e.EHOSTDOWN="com.microsoft:timeout",e.ENETRESET="com.microsoft:timeout",e.ENETUNREACH="com.microsoft:timeout",e.ENONET="com.microsoft:timeout",e}(HD||{});const C8=["OperationTimeoutError","InsufficientCreditError","SendOperationFailedError"];function Ti(e){if(!Dn(e))return new Error("Unknown error encountered.");if("object"!=typeof e)return new Error(String(e));if(e instanceof TypeError||e instanceof RangeError)return e;if(function E8(e){return(0,je.Zm)(e)}(e)){const t=e.condition,n=e.description,r=new Sl(n);return e.stack&&(r.stack=e.stack),r.info=e.info,t&&(r.code=Oa[t]),n&&(n.includes("status-code: 404")||null!==n.match(/The messaging entity .* could not be found.*/i))&&(r.code="MessagingEntityNotFoundError"),r.code&&-1===$_.indexOf(r.code)&&(r.retryable=!1),r}if(e instanceof Error&&"MessagingError"===e.name)return e;if(function y8(e){return!(!xr(e,["code","syscall","errno"])||!F_(e.code)||!F_(e.syscall)||!F_(e.errno)&&!function i8(e){return"number"==typeof e}(e.errno))}(e)){const t=e.code,r=new Sl(e.message,e);let o="SystemError";return t&&(o=Oa[HD[t]]),-1===$_.indexOf(o)&&(r.retryable=!1),r}if(function v8(e){let t=!1;return!xD&&self&&"error"===e.type&&e.target instanceof self.WebSocket&&(t=!0),t}(e)){const t=new Sl("Websocket connection failed.");return t.code=Oa[Mo.ServiceCommunicationError],t.retryable=!1,t}if(Ra(e)&&-1!==C8.indexOf(e.name)){const t=new Sl(e.message,e);return t.code=e.name,t.code&&-1===$_.indexOf(t.code)&&(t.retryable=!1),t}return Ra(e)?e:new Error(String(e))}class Fh{constructor(t,n,r){this.session=t,this.sender=n,this.receiver=r,this._responsesMap=new Map,this.session=t,this.sender=n,this.receiver=r,this.receiver.on(je.cz.message,o=>{!function b8(e,t,n){const r=e.message;if(!r)return void It.verbose(`[${t}] "message" property on the EventContext is "undefined" which is unexpected, returning from the "onMessageReceived" handler without resolving or rejecting the promise upon encountering the message event.`);const o=r.correlation_id;if(!n.has(o))return void It.verbose(`[${t}] correlationId "${o}" property on the response does not match with any of the "request-id"s in the map, returning from the "onMessageReceived" handler without resolving or rejecting the promise upon encountering the message event.`);const i=n.get(o);i.cleanupBeforeResolveOrReject();const s=n.delete(o);It.verbose(`[${t}] Successfully deleted the response with id ${o} from the map. Delete result - ${s}`);const a=w8(r.application_properties);let l;a.statusCode||(l=new Error(`[${t}] No statusCode in the "application_properties" in the returned response with correlation-id: ${o}`)),a.statusCode>199&&a.statusCode<300?(It.verbose(`[${t}] Resolving the response with correlation-id: ${o}`),i.resolve(r)):(l||(l=Ti({condition:a.errorCondition||jD[a.statusCode]||"amqp:internal-error",description:a.statusDescription}),It.warning(`${l?.name}: ${l?.message}`)),k_(l),i.reject(l))}(o,this.connection.id,this._responsesMap)}),this.sender.on(je.KO.senderError,o=>{!function I8(e,t,n){if(e.sender){for(const[r,o]of n.entries())It.verbose(`[${t}] Sender closed due to error when sending request with message_id "${r}"`),o.cleanupBeforeResolveOrReject(),o.reject(e.sender.error);n.clear()}}(o,this.connection.id,this._responsesMap)})}get connection(){return this.session.connection}isOpen(){return this.session.isOpen()&&this.sender.isOpen()&&this.receiver.isOpen()}sendRequest(t,n={}){const r=n.timeoutInMs||we.defaultOperationTimeoutInMs,o=n.abortSignal;return t.message_id||(t.message_id=(0,je.kE)()),new Promise((i,s)=>{let a;const l=()=>{this._responsesMap.delete(t.message_id),It.info(`[${this.connection.id}] The request "${n.requestName}" to "${this.receiver.address||"address"}" has been cancelled by the user.`);const W=new sr(Do);s(W)},h=()=>{Dn(a)&&clearTimeout(a),o.removeEventListener("abort",h),l()};if(o){if(o.aborted)return l();o.addEventListener("abort",h)}a=setTimeout(()=>{var f;this._responsesMap.delete(t.message_id),o&&o.removeEventListener("abort",h);const v=(null===(f=this.receiver)||void 0===f?void 0:f.address)||"address";return s(Ti({name:"OperationTimeoutError",message:`The request with message_id "${t.message_id}" to "${v}" endpoint timed out. Please try again later.`}))},r),this._responsesMap.set(t.message_id,{resolve:i,reject:s,cleanupBeforeResolveOrReject:()=>{o&&o.removeEventListener("abort",h),Dn(a)&&clearTimeout(a)}}),It.verbose("[%s] %s request sent: %O",this.connection.id,t.to||"$management",t),this.sender.send(t)})}close(){var t=this;return(0,ge.Z)(function*(){yield t.sender.close({closeSession:!1}),yield t.receiver.close({closeSession:!1}),yield t.session.close()})()}remove(){this.sender.remove(),this.receiver.remove(),this.session.remove()}static create(t,n,r,o={}){return(0,ge.Z)(function*(){const{abortSignal:i}=o,s=yield t.createSession({abortSignal:i}),a=yield s.createSender(Object.assign(Object.assign({},n),{abortSignal:i})),l=yield s.createReceiver(Object.assign(Object.assign({},r),{abortSignal:i}));return It.verbose("[%s] Successfully created the sender and receiver links on the same session.",t.id),new Fh(s,a,l)})()}}const w8=(e={})=>({statusCode:e[we.statusCode]||e.statusCode,statusDescription:e[we.statusDescription]||e.statusDescription,errorCondition:e[we.errorCondition]||e.errorCondition});class $D{constructor(t,n){this.endpoint=we.cbsEndpoint,this.replyTo=`${we.cbsReplyTo}-${(0,je.kE)()}`,this.cbsLock=`${we.negotiateCbsKey}-${(0,je.kE)()}`,this.connection=t,this.connectionLock=n}init(t={}){var n=this;return(0,ge.Z)(function*(){const{abortSignal:r,timeoutInMs:o}=t;try{if(r?.aborted)throw new sr(Do);if(n.connection.isOpen()||(It.verbose("The CBS client is trying to establish an AMQP connection."),yield Ma.acquire(n.connectionLock,()=>n.connection.open({abortSignal:r}),{abortSignal:r,timeoutInMs:o})),n.isOpen())It.verbose("[%s] CBS session is already present. Reusing the cbs sender '%s' and receiver '%s' links over cbs session.",n.connection.id,n._cbsSenderReceiverLink.sender.name,n._cbsSenderReceiverLink.receiver.name);else{const i={source:{address:n.endpoint},name:n.replyTo,onSessionError:a=>{const l=a.connection.options.id,h=Ti(a.session.error);It.verbose("[%s] An error occurred on the session for request/response links for $cbs: %O",l,h)}},s={target:{address:n.endpoint}};It.verbose("[%s] Creating sender/receiver links on a session for $cbs endpoint.",n.connection.id),n._cbsSenderReceiverLink=yield Fh.create(n.connection,s,i,{abortSignal:r}),n._cbsSenderReceiverLink.sender.on(je.KO.senderError,a=>{const l=a.connection.options.id,h=Ti(a.sender.error);It.verbose("[%s] An error occurred on the cbs sender link.. %O",l,h)}),n._cbsSenderReceiverLink.receiver.on(je.cz.receiverError,a=>{const l=a.connection.options.id,h=Ti(a.receiver.error);It.verbose("[%s] An error occurred on the cbs receiver link.. %O",l,h)}),It.verbose("[%s] Successfully created the cbs sender '%s' and receiver '%s' links over cbs session.",n.connection.id,n._cbsSenderReceiverLink.sender.name,n._cbsSenderReceiverLink.receiver.name)}}catch(i){const s=Ti(i);throw It.warning("[%s] An error occurred while establishing the cbs links: %s",n.connection.id,`${s?.name}: ${s?.message}`),k_(s),s}})()}negotiateClaim(t,n,r,o={}){var i=this;return(0,ge.Z)(function*(){const{abortSignal:s,timeoutInMs:a}=o;try{if(s?.aborted)throw new sr(Do);if(!i._cbsSenderReceiverLink)throw new Error("Attempted to negotiate a claim but the CBS link does not exist.");const l={body:n,message_id:(0,je.kE)(),reply_to:i.replyTo,to:i.endpoint,application_properties:{operation:we.operationPutToken,name:t,type:r}},h=yield i._cbsSenderReceiverLink.sendRequest(l,{abortSignal:s,timeoutInMs:a,requestName:"negotiateClaim"});return It.verbose("[%s] The CBS response is: %O",i.connection.id,h),i._fromRheaMessageResponse(h)}catch(l){throw It.warning("[%s] An error occurred while negotiating the cbs claim: %s",i.connection.id,Ra(l)?`${l.name}: ${l.message}`:String(l)),k_(l),l}})()}close(){var t=this;return(0,ge.Z)(function*(){try{if(t.isOpen()){const n=t._cbsSenderReceiverLink;t._cbsSenderReceiverLink=void 0,yield n.close(),It.verbose("[%s] Successfully closed the cbs session.",t.connection.id)}}catch(n){const r=`An error occurred while closing the cbs link: ${Ra(n)&&n.stack?n.stack:JSON.stringify(n)}.`;throw It.verbose("[%s] %s",t.connection.id,r),new Error(r)}})()}remove(){try{if(this._cbsSenderReceiverLink){const t=this._cbsSenderReceiverLink;this._cbsSenderReceiverLink=void 0,t.remove(),It.verbose("[%s] Successfully removed the cbs session.",this.connection.id)}}catch(t){const n=`An error occurred while removing the cbs link: ${Ra(t)&&t.stack?t.stack:JSON.stringify(t)}.`;throw It.verbose("[%s] %s",this.connection.id,n),new Error(n)}}isOpen(){var t;return!(null===(t=this._cbsSenderReceiverLink)||void 0===t||!t.isOpen())}_fromRheaMessageResponse(t){const n={correlationId:t.correlation_id,statusCode:t.application_properties?t.application_properties["status-code"]:"",statusDescription:t.application_properties?t.application_properties["status-description"]:""};return It.verbose("[%s] The deserialized CBS response is: %o",this.connection.id,n),n}}class VD extends je.ew{createSender(t){var n=()=>super.createSender,r=this;return(0,ge.Z)(function*(){const o=yield n().call(r,t);return o.setMaxListeners(1e3),o})()}createAwaitableSender(t){var n=()=>super.createAwaitableSender,r=this;return(0,ge.Z)(function*(){const o=yield n().call(r,t);return o.setMaxListeners(1e3),o})()}createReceiver(t){var n=()=>super.createReceiver,r=this;return(0,ge.Z)(function*(){const o=yield n().call(r,t);return o.setMaxListeners(1e3),o})()}}const S8={create(e){var t,n,r;LD.validate(e.config,{isEntityPathRequired:e.isEntityPathRequired||!1});const o=e.connectionProperties.userAgent;if(o.length>we.maxUserAgentLength)throw new Error(`The user-agent string cannot be more than ${we.maxUserAgentLength} characters in length.The given user-agent string is: ${o} with length: ${o.length}`);const i={transport:we.TLS,host:e.config.host,hostname:null!==(t=e.config.amqpHostname)&&void 0!==t?t:e.config.host,username:e.config.sharedAccessKeyName,port:null!==(n=e.config.port)&&void 0!==n?n:5671,reconnect:!1,properties:{product:e.connectionProperties.product,version:e.connectionProperties.version,"user-agent":o,platform:`(javascript-Browser-${BD()})`,framework:`Browser/${BD()}`},idle_time_out:we.defaultConnectionIdleTimeoutInMs,operationTimeoutInSeconds:e.operationTimeoutInMs?e.operationTimeoutInMs/1e3:void 0};if(e.config.webSocket||!xD&&typeof self<"u"&&self.WebSocket){const h=e.config.webSocket||self.WebSocket,W=null!==(r=e.config.port)&&void 0!==r?r:443;i.webSocketOptions={webSocket:h,url:`wss://${e.config.host}:${W}/${e.config.webSocketEndpointPath||""}`,protocol:["AMQPWSB10"],options:e.config.webSocketConstructorOptions||{}}}const s=new VD(i),a=`${we.establishConnection}-${(0,je.kE)()}`;return{wasConnectionCloseCalled:!1,connectionLock:a,negotiateClaimLock:`${we.negotiateClaim}-${(0,je.kE)()}`,connection:s,connectionId:s.id,cbsSession:new $D(s,a),config:e.config,refreshConnection(){const h=new VD(i),f=`${we.establishConnection}-${(0,je.kE)()}`;this.wasConnectionCloseCalled=!1,this.connectionLock=f,this.negotiateClaimLock=`${we.negotiateClaim} - ${(0,je.kE)()}`,this.connection=h,this.connectionId=h.id,this.cbsSession=new $D(h,f)}}}};var Vr=null;try{Vr=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function en(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function Vn(e){return!0===(e&&e.__isLong__)}function zD(e){var t=Math.clz32(e&-e);return e?31-t:t}Object.defineProperty(en.prototype,"__isLong__",{value:!0}),en.isLong=Vn;var GD={},qD={};function as(e,t){var n,r,o;return t?(o=0<=(e>>>=0)&&e<256)&&(r=qD[e])?r:(n=Nt(e,0,!0),o&&(qD[e]=n),n):(o=-128<=(e|=0)&&e<128)&&(r=GD[e])?r:(n=Nt(e,e<0?-1:0,!1),o&&(GD[e]=n),n)}function zr(e,t){if(isNaN(e))return t?Qo:ao;if(t){if(e<0)return Qo;if(e>=WD)return XD}else{if(e<=-ZD)return wr;if(e+1>=ZD)return JD}return e<0?zr(-e,t).neg():Nt(e%ka|0,e/ka|0,t)}function Nt(e,t,n){return new en(e,t,n)}en.fromInt=as,en.fromNumber=zr,en.fromBits=Nt;var Uh=Math.pow;function z_(e,t,n){if(0===e.length)throw Error("empty string");if("number"==typeof t?(n=t,t=!1):t=!!t,"NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return t?Qo:ao;if((n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return z_(e.substring(1),t,n).neg();for(var o=zr(Uh(n,8)),i=ao,s=0;s<e.length;s+=8){var a=Math.min(8,e.length-s),l=parseInt(e.substring(s,s+a),n);if(a<8){var h=zr(Uh(n,a));i=i.mul(h).add(zr(l))}else i=(i=i.mul(o)).add(zr(l))}return i.unsigned=t,i}function so(e,t){return"number"==typeof e?zr(e,t):"string"==typeof e?z_(e,t):Nt(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}en.fromString=z_,en.fromValue=so;var ka=4294967296,WD=ka*ka,ZD=WD/2,YD=as(1<<24),ao=as(0);en.ZERO=ao;var Qo=as(0,!0);en.UZERO=Qo;var Pa=as(1);en.ONE=Pa;var QD=as(1,!0);en.UONE=QD;var G_=as(-1);en.NEG_ONE=G_;var JD=Nt(-1,2147483647,!1);en.MAX_VALUE=JD;var XD=Nt(-1,-1,!0);en.MAX_UNSIGNED_VALUE=XD;var wr=Nt(0,-2147483648,!1);en.MIN_VALUE=wr;var $e=en.prototype;$e.toInt=function(){return this.unsigned?this.low>>>0:this.low},$e.toNumber=function(){return this.unsigned?(this.high>>>0)*ka+(this.low>>>0):this.high*ka+(this.low>>>0)},$e.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(wr)){var n=zr(t),r=this.div(n),o=r.mul(n).sub(this);return r.toString(t)+o.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var i=zr(Uh(t,6),this.unsigned),s=this,a="";;){var l=s.div(i),f=(s.sub(l.mul(i)).toInt()>>>0).toString(t);if((s=l).isZero())return f+a;for(;f.length<6;)f="0"+f;a=""+f+a}},$e.getHighBits=function(){return this.high},$e.getHighBitsUnsigned=function(){return this.high>>>0},$e.getLowBits=function(){return this.low},$e.getLowBitsUnsigned=function(){return this.low>>>0},$e.getNumBitsAbs=function(){if(this.isNegative())return this.eq(wr)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,n=31;n>0&&!(t&1<<n);n--);return 0!=this.high?n+33:n+1},$e.isZero=function(){return 0===this.high&&0===this.low},$e.eqz=$e.isZero,$e.isNegative=function(){return!this.unsigned&&this.high<0},$e.isPositive=function(){return this.unsigned||this.high>=0},$e.isOdd=function(){return 1==(1&this.low)},$e.isEven=function(){return 0==(1&this.low)},$e.equals=function(t){return Vn(t)||(t=so(t)),(this.unsigned===t.unsigned||this.high>>>31!=1||t.high>>>31!=1)&&this.high===t.high&&this.low===t.low},$e.eq=$e.equals,$e.notEquals=function(t){return!this.eq(t)},$e.neq=$e.notEquals,$e.ne=$e.notEquals,$e.lessThan=function(t){return this.comp(t)<0},$e.lt=$e.lessThan,$e.lessThanOrEqual=function(t){return this.comp(t)<=0},$e.lte=$e.lessThanOrEqual,$e.le=$e.lessThanOrEqual,$e.greaterThan=function(t){return this.comp(t)>0},$e.gt=$e.greaterThan,$e.greaterThanOrEqual=function(t){return this.comp(t)>=0},$e.gte=$e.greaterThanOrEqual,$e.ge=$e.greaterThanOrEqual,$e.compare=function(t){if(Vn(t)||(t=so(t)),this.eq(t))return 0;var n=this.isNegative(),r=t.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},$e.comp=$e.compare,$e.negate=function(){return!this.unsigned&&this.eq(wr)?wr:this.not().add(Pa)},$e.neg=$e.negate,$e.add=function(t){Vn(t)||(t=so(t));var f=0,v=0,x=0,W=0;return x+=(W+=(65535&this.low)+(65535&t.low))>>>16,v+=(x+=(this.low>>>16)+(t.low>>>16))>>>16,f+=(v+=(65535&this.high)+(65535&t.high))>>>16,f+=(this.high>>>16)+(t.high>>>16),Nt((x&=65535)<<16|(W&=65535),(f&=65535)<<16|(v&=65535),this.unsigned)},$e.subtract=function(t){return Vn(t)||(t=so(t)),this.add(t.neg())},$e.sub=$e.subtract,$e.multiply=function(t){if(this.isZero())return this;if(Vn(t)||(t=so(t)),Vr)return Nt(Vr.mul(this.low,this.high,t.low,t.high),Vr.get_high(),this.unsigned);if(t.isZero())return this.unsigned?Qo:ao;if(this.eq(wr))return t.isOdd()?wr:ao;if(t.eq(wr))return this.isOdd()?wr:ao;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(YD)&&t.lt(YD))return zr(this.toNumber()*t.toNumber(),this.unsigned);var o=65535&this.high,i=this.low>>>16,s=65535&this.low,l=65535&t.high,h=t.low>>>16,f=65535&t.low,v=0,x=0,W=0,ne=0;return W+=(ne+=s*f)>>>16,x+=(W+=i*f)>>>16,W&=65535,x+=(W+=s*h)>>>16,v+=(x+=o*f)>>>16,x&=65535,v+=(x+=i*h)>>>16,x&=65535,v+=(x+=s*l)>>>16,v+=(this.high>>>16)*f+o*h+i*l+s*(t.high>>>16),Nt((W&=65535)<<16|(ne&=65535),(v&=65535)<<16|(x&=65535),this.unsigned)},$e.mul=$e.multiply,$e.divide=function(t){if(Vn(t)||(t=so(t)),t.isZero())throw Error("division by zero");var r,o,i;if(Vr)return this.unsigned||-2147483648!==this.high||-1!==t.low||-1!==t.high?Nt((this.unsigned?Vr.div_u:Vr.div_s)(this.low,this.high,t.low,t.high),Vr.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?Qo:ao;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return Qo;if(t.gt(this.shru(1)))return QD;i=Qo}else{if(this.eq(wr))return t.eq(Pa)||t.eq(G_)?wr:t.eq(wr)?Pa:(r=this.shr(1).div(t).shl(1)).eq(ao)?t.isNegative()?Pa:G_:(o=this.sub(t.mul(r)),i=r.add(o.div(t)));if(t.eq(wr))return this.unsigned?Qo:ao;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();i=ao}for(o=this;o.gte(t);){r=Math.max(1,Math.floor(o.toNumber()/t.toNumber()));for(var a=Math.ceil(Math.log(r)/Math.LN2),l=a<=48?1:Uh(2,a-48),h=zr(r),f=h.mul(t);f.isNegative()||f.gt(o);)f=(h=zr(r-=l,this.unsigned)).mul(t);h.isZero()&&(h=Pa),i=i.add(h),o=o.sub(f)}return i},$e.div=$e.divide,$e.modulo=function(t){return Vn(t)||(t=so(t)),Vr?Nt((this.unsigned?Vr.rem_u:Vr.rem_s)(this.low,this.high,t.low,t.high),Vr.get_high(),this.unsigned):this.sub(this.div(t).mul(t))},$e.mod=$e.modulo,$e.rem=$e.modulo,$e.not=function(){return Nt(~this.low,~this.high,this.unsigned)},$e.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},$e.clz=$e.countLeadingZeros,$e.countTrailingZeros=function(){return this.low?zD(this.low):zD(this.high)+32},$e.ctz=$e.countTrailingZeros,$e.and=function(t){return Vn(t)||(t=so(t)),Nt(this.low&t.low,this.high&t.high,this.unsigned)},$e.or=function(t){return Vn(t)||(t=so(t)),Nt(this.low|t.low,this.high|t.high,this.unsigned)},$e.xor=function(t){return Vn(t)||(t=so(t)),Nt(this.low^t.low,this.high^t.high,this.unsigned)},$e.shiftLeft=function(t){return Vn(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?Nt(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):Nt(0,this.low<<t-32,this.unsigned)},$e.shl=$e.shiftLeft,$e.shiftRight=function(t){return Vn(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?Nt(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):Nt(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},$e.shr=$e.shiftRight,$e.shiftRightUnsigned=function(t){return Vn(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?Nt(this.low>>>t|this.high<<32-t,this.high>>>t,this.unsigned):Nt(32===t?this.high:this.high>>>t-32,0,this.unsigned)},$e.shru=$e.shiftRightUnsigned,$e.shr_u=$e.shiftRightUnsigned,$e.rotateLeft=function(t){var n;return Vn(t)&&(t=t.toInt()),0==(t&=63)?this:32===t?Nt(this.high,this.low,this.unsigned):t<32?Nt(this.low<<t|this.high>>>(n=32-t),this.high<<t|this.low>>>n,this.unsigned):Nt(this.high<<(t-=32)|this.low>>>(n=32-t),this.low<<t|this.high>>>n,this.unsigned)},$e.rotl=$e.rotateLeft,$e.rotateRight=function(t){var n;return Vn(t)&&(t=t.toInt()),0==(t&=63)?this:32===t?Nt(this.high,this.low,this.unsigned):t<32?Nt(this.high<<(n=32-t)|this.low>>>t,this.low<<n|this.high>>>t,this.unsigned):Nt(this.low<<(n=32-(t-=32))|this.high>>>t,this.high<<n|this.low>>>t,this.unsigned)},$e.rotr=$e.rotateRight,$e.toSigned=function(){return this.unsigned?Nt(this.low,this.high,!1):this},$e.toUnsigned=function(){return this.unsigned?this:Nt(this.low,this.high,!0)},$e.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},$e.toBytesLE=function(){var t=this.high,n=this.low;return[255&n,n>>>8&255,n>>>16&255,n>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]},$e.toBytesBE=function(){var t=this.high,n=this.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,n>>>24,n>>>16&255,n>>>8&255,255&n]},en.fromBytes=function(t,n,r){return r?en.fromBytesLE(t,n):en.fromBytesBE(t,n)},en.fromBytesLE=function(t,n){return new en(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,n)},en.fromBytesBE=function(t,n){return new en(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],n)};const Ai=en,eM={toRheaMessageHeader(e){const t={};return null!=e.deliveryCount&&(t.delivery_count=e.deliveryCount),null!=e.durable&&(t.durable=e.durable),null!=e.firstAcquirer&&(t.first_acquirer=e.firstAcquirer),null!=e.priority&&(t.priority=e.priority),null!=e.timeToLive&&(t.ttl=e.timeToLive),It.verbose("To RheaMessageHeader: %O",t),t},fromRheaMessageHeader(e){const t={};return null!=e.delivery_count&&(t.deliveryCount=e.delivery_count),null!=e.durable&&(t.durable=e.durable),null!=e.first_acquirer&&(t.firstAcquirer=e.first_acquirer),null!=e.priority&&(t.priority=e.priority),null!=e.ttl&&(t.timeToLive=e.ttl),It.verbose("From RheaMessageHeader: %O",t),t}},tM={toRheaMessageProperties(e){const t={};return null!=e.absoluteExpiryTime&&(t.absolute_expiry_time=new Date(e.absoluteExpiryTime)),null!=e.contentEncoding&&(t.content_encoding=e.contentEncoding),null!=e.contentType&&(t.content_type=e.contentType),null!=e.correlationId&&(t.correlation_id=e.correlationId),null!=e.creationTime&&(t.creation_time=new Date(e.creationTime)),null!=e.groupId&&(t.group_id=e.groupId),null!=e.groupSequence&&(t.group_sequence=e.groupSequence),null!=e.messageId&&(t.message_id=e.messageId),null!=e.replyTo&&(t.reply_to=e.replyTo),null!=e.replyToGroupId&&(t.reply_to_group_id=e.replyToGroupId),null!=e.subject&&(t.subject=e.subject),null!=e.to&&(t.to=e.to),It.verbose("To RheaMessageProperties: %O",t),t},fromRheaMessageProperties(e){const t={};return null!=e.absolute_expiry_time&&(t.absoluteExpiryTime=e.absolute_expiry_time.getTime()),null!=e.content_encoding&&(t.contentEncoding=e.content_encoding),null!=e.content_type&&(t.contentType=e.content_type),null!=e.correlation_id&&(t.correlationId=e.correlation_id),null!=e.creation_time&&(t.creationTime=e.creation_time.getTime()),null!=e.group_id&&(t.groupId=e.group_id),null!=e.group_sequence&&(t.groupSequence=e.group_sequence),null!=e.message_id&&(t.messageId=e.message_id),null!=e.reply_to&&(t.replyTo=e.reply_to),null!=e.reply_to_group_id&&(t.replyToGroupId=e.reply_to_group_id),null!=e.subject&&(t.subject=e.subject),null!=e.to&&(t.to=e.to),It.verbose("From RheaMessageProperties: %O",t),t}},nM_fromRheaMessage=e=>({header:eM.fromRheaMessageHeader(e),footer:e.footer,messageAnnotations:e.message_annotations,deliveryAnnotations:e.delivery_annotations,applicationProperties:e.application_properties,properties:tM.fromRheaMessageProperties(e),body:e.body}),nM_toRheaMessage=e=>Object.assign(Object.assign(Object.assign({},tM.toRheaMessageProperties(e.properties||{})),eM.toRheaMessageHeader(e.header||{})),{body:e.body,message_annotations:e.messageAnnotations,delivery_annotations:e.deliveryAnnotations,application_properties:e.applicationProperties,footer:e.footer});var Gr=S(9007),A8=S(3678),q_=S.n(A8);const Bh={encode(e,t){let n;if("value"===t)n=je.yw.data_section(e),n.typecode=119;else if("sequence"===t)n=je.yw.sequence_section(e);else if(q_()(e)||e instanceof Uint8Array)n=je.yw.data_section(e);else{void 0===e&&(e=null);try{const r=JSON.stringify(e);n=je.yw.data_section(Gr.lW.from(r,"utf8"))}catch(r){const o="An error occurred while executing JSON.stringify() on the given body "+e+`${r?r.stack:JSON.stringify(r)}`;throw ar.warning("[encode] "+o),function u8(e,t){xr(t,["stack"])&&t.stack&&e.verbose(t.stack)}(ar,r),new Error(o)}}return n},decode(e,t){let n=e;return iM(e)&&(n=e.content),t?n:jh(n)},decodeWithType(e,t){try{if(!iM(e))return q_()(e)?{body:t?e:jh(e),bodyType:"data"}:{body:e,bodyType:"value"};switch(e.typecode){case 117:return{body:t?e.content:jh(e.content),bodyType:"data"};case 118:return{body:e.content,bodyType:"sequence"};case 119:return{body:e.content,bodyType:"value"}}}catch(n){throw ar.verbose("[decode] An error occurred while decoding the received message body. The error is: %O",n),n}}};function iM(e){return null!=e&&"number"==typeof e.typecode&&(117===e.typecode||119===e.typecode||118===e.typecode)}function jh(e){let t=e;try{const n=t.toString("utf8");t=JSON.parse(n)}catch(n){ar.verbose("[decode] An error occurred while trying JSON.parse() on the received body. The error is %O",n)}return t}const sM=new Map([["MessagingEntityNotFoundError","MessagingEntityNotFound"],["MessageLockLostError","MessageLockLost"],["MessageNotFoundError","MessageNotFound"],["MessageTooLargeError","MessageSizeExceeded"],["MessagingEntityAlreadyExistsError","MessagingEntityAlreadyExists"],["MessagingEntityDisabledError","MessagingEntityDisabled"],["QuotaExceededError","QuotaExceeded"],["ServerBusyError","ServiceBusy"],["OperationTimeoutError","ServiceTimeout"],["ServiceUnavailableError","ServiceTimeout"],["ServiceCommunicationError","ServiceCommunicationProblem"],["SessionCannotBeLockedError","SessionCannotBeLocked"],["SessionLockLostError","SessionLockLost"],["UnauthorizedError","UnauthorizedAccess"]]);class co extends Sl{constructor(t,n){if(super("string"==typeof t?t:t.message),"string"==typeof t)this.code=n??"GeneralError";else{for(const o in t)this[o]=t[o];this.code=co.normalizeMessagingCode(t.code),"GeneralError"===this.code&&t.code&&(this.message=`${t.code}: ${this.message}`)}this.name="ServiceBusError"}static normalizeMessagingCode(t){return null!=t&&sM.has(t)?sM.get(t):"GeneralError"}}function rt(e){if(function D8(e){return xr(e,["name"])&&"ServiceBusError"===e.name}(e))return e;const t=Ti(e);return function _8(e){return"MessagingError"===e.name}(t)?new co(t):t}function Tl(e){return`${e}-${(0,je.kE)()}`}function Al(e,t){return t||Tl(e)}function M8(e){return e&&Gr.lW.isBuffer(e)?Gr.lW.from([e[3],e[2],e[1],e[0],e[5],e[4],e[7],e[6],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]):e}function aM(e){const t=Date.now(),n=e.getTime(),r=n-t;if(Ie.verbose("Locked until utc  : %d",n),Ie.verbose("Current time is   : %d",t),Ie.verbose("Remaining time is : %d",r),r<1e3)return 0;const i=r-Math.min(r/2,1e4);return Ie.verbose("Renew after       : %d",i),i}function W_(){return W_=(0,ge.Z)(function*(e){if(e.abortSignal&&e.abortSignal.aborted)throw new sr(Do);let t,n;const o=new Promise((i,s)=>{var a,l;n=lM(s,e.abortSignal),t=(null!==(l=null===(a=e.timeoutFunctions)||void 0===a?void 0:a.setTimeoutFn)&&void 0!==l?l:setTimeout)(()=>{s(new je.S$(e.timeoutMessage))},e.timeoutMs)});try{return yield Promise.race([o,e.actionFn()])}finally{(null!==(s=null===(i=e.timeoutFunctions)||void 0===i?void 0:i.clearTimeoutFn)&&void 0!==s?s:clearTimeout)(t),n&&n()}var i,s}),W_.apply(this,arguments)}function lM(e,t){if(null==t)return()=>{};if(t.aborted)throw new sr(Do);const n=()=>{t.removeEventListener("abort",n),e(new sr(Do))};return t.addEventListener("abort",n),()=>t.removeEventListener("abort",n)}function uM(e,t,n,r,o,i){return Z_.apply(this,arguments)}function Z_(){return Z_=(0,ge.Z)(function*(e,t,n,r,o,i){let s=1e3;if(!o?.sendable()&&r>s?(e.verbose("%s Sender '%s', waiting for 1 second for sender to become sendable",t,n),yield function o8(e,t,n,r){return L_.apply(this,arguments)}(s),e.verbose("%s Sender '%s' after waiting for a second, credit: %d available: %d",t,n,o?.credit,i)):s=0,!o?.sendable()){const a=`[${t}] Sender "${n}", cannot send the message right now. Please try later.`;throw e.warning(a),rt({condition:Mo.SenderBusyError,description:a})}return s}),Z_.apply(this,arguments)}var Ln=function(e){return e.complete="complete",e.deadletter="deadletter",e.abandon="abandon",e.defer="defer",e}(Ln||{});function Y_(e,t){var n,r;let o;if(J_(e))o=Object.assign(Object.assign({},nM_toRheaMessage(e)),{body:t.encode(e.body,null!==(n=e.bodyType)&&void 0!==n?n:"data")});else{let i="data";(function z8(e){return Q_(e)&&"_rawAmqpMessage"in e})(e)&&(i=null!==(r=e._rawAmqpMessage.bodyType)&&void 0!==r?r:"data");const s=function V8(e){return null!=e.contentType&&"string"!=typeof e.contentType?new TypeError("The property 'contentType' on the message must be of type 'string'"):null!=e.subject&&"string"!=typeof e.subject?new TypeError("The property 'label' on the message must be of type 'string'"):null!=e.to&&"string"!=typeof e.to?new TypeError("The property 'to' on the message must be of type 'string'"):null!=e.replyTo&&"string"!=typeof e.replyTo?new TypeError("The property 'replyTo' on the message must be of type 'string'"):null!=e.replyToSessionId&&"string"!=typeof e.replyToSessionId?new TypeError("The property 'replyToSessionId' on the message must be of type 'string'"):null!=e.timeToLive&&"number"!=typeof e.timeToLive?new TypeError("The property 'timeToLive' on the message must be of type 'number'"):null!=e.sessionId&&"string"!=typeof e.sessionId?new TypeError("The property 'sessionId' on the message must be of type 'string'"):null==e.messageId||"string"==typeof e.messageId||"number"==typeof e.messageId||Gr.lW.isBuffer(e.messageId)?null==e.correlationId||"string"==typeof e.correlationId||"number"==typeof e.correlationId||Gr.lW.isBuffer(e.correlationId)?void 0:new TypeError("The property 'correlationId' on the message must be of type string, number or Buffer"):new TypeError("The property 'messageId' on the message must be of type string, number or Buffer")}(e);if(s)throw s;o={body:t.encode(e.body,i),message_annotations:{}},o.ttl=e.timeToLive}if(null!=o.ttl&&o.ttl!==we.maxDurationValue&&(o.creation_time=new Date,o.absolute_expiry_time=new Date(Math.min(we.maxAbsoluteExpiryTime,o.creation_time.getTime()+o.ttl))),J_(e))return o;if(null!=e.applicationProperties&&(o.application_properties=e.applicationProperties),null!=e.contentType&&(o.content_type=e.contentType),null!=e.sessionId){if(e.sessionId.length>we.maxSessionIdLength)throw new Error("Length of 'sessionId' property on the message cannot be greater than 128 characters.");o.group_id=e.sessionId}if(null!=e.replyTo&&(o.reply_to=e.replyTo),null!=e.to&&(o.to=e.to),null!=e.subject&&(o.subject=e.subject),dM(o,e.messageId),null!=e.correlationId&&(o.correlation_id=e.correlationId),null!=e.replyToSessionId&&(o.reply_to_group_id=e.replyToSessionId),null!=e.partitionKey){if(e.partitionKey.length>we.maxPartitionKeyLength)throw new Error("Length of 'partitionKey' property on the message cannot be greater than 128 characters.");o.message_annotations[we.partitionKey]=e.partitionKey}return hM(o,e.scheduledEnqueueTimeUtc),Il.verbose("SBMessage to RheaMessage: %O",o),o}function dM(e,t){if(null!=t){if("string"==typeof t&&t.length>we.maxMessageIdLength)throw new Error(`Length of 'messageId' property on the message cannot be greater than ${we.maxMessageIdLength} characters.`);e.message_id=t}}function hM(e,t){var n;null!=t&&(e.message_annotations=null!==(n=e.message_annotations)&&void 0!==n?n:{},e.message_annotations[we.scheduledEnqueueTime]=t)}function fM(e,t){var n,r;e||(e={body:void 0});const{skipParsingBodyAsJson:o,delivery:i,shouldReorderLockToken:s,skipConvertingDate:a=!1}=t,{body:l,bodyType:h}=Bh.decodeWithType(e.body,o),f={body:l};null!=e.application_properties&&(f.applicationProperties=a?e.application_properties:Na(e.application_properties)),null!=e.content_type&&(f.contentType=e.content_type),null!=e.group_id&&(f.sessionId=e.group_id),null!=e.reply_to&&(f.replyTo=e.reply_to),null!=e.to&&(f.to=e.to),null!=e.ttl&&(f.timeToLive=e.ttl),null!=e.subject&&(f.subject=e.subject),null!=e.message_id&&(f.messageId=e.message_id),null!=e.correlation_id&&(f.correlationId=e.correlation_id),null!=e.reply_to_group_id&&(f.replyToSessionId=e.reply_to_group_id),null!=e.message_annotations&&(null!=e.message_annotations[we.partitionKey]&&(f.partitionKey=e.message_annotations[we.partitionKey]),null!=e.message_annotations[we.scheduledEnqueueTime]&&(f.scheduledEnqueueTimeUtc=e.message_annotations[we.scheduledEnqueueTime]));const v={state:"active"};if(null!=e.message_annotations){null!=e.message_annotations[we.deadLetterSource]&&(v.deadLetterSource=e.message_annotations[we.deadLetterSource]);const ne=e.message_annotations[we.messageState];1===ne?v.state="deferred":2===ne&&(v.state="scheduled"),null!=e.message_annotations[we.enqueueSequenceNumber]&&(v.enqueuedSequenceNumber=e.message_annotations[we.enqueueSequenceNumber]),null!=e.message_annotations[we.sequenceNumber]&&(v.sequenceNumber=Gr.lW.isBuffer(e.message_annotations[we.sequenceNumber])?Ai.fromBytesBE(e.message_annotations[we.sequenceNumber]):Ai.fromNumber(e.message_annotations[we.sequenceNumber])),null!=e.message_annotations[we.enqueuedTime]&&(v.enqueuedTimeUtc=new Date(e.message_annotations[we.enqueuedTime])),null!=e.message_annotations[we.lockedUntil]&&(v.lockedUntilUtc=new Date(e.message_annotations[we.lockedUntil]))}null==e.ttl&&(e.ttl=we.maxDurationValue),v.enqueuedTimeUtc&&(v.expiresAtUtc=new Date(Math.min(v.enqueuedTimeUtc.getTime()+e.ttl,we.maxDurationValue)));const x=nM_fromRheaMessage(e);x.bodyType=h,x.applicationProperties&&(x.applicationProperties=a?x.applicationProperties:Na(x.applicationProperties)),x.deliveryAnnotations&&(x.deliveryAnnotations=a?x.deliveryAnnotations:Na(x.deliveryAnnotations)),x.messageAnnotations&&(x.messageAnnotations=a?x.messageAnnotations:Na(x.messageAnnotations));const W=Object.assign(Object.assign(Object.assign({_rawAmqpMessage:x,deliveryCount:e.delivery_count,lockToken:i&&i.tag&&0!==i.tag.length?(0,je.nq)(!0===s?M8("string"==typeof i.tag?Gr.lW.from(i.tag):i.tag):"string"==typeof i.tag?Gr.lW.from(i.tag):i.tag):void 0},f),v),{deadLetterReason:null===(n=f.applicationProperties)||void 0===n?void 0:n.DeadLetterReason,deadLetterErrorDescription:null===(r=f.applicationProperties)||void 0===r?void 0:r.DeadLetterErrorDescription});return Il.verbose("AmqpMessage to ServiceBusReceivedMessage: %O",W),W}function Q_(e){return xr(e,["body"])}function J_(e){return xr(e,["body","bodyType"])&&e.constructor.name!==Dl.name}class Dl{constructor(t,n,r,o,i,s){const a=fM(t,{skipParsingBodyAsJson:i,delivery:n,shouldReorderLockToken:r,skipConvertingDate:s}),{_rawAmqpMessage:l}=a,h=(0,xe.__rest)(a,["_rawAmqpMessage"]);this._rawAmqpMessage=l,Object.assign(this,h),this.state=h.state,"receiveAndDelete"===o&&(this.lockToken=void 0),this.delivery=n}clone(){return{body:this.body,contentType:this.contentType,correlationId:this.correlationId,subject:this.subject,messageId:this.messageId,partitionKey:this.partitionKey,replyTo:this.replyTo,replyToSessionId:this.replyToSessionId,scheduledEnqueueTimeUtc:this.scheduledEnqueueTimeUtc,sessionId:this.sessionId,timeToLive:this.timeToLive,to:this.to,applicationProperties:this.applicationProperties}}}function Na(e){if(!Dn(e))return e;if("object"==typeof e&&xr(e,["getTime"])&&"function"==typeof e.getTime)return e.getTime();if(Array.isArray(e)){const t=[];for(const n of e)t.push(Na(n));return t}if("object"==typeof e&&Dn(e)){const t=Object.assign({},e);for(const n of Object.keys(t))t[n]=Na(t[n]);return t}return e}var X_=function(e){return e.CbsTokenTypeJwt="jwt",e.CbsTokenTypeSas="servicebus.windows.net:sastoken",e}(X_||{});class Hh{get logPrefix(){return this._logPrefix}constructor(t,n,r,o,i,s){this.baseName=t,this.entityPath=n,this._linkType=o,this._logger=i,this._wasClosedPermanently=!1,this._openLock=(0,je.kE)(),s||(s={}),this._context=r,this.address=s.address||"",this.audience=s.audience||"",this.name=Tl(t),this._logPrefix=`[${r.connectionId}|${this._linkType}:${this.name}]`}isOpen(){const t=!!this._link&&this._link.isOpen();return this._logger.verbose(`${this._logPrefix} is open? ${t}`),t}initLink(t,n){var r=this;return(0,ge.Z)(function*(){return yield r._context.readyToOpenLink(),r._logger.verbose(`${r._logPrefix} Attempting to acquire lock token ${r._openLock} for initializing link`),Ma.acquire(r._openLock,()=>(r._logger.verbose(`${r._logPrefix} Lock ${r._openLock} acquired for initializing link`),r._initLinkImpl(t,n)),{abortSignal:n,timeoutInMs:we.defaultOperationTimeoutInMs})})()}_initLinkImpl(t,n){var r=this;return(0,ge.Z)(function*(){const o=()=>{if(n?.aborted)throw new sr(Do)},i=r._context.connectionId;if(o(),t.name&&(r.name=t.name,r._logPrefix=`[${i}|${r._linkType}:${r.name}]`),r._wasClosedPermanently)throw r._logger.verbose(`${r._logPrefix} Link has been permanently closed. Not reopening.`),new sr("Link has been permanently closed. Not reopening.");if(r.isOpen())r._logger.verbose(`${r._logPrefix} Link is already open. Returning.`);else{r._logger.verbose(`${r._logPrefix} Is not open and is not currently connecting. Opening.`);try{yield r._negotiateClaim({abortSignal:n,setTokenRenewal:!1,timeoutInMs:we.defaultOperationTimeoutInMs}),o(),r.checkIfConnectionReady(),r._logger.verbose(`${r._logPrefix} Creating with options %O`,t),r._link=yield r.createRheaLink(t),o(),r._ensureTokenRenewal(),r._logger.verbose(`${r._logPrefix} Link has been created.`)}catch(s){throw r._logger.logError(s,`${r._logPrefix} Error thrown when creating the link`),yield r.closeLinkImpl(),s}}})()}close(){var t=this;return(0,ge.Z)(function*(){t._wasClosedPermanently=!0,t._logger.verbose(`${t.logPrefix} permanently closing this link.`),t.removeLinkFromContext(),yield t.closeLink(),t._logger.verbose(`${t.logPrefix} permanently closed this link.`)})()}closeLink(){return this._logger.verbose(`${this._logPrefix} Attempting to acquire lock token ${this._openLock} for closing link`),Ma.acquire(this._openLock,()=>(this._logger.verbose(`${this._logPrefix} Lock ${this._openLock} acquired for closing link`),this.closeLinkImpl()),{abortSignal:void 0,timeoutInMs:void 0})}closeLinkImpl(){var t=this;return(0,ge.Z)(function*(){if(t._logger.verbose(`${t._logPrefix} closeLinkImpl() called`),clearTimeout(t._tokenRenewalTimer),t._tokenRenewalTimer=void 0,t._link)try{const n=t._link;t._link=void 0,yield n.close(),t._logger.verbose(`${t._logPrefix} closed.`)}catch(n){t._logger.logError(n,`${t._logPrefix} An error occurred while closing the link`)}})()}get _type(){let t="LinkEntity";return this.constructor&&this.constructor.name&&(t=this.constructor.name),t}get wasClosedPermanently(){return this._wasClosedPermanently}get link(){return this._link}_negotiateClaim({abortSignal:t,setTokenRenewal:n,timeoutInMs:r}){var o=this;return(0,ge.Z)(function*(){o._logger.verbose(`${o._logPrefix} negotiateclaim() has been called`),o.checkIfConnectionReady(),o._logger.verbose("%s Acquiring cbs lock: '%s' for creating the cbs session while creating the %s: '%s' with address: '%s'.",o.logPrefix,o._context.cbsSession.cbsLock,o._type,o.name,o.address);const i=Date.now();let s,a;if(o._context.cbsSession.isOpen()||(yield Ma.acquire(o._context.cbsSession.cbsLock,()=>(o.checkIfConnectionReady(),o._context.cbsSession.init({abortSignal:t,timeoutInMs:r})),{abortSignal:t,timeoutInMs:r-(Date.now()-i)})),function G8(e){return xr(e,["isSasTokenProvider"])&&!0===e.isSasTokenProvider}(o._context.tokenCredential))s=yield o._context.tokenCredential.getToken(o.audience),a=X_.CbsTokenTypeSas,o._tokenTimeout=27e5;else{const l=yield o._context.tokenCredential.getToken(we.aadServiceBusScope);if(!l)throw new Error('Failed to get token from the provided "TokenCredential" object');s=l,a=X_.CbsTokenTypeJwt,o._tokenTimeout=s.expiresOnTimestamp-Date.now()-12e4}if(o._logger.verbose("%s %s: calling negotiateClaim for audience '%s'.",o.logPrefix,o._type,o.audience),o._logger.verbose("%s Acquiring cbs lock: '%s' for cbs auth for %s: '%s' with address '%s'.",o.logPrefix,o._context.negotiateClaimLock,o._type,o.name,o.address),!s)throw new Error("Token cannot be null");yield Ma.acquire(o._context.negotiateClaimLock,()=>(o.checkIfConnectionReady(),o._context.cbsSession.negotiateClaim(o.audience,s.token,a,{abortSignal:t,timeoutInMs:r-(Date.now()-i)})),{abortSignal:t,timeoutInMs:r-(Date.now()-i)}),o._logger.verbose("%s Negotiated claim for %s '%s' with with address: %s",o.logPrefix,o._type,o.name,o.address),n&&o._ensureTokenRenewal()})()}checkIfConnectionReady(){if(!this._context.isConnectionClosing())return;this._logger.verbose(`${this._logPrefix} Connection is reopening, aborting link initialization.`);const t=new co("Connection is reopening, aborting link initialization.","GeneralError");throw t.retryable=!0,t}_ensureTokenRenewal(){var t=this;this._tokenTimeout&&(this._tokenRenewalTimer&&clearTimeout(this._tokenRenewalTimer),this._tokenRenewalTimer=setTimeout((0,ge.Z)(function*(){try{yield t._negotiateClaim({setTokenRenewal:!0,abortSignal:void 0,timeoutInMs:we.defaultOperationTimeoutInMs})}catch(n){t._logger.logError(n,"%s %s '%s' with address %s, an error occurred while renewing the token",t.logPrefix,t._type,t.name,t.address)}}),this._tokenTimeout),this._logger.verbose("%s %s '%s' with address %s, has next token renewal in %d milliseconds @(%s).",this.logPrefix,this._type,this.name,this.address,this._tokenTimeout,new Date(Date.now()+this._tokenTimeout).toString()))}}const ey="'maxMessageCount' must be a number greater than 0.";function xt(e){if(e&&e.wasConnectionCloseCalled){const n=new Error("The underlying AMQP connection is closed.");throw ar.warning(`[${e.connectionId}] %O`,n),n}}function pM(e,t){return Dn(t)?`The receiver for session "${t}" in "${e}" has been closed and can no longer be used. Please create a new receiver using the "acceptSession" or "acceptNextSession" method on the ServiceBusClient.`:`The receiver for "${e}" has been closed and can no longer be used. Please create a new receiver using the "createReceiver" method on the ServiceBusClient.`}function gM(e,t){return Dn(t)?`The receiver for session "${t}" for "${e}" is already receiving messages.`:`The receiver for "${e}" is already receiving messages.`}function zn(e,t,n){if(null==n){const r=new TypeError(`Missing parameter "${t}"`);throw ar.warning(`[${e}] %O`,r),r}}function ty(e,t,n,r){if(typeof n!==r){const o=new TypeError(`The parameter "${t}" should be of type "${r}"`);throw ar.warning(`[${e}] %O`,o),o}}function $h(e,t,n){if(Array.isArray(n))return function Z8(e,t,n){if(n.every(o=>Ai.isLong(o)))return;const r=new TypeError(`The parameter "${t}" should be an array of type "Long"`);throw ar.warning(`[${e}] %O`,r),r}(e,t,n);if(Ai.isLong(n))return;const r=new TypeError(`The parameter "${t}" should be of type "Long"`);throw ar.warning(`[${e}] %O`,r),r}function mM(e,t,n){if(""!==n)return;const r=new TypeError(`Empty string not allowed in parameter "${t}"`);throw ar.warning(`[${e}] %O`,r),r}const J8="The message has either been deleted or already settled";function Jo(e,t,n){let r;if("receiveAndDelete"===t?r=new Error("The operation is not supported in 'receiveAndDelete' receive mode."):e.lockToken||(r=new Error("This operation is not supported for peeked messages. Only messages received using 'receiveMessages()', 'subscribe()' and 'getMessageIterator()' methods on the receiver in 'peekLock' receive mode can be settled.")),r)throw Ie.logError(r,"[%s] An error occurred for message with id '%s'",n,e.messageId),r}function Vh(e,t){if(!Q_(e)&&!J_(e))throw new TypeError(t);if(Q_(e)&&e.partitionKey&&e.sessionId&&e.partitionKey!==e.sessionId)throw new TypeError("The fields 'partitionKey' and 'sessionId' cannot have different values.")}const ny="Provided value for 'messages' must be of type: ServiceBusMessage, AmqpAnnotatedMessage, ServiceBusMessageBatch or an array of type ServiceBusMessage or AmqpAnnotatedMessage.",t6=["sqlExpression"];function _M(e){return!!e&&t6.some(t=>xr(e,[t]))}const n6=["correlationId","messageId","to","replyTo","subject","sessionId","replyToSessionId","contentType","applicationProperties"];class o6 extends Hh{constructor(t,n,r){super(`${n}/$management`,n,t,"mgmt",mn,{address:r&&r.address?r.address:we.management,audience:r&&r.audience?r.audience:`${t.config.endpoint}${n}/$management`}),this.replyTo=(0,je.kE)(),this._lastPeekedSequenceNumber=Ai.ZERO,this._initLock=(0,je.kE)(),this._context=t}initWithUniqueReplyTo(t={}){var n=this;return(0,ge.Z)(function*(){var r;const o=null!==(r=t.timeoutInMs)&&void 0!==r?r:we.defaultOperationTimeoutInMs,i=Date.now();return Ma.acquire(n._initLock,(0,ge.Z)(function*(){mn.verbose(`${n.logPrefix} lock acquired for initializing replyTo address and link`),n.isOpen()||(n.replyTo=(0,je.kE)(),mn.verbose(`${n.logPrefix} new replyTo address: ${n.replyTo} generated`));const{abortSignal:s}=t??{},a=new bD,{signal:l}=new bD([a.signal,...s?[s]:[]]);n.isOpen()||(yield Promise.race([n._init(l),bl(o,{abortSignal:a.signal}).then(()=>{throw{name:"OperationTimeoutError",message:"The management request timed out. Please try again later."}})]).finally(()=>a.abort()));const h=Date.now()-i;return Object.assign(Object.assign({},t),{timeoutInMs:o-h})}),{abortSignal:t.abortSignal,timeoutInMs:o})})()}_init(t){var n=this;return(0,ge.Z)(function*(){xt(n._context);try{const r={source:{address:n.address},name:n.replyTo,target:{address:n.replyTo},onSessionError:i=>{const s=rt(i.session.error);mn.logError(s,`${n.logPrefix} An error occurred on the session for request/response links for $management`)}},o={target:{address:n.address},onError:i=>{const s=rt(i.sender.error);mn.logError(s,`${n.logPrefix} An error occurred on the $management sender link`)}};yield n.initLink({senderOptions:o,receiverOptions:r},t)}catch(r){const o=rt(r);throw mn.logError(o,`${n.logPrefix} An error occurred while establishing the $management links`),o}})()}createRheaLink(t){var n=this;return(0,ge.Z)(function*(){const r=yield Fh.create(n._context.connection,t.senderOptions,t.receiverOptions);return r.receiver.on(je.cz.receiverError,o=>{const i=rt(o.receiver.error);mn.logError(i,`${n.logPrefix} An error occurred on the $management receiver link`)}),r})()}_safelyGetTypedValueFromArray(t,n){return Array.isArray(t)&&t.length>n&&t[n]?t[n].value:void 0}_decodeApplicationPropertiesMap(t){if(!je.V5.is_map(t))throw new Error("object to decode is not of Map types");const n=t.value,r={};for(let o=0;o<n.length;o+=2)r[n[o].value]=n[o+1].value;return r}_makeManagementRequest(t,n,r={}){var o=this;return(0,ge.Z)(function*(){var i,s,a,l;void 0===t.message_id&&(t.message_id=(0,je.kE)());try{const{timeoutInMs:h}=r;return yield uM(n,o.logPrefix,o.name,h??we.defaultOperationTimeoutInMs,null===(i=o.link)||void 0===i?void 0:i.sender,null===(l=null===(a=null===(s=o.link)||void 0===s?void 0:s.session)||void 0===a?void 0:a.outgoing)||void 0===l?void 0:l.available()),yield o.link.sendRequest(t,r)}catch(h){const f=rt(h);throw n.logError(f,"%s An error occurred during send on management request-response link with address '%s'",o.logPrefix,o.address),f}})()}close(){var t=this;return(0,ge.Z)(function*(){try{yield t.closeLink(),mn.verbose("Successfully closed the management session.")}catch(n){throw mn.logError(n,`${t.logPrefix} An error occurred while closing the management session`),n}})()}peek(t,n,r){var o=this;return(0,ge.Z)(function*(){return xt(o._context),o.peekBySequenceNumber(o._lastPeekedSequenceNumber.add(1),t,void 0,n,r)})()}peekMessagesBySession(t,n,r,o){var i=this;return(0,ge.Z)(function*(){return xt(i._context),i.peekBySequenceNumber(i._lastPeekedSequenceNumber.add(1),n,t,r,o)})()}peekBySequenceNumber(t,n,r,o,i){var s=this;return(0,ge.Z)(function*(){var a,l;xt(s._context);const h=s._context.connectionId;if(zn(h,"fromSequenceNumber",t),$h(h,"fromSequenceNumber",t),zn(s._context.connectionId,"maxMessageCount",n),ty(s._context.connectionId,"maxMessageCount",n,"number"),isNaN(n)||n<1)throw new TypeError(ey);const f=[];try{const v={};v[we.fromSequenceNumber]=je.V5.wrap_long(Gr.lW.from(t.toBytesBE())),v[we.messageCount]=je.V5.wrap_int(n),Dn(r)&&(v[we.sessionIdMapKey]=r),Dn(o)&&(v["omit-message-body"]=je.V5.wrap_boolean(o));const x=yield s.initWithUniqueReplyTo(i),W={body:v,reply_to:s.replyTo,application_properties:{operation:we.operations.peekMessage}};x?.associatedLinkName&&(W.application_properties[we.associatedLinkName]=x?.associatedLinkName),W.application_properties[we.trackingId]=(0,je.kE)(),Ie.verbose("%s Peek by sequence number request body: %O.",s.logPrefix,W.body);const ne=yield s._makeManagementRequest(W,Ie,x);if(204!==ne.application_properties.statusCode){const ae=ne.body.messages;for(const _e of ae){const ve=fM(je.yw.decode(_e.message),{skipParsingBodyAsJson:null!==(a=x?.skipParsingBodyAsJson)&&void 0!==a&&a,skipConvertingDate:null!==(l=x?.skipConvertingDate)&&void 0!==l&&l});f.push(ve),s._lastPeekedSequenceNumber=ve.sequenceNumber}}}catch(v){const x=rt(v);if(Ie.logError(x,`${s.logPrefix} An error occurred while sending the request to peek messages to $management endpoint`),x.code!==Oa["com.microsoft:message-not-found"])throw x}return f})()}renewLock(t,n){var r=this;return(0,ge.Z)(function*(){xt(r._context),n||(n={}),null==n.timeoutInMs&&(n.timeoutInMs=5e3);try{const o={};o[we.lockTokens]=je.V5.wrap_array([(0,je.Rg)(t)],152,void 0);const i=yield r.initWithUniqueReplyTo(n),s={body:o,reply_to:r.replyTo,application_properties:{operation:we.operations.renewLock}};s.application_properties[we.trackingId]=(0,je.kE)(),i.associatedLinkName&&(s.application_properties[we.associatedLinkName]=i.associatedLinkName),Ie.verbose("[%s] Renew message Lock request: %O.",r._context.connectionId,s);const a=yield r._makeManagementRequest(s,Ie,{abortSignal:i?.abortSignal,requestName:"renewLock"});return new Date(a.body.expirations[0])}catch(o){const i=rt(o);throw Ie.logError(i,`${r.logPrefix} An error occurred while sending the renew lock request to $management endpoint`),i}})()}scheduleMessages(t,n,r){var o=this;return(0,ge.Z)(function*(){var i;if(xt(o._context),!n.length)return[];const s=[];for(let l=0;l<n.length;l++){const h=n[l];try{const f=Y_(h,Bh);dM(f,f.message_id||(0,je.kE)()),hM(f,t);const v={message:je.yw.encode(f),"message-id":f.message_id};f.group_id&&(v[we.sessionIdMapKey]=f.group_id),null!==(i=f.message_annotations)&&void 0!==i&&i[we.partitionKey]&&(v["partition-key"]=f.message_annotations[we.partitionKey]);const x=je.V5.wrap_map(v);s.push(x)}catch(f){const v=rt(f);throw Ut.logError(v,`${o.logPrefix} An error occurred while encoding the item at position ${l} in the messages array`),v}}const a=yield o.initWithUniqueReplyTo(r);try{const l={body:{messages:s},reply_to:o.replyTo,application_properties:{operation:we.operations.scheduleMessage}};a?.associatedLinkName&&(l.application_properties[we.associatedLinkName]=a?.associatedLinkName),l.application_properties[we.trackingId]=(0,je.kE)(),Ut.verbose("%s Schedule messages request body: %O.",o.logPrefix,l.body);const f=(yield o._makeManagementRequest(l,Ut,a)).body[we.sequenceNumbers],v=[];for(let x=0;x<f.length;x++)v.push("number"==typeof f[x]?Ai.fromNumber(f[x]):Ai.fromBytesBE(f[x]));return v}catch(l){const h=rt(l);throw Ut.logError(h,`${o.logPrefix} An error occurred while sending the request to schedule messages to $management endpoint`),h}})()}cancelScheduledMessages(t,n){var r=this;return(0,ge.Z)(function*(){if(xt(r._context),!t.length)return;const o={};o[we.sequenceNumbers]=[];for(let i=0;i<t.length;i++){const s=t[i];try{o[we.sequenceNumbers].push(Gr.lW.from(s.toBytesBE()))}catch(a){const l=rt(a);throw Ut.logError(l,`${r.logPrefix} An error occurred while encoding the item at position ${i} in the sequenceNumbers array`),l}}try{o[we.sequenceNumbers]=je.V5.wrap_array(o[we.sequenceNumbers],129,void 0);const i=yield r.initWithUniqueReplyTo(n),s={body:o,reply_to:r.replyTo,application_properties:{operation:we.operations.cancelScheduledMessage}};return i?.associatedLinkName&&(s.application_properties[we.associatedLinkName]=i?.associatedLinkName),s.application_properties[we.trackingId]=(0,je.kE)(),Ut.verbose("%s Cancel scheduled messages request body: %O.",r.logPrefix,s.body),void(yield r._makeManagementRequest(s,Ut,i))}catch(i){const s=rt(i);throw Ut.logError(s,`${r.logPrefix} An error occurred while sending the request to cancel the scheduled message to $management endpoint`),s}})()}receiveDeferredMessages(t,n,r,o){var i=this;return(0,ge.Z)(function*(){var s;if(xt(i._context),!t.length)return[];const a=[],l={};l[we.sequenceNumbers]=[];for(let h=0;h<t.length;h++){const f=t[h];try{l[we.sequenceNumbers].push(Gr.lW.from(f.toBytesBE()))}catch(v){const x=rt(v);throw Ie.logError(x,`${i.logPrefix} An error occurred while encoding the item at position ${h} in the sequenceNumbers array`),x}}try{l[we.sequenceNumbers]=je.V5.wrap_array(l[we.sequenceNumbers],129,void 0),l[we.receiverSettleMode]=je.V5.wrap_uint("receiveAndDelete"===n?0:1),null!=r&&(l[we.sessionIdMapKey]=r);const f=yield i.initWithUniqueReplyTo(o),v={body:l,reply_to:i.replyTo,application_properties:{operation:we.operations.receiveBySequenceNumber}};f?.associatedLinkName&&(v.application_properties[we.associatedLinkName]=f?.associatedLinkName),v.application_properties[we.trackingId]=(0,je.kE)(),Ie.verbose("%s Receive deferred messages request body: %O.",i.logPrefix,v.body);const W=(yield i._makeManagementRequest(v,Ie,f)).body.messages;for(const ne of W){const ae=je.yw.decode(ne.message),_e=new Dl(ae,{tag:ne["lock-token"]},!1,n,null!==(s=f?.skipParsingBodyAsJson)&&void 0!==s&&s,!1);a.push(_e)}return a}catch(h){const f=rt(h);throw Ie.logError(f,`${i.logPrefix} An error occurred while sending the request to receive deferred messages to $management endpoint`),f}})()}updateDispositionStatus(t,n,r){var o=this;return(0,ge.Z)(function*(){xt(o._context),r||(r={});try{let i;if(n===Ln.abandon)i="abandoned";else if(n===Ln.complete)i="completed";else if(n===Ln.defer)i="defered";else{if(n!==Ln.deadletter)throw new Error(`Provided "dispositionType" - ${n} is invalid`);i="suspended"}const s={},a=[];a.push((0,je.Rg)(t)),s[we.lockTokens]=je.V5.wrap_array(a,152,void 0),s[we.dispositionStatus]=i,null!=r.deadLetterDescription&&(s[we.deadLetterDescription]=r.deadLetterDescription),null!=r.deadLetterReason&&(s[we.deadLetterReason]=r.deadLetterReason),null!=r.propertiesToModify&&(s[we.propertiesToModify]=r.propertiesToModify),null!=r.sessionId&&(s[we.sessionIdMapKey]=r.sessionId);const l=yield o.initWithUniqueReplyTo(r),h={body:s,reply_to:o.replyTo,application_properties:{operation:we.operations.updateDisposition}};l.associatedLinkName&&(h.application_properties[we.associatedLinkName]=l.associatedLinkName),h.application_properties[we.trackingId]=(0,je.kE)(),Ie.verbose("%s Update disposition status request body: %O.",o.logPrefix,h.body),yield o._makeManagementRequest(h,Ie,l)}catch(i){const s=rt(i);throw Ie.logError(s,`${o.logPrefix} An error occurred while sending the request to update disposition status to $management endpoint`),s}})()}renewSessionLock(t,n){var r=this;return(0,ge.Z)(function*(){xt(r._context);try{const o={};o[we.sessionIdMapKey]=t;const i=yield r.initWithUniqueReplyTo(n),s={body:o,reply_to:r.replyTo,application_properties:{operation:we.operations.renewSessionLock}};s.application_properties[we.trackingId]=(0,je.kE)(),i?.associatedLinkName&&(s.application_properties[we.associatedLinkName]=i?.associatedLinkName),Ie.verbose("%s Renew Session Lock request body: %O.",r.logPrefix,s.body);const a=yield r._makeManagementRequest(s,Ie,i),l=new Date(a.body.expiration);return Ie.verbose("%s Lock for session '%s' will expire at %s.",r.logPrefix,t,l.toString()),l}catch(o){const i=rt(o);throw Ie.logError(i,`${r.logPrefix} An error occurred while sending the renew lock request to $management endpoint`),i}})()}setSessionState(t,n,r){var o=this;return(0,ge.Z)(function*(){xt(o._context);try{const i={};i[we.sessionIdMapKey]=t,i["session-state"]=function O8(e){let t;if(Il.verbose("[utils.toBuffer] The given message body that needs to be converted to buffer is: ",e),q_()(e))t=e;else{void 0===e&&(e=null);try{const n=JSON.stringify(e);t=Gr.lW.from(n,"utf8")}catch(n){const r="An error occurred while executing JSON.stringify() on the given input "+e+`${n instanceof Error?n.stack:JSON.stringify(n)}`;throw Il.warning("[utils.toBuffer] "+r),n instanceof Error?n:new Error(r)}}return Il.verbose("[utils.toBuffer] The converted buffer is: %O.",t),t}(n);const s=yield o.initWithUniqueReplyTo(r),a={body:i,reply_to:o.replyTo,application_properties:{operation:we.operations.setSessionState}};s?.associatedLinkName&&(a.application_properties[we.associatedLinkName]=s?.associatedLinkName),a.application_properties[we.trackingId]=(0,je.kE)(),Ie.verbose("%s Set Session state request body: %O.",o.logPrefix,a.body),yield o._makeManagementRequest(a,Ie,s)}catch(i){const s=rt(i);throw Ie.logError(s,`${o.logPrefix} An error occurred while sending the renew lock request to $management endpoint`),s}})()}getSessionState(t,n){var r=this;return(0,ge.Z)(function*(){xt(r._context);try{const o={};o[we.sessionIdMapKey]=t;const i=yield r.initWithUniqueReplyTo(n),s={body:o,reply_to:r.replyTo,application_properties:{operation:we.operations.getSessionState}};i?.associatedLinkName&&(s.application_properties[we.associatedLinkName]=i?.associatedLinkName),s.application_properties[we.trackingId]=(0,je.kE)(),Ie.verbose("%s Get session state request body: %O.",r.logPrefix,s.body);const a=yield r._makeManagementRequest(s,Ie,i);return a.body["session-state"]?jh(a.body["session-state"]):a.body["session-state"]}catch(o){const i=rt(o);throw Ie.logError(i,`${r.logPrefix} An error occurred while sending the renew lock request to $management endpoint`),i}})()}listMessageSessions(t,n,r,o){var i=this;return(0,ge.Z)(function*(){if(xt(i._context),"number"!=typeof t)throw new Error("'skip' is a required parameter and must be of type 'number'.");if("number"!=typeof n)throw new Error("'top' is a required parameter and must be of type 'number'.");if(r&&!(r instanceof Date))throw new Error("'lastUpdatedTime' must be of type 'Date'.");r||(r=new Date(Date.now()-2592e5));try{const a={};a["last-updated-time"]=r,a.skip=je.V5.wrap_int(t),a.top=je.V5.wrap_int(n);const l=yield i.initWithUniqueReplyTo(o),h={body:a,reply_to:i.replyTo,application_properties:{operation:we.operations.enumerateSessions}};h.application_properties[we.trackingId]=(0,je.kE)(),mn.verbose("%s List sessions request body: %O.",i.logPrefix,h.body);const f=yield i._makeManagementRequest(h,mn,l);return f&&f.body&&f.body["sessions-ids"]||[]}catch(a){const l=rt(a);throw mn.logError(l,`${i.logPrefix} An error occurred while sending the renew lock request to $management endpoint`),l}})()}getRules(t){var n=this;return(0,ge.Z)(function*(){xt(n._context);try{const r=yield n.initWithUniqueReplyTo(t),o={body:{top:je.V5.wrap_int(r?.maxCount?r.maxCount:h8),skip:je.V5.wrap_int(r?.skip?r.skip:0)},reply_to:n.replyTo,application_properties:{operation:we.operations.enumerateRules}};o.application_properties[we.trackingId]=(0,je.kE)(),mn.verbose("%s Get rules request body: %O.",n.logPrefix,o.body);const i=yield n._makeManagementRequest(o,mn,r);if(204===i.application_properties.statusCode||!i.body||!Array.isArray(i.body.rules))return[];const a=[];return(i.body.rules||[]).forEach(l=>{const h=l["rule-description"];let f;if(!h||!h.descriptor||h.descriptor.value!==we.descriptorCodes.ruleDescriptionList||!Array.isArray(h.value)||h.value.length<3)return;const v=h.value[0],x=h.value[1];let W;switch(W=x.descriptor.value===we.descriptorCodes.sqlRuleActionList&&Array.isArray(x.value)&&x.value.length?{sqlExpression:n._safelyGetTypedValueFromArray(x.value,0)}:{},v.descriptor.value){case we.descriptorCodes.trueFilterList:f={sqlExpression:"1=1"};break;case we.descriptorCodes.falseFilterList:f={sqlExpression:"1=0"};break;case we.descriptorCodes.sqlFilterList:f={sqlExpression:n._safelyGetTypedValueFromArray(v.value,0)};break;case we.descriptorCodes.correlationFilterList:f={correlationId:n._safelyGetTypedValueFromArray(v.value,0),messageId:n._safelyGetTypedValueFromArray(v.value,1),to:n._safelyGetTypedValueFromArray(v.value,2),replyTo:n._safelyGetTypedValueFromArray(v.value,3),subject:n._safelyGetTypedValueFromArray(v.value,4),sessionId:n._safelyGetTypedValueFromArray(v.value,5),replyToSessionId:n._safelyGetTypedValueFromArray(v.value,6),contentType:n._safelyGetTypedValueFromArray(v.value,7),applicationProperties:Array.isArray(v.value)&&v.value.length>8&&v.value[8]?n._decodeApplicationPropertiesMap(v.value[8]):void 0};break;default:throw new Error(`${n.logPrefix} Found unexpected descriptor code for the filter: ${v.descriptor.value}`)}a.push({name:h.value[2].value,filter:f,action:W})}),a}catch(r){const o=rt(r);throw mn.logError(o,`${n.logPrefix} An error occurred while sending the get rules request to $management endpoint`),o}})()}removeRule(t,n){var r=this;return(0,ge.Z)(function*(){xt(r._context),zn(r._context.connectionId,"ruleName",t),t=String(t),mM(r._context.connectionId,"ruleName",t);try{const o=yield r.initWithUniqueReplyTo(n),i={body:{"rule-name":je.V5.wrap_string(t)},reply_to:r.replyTo,application_properties:{operation:we.operations.removeRule}};i.application_properties[we.trackingId]=(0,je.kE)(),mn.verbose("%s Remove Rule request body: %O.",r.logPrefix,i.body),yield r._makeManagementRequest(i,mn,o)}catch(o){const i=rt(o);throw mn.logError(i,`${r.logPrefix} An error occurred while sending the remove rule request to $management endpoint`),i}})()}addRule(t,n,r,o){var i=this;return(0,ge.Z)(function*(){if(xt(i._context),zn(i._context.connectionId,"ruleName",t),t=String(t),mM(i._context.connectionId,"ruleName",t),zn(i._context.connectionId,"filter",n),!_M(n)&&!function r6(e){return!!e&&n6.some(t=>xr(e,[t]))}(n))throw new TypeError('The parameter "filter" should implement either the SqlRuleFilter or the CorrelationRuleFilter interface.');try{const s={};_M(n)?s["sql-filter"]={expression:n.sqlExpression}:s["correlation-filter"]={"correlation-id":n.correlationId,"message-id":n.messageId,to:n.to,"reply-to":n.replyTo,label:n.subject,"session-id":n.sessionId,"reply-to-session-id":n.replyToSessionId,"content-type":n.contentType,properties:n.applicationProperties},void 0!==r&&(s["sql-rule-action"]={expression:String(r)});const a=yield i.initWithUniqueReplyTo(o),l={body:{"rule-name":je.V5.wrap_string(t),"rule-description":je.V5.wrap_map(s)},reply_to:i.replyTo,application_properties:{operation:we.operations.addRule}};l.application_properties[we.trackingId]=(0,je.kE)(),mn.verbose("%s Add Rule request body: %O.",i.logPrefix,l.body),yield i._makeManagementRequest(l,mn,a)}catch(s){const a=rt(s);throw mn.logError(a,`${i.logPrefix} An error occurred while sending the Add rule request to $management endpoint`),a}})()}removeLinkFromContext(){delete this._context.managementClients[this.name]}}function yM(e,t,n){return ry.apply(this,arguments)}function ry(){return ry=(0,ge.Z)(function*(e,t,n){const r=[];for(const o of Object.keys(e.messageReceivers)){const i=e.messageReceivers[o];i&&i.receiverType===n&&(Dt.verbose("[%s] calling detached on %s receiver '%s'.",e.connection.id,i.receiverType,i.name),r.push(i.onDetached(t).catch(s=>{Dt.logError(s,"[%s] An error occurred while calling onDetached() on the %s receiver '%s'",e.connection.id,i.receiverType,i.name)})))}return Promise.all(r)}),ry.apply(this,arguments)}function oy(){return oy=(0,ge.Z)(function*(e,t){const n=(o,i)=>{const s=`The receiver for session "${o}" in "${i}" has been closed and can no longer be used. Please create a new receiver using the "acceptSession" or "acceptNextSession" method on the ServiceBusClient.`,l=new co(null==t?"Unknown error occurred on the AMQP connection while receiving messages. "+s:"Error occurred on the AMQP connection while receiving messages. "+s+`\nMore info - \n${t}`,"SessionLockLost");return l.retryable=!1,l},r=[];for(const o of Object.keys(e.messageSessions)){const i=e.messageSessions[o];Dt.verbose("[%s] calling detached on %s receiver(sessions).",e.connection.id,i.name),r.push(i.onDetached(n(i.sessionId,i.entityPath)).catch(s=>{Dt.logError(s,"[%s] An error occurred while calling onDetached() on the session receiver(sessions) '%s'",e.connection.id,i.name)}))}return Promise.all(r)}),oy.apply(this,arguments)}function iy(e,t){if("session"===t)return Object.keys(e.messageSessions).length;const n=e.messageReceivers;return Object.keys(n).reduce((i,s)=>n[s].receiverType===t?++i:i,0)}var zh;function vM(e,t,n){var r,o;const i=LD.create(e);return i.webSocket=null===(r=n?.webSocketOptions)||void 0===r?void 0:r.webSocket,i.webSocketEndpointPath="$servicebus/websocket",i.webSocketConstructorOptions=null===(o=n?.webSocketOptions)||void 0===o?void 0:o.webSocketConstructorOptions,n?.customEndpointAddress&&function l6(e,t){e.amqpHostname=e.host;const{hostname:n,port:r}=function c6(e){const t=e.match(/.*:\/\/([^/]*)/);if(!t)throw new TypeError(`Invalid endpoint missing host: ${e}`);const[,n]=t,[r,o]=n.split(":");return{host:n,hostname:r,port:o}}(t);e.host=n,r&&(e.port=parseInt(r,10))}(i,n.customEndpointAddress),zh.create(i,t,n)}function CM(e,t,n){if(t){const r=t.id,o=t.remote_state,i=t.remote_settled;if(Ie.verbose("%s Delivery with id %d, remote_settled: %s, remote_state: %o has been received.",e,r,i,o&&o.error?o.error:o),i&&n.has(r)){const s=n.get(r);clearTimeout(s.timer),Ie.verbose("%s Found the delivery with id %d in the map and cleared the timer.",e,r);const a=n.delete(r);if(Ie.verbose("%s Successfully deleted the delivery with id %d from the map.",e,r,a),o&&o.error&&(o.error.condition||o.error.description)){const l=rt(o.error);return s.reject(l)}return s.resolve()}}}!function(e){function r(){return(r=(0,ge.Z)(function*(o){const i=`[${o.connectionId}]`;try{Dt.verbose(`${i} Permanently closing the amqp connection on the client.`);const s=Object.keys(o.senders),a=Object.keys(o.messageReceivers),l=Object.keys(o.messageSessions),h=Object.keys(o.managementClients);Dt.verbose(`${i} Permanently closing all the senders(${s.length}), MessageReceivers(${a.length}), MessageSessions(${l.length}), and ManagementClients(${h.length}).`),yield Promise.all([...s.map(f=>o.senders[f].close()),...a.map(f=>o.messageReceivers[f].close()),...l.map(f=>o.messageSessions[f].close()),...h.map(f=>o.managementClients[f].close())]),Dt.verbose(`${i} Permanently closing cbsSession`),yield o.cbsSession.close(),Dt.verbose(`${i} Permanently closing internal connection`),yield o.connection.close(),o.wasConnectionCloseCalled=!0,Dt.verbose(`[${i} Permanently closed the amqp connection on the client.`)}catch(s){const a=s instanceof Error?s:new Error(JSON.stringify(s));throw Dt.logError(s,`${i} An error occurred while closing the connection`),a}})).apply(this,arguments)}e.create=function t(o,i,s){var a;s||(s={});const l=`${function $8(e){let t=`${(e||"").replace(" ","")}`;return t=t.length>0?t+" ":"",`${t}azsdk-js-azureservicebus/7.9.3`}(null===(a=s.userAgentOptions)||void 0===a?void 0:a.userAgentPrefix)} ${function i6(){const e=self.navigator;return`OS/${(e.oscpu||e.platform).replace(" ","")}`}()}`,f=S8.create({config:o,isEntityPathRequired:!1,connectionProperties:{product:"MSJSClient",userAgent:l,version:"7.9.3"}});let v,x;f.tokenCredential=i,f.senders={},f.messageReceivers={},f.messageSessions={},f.managementClients={},Object.assign(f,{isConnectionClosing(){return!(this.connection.isOpen()||!this.connection.isRemoteOpen())},readyToOpenLink(){var et=this;return(0,ge.Z)(function*(){Dt.verbose(`[${et.connectionId}] Waiting until the connection is ready to open link.`),et.isConnectionClosing()&&(Dt.verbose(`[${et.connectionId}] Connection is closing, waiting for disconnected event`),yield et.waitForDisconnectedEvent()),yield et.waitForConnectionReset(),Dt.verbose(`[${et.connectionId}] Connection is ready to open link.`)})()},waitForDisconnectedEvent(){return new Promise(et=>{Dt.verbose(`[${this.connectionId}] Attempting to reinitialize connection but the connection is in the process of closing. Waiting for the disconnect event before continuing.`),this.connection.once(je.h2.disconnected,et)})},waitForConnectionReset(){return x?(Dt.verbose(`[${this.connectionId}] Waiting for connection reset`),x):(Dt.verbose(`[${this.connectionId}] Connection not waiting to be reset. Resolving immediately.`),Promise.resolve())},getReceiverFromCache(et,Ct){if(null!=Ct&&this.messageSessions[et])return this.messageSessions[et];if(this.messageReceivers[et])return this.messageReceivers[et];let Ht="";if(null!=Ct){for(const lr of Object.keys(this.messageSessions))if(this.messageSessions[lr].sessionId===Ct){Ht=this.messageSessions[lr].name;break}}else Ht+=(Ht?", ":"")+Object.keys(this.messageReceivers).join(",");Dt.verbose("[%s] Failed to find receiver '%s' among existing receivers: %s",this.connectionId,et,Ht)},getManagementClient(et){return this.managementClients[et]||(this.managementClients[et]=new o6(this,et,{address:`${et}/$management`})),this.managementClients[et]}});const W=()=>{f.wasConnectionCloseCalled=!1,Dt.verbose("[%s] setting 'wasConnectionCloseCalled' property of connection context to %s.",f.connection.id,f.wasConnectionCloseCalled)},ne=function(){var et=(0,ge.Z)(function*(Ct){if(x)return;x=new Promise(Ua=>{v=Ua});const Ht=Ct.connection&&Ct.connection.error?Ct.connection.error:void 0;Ht&&Dt.logError(Ht,"[%s] Error (context.connection.error) occurred on the amqp connection",f.connection.id);const lr=Ct.error;lr&&Dt.logError(lr,"[%s] Error (context.error) occurred on the amqp connection",f.connection.id);const ds={wasConnectionCloseCalled:f.wasConnectionCloseCalled,numSenders:Object.keys(f.senders).length,numReceivers:Object.keys(f.messageReceivers).length+Object.keys(f.messageSessions).length};f.connection.removeAllSessions(),yield f.cbsSession.close();for(const Ua of Object.keys(f.managementClients))yield f.managementClients[Ua].close();if(!ds.wasConnectionCloseCalled){if(ds.numSenders){Dt.verbose(`[${f.connection.id}] connection.close() was not called from the sdk and there were ${ds.numSenders} senders. We should not reconnect.`);const qR=[];for(const lq of Object.keys(f.senders)){const df=f.senders[lq];df&&(Dt.verbose("[%s] calling detached on sender '%s'.",f.connection.id,df.name),qR.push(df.onDetached().catch(uq=>{Dt.logError(uq,"[%s] An error occurred while calling onDetached() the sender '%s'",f.connection.id,df.name)})))}yield Promise.all(qR)}const Ua=iy(f,"batching");Ua&&(Dt.verbose(`[${f.connection.id}] connection.close() was not called from the sdk and there were ${Ua} batching receivers. We should not reconnect.`),yield yM(f,Ht||lr,"batching"));const GR=iy(f,"session");GR&&(Dt.verbose(`[${f.connection.id}] connection.close() was not called from the sdk and there were ${GR} session receivers. We should close them.`),yield function s6(e,t){return oy.apply(this,arguments)}(f,Ht||lr))}yield function Ae(){return ve.apply(this,arguments)}(),v(),x=void 0,Dt.verbose("[%s] state: %O",f.connectionId,ds);const uf=iy(f,"streaming");!ds.wasConnectionCloseCalled&&uf&&(Dt.verbose(`[${f.connection.id}] connection.close() was not called from the sdk and there were ${uf} streaming receivers. We should reconnect.`),yield yM(f,Ht||lr,"streaming"))});return function(Ht){return et.apply(this,arguments)}}(),ae=function(){var et=(0,ge.Z)(function*(Ct){Ct.connection&&Ct.connection.error&&Dt.logError(Ct.connection.error,"[%s] Error (context.connection.error) occurred on the amqp connection",f.connection.id),Ct.error&&Dt.logError(Ct.error,"[%s] Error (context.error) occurred on the amqp connection",f.connection.id)});return function(Ht){return et.apply(this,arguments)}}(),_e=function(){var et=(0,ge.Z)(function*(Ct){Ct.connection&&Ct.connection.error&&Dt.logError(Ct.connection.error,"[%s] Error (context.connection.error) occurred on the amqp connection",f.connection.id),Ct.error&&Dt.logError(Ct.error,"[%s] Error (context.error) occurred on the amqp connection",f.connection.id)});return function(Ht){return et.apply(this,arguments)}}();function ve(){return ve=(0,ge.Z)(function*(){const et=f.connectionId;try{yield function We(){return Qe.apply(this,arguments)}()}catch(Ct){Dt.logError(Ct,`[${f.connectionId}] There was an error closing the connection before reconnecting`)}f.refreshConnection(),Ue(f.connection),Dt.verbose(`The connection "${et}" has been updated to "${f.connectionId}".`)}),ve.apply(this,arguments)}function Ue(et){et.on(je.h2.connectionOpen,W),et.on(je.h2.disconnected,ne),et.on(je.h2.protocolError,ae),et.on(je.h2.error,_e)}function Qe(){return(Qe=(0,ge.Z)(function*(){f.connection.removeListener(je.h2.connectionOpen,W),f.connection.removeListener(je.h2.disconnected,ne),f.connection.removeListener(je.h2.protocolError,ae),f.connection.removeListener(je.h2.error,_e),yield f.connection.close()})).apply(this,arguments)}return Ue(f.connection),Dt.verbose("[%s] Created connection context successfully.",f.connectionId),f},e.close=function n(o){return r.apply(this,arguments)}}(zh||(zh={}));const h6=`${we.vendorString}:timeout`;function EM(e,t,n,r,o,i){return Object.assign({name:e,autoaccept:"receiveAndDelete"===t,rcv_settle_mode:"receiveAndDelete"===t?0:1,snd_settle_mode:"receiveAndDelete"===t?1:0,source:n,target:r,credit_window:0,properties:void 0!==i?{[we.receiverIdentifierName]:r,[h6]:i}:{[we.receiverIdentifierName]:r}},o)}class wM extends Hh{constructor(t,n,r,o,i){super(r,r,n,o,Ie,{address:r,audience:`${n.config.endpoint}${r}`}),this.identifier=t,this._deliveryDispositionMap=new Map,this.receiverType=o,this.receiveMode=i.receiveMode||"peekLock",this.autoComplete=!1!==i.autoCompleteMessages||i.autoCompleteMessages,this._lockRenewer=i.lockRenewer}_createReceiverOptions(t,n){return EM(t?Tl(this.baseName):this.name,this.receiveMode,{address:this.address},this.identifier,Object.assign({onSettled:o=>CM(this.logPrefix,o.delivery,this._deliveryDispositionMap)},n))}_init(t,n){var r=this;return(0,ge.Z)(function*(){try{yield r.initLink(t,n),r._context.messageReceivers[r.name]=r}catch(o){const i=rt(o);throw Ie.logError(i,"%s An error occured while creating the receiver",r.logPrefix),"OperationTimeoutError"===i.code&&(i.message="Failed to create a receiver within allocated time and retry attempts."),i}})()}createRheaLink(t,n){return this._context.connection.createReceiver(t)}close(){var t=()=>super.close,n=this;return(0,ge.Z)(function*(){var r;null===(r=n._lockRenewer)||void 0===r||r.stopAll(n),yield t().call(n)})()}settleMessage(t,n,r){var o=this;return(0,ge.Z)(function*(){return new Promise((i,s)=>{var a,l,h;if(null==n.match(/^(complete|abandon|defer|deadletter)$/))return s(new Error(`operation: '${n}' is not a valid operation.`));null===(a=o._lockRenewer)||void 0===a||a.stop(o,t);const f=t.delivery,v=setTimeout(()=>(o._deliveryDispositionMap.delete(f.id),Ie.verbose("%s Disposition for delivery id: %d, did not complete in %d milliseconds. Hence rejecting the promise with timeout error.",o.logPrefix,f.id,we.defaultOperationTimeoutInMs),s(rt({condition:Mo.ServiceUnavailableError,description:"Operation to settle the message has timed out. The disposition of the message may or may not be successful"}))),null!==(h=null===(l=r.retryOptions)||void 0===l?void 0:l.timeoutInMs)&&void 0!==h?h:we.defaultOperationTimeoutInMs);if(o._deliveryDispositionMap.set(f.id,{resolve:i,reject:s,timer:v}),n===Ln.complete)f.accept();else if(n===Ln.abandon){const x={undeliverable_here:!1};r.propertiesToModify&&(x.message_annotations=r.propertiesToModify),f.modified(x)}else if(n===Ln.defer){const x={undeliverable_here:!0};r.propertiesToModify&&(x.message_annotations=r.propertiesToModify),f.modified(x)}else if(n===Ln.deadletter){const x={condition:we.deadLetterName,info:Object.assign(Object.assign({},r.propertiesToModify),{DeadLetterReason:r.deadLetterReason,DeadLetterErrorDescription:r.deadLetterDescription})};f.reject(x)}})})()}}class bM{constructor(t){this._getCurrentReceiver=t,this._isSuspended=!0}_getCurrentReceiverOrError(){const t=this._getCurrentReceiver();return null==t.receiver?"is undefined":t.receiver.isOpen()?this._isSuspended?"is suspended":t:"is not open"}addCredit(t){const n=this._getCurrentReceiverOrError();if("string"==typeof n){const r=`Cannot request messages on the receiver since it ${n}.`;throw"is suspended"===n?new sr(r):new co(r,"GeneralError")}null!=n.receiver&&(Ie.verbose(`${n.logPrefix} Adding ${t} credits`),n.receiver.addCredit(t))}suspend(){var t=this;return(0,ge.Z)(function*(){const{receiver:n,logPrefix:r}=t._getCurrentReceiver();if(t._isSuspended=!0,t._isValidReceiver(n))return Ie.verbose(`${r} User has requested to stop receiving new messages, attempting to drain.`),t.drain()})()}resume(){this._isSuspended=!1}isSuspended(){return this._isSuspended}drain(){var t=this;return(0,ge.Z)(function*(){const{receiver:n,logPrefix:r}=t._getCurrentReceiver();return t._isValidReceiver(n)&&0!==n.credit?(Ie.verbose(`${r} Receiver is starting drain. Remaining credits; ${n.credit}`),new Promise(i=>{const s=setTimeout((0,ge.Z)(function*(){Ie.warning(`${r} Time out when draining credits in suspend().`),yield n?.close(),i()}),200);n.once(je.cz.receiverDrained,()=>{Ie.verbose(`${r} Receiver has been drained.`),n.drain=!1,clearTimeout(s),i()}),n.drainCredit()})):void 0})()}_isValidReceiver(t){return null!=t&&t.isOpen()}}function p6(e){let t=!1;return e&&"number"==typeof e.id&&"boolean"==typeof e.settled&&"boolean"==typeof e.remote_settled&&"number"==typeof e.format&&(t=!0),t}var Ml=function(e){return e[e.Exponential=0]="Exponential",e[e.Fixed=1]="Fixed",e}(Ml||{}),Sn=function(e){return e.cbsAuth="cbsAuth",e.connection="connection",e.management="management",e.receiverLink="receiverLink",e.senderLink="senderLink",e.sendMessage="sendMessage",e.receiveMessage="receiveMessage",e.session="session",e.messageSettlement="settlement",e}(Sn||{});function m6(e,t,n,r){if(r===Ml.Exponential){const i=(.8*t+Math.floor(Math.random()*(1.2*t-.8*t)))*(Math.pow(2,e)-1);return Math.min(i,n)}return t}function Mn(e){return sy.apply(this,arguments)}function sy(){return sy=(0,ge.Z)(function*(e){!function g6(e){if(!e.operation)throw new TypeError("Missing 'operation' in retry configuration");if(!e.connectionId)throw new TypeError("Missing 'connectionId' in retry configuration");if(!e.operationType)throw new TypeError("Missing 'operationType' in retry configuration")}(e);const t=Object.assign({},e);t.retryOptions||(t.retryOptions={}),(null==t.retryOptions.maxRetries||t.retryOptions.maxRetries<0)&&(t.retryOptions.maxRetries=we.defaultMaxRetries),(null==t.retryOptions.retryDelayInMs||t.retryOptions.retryDelayInMs<0)&&(t.retryOptions.retryDelayInMs=we.defaultDelayBetweenOperationRetriesInMs),(null==t.retryOptions.maxRetryDelayInMs||t.retryOptions.maxRetryDelayInMs<0)&&(t.retryOptions.maxRetryDelayInMs=we.defaultMaxDelayForExponentialRetryInMs),null==t.retryOptions.mode&&(t.retryOptions.mode=Ml.Fixed);let n,r,o=!1;const i=t.retryOptions.maxRetries+1;for(let s=1;s<=i;s++){It.verbose("[%s] Attempt number for '%s': %d.",t.connectionId,t.operationType,s);try{r=yield t.operation(),o=!0,It.verbose("[%s] Success for '%s', after attempt number: %d.",t.connectionId,t.operationType,s),r&&!p6(r)&&It.verbose("[%s] Success result for '%s': %O",t.connectionId,t.operationType,r);break}catch(a){const l=Ti(a);if(!l.retryable&&"ServiceCommunicationError"===l.name&&t.connectionHost&&((yield Promise.resolve(self.navigator.onLine))||(l.name="ConnectionLostError",l.retryable=!0)),It.verbose("[%s] Error occurred for '%s' in attempt number %d: %O",t.connectionId,t.operationType,s,l),n=l,n.retryable&&i>s){const h=m6(s,t.retryOptions.retryDelayInMs,t.retryOptions.maxRetryDelayInMs,t.retryOptions.mode);It.verbose("[%s] Sleeping for %d milliseconds for '%s'.",t.connectionId,h,t.operationType),yield bl(h,{abortSignal:t.abortSignal,abortErrorMsg:"The retry operation has been cancelled by the user."});continue}break}}if(o)return r;throw n}),sy.apply(this,arguments)}const Rl={span:Symbol.for("@azure/core-tracing span"),namespace:Symbol.for("@azure/core-tracing namespace")};function _6(e={}){let t=new Ol(e.parentContext);return e.span&&(t=t.setValue(Rl.span,e.span)),e.namespace&&(t=t.setValue(Rl.namespace,e.namespace)),t}class Ol{constructor(t){this._contextMap=t instanceof Ol?new Map(t._contextMap):new Map}setValue(t,n){const r=new Ol(this);return r._contextMap.set(t,n),r}getValue(t){return this._contextMap.get(t)}deleteValue(t){const n=new Ol(this);return n._contextMap.delete(t),n}}let Gh;function qh(){return Gh||(Gh=function v6(){return{createRequestHeaders:()=>({}),parseTraceparentHeader:()=>{},startSpan:(e,t)=>({span:{end:()=>{},isRecording:()=>!1,recordException:()=>{},setAttribute:()=>{},setStatus:()=>{}},tracingContext:_6({parentContext:t.tracingContext})}),withContext:(e,t,...n)=>t(...n)}}()),Gh}const Tn=function C6(e){const{namespace:t,packageName:n,packageVersion:r}=e;function o(f,v,x){var W;const ne=qh().startSpan(f,Object.assign(Object.assign({},x),{packageName:n,packageVersion:r,tracingContext:null===(W=v?.tracingOptions)||void 0===W?void 0:W.tracingContext}));let ae=ne.tracingContext;const _e=ne.span;return ae.getValue(Rl.namespace)||(ae=ae.setValue(Rl.namespace,t)),_e.setAttribute("az.namespace",ae.getValue(Rl.namespace)),{span:_e,updatedOptions:Object.assign({},v,{tracingOptions:Object.assign(Object.assign({},v?.tracingOptions),{tracingContext:ae})})}}function s(){return(s=(0,ge.Z)(function*(f,v,x,W){const{span:ne,updatedOptions:ae}=o(f,v,W);try{const _e=yield a(ae.tracingOptions.tracingContext,()=>Promise.resolve(x(ae,ne)));return ne.setStatus({status:"success"}),_e}catch(_e){throw ne.setStatus({status:"error",error:_e}),_e}finally{ne.end()}})).apply(this,arguments)}function a(f,v,...x){return qh().withContext(f,v,...x)}return{startSpan:o,withSpan:function i(f,v,x,W){return s.apply(this,arguments)},withContext:a,parseTraceparentHeader:function l(f){return qh().parseTraceparentHeader(f)},createRequestHeaders:function h(f){return qh().createRequestHeaders(f)}}}({namespace:"Microsoft.ServiceBus",packageName:"@azure/service-bus",packageVersion:"7.9.3"});function Xo(e,t,n){const o={spanAttributes:{"messaging.system":"servicebus",["process"===t||"receive"===t?"messaging.source.name":"messaging.destination.name"]:e.entityPath,"messaging.operation":t,"net.peer.name":e.host}};return n&&(o.spanKind=n),o}const Kh="Diagnostic-Id";function IM(e,t,n,r,o){var i,s,a;if(null!==(i=e.applicationProperties)&&void 0!==i&&i[Kh])return{message:e,spanContext:void 0};const{span:h,updatedOptions:f}=Tn.startSpan("message",t,Xo({entityPath:n,host:r},o,"producer"));try{if(!h.isRecording())return{message:e,spanContext:void 0};const v=Tn.createRequestHeaders(null===(s=f.tracingOptions)||void 0===s?void 0:s.tracingContext).traceparent;return v&&(e=Object.assign(Object.assign({},e),{applicationProperties:Object.assign(Object.assign({},e.applicationProperties),{[Kh]:v})})),{message:e,spanContext:null===(a=f.tracingOptions)||void 0===a?void 0:a.tracingContext}}finally{h.end()}}function xa(e){if(e.applicationProperties&&e.applicationProperties[Kh])return Tn.parseTraceparentHeader(e.applicationProperties[Kh])}function ay(e,t,n,r){var o;const i=[];for(const s of function*E6(e){if(Array.isArray(e))for(const t of e)yield t;else yield e}(e)){const a=xa(s);a&&i.push({tracingContext:a,attributes:{enqueuedTime:null===(o=s.enqueuedTimeUtc)||void 0===o?void 0:o.getTime()}})}return Object.assign({spanLinks:i,spanKind:"consumer"},Xo({host:n.host,entityPath:t.entityPath},r))}function SM(e){if(!(e&&e.processMessage instanceof Function&&e.processError instanceof Function))throw new TypeError('Invalid "MessageHandlers" provided.')}function TM(e,t){return(0,xe.__asyncGenerator)(this,arguments,function*(){for(;;){const r=yield(0,xe.__await)(e.receiveMessages(1,t));0!==r.length&&(yield yield(0,xe.__await)(r[0]))}})}function Wh(e,t,n,r){Ie.verbose("[%s] Completing the message with id '%s'.",t.connectionId,e.messageId);const o=xa(e);return Tn.withSpan("ServicebusReceiver.complete",{},()=>Yh(e,Ln.complete,t,n,{retryOptions:r}),Object.assign({spanLinks:o?[{tracingContext:o}]:[]},Xo({entityPath:n,host:t.config.host},"settle","client")))}function Zh(e,t,n,r,o){Ie.verbose("[%s] Abandoning the message with id '%s'.",t.connectionId,e.messageId);const i=xa(e);return Tn.withSpan("ServicebusReceiver.abandon",{},()=>Yh(e,Ln.abandon,t,n,{propertiesToModify:r,retryOptions:o}),Object.assign({spanLinks:i?[{tracingContext:i}]:[]},Xo({entityPath:n,host:t.config.host},"settle","client")))}function AM(e,t,n,r,o){Ie.verbose("[%s] Deferring the message with id '%s'.",t.connectionId,e.messageId);const i=xa(e);return Tn.withSpan("ServiceBusReceiver.defer",{},()=>Yh(e,Ln.defer,t,n,{retryOptions:o,propertiesToModify:r}),Object.assign({spanLinks:i?[{tracingContext:i}]:[]},Xo({entityPath:n,host:t.config.host},"settle","client")))}function DM(e,t,n,r,o){Ie.verbose("[%s] Deadlettering the message with id '%s'.",t.connectionId,e.messageId);const i=Object.assign({},r);delete i.deadLetterErrorDescription,delete i.deadLetterReason;const s={propertiesToModify:i,deadLetterReason:r?.deadLetterReason,deadLetterDescription:r?.deadLetterErrorDescription,retryOptions:o},a=xa(e);return Tn.withSpan("ServiceBusReceiver.deadLetter",{},()=>Yh(e,Ln.deadletter,t,n,s),Object.assign({spanLinks:a?[{tracingContext:a}]:[]},Xo({entityPath:n,host:t.config.host},"settle","client")))}function Yh(e,t,n,r,o,i=b6){return Mn({connectionId:n.connectionId,operation:()=>i(e,t,n,r,o),operationType:Sn.messageSettlement,abortSignal:o?.abortSignal,retryOptions:o?.retryOptions})}function b6(e,t,n,r,o){return cy.apply(this,arguments)}function cy(){return cy=(0,ge.Z)(function*(e,t,n,r,o){const i=!e.delivery.link,s=i?void 0:n.getReceiverFromCache(e.delivery.link.name,e.sessionId),a=s?.name;let l;if(e.delivery.remote_settled?l=new Error(J8):!i&&(!s||!s.isOpen())&&Dn(e.sessionId)&&(l=rt({description:`Failed to ${t} the message as the AMQP link with which the message was received is no longer alive.`,condition:Mo.SessionLockLostError})),l)throw Ie.logError(l,"[%s] An error occurred when settling a message with id '%s'",n.connectionId,e.messageId),l;return!i&&(s&&s.isOpen()||Dn(e.sessionId))?s.settleMessage(e,t,o).catch(h=>{throw rt(h)}):n.getManagementClient(r).updateDispositionStatus(e.lockToken,t,Object.assign(Object.assign({},o),{associatedLinkName:a,sessionId:e.sessionId})).catch(h=>{throw rt(h)})}),cy.apply(this,arguments)}function I6(e,t,n,r){if(r===Ml.Exponential){const i=(.8*t+Math.floor(Math.random()*(1.2*t-.8*t)))*(Math.pow(2,e)-1);return Math.min(i,n)}return t}function S6(e){return ly.apply(this,arguments)}function ly(){return ly=(0,ge.Z)(function*(e,t=Mn){let n=0;const r=e.retryConfig;for(r.retryOptions||(r.retryOptions={}),(null==r.retryOptions.retryDelayInMs||r.retryOptions.retryDelayInMs<0)&&(r.retryOptions.retryDelayInMs=we.defaultDelayBetweenOperationRetriesInMs),(null==r.retryOptions.maxRetryDelayInMs||r.retryOptions.maxRetryDelayInMs<0)&&(r.retryOptions.maxRetryDelayInMs=we.defaultMaxDelayForExponentialRetryInMs),r.retryOptions.mode||(r.retryOptions.mode=Ml.Fixed);;){++n;try{return yield t(e.retryConfig)}catch(o){if("AbortError"===o.name)throw ar.warning(`${e.logPrefix} AbortError caught, ending retries.`),o;try{e.onError(o)}catch(s){ar.error("args.onerror has thrown",s)}e.logger.logError(o,`${e.logPrefix} Error thrown in retry cycle ${n}, restarting retry cycle with retry options`,e.retryConfig);const i=I6(n,r.retryOptions.retryDelayInMs,r.retryOptions.maxRetryDelayInMs,r.retryOptions.mode);ar.verbose("[%s] Sleeping for %d milliseconds for '%s'.",r.connectionId,i,r.operationType),yield bl(i,{abortSignal:r.abortSignal,abortErrorMsg:"Retry cycle has been cancelled by the user."});continue}}}),ly.apply(this,arguments)}class T6 extends wM{get isSubscribeActive(){return!this._receiverHelper.isSuspended()}constructor(t,n,r,o){var i;super(t,n,r,"streaming",o),i=this,this.maxConcurrentCalls=1,this._isDetaching=!1,this._messageHandlers=()=>{throw new Error("messageHandlers are not set.")},this._retryForeverFn=S6,"number"==typeof o?.maxConcurrentCalls&&o?.maxConcurrentCalls>0&&(this.maxConcurrentCalls=o.maxConcurrentCalls),this._retryOptions=o?.retryOptions||{},this._receiverHelper=new bM(()=>({receiver:this.link,logPrefix:this.logPrefix})),this._onAmqpClose=function(){var s=(0,ge.Z)(function*(a){var l;const h=a.receiver&&a.receiver.error,f=i.link||a.receiver;Ie.logError(h,`${i.logPrefix} 'receiver_close' event occurred. The associated error is`),null===(l=i._lockRenewer)||void 0===l||l.stopAll(i),f&&!f.isItselfClosed()?yield i.onDetached(h):Ie.verbose("%s 'receiver_close' event occurred on the receiver '%s' with address '%s' because the sdk initiated it. Hence not calling detached from the _onAmqpClose() handler.",i.logPrefix,i.name,i.address)});return function(a){return s.apply(this,arguments)}}(),this._onSessionClose=function(){var s=(0,ge.Z)(function*(a){var l;const h=i.link||a.receiver,f=a.session&&a.session.error;Ie.logError(f,`${i.logPrefix} 'session_close' event occurred. The associated error is`),null===(l=i._lockRenewer)||void 0===l||l.stopAll(i),h&&!h.isSessionItselfClosed()?yield i.onDetached(f):Ie.verbose("%s 'session_close' event occurred on the session of receiver '%s' with address '%s' because the sdk initiated it. Hence not calling detached from the _onSessionClose() handler.",i.logPrefix,i.name,i.address)});return function(a){return s.apply(this,arguments)}}(),this._onAmqpError=s=>{const a=s.receiver&&s.receiver.error;if(a){const l=rt(a);Ie.logError(l,`${this.logPrefix} 'receiver_error' event occurred. The associated error is`),this._messageHandlers().processError({error:l,errorSource:"receive",entityPath:this.entityPath,fullyQualifiedNamespace:this._context.config.host,identifier:t})}},this._onSessionError=s=>{const a=s.session&&s.session.error;if(a){const l=rt(a);Ie.logError(l,`${this.logPrefix} 'session_error' event occurred. The associated error is`),this._messageHandlers().processError({error:l,errorSource:"receive",entityPath:this.entityPath,fullyQualifiedNamespace:this._context.config.host,identifier:t})}},this._onAmqpMessage=function(){var s=(0,ge.Z)(function*(a){var l,h,f,v;if(!("peekLock"!==i.receiveMode||i.link&&i.link.isOpen()))return void Ie.verbose("%s Not calling the user's message handler for the current message as the receiver is closed",i.logPrefix);const x=new Dl(a.message,a.delivery,!0,i.receiveMode,null!==(l=o.skipParsingBodyAsJson)&&void 0!==l&&l,null!==(h=o.skipConvertingDate)&&void 0!==h&&h);null===(f=i._lockRenewer)||void 0===f||f.start(i,x,W=>{i._messageHandlers().processError({error:W,errorSource:"renewLock",entityPath:i.entityPath,fullyQualifiedNamespace:i._context.config.host,identifier:t})});try{yield i._messageHandlers().processMessage(x)}catch(W){Ie.logError(W,"%s An error occurred while running user's message handler for the message with id '%s' on the receiver '%s'",i.logPrefix,x.messageId,i.name),null===(v=i._lockRenewer)||void 0===v||v.stop(i,x);const ne=rt(W);if(!x.delivery.remote_settled&&ne.code!==Oa["com.microsoft:message-lock-lost"]&&"peekLock"===i.receiveMode&&i.isOpen())try{Ie.logError(ne,"%s Abandoning the message with id '%s' on the receiver '%s' since an error occured: %O.",i.logPrefix,x.messageId,i.name,ne),yield Zh(x,i._context,r,void 0,i._retryOptions)}catch(ae){const _e=rt(ae);Ie.logError(_e,"%s An error occurred while abandoning the message with id '%s' on the receiver '%s'",i.logPrefix,x.messageId,i.name),i._messageHandlers().processError({error:_e,errorSource:"abandon",entityPath:i.entityPath,fullyQualifiedNamespace:i._context.config.host,identifier:t})}return}finally{try{i._receiverHelper.addCredit(1)}catch(W){"AbortError"!==W.name&&(Ie.logError(W,`[${i.logPrefix}] Failed to add credit after receiving message`),yield i._reportInternalError(W))}}if(i.autoComplete&&"peekLock"===i.receiveMode&&!x.delivery.remote_settled)try{Ie.verbose("%s Auto completing the message with id '%s' on the receiver.",i.logPrefix,x.messageId),yield Wh(x,i._context,r,i._retryOptions)}catch(W){const ne=rt(W);Ie.logError(ne,"%s An error occurred while completing the message with id '%s' on the receiver '%s'",i.logPrefix,x.messageId,i.name),i._messageHandlers().processError({error:ne,errorSource:"complete",entityPath:i.entityPath,fullyQualifiedNamespace:i._context.config.host,identifier:t})}});return function(a){return s.apply(this,arguments)}}()}_reportInternalError(t){const n=this._messageHandlers();return n.forwardInternalErrors?n.processError({error:t,entityPath:this.entityPath,errorSource:"internal",fullyQualifiedNamespace:this._context.config.host,identifier:this.identifier}):Promise.resolve()}_getHandlers(){return{onMessage:t=>this._onAmqpMessage(t).catch(n=>this._reportInternalError(n)),onClose:t=>this._onAmqpClose(t).catch(n=>this._reportInternalError(n)),onSessionClose:t=>this._onSessionClose(t).catch(n=>this._reportInternalError(n)),onError:this._onAmqpError,onSessionError:this._onSessionError}}stopReceivingMessages(){var t=this;return(0,ge.Z)(function*(){yield t._receiverHelper.suspend(),t._subscribeCallPromise&&(yield t._subscribeCallPromise)})()}close(){var t=()=>super.close,n=this;return(0,ge.Z)(function*(){return yield n._receiverHelper.suspend(),t().call(n)})()}subscribe(t,n){var r=this;return(0,ge.Z)(function*(){let o;r._subscribeOptions=n,r._setMessageHandlers(t,n),r._subscribeCallPromise=new Promise(i=>{o=i});try{return r._receiverHelper.resume(),yield r._subscribeImpl("subscribe")}catch(i){throw yield r._messageHandlers().processError({entityPath:r.entityPath,fullyQualifiedNamespace:r._context.config.host,errorSource:"receive",error:i,identifier:r.identifier}),i}finally{o?.(),r._subscribeCallPromise=void 0}})()}_setMessageHandlers(t,n){var o,r=this;const i={processError:(s=(0,ge.Z)(function*(a){try{a.error=rt(a.error),yield t.processError(a)}catch(l){yield r._reportInternalError(l),Ie.logError(l,"An error was thrown from the user's processError handler")}}),function(l){return s.apply(this,arguments)}),processMessage:function(){var s=(0,ge.Z)(function*(a){try{yield Tn.withSpan("StreamReceiver.process",n??{},()=>t.processMessage(a),ay(a,r,r._context.config,"process"))}catch(l){throw r._messageHandlers().processError({error:l,errorSource:"processMessageCallback",entityPath:r.entityPath,fullyQualifiedNamespace:r._context.config.host,identifier:r.identifier}),l}});return function(l){return s.apply(this,arguments)}}(),postInitialize:function(){var s=(0,ge.Z)(function*(){if(t.postInitialize)return t.postInitialize().catch(a=>r._messageHandlers().processError({error:a,errorSource:"processMessageCallback",entityPath:r.entityPath,fullyQualifiedNamespace:r._context.config.host,identifier:r.identifier}))});return function(){return s.apply(this,arguments)}}(),preInitialize:function(){var s=(0,ge.Z)(function*(){if(t.preInitialize)return t.preInitialize().catch(a=>r._messageHandlers().processError({error:a,errorSource:"processMessageCallback",entityPath:r.entityPath,fullyQualifiedNamespace:r._context.config.host,identifier:r.identifier}))});return function(){return s.apply(this,arguments)}}(),forwardInternalErrors:null!==(o=t.forwardInternalErrors)&&void 0!==o&&o};var s;this._messageHandlers=()=>i}_subscribeImpl(t){var n=this;return(0,ge.Z)(function*(){var r;try{return yield n._retryForeverFn({retryConfig:{connectionId:n._context.connection.id,operationType:Sn.receiverLink,abortSignal:null===(r=n._subscribeOptions)||void 0===r?void 0:r.abortSignal,retryOptions:n._retryOptions,operation:()=>n._initAndAddCreditOperation(t)},onError:o=>n._messageHandlers().processError({error:o,errorSource:"receive",entityPath:n.entityPath,fullyQualifiedNamespace:n._context.config.host,identifier:n.identifier}),logPrefix:n.logPrefix,logger:Ie})}catch(o){try{yield n._receiverHelper.suspend()}catch(i){Ie.logError(i,`${n.logPrefix} receiver.suspend threw an error`)}throw o}})()}_initAndAddCreditOperation(t){var n=this;return(0,ge.Z)(function*(){var r;if(n._receiverHelper.isSuspended())throw new sr("Receiver was suspended during initialization.");if(xt(n._context),yield n._messageHandlers().preInitialize(),n._receiverHelper.isSuspended())throw new sr("Receiver was suspended during initialization.");yield n._init(n._createReceiverOptions("detach"===t,n._getHandlers()),null===(r=n._subscribeOptions)||void 0===r?void 0:r.abortSignal);try{yield n._messageHandlers().postInitialize(),n._receiverHelper.addCredit(n.maxConcurrentCalls)}catch(o){try{yield n.closeLink()}catch(i){yield n._messageHandlers().processError({error:i,errorSource:"receive",entityPath:n.entityPath,fullyQualifiedNamespace:n._context.config.host,identifier:n.identifier})}throw o}})()}onDetached(t){var n=this;return(0,ge.Z)(function*(){try{if(Ie.verbose(`${n.logPrefix} onDetached: reinitializing link.`),n.wasClosedPermanently)return void Ie.verbose(`${n.logPrefix} onDetached: link has been closed permanently, not reinitializing. `);if(n._isDetaching)return void Ie.verbose(`${n.logPrefix} onDetached: Call to detached on streaming receiver '${n.name}' is already in progress.`);n._isDetaching=!0;const r=t&&rt(t);Ie.logError(r,`${n.logPrefix} onDetached: Reinitializing receiver because of error`),yield n.closeLink()}catch(r){Ie.verbose(`${n.logPrefix} onDetached: Encountered an error when closing the previous link: `,r)}try{yield n._subscribeImpl("detach")}finally{n._isDetaching=!1}})()}removeLinkFromContext(){delete this._context.messageReceivers[this.name]}}class uy extends wM{constructor(t,n,r,o){var i,s,a;super(t,n,r,"batching",o),i=this,this._batchingReceiverLite=new MM(n,r,function(){var l=(0,ge.Z)(function*(h){let f;const v=i._createReceiverOptions(!1,{onError:x=>{var W;f=null===(W=x?.receiver)||void 0===W?void 0:W.error},onSessionError:x=>{var W;f=null===(W=x?.session)||void 0===W?void 0:W.error},onClose:(x=(0,ge.Z)(function*(){}),function(){return x.apply(this,arguments)}),onSessionClose:function(){var x=(0,ge.Z)(function*(){});return function(){return x.apply(this,arguments)}}(),onMessage:function(){var x=(0,ge.Z)(function*(){});return function(){return x.apply(this,arguments)}}()});var x;if(yield i._init(v,h),null!=f)throw f;return i.link});return function(h){return l.apply(this,arguments)}}(),this.receiveMode,null!==(s=o.skipParsingBodyAsJson)&&void 0!==s&&s,null!==(a=o.skipConvertingDate)&&void 0!==a&&a)}get isReceivingMessages(){return this._batchingReceiverLite.isReceivingMessages}onDetached(t){var n=this;return(0,ge.Z)(function*(){yield n.closeLink(),null==t&&(t=new Error("Unknown error occurred on the AMQP connection while receiving messages.")),n._batchingReceiverLite.terminate(t)})()}receive(t,n,r,o){var i=this;return(0,ge.Z)(function*(){xt(i._context);try{const s=yield i._batchingReceiverLite.receiveMessages(Object.assign({maxMessageCount:t,maxWaitTimeInMs:n,maxTimeAfterFirstMessageInMs:r},o));if(i._lockRenewer)for(const a of s)i._lockRenewer.start(i,a,l=>{});return s}catch(s){throw Ie.logError(s,"[%s] Rejecting receiveMessages()",i.logPrefix),s}})()}static create(t,n,r,o){xt(n);const i=new uy(t,n,r,o);return n.messageReceivers[i.name]=i,i}removeLinkFromContext(){delete this._context.messageReceivers[this.name]}}class MM{constructor(t,n,r,o,i,s){this._connectionContext=t,this.entityPath=n,this._getCurrentReceiver=r,this._receiveMode=o,this._drainTimeoutInMs=200,this._createServiceBusMessage=a=>new Dl(a.message,a.delivery,!0,this._receiveMode,i,s),this._getRemainingWaitTimeInMsFn=(a,l)=>function A6(e,t){const n=Date.now();return()=>{const r=e-(Date.now()-n);return r<0?0:Math.min(r,t)}}(a,l),this.isReceivingMessages=!1}receiveMessages(t){var n=this;return(0,ge.Z)(function*(){try{n.isReceivingMessages=!0;const r=yield n._getCurrentReceiver(t.abortSignal);if(null==r)throw new co("Link closed before receiving messages.","GeneralError");const o=yield new Promise((i,s)=>n._receiveMessagesImpl(r,t,i,s));return Tn.withSpan("BatchingReceiverLite.process",t,()=>o,ay(o,n,n._connectionContext.config,"process"))}finally{n._closeHandler=void 0,n.isReceivingMessages=!1}})()}terminate(t){this._closeHandler&&(this._closeHandler(t),this._closeHandler=void 0)}tryDrainReceiver(t,n,r){var o=this;return(0,ge.Z)(function*(){if(!t.isOpen()||t.credit<=0)return;let s,i=!1;const a=new Promise(l=>{function h(){Ie.verbose(`${n} Receiver has been drained.`),clearTimeout(s),l()}function f(){r?.removeEventListener("abort",v),t.removeListener(je.cz.receiverDrained,h)}function v(){f(),clearTimeout(s),l()}s=setTimeout(()=>{i=!0,f(),l()},o._drainTimeoutInMs),t.once(je.cz.receiverDrained,h),r?.addEventListener("abort",v)});t.drainCredit(),Ie.verbose(`${n} Draining leftover credits(${t.credit}), waiting for event_drained event, or timing out after ${o._drainTimeoutInMs} milliseconds...`),yield a,i&&(Ie.warning(`${n} Time out after ${o._drainTimeoutInMs} milliseconds when draining credits. Closing receiver...`),yield t.close()),t.drain=!1})()}_receiveMessagesImpl(t,n,r,o){var i=this;const s=this._getRemainingWaitTimeInMsFn(n.maxWaitTimeInMs,n.maxTimeAfterFirstMessageInMs),a=[],l=`[${t.connection.id}|r:${t.name}]`;let h,f;const v=Ue=>{f(),o(Ue)},ne=Ue=>{var We,Qe,et;const Ct=null!=(null===(We=Ue.session)||void 0===We?void 0:We.error)?"session_error":"receiver_error";let Ht=(null===(Qe=Ue.session)||void 0===Qe?void 0:Qe.error)||(null===(et=Ue.receiver)||void 0===et?void 0:et.error);Ht?(Ht=rt(Ht),Ie.logError(Ht,`${l} '${Ct}' event occurred. Received an error`)):Ht=new co("An error occurred while receiving messages.","GeneralError"),v(Ht)};let ae;this._closeHandler=Ue=>{if(null==Ue||"receiveAndDelete"===this._receiveMode&&a.length)return Ie.verbose(`${l} Closing. Resolving with ${a.length} messages.`),(Ue=>{setTimeout(()=>{f(),r(Ue)})})(a);v(rt(Ue))},this._finalAction=(0,ge.Z)(function*(){var Ue;t.drain?Ie.verbose(`${l} Already draining.`):(yield i.tryDrainReceiver(t,l,n.abortSignal),Ie.verbose(`${l} Resolving receiveMessages() with ${a.length} messages.`),Ue=a,f(),r(Ue))});const _e=function(){var Ue=(0,ge.Z)(function*(We){if("peekLock"===i._receiveMode&&0===a.length){h&&clearTimeout(h);const Qe=s();h=setTimeout(()=>{Ie.verbose(`${l} Batching, waited for ${Qe} milliseconds after receiving the first message.`),i._finalAction()},Qe)}try{const Qe=i._createServiceBusMessage(We);a.push(Qe),a.length>n.maxMessageCount&&Ie.warning(`More messages arrived than expected: ${n.maxMessageCount} vs ${a.length}`)}catch(Qe){const et=Qe instanceof Error?Qe:new Error(JSON.stringify(Qe));Ie.logError(Qe,`${l} Received an error while converting AmqpMessage to ServiceBusMessage`),v(et)}a.length>=n.maxMessageCount&&i._finalAction()});return function(Qe){return Ue.apply(this,arguments)}}(),Ae=function(){var Ue=(0,ge.Z)(function*(We){var Qe,et,Ct;const Ht=null!=(null===(Qe=We.session)||void 0===Qe?void 0:Qe.error)?"session_closed":"receiver_closed",lr=(null===(et=We.session)||void 0===et?void 0:et.error)||(null===(Ct=We.receiver)||void 0===Ct?void 0:Ct.error);lr&&Ie.logError(lr,`${l} '${Ht}' event occurred. The associated error`)});return function(Qe){return Ue.apply(this,arguments)}}();f=()=>{null!=t&&(t.removeListener(je.cz.receiverError,ne),t.removeListener(je.cz.message,_e),t.session.removeListener(je.qW.sessionError,ne),t.removeListener(je.cz.receiverClose,Ae),t.session.removeListener(je.qW.sessionClose,Ae)),h&&clearTimeout(h),ae&&ae(),ae=void 0},ae=lM(Ue=>{t.drain&&t.close(),v(Ue)},n.abortSignal);const ve=n.maxMessageCount-t.credit;Ie.verbose(`${l} Ensure enough credit for receiving ${n.maxMessageCount} messages. Current: ${t.credit}.  To add: ${ve}.`),ve>0&&t.addCredit(ve),Ie.verbose(`${l} Setting the wait timer for ${n.maxWaitTimeInMs} milliseconds.`),h=setTimeout(()=>{Ie.verbose(`${l} Batching, waited for max wait time ${n.maxWaitTimeInMs} milliseconds.`),this._finalAction()},n.maxWaitTimeInMs),t.on(je.cz.message,_e),t.on(je.cz.receiverError,ne),t.on(je.cz.receiverClose,Ae),t.session.on(je.qW.sessionError,ne),t.session.on(je.qW.sessionClose,Ae)}}class dy{constructor(t,n){this._context=t,this._maxAutoRenewDurationInMs=n,this._messageRenewLockTimers=new Map,this._calculateRenewAfterDuration=aM}static create(t,n,r){if("peekLock"===r&&!(n<=0))return new dy(t,n)}stopAll(t){Ie.verbose(`${t.logPrefix} Clearing message renew lock timers for all the active messages.`);const n=this._messageRenewLockTimers.get(t.name);if(null!=n){for(const r of n.keys())this._stopAndRemoveById(t,n,r);this._messageRenewLockTimers.delete(t.name)}}stop(t,n){const r=n.messageId,o=this._messageRenewLockTimers.get(t.name);null!=o&&this._stopAndRemoveById(t,o,r)}start(t,n,r){var o=this;try{const i=t.logPrefix;if(null==n.lockToken)throw new Error(`Can't start auto lock renewal for message with message id '${n.messageId}' since it does not have a lock token.`);const s=n.lockToken,a=this._getOrCreateMapForLink(t);a.set(n.messageId,void 0),Ie.verbose(`${i} message with id '${n.messageId}' is locked until ${n.lockedUntilUtc.toString()}.`);const l=Date.now()+this._maxAutoRenewDurationInMs,h=new Date(l);Ie.verbose(`${i} Total autolockrenew duration for message with id '${n.messageId}' is: ${h.toString()}`);const f=()=>{if(h>n.lockedUntilUtc)if(Date.now()>=l)Ie.verbose(`${i} Current time ${new Date} exceeds the total autolockrenew duration ${h} for message with messageId '${n.messageId}'. Hence we will stop the autoLockRenewTask.`),this.stop(t,n);else if(a.has(n.messageId)){const x=this._calculateRenewAfterDuration(n.lockedUntilUtc);Ie.verbose(`${i} Sleeping for ${x} milliseconds while renewing the lock for message with id '${n.messageId}'`);const W=setTimeout((0,ge.Z)(function*(){try{Ie.verbose(`${i} Attempting to renew the lock for message with id '${n.messageId}'.`),n.lockedUntilUtc=yield o._context.getManagementClient(t.entityPath).renewLock(s,{associatedLinkName:t.name}),Ie.verbose(`${i} Successfully renewed the lock for message with id '${n.messageId}'. Starting next auto-lock-renew cycle for message.`),f()}catch(ne){Ie.logError(ne,`${i} An error occurred while auto renewing the message lock '${n.lockToken}' for message with id '${n.messageId}'`),r(ne)}}),x);"function"==typeof W.unref&&W.unref(),a.set(n.messageId,W)}else Ie.verbose(`${i} Looks like the message lock renew timer has already been cleared for message with id '${n.messageId}'.`);else Ie.verbose(`${i} Autolockrenew not needed as message's lockedUntilUtc ${n.lockedUntilUtc} is after the total autolockrenew duration ${h} for message with messageId '${n.messageId}'. Hence we will stop the autoLockRenewTask.`),this.stop(t,n)};f()}catch(i){r(i)}}_getOrCreateMapForLink(t){return this._messageRenewLockTimers.has(t.name)||this._messageRenewLockTimers.set(t.name,new Map),this._messageRenewLockTimers.get(t.name)}_stopAndRemoveById(t,n,r){if(null==r)throw new Error("Failed to stop auto lock renewal - no message ID");n.has(r)&&(clearTimeout(n.get(r)),Ie.verbose(`${t.logPrefix} Cleared the message renew lock timer for message with id '${r}'.`),n.delete(r))}}class D6{get logPrefix(){return`[${this._context.connectionId}|receiver:${this.entityPath}]`}constructor(t,n,r,o,i,s=!1,a={},l){this._context=t,this.entityPath=n,this.receiveMode=r,this.skipParsingBodyAsJson=i,this.skipConvertingDate=s,this._isClosed=!1,xt(t),this._retryOptions=a,this._lockRenewer=dy.create(this._context,o,r),this.identifier=Al(this.entityPath,l)}_throwIfAlreadyReceiving(){if(this._isReceivingMessages()){const t=gM(this.entityPath),n=new Error(t);throw Ie.logError(n,`${this.logPrefix} is already receiving`),n}}_throwIfReceiverOrConnectionClosed(){if(xt(this._context),this.isClosed){const t=pM(this.entityPath),n=new Error(t);throw Ie.logError(n,`${this.logPrefix} is closed`),n}}get isClosed(){return this._isClosed||this._context.wasConnectionCloseCalled}receiveMessages(t,n){var r=this;return(0,ge.Z)(function*(){if(r._throwIfReceiverOrConnectionClosed(),r._throwIfAlreadyReceiving(),zn(r._context.connectionId,"maxMessageCount",t),ty(r._context.connectionId,"maxMessageCount",t,"number"),isNaN(t)||t<1)throw new TypeError(ey);const o=function(){var s=(0,ge.Z)(function*(){var a;return r._batchingReceiver&&r._context.messageReceivers[r._batchingReceiver.name]||(r._batchingReceiver=r._createBatchingReceiver(r._context,r.entityPath,{maxConcurrentCalls:0,receiveMode:r.receiveMode,lockRenewer:r._lockRenewer,skipParsingBodyAsJson:r.skipParsingBodyAsJson,skipConvertingDate:r.skipConvertingDate})),yield r._batchingReceiver.receive(t,null!==(a=n?.maxWaitTimeInMs)&&void 0!==a?a:we.defaultOperationTimeoutInMs,1e3,n??{})});return function(){return s.apply(this,arguments)}}();return Mn({connectionHost:r._context.config.host,connectionId:r._context.connectionId,operation:o,operationType:Sn.receiveMessage,abortSignal:n?.abortSignal,retryOptions:r._retryOptions}).catch(s=>{throw rt(s)})})()}getMessageIterator(t){return TM(this,t)}receiveDeferredMessages(t,n={}){var r=this;return(0,ge.Z)(function*(){r._throwIfReceiverOrConnectionClosed(),zn(r._context.connectionId,"sequenceNumbers",t),$h(r._context.connectionId,"sequenceNumbers",t);const o=Array.isArray(t)?t:[t],s={operation:function(){var a=(0,ge.Z)(function*(){return yield r._context.getManagementClient(r.entityPath).receiveDeferredMessages(o,r.receiveMode,void 0,Object.assign(Object.assign({},n),{associatedLinkName:r._getAssociatedReceiverName(),requestName:"receiveDeferredMessages",timeoutInMs:r._retryOptions.timeoutInMs,skipParsingBodyAsJson:r.skipParsingBodyAsJson,skipConvertingDate:r.skipConvertingDate}))});return function(){return a.apply(this,arguments)}}(),connectionId:r._context.connectionId,operationType:Sn.management,retryOptions:r._retryOptions,abortSignal:n?.abortSignal};return Mn(s)})()}peekMessages(t,n={}){var r=this;return(0,ge.Z)(function*(){var o;r._throwIfReceiverOrConnectionClosed();const i=Object.assign(Object.assign({},n),{associatedLinkName:r._getAssociatedReceiverName(),requestName:"peekMessages",timeoutInMs:null===(o=r._retryOptions)||void 0===o?void 0:o.timeoutInMs,skipParsingBodyAsJson:r.skipParsingBodyAsJson,skipConvertingDate:r.skipConvertingDate}),a={operation:function(){var l=(0,ge.Z)(function*(){return void 0!==n.fromSequenceNumber?r._context.getManagementClient(r.entityPath).peekBySequenceNumber(n.fromSequenceNumber,t,void 0,n.omitMessageBody,i):r._context.getManagementClient(r.entityPath).peek(t,n.omitMessageBody,i)});return function(){return l.apply(this,arguments)}}(),connectionId:r._context.connectionId,operationType:Sn.management,retryOptions:r._retryOptions,abortSignal:n?.abortSignal};return Mn(a)})()}subscribe(t,n){var o,i,s,r=this;return SM(t),xt(this._context),this._throwIfReceiverOrConnectionClosed(),this._throwIfAlreadyReceiving(),n=Object.assign(Object.assign({},n??{}),{autoCompleteMessages:null===(o=n?.autoCompleteMessages)||void 0===o||o}),this._streamingReceiver=null!==(i=this._streamingReceiver)&&void 0!==i?i:new T6(this.identifier,this._context,this.entityPath,Object.assign(Object.assign({},n),{receiveMode:this.receiveMode,retryOptions:this._retryOptions,lockRenewer:this._lockRenewer,skipParsingBodyAsJson:this.skipParsingBodyAsJson,skipConvertingDate:this.skipConvertingDate})),this._context.messageReceivers[this._streamingReceiver.name]=this._streamingReceiver,this._streamingReceiver.subscribe(t,n).catch(s=>{this._streamingReceiver&&delete this._context.messageReceivers[this._streamingReceiver.name]}),{close:(s=(0,ge.Z)(function*(){var a;return null===(a=r._streamingReceiver)||void 0===a?void 0:a.stopReceivingMessages()}),function(){return s.apply(this,arguments)})}}completeMessage(t){var n=this;return(0,ge.Z)(function*(){return n._throwIfReceiverOrConnectionClosed(),Jo(t,n.receiveMode,n._context.connectionId),Wh(t,n._context,n.entityPath,n._retryOptions)})()}abandonMessage(t,n){var r=this;return(0,ge.Z)(function*(){return r._throwIfReceiverOrConnectionClosed(),Jo(t,r.receiveMode,r._context.connectionId),Zh(t,r._context,r.entityPath,n,r._retryOptions)})()}deferMessage(t,n){var r=this;return(0,ge.Z)(function*(){return r._throwIfReceiverOrConnectionClosed(),Jo(t,r.receiveMode,r._context.connectionId),AM(t,r._context,r.entityPath,n,r._retryOptions)})()}deadLetterMessage(t,n){var r=this;return(0,ge.Z)(function*(){return r._throwIfReceiverOrConnectionClosed(),Jo(t,r.receiveMode,r._context.connectionId),DM(t,r._context,r.entityPath,n,r._retryOptions)})()}renewMessageLock(t){var n=this;return(0,ge.Z)(function*(){n._throwIfReceiverOrConnectionClosed(),Jo(t,n.receiveMode,n._context.connectionId);const r=xa(t);return Tn.withSpan("ServiceBusReceiver.renewMessageLock",{},()=>{let s;if(t.delivery.link){const a=n._context.getReceiverFromCache(t.delivery.link.name);s=a?.name}return n._context.getManagementClient(n.entityPath).renewLock(t.lockToken,{associatedLinkName:s}).then(a=>(t.lockedUntilUtc=a,a))},Object.assign({spanLinks:r?[{tracingContext:r}]:[]},Xo({entityPath:n.entityPath,host:n._context.config.host},"receive","client")))})()}close(){var t=this;return(0,ge.Z)(function*(){try{t._isClosed=!0,t._context.connection&&t._context.connection.isOpen()&&(t._streamingReceiver&&(yield t._streamingReceiver.close()),t._batchingReceiver&&(yield t._batchingReceiver.close()))}catch(n){throw Ie.logError(n,`${t.logPrefix} An error occurred while closing the Receiver`),n}})()}_isReceivingMessages(){return!!(this._streamingReceiver&&this._streamingReceiver.isOpen()&&this._streamingReceiver.isSubscribeActive||this._batchingReceiver&&this._batchingReceiver.isOpen()&&this._batchingReceiver.isReceivingMessages)}_createBatchingReceiver(t,n,r){const o=uy.create(this.identifier,t,n,r);return Ie.verbose(`[${this.logPrefix}] receiver '${o.name}' created, with maxConcurrentCalls set to ${r.maxConcurrentCalls}.`),o}_getAssociatedReceiverName(){return this._streamingReceiver&&this._streamingReceiver.isOpen()?this._streamingReceiver.name:this._batchingReceiver&&this._batchingReceiver.isOpen()&&this._batchingReceiver.isReceivingMessages?this._batchingReceiver.name:void 0}}class OM{get logPrefix(){return`[${this._context.connectionId}|session:${this.entityPath}]`}constructor(t,n,r,o,i,s,a={}){this._messageSession=t,this._context=n,this.entityPath=r,this.receiveMode=o,this._skipParsingBodyAsJson=i,this._skipConvertingDate=s,this._retryOptions=a,this._isClosed=!1,xt(n),this.sessionId=t.sessionId,this.identifier=t.identifier}_throwIfReceiverOrConnectionClosed(){if(xt(this._context),this.isClosed){if(this._isClosed){const n=pM(this.entityPath,this.sessionId),r=new Error(n);throw Ie.logError(r,`${this.logPrefix} already closed`),r}throw rt({condition:Mo.SessionLockLostError,description:`The session lock has expired on the session with id ${this.sessionId}`})}}_throwIfAlreadyReceiving(){if(this._isReceivingMessages()){const t=gM(this.entityPath,this.sessionId),n=new Error(t);throw Ie.logError(n,`${this.logPrefix} is already receiving.`),n}}get isClosed(){return this._isClosed||!this._context.messageSessions[this._messageSession.name]||!this._messageSession.isOpen()}get sessionLockedUntilUtc(){return this._messageSession.sessionLockedUntilUtc}renewSessionLock(t){var n=this;return(0,ge.Z)(function*(){return n._throwIfReceiverOrConnectionClosed(),Tn.withSpan("ServiceBusSessionReceiver.renewSessionLock",t??{},r=>{const i={operation:function(){var s=(0,ge.Z)(function*(){return n._messageSession.sessionLockedUntilUtc=yield n._context.getManagementClient(n.entityPath).renewSessionLock(n.sessionId,Object.assign(Object.assign({},r),{associatedLinkName:n._messageSession.name,requestName:"renewSessionLock",timeoutInMs:n._retryOptions.timeoutInMs})),n._messageSession.sessionLockedUntilUtc});return function(){return s.apply(this,arguments)}}(),connectionId:n._context.connectionId,operationType:Sn.management,retryOptions:n._retryOptions,abortSignal:t?.abortSignal};return Mn(i)})})()}setSessionState(t,n={}){var r=this;return(0,ge.Z)(function*(){return r._throwIfReceiverOrConnectionClosed(),Tn.withSpan("ServiceBusSessionReceiver.setSessionState",n??{},o=>{const s={operation:function(){var a=(0,ge.Z)(function*(){yield r._context.getManagementClient(r.entityPath).setSessionState(r.sessionId,t,Object.assign(Object.assign({},o),{associatedLinkName:r._messageSession.name,requestName:"setState",timeoutInMs:r._retryOptions.timeoutInMs}))});return function(){return a.apply(this,arguments)}}(),connectionId:r._context.connectionId,operationType:Sn.management,retryOptions:r._retryOptions,abortSignal:n?.abortSignal};return Mn(s)})})()}getSessionState(t={}){var n=this;return(0,ge.Z)(function*(){return n._throwIfReceiverOrConnectionClosed(),Tn.withSpan("ServiceBusSessionReceiver.getSessionState",t??{},r=>{const i={operation:function(){var s=(0,ge.Z)(function*(){return n._context.getManagementClient(n.entityPath).getSessionState(n.sessionId,Object.assign(Object.assign({},r),{associatedLinkName:n._messageSession.name,requestName:"getState",timeoutInMs:n._retryOptions.timeoutInMs}))});return function(){return s.apply(this,arguments)}}(),connectionId:n._context.connectionId,operationType:Sn.management,retryOptions:n._retryOptions,abortSignal:t?.abortSignal};return Mn(i)})})()}peekMessages(t,n={}){var r=this;return(0,ge.Z)(function*(){var o;r._throwIfReceiverOrConnectionClosed();const i=Object.assign(Object.assign({},n),{associatedLinkName:r._messageSession.name,requestName:"peekMessages",timeoutInMs:null===(o=r._retryOptions)||void 0===o?void 0:o.timeoutInMs,skipParsingBodyAsJson:r._skipParsingBodyAsJson,skipConvertingDate:r._skipConvertingDate}),a={operation:function(){var l=(0,ge.Z)(function*(){return void 0!==n.fromSequenceNumber?r._context.getManagementClient(r.entityPath).peekBySequenceNumber(n.fromSequenceNumber,t,r.sessionId,n.omitMessageBody,i):r._context.getManagementClient(r.entityPath).peekMessagesBySession(r.sessionId,t,n.omitMessageBody,i)});return function(){return l.apply(this,arguments)}}(),connectionId:r._context.connectionId,operationType:Sn.management,retryOptions:r._retryOptions,abortSignal:n?.abortSignal};return Mn(a)})()}receiveDeferredMessages(t,n={}){var r=this;return(0,ge.Z)(function*(){r._throwIfReceiverOrConnectionClosed(),zn(r._context.connectionId,"sequenceNumbers",t),$h(r._context.connectionId,"sequenceNumbers",t);const o=Array.isArray(t)?t:[t],s={operation:function(){var a=(0,ge.Z)(function*(){return yield r._context.getManagementClient(r.entityPath).receiveDeferredMessages(o,r.receiveMode,r.sessionId,Object.assign(Object.assign({},n),{associatedLinkName:r._messageSession.name,requestName:"receiveDeferredMessages",timeoutInMs:r._retryOptions.timeoutInMs,skipParsingBodyAsJson:r._skipParsingBodyAsJson,skipConvertingDate:r._skipConvertingDate}))});return function(){return a.apply(this,arguments)}}(),connectionId:r._context.connectionId,operationType:Sn.management,retryOptions:r._retryOptions,abortSignal:n?.abortSignal};return Mn(s)})()}receiveMessages(t,n){var r=this;return(0,ge.Z)(function*(){if(r._throwIfReceiverOrConnectionClosed(),r._throwIfAlreadyReceiving(),zn(r._context.connectionId,"maxMessageCount",t),ty(r._context.connectionId,"maxMessageCount",t,"number"),isNaN(t)||t<1)throw new TypeError(ey);const i={operation:function(){var s=(0,ge.Z)(function*(){var a;return yield r._messageSession.receiveMessages(t,null!==(a=n?.maxWaitTimeInMs)&&void 0!==a?a:we.defaultOperationTimeoutInMs,1e3,n??{})});return function(){return s.apply(this,arguments)}}(),connectionId:r._context.connectionId,operationType:Sn.receiveMessage,retryOptions:r._retryOptions,abortSignal:n?.abortSignal};return Mn(i).catch(s=>{throw rt(s)})})()}subscribe(t,n){var r=this;SM(t),n=n??{};const o=function w6(e,t=Ie){return function(){var n=(0,ge.Z)(function*(r){try{r.error=rt(r.error),yield e.processError(r)}catch(o){t.logError(o,"An error was thrown from the user's processError handler")}});return function(r){return n.apply(this,arguments)}}()}(t);return this._registerMessageHandler(function(){var i=(0,ge.Z)(function*(s){return Tn.withSpan("SessionReceiver.process",n??{},()=>t.processMessage(s),ay(s,r,r._context.config,"process"))});return function(s){return i.apply(this,arguments)}}(),o,n),{close:(i=(0,ge.Z)(function*(){var s;return null===(s=r._messageSession)||void 0===s?void 0:s.receiverHelper.suspend()}),function(){return i.apply(this,arguments)})};var i}_registerMessageHandler(t,n,r){this._throwIfReceiverOrConnectionClosed(),this._throwIfAlreadyReceiving();const o=this._context.connectionId;if(zn(o,"onMessage",t),zn(o,"onError",n),"function"!=typeof t)throw new TypeError("The parameter 'onMessage' must be of type 'function'.");if("function"!=typeof n)throw new TypeError("The parameter 'onError' must be of type 'function'.");try{this._messageSession.subscribe(t,n,r)}catch(i){n({error:i,errorSource:"receive",entityPath:this.entityPath,fullyQualifiedNamespace:this._context.config.host,identifier:this.identifier})}}getMessageIterator(t){return TM(this,t)}completeMessage(t){var n=this;return(0,ge.Z)(function*(){return n._throwIfReceiverOrConnectionClosed(),Jo(t,n.receiveMode,n._context.connectionId),Wh(t,n._context,n.entityPath,n._retryOptions)})()}abandonMessage(t,n){var r=this;return(0,ge.Z)(function*(){return r._throwIfReceiverOrConnectionClosed(),Jo(t,r.receiveMode,r._context.connectionId),Zh(t,r._context,r.entityPath,n,r._retryOptions)})()}deferMessage(t,n){var r=this;return(0,ge.Z)(function*(){return r._throwIfReceiverOrConnectionClosed(),Jo(t,r.receiveMode,r._context.connectionId),AM(t,r._context,r.entityPath,n,r._retryOptions)})()}deadLetterMessage(t,n){var r=this;return(0,ge.Z)(function*(){return r._throwIfReceiverOrConnectionClosed(),Jo(t,r.receiveMode,r._context.connectionId),DM(t,r._context,r.entityPath,n,r._retryOptions)})()}renewMessageLock(){return(0,ge.Z)(function*(){throw new Error("Renewing message lock is an invalid operation when working with sessions.")})()}close(){var t=this;return(0,ge.Z)(function*(){try{yield t._messageSession.close()}catch(n){throw Ie.logError(n,"%s An error occurred while closing the SessionReceiver for session %s",t.logPrefix,t.sessionId),n}finally{t._isClosed=!0}})()}_isReceivingMessages(){return!!this._messageSession&&this._messageSession.isReceivingMessages}}function kM(e,t={}){return(0,xe.__asyncGenerator)(this,arguments,function*(){const{pageLink:r,maxPageSize:o}=t;let i=yield(0,xe.__await)(e.getPage(r??e.firstPageLink,o));if(!i)return yield(0,xe.__await)(void 0);for(yield yield(0,xe.__await)(i.page);i.nextPageLink;){if(i=yield(0,xe.__await)(e.getPage(i.nextPageLink,o)),!i)return yield(0,xe.__await)(void 0);yield yield(0,xe.__await)(i.page)}})}class x6{constructor(t,n,r={}){this._context=t,this._entityPath=n,this._retryOptions=r,this._isClosed=!1,xt(t),this.entityPath=n,this.name=Tl("ruleManager")}get isClosed(){return this._isClosed||this._context.wasConnectionCloseCalled}createRule(t,n,r,o={}){var i=this;return(0,ge.Z)(function*(){let s,a;return r&&(function k6(e){return xr(e,["sqlExpression"])}(r)?(s=r,a=o):a=Object.assign(Object.assign({},r),o)),Tn.withSpan("ServiceBusRuleManager.createRule",a??{},function(){var l=(0,ge.Z)(function*(h){const v={operation:function(){var x=(0,ge.Z)(function*(){return i._context.getManagementClient(i._entityPath).addRule(t,n,s?.sqlExpression,Object.assign(Object.assign({},h),{associatedLinkName:i.name,requestName:"addRule",timeoutInMs:i._retryOptions.timeoutInMs}))});return function(){return x.apply(this,arguments)}}(),connectionId:i._context.connectionId,operationType:Sn.management,retryOptions:i._retryOptions,abortSignal:h?.abortSignal};return Mn(v)});return function(h){return l.apply(this,arguments)}}())})()}getRules(t){var n=this;return(0,ge.Z)(function*(){return Tn.withSpan("ServiceBusRuleManager.getRules",t??{},function(){var r=(0,ge.Z)(function*(o){const s={operation:function(){var a=(0,ge.Z)(function*(){return n._context.getManagementClient(n._entityPath).getRules(Object.assign(Object.assign({},o),{associatedLinkName:n.name,requestName:"getRules",timeoutInMs:n._retryOptions.timeoutInMs}))});return function(){return a.apply(this,arguments)}}(),connectionId:n._context.connectionId,operationType:Sn.management,retryOptions:n._retryOptions,abortSignal:o?.abortSignal};return Mn(s)});return function(o){return r.apply(this,arguments)}}())})()}listRules(t){var n=this;l8.verbose("Performing operation - listRules() with options: %j",t);const r={firstPageLink:0,getPage:(o=(0,ge.Z)(function*(i,s){const a=s??100,l=yield n.getRules(Object.assign({skip:i,maxCount:a},t));return l.length?{page:l,nextPageLink:l.length>0?i+l.length:void 0}:void 0}),function(s,a){return o.apply(this,arguments)})};var o;return function P6(e){var t;const n=function N6(e){return(0,xe.__asyncGenerator)(this,arguments,function*(){var n,r,o,i;const s=kM(e),a=yield(0,xe.__await)(s.next());if(Array.isArray(a.value)){yield(0,xe.__await)(yield*(0,xe.__asyncDelegator)((0,xe.__asyncValues)(a.value)));try{for(var v,f=(0,xe.__asyncValues)(s);!(v=yield(0,xe.__await)(f.next())).done;){const x=v.value;yield(0,xe.__await)(yield*(0,xe.__asyncDelegator)((0,xe.__asyncValues)(x)))}}catch(x){o={error:x}}finally{try{v&&!v.done&&(i=f.return)&&(yield(0,xe.__await)(i.call(f)))}finally{if(o)throw o.error}}}else{const{toElements:x}=e;if(x){yield(0,xe.__await)(yield*(0,xe.__asyncDelegator)((0,xe.__asyncValues)(x(a.value))));try{for(var h,l=(0,xe.__asyncValues)(s);!(h=yield(0,xe.__await)(l.next())).done;){const W=h.value;yield(0,xe.__await)(yield*(0,xe.__asyncDelegator)((0,xe.__asyncValues)(x(W))))}}catch(W){n={error:W}}finally{try{h&&!h.done&&(r=l.return)&&(yield(0,xe.__await)(r.call(l)))}finally{if(n)throw n.error}}}else yield yield(0,xe.__await)(a.value),yield(0,xe.__await)(yield*(0,xe.__asyncDelegator)((0,xe.__asyncValues)(s)))}})}(e);return{next:()=>n.next(),[Symbol.asyncIterator](){return this},byPage:null!==(t=e?.byPage)&&void 0!==t?t:r=>{const{continuationToken:o,maxPageSize:i}=r??{};return kM(e,{pageLink:o,maxPageSize:i})}}}(r)}deleteRule(t,n={}){var r=this;return(0,ge.Z)(function*(){return Tn.withSpan("ServiceBusRuleManager.deleteRule",n,function(){var o=(0,ge.Z)(function*(i){const a={operation:function(){var l=(0,ge.Z)(function*(){return r._context.getManagementClient(r._entityPath).removeRule(t,Object.assign(Object.assign({},i),{associatedLinkName:r.name,requestName:"removeRule",timeoutInMs:r._retryOptions.timeoutInMs}))});return function(){return l.apply(this,arguments)}}(),connectionId:r._context.connectionId,operationType:Sn.management,retryOptions:r._retryOptions,abortSignal:i?.abortSignal};return Mn(a)});return function(i){return o.apply(this,arguments)}}())})()}}class B6{constructor(t,n){this._context=t,this._maxSizeInBytes=n,this._encodedMessages=[],this._spanContexts=[],this._sizeInBytes=0,this._batchMessageProperties={}}get maxSizeInBytes(){return this._maxSizeInBytes}get sizeInBytes(){return this._sizeInBytes}get count(){return this._encodedMessages.length}get _messageSpanContexts(){return this._spanContexts}_generateBatch(t,n,r,o){const i={body:je.yw.data_sections(t),message_annotations:n,application_properties:r};if(o)for(const s of je.zV)o[s]&&(i[s]=o[s]);return je.yw.encode(i)}_generateMessage(){return this._generateBatch(this._encodedMessages,this._batchAnnotations,this._batchApplicationProperties,this._batchMessageProperties)}tryAddMessage(t,n={}){zn(this._context.connectionId,"message",t),Vh(t,"Provided value for 'message' must be of type: ServiceBusMessage or AmqpAnnotatedMessage.");const{message:r,spanContext:o}=IM(t,n,this._context.config.entityPath,this._context.config.host,"publish"),i=Y_(r,Bh),s=je.yw.encode(i);let a=this._sizeInBytes;if(0===this.count){i.message_annotations&&(this._batchAnnotations=i.message_annotations),i.application_properties&&(this._batchApplicationProperties=i.application_properties);for(const f of je.zV)i[f]&&(this._batchMessageProperties[f]=i[f]);a+=this._generateBatch([],this._batchAnnotations,this._batchApplicationProperties,this._batchMessageProperties).length}const l=s.length;return a+=l+(l<=255?5:8),!(a>this._maxSizeInBytes||(this._encodedMessages.push(s),o&&this._spanContexts.push(o),this._sizeInBytes=a,0))}}class py extends Hh{constructor(t,n,r,o){var i;super(r,r,n,"sender",Ut,{address:r,audience:`${n.config.endpoint}${r}`}),i=this,this.identifier=t,this._retryOptions=o,this._onAmqpError=s=>{Ut.logError(s.sender&&s.sender.error,"%s 'sender_error' event occurred on the sender '%s' with address '%s'. The associated error",this.logPrefix,this.name,this.address)},this._onSessionError=s=>{Ut.logError(s.session&&s.session.error,"%s 'session_error' event occurred on the session of sender '%s' with address '%s'. The associated error",this.logPrefix,this.name,this.address)},this._onAmqpClose=function(){var s=(0,ge.Z)(function*(a){Ut.logError(a.sender&&a.sender.error,`${i.logPrefix} 'sender_close' event occurred. The associated error is`),yield i.onDetached().catch(h=>{Ut.logError(h,`${i.logPrefix} error when closing sender after 'sender_close' event`)})});return function(a){return s.apply(this,arguments)}}(),this._onSessionClose=function(){var s=(0,ge.Z)(function*(a){Ut.logError(a.session&&a.session.error,`${i.logPrefix} 'session_close' event occurred. The associated error is`),yield i.onDetached().catch(h=>{Ut.logError(h,`${i.logPrefix} error when closing sender after 'session_close' event`)})});return function(a){return s.apply(this,arguments)}}()}_createSenderOptions(t){t&&(this.name=Tl(this.baseName));const n={name:this.name,target:{address:this.address},source:this.identifier,onError:this._onAmqpError,onClose:this._onAmqpClose,onSessionError:this._onSessionError,onSessionClose:this._onSessionClose};return Ut.verbose(`${this.logPrefix} Creating sender with options: %O`,n),n}_trySend(t,n,r){var o=this;const i=r?.abortSignal,s=Dn(this._retryOptions.timeoutInMs)?this._retryOptions.timeoutInMs:we.defaultOperationTimeoutInMs,l={operation:function(){var h=(0,ge.Z)(function*(){var f,v,x,W,ne,ae,_e;const Ae=Date.now();if(!o.isOpen())try{yield function j8(e){return W_.apply(this,arguments)}({actionFn:()=>o.open(void 0,r?.abortSignal),abortSignal:r?.abortSignal,timeoutMs:s,timeoutMessage:`[${o._context.connectionId}] Sender "${o.name}" with address "${o.address}", was not able to send the message right now, due to operation timeout.`})}catch(We){const Qe=rt(We);throw Ut.logError(Qe,"%s An error occurred while creating the sender",o.logPrefix,o.name),Qe}const ve=Date.now()-Ae;Ut.verbose("%s Sender '%s', credit: %d available: %d",o.logPrefix,o.name,null===(f=o.link)||void 0===f?void 0:f.credit,null===(W=null===(x=null===(v=o.link)||void 0===v?void 0:v.session)||void 0===x?void 0:x.outgoing)||void 0===W?void 0:W.available());const Ue=yield uM(Ut,o.logPrefix,o.name,s-ve,o.link,null===(_e=null===(ae=null===(ne=o.link)||void 0===ne?void 0:ne.session)||void 0===ae?void 0:ae.outgoing)||void 0===_e?void 0:_e.available());if(s<=ve+Ue){const We=`${o.logPrefix} Sender "${o.name}" with address "${o.address}", was not able to send the message right now, due to operation timeout.`;throw Ut.warning(We),rt({condition:Mo.ServiceUnavailableError,description:We})}if(!o.link){const We=`[${o.logPrefix}] Cannot send the message. Link is not ready.`;throw Ut.warning(We),rt({condition:Mo.SenderNotReadyError,description:We})}try{const We=yield o.link.send(t,{format:n?2147563264:0,timeoutInSeconds:(s-ve-Ue)/1e3,abortSignal:i});Ut.verbose("%s Sender '%s', sent message with delivery id: %d",o.logPrefix,o.name,We.id)}catch(We){const Qe=rt(We.innerError||We);throw Ut.logError(Qe,`${o.logPrefix} An error occurred while sending the message`),Qe}});return function(){return h.apply(this,arguments)}}(),connectionId:this._context.connectionId,operationType:Sn.sendMessage,retryOptions:this._retryOptions,abortSignal:i};return Mn(l)}createRheaLink(t){return this._context.connection.createAwaitableSender(t)}open(t,n){var r=this;return(0,ge.Z)(function*(){try{t||(t=r._createSenderOptions()),yield r.initLink(t,n)}catch(o){const i=rt(o);throw Ut.logError(i,`${r.logPrefix} An error occurred while creating the sender`),"OperationTimeoutError"===i.code&&(i.message="Failed to create a sender within allocated time and retry attempts."),i}})()}onDetached(){var t=this;return(0,ge.Z)(function*(){yield t.closeLink()})()}isOpen(){const t=null!=this.link&&this.link.isOpen();return Ut.verbose("%s Sender '%s' with address '%s' is open? -> %s",this.logPrefix,this.name,this.address,t),t}send(t,n){var r=this;return(0,ge.Z)(function*(){xt(r._context);try{const o=Y_(t,Bh),i=je.yw.encode(o);return Ut.verbose("%s Sender '%s', trying to send message: %O",r.logPrefix,r.name,t),yield r._trySend(i,!1,n)}catch(o){throw Ut.logError(o,"%s An error occurred while sending the message: %O\nError",r.logPrefix,t),o}})()}getMaxMessageSize(t={}){var n=this;return(0,ge.Z)(function*(){const r=t.retryOptions||{};if(n.isOpen())return n.link.maxMessageSize;const o={operation:(i=(0,ge.Z)(function*(){if(yield n.open(void 0,t?.abortSignal),n.link)return n.link.maxMessageSize;throw new co("Link failed to initialize, cannot get max message size.","GeneralError")}),function(){return i.apply(this,arguments)}),connectionId:n._context.connectionId,operationType:Sn.senderLink,retryOptions:r,abortSignal:t?.abortSignal};var i;return Mn(o)})()}createBatch(t){var n=this;return(0,ge.Z)(function*(){xt(n._context);let r=yield n.getMaxMessageSize({retryOptions:n._retryOptions,abortSignal:t?.abortSignal});if(t?.maxSizeInBytes){if(t.maxSizeInBytes>r)throw new Error(`Max message size (${t.maxSizeInBytes} bytes) is greater than maximum message size (${r} bytes) on the AMQP sender link.`);r=t.maxSizeInBytes}return new B6(n._context,r)})()}sendBatch(t,n){var r=this;return(0,ge.Z)(function*(){xt(r._context);try{return Ut.verbose("%s Sender '%s', sending encoded batch message.",r.logPrefix,r.name,t),yield r._trySend(t._generateMessage(),!0,n)}catch(o){throw Ut.logError(o,"%s Sender '%s': An error occurred while sending the messages: %O\nError",r.logPrefix,r.name,t),o}})()}static create(t,n,r,o){xt(n);const i=new py(t,n,r,o);return n.senders[i.name]=i,i}removeLinkFromContext(){delete this._context.senders[this.name]}}class j6{get logPrefix(){return`[${this._context.connectionId}|sender:${this.entityPath}]`}constructor(t,n,r={},o){this._context=t,this._entityPath=n,this._isClosed=!1,xt(t),this.entityPath=n,this.identifier=Al(this.entityPath,o),this._sender=py.create(this.identifier,this._context,n,r),this._retryOptions=r}_throwIfSenderOrConnectionClosed(){if(xt(this._context),this.isClosed){const t=function K8(e){return`The sender for "${e}" has been closed and can no longer be used. Please create a new sender using the "createSender" method on the ServiceBusClient.`}(this._entityPath),n=new Error(t);throw Ut.logError(n,`[${this._context.connectionId}] is closed`),n}}get isClosed(){return this._isClosed||this._context.wasConnectionCloseCalled}sendMessages(t,n){var r=this;return(0,ge.Z)(function*(){if(r._throwIfSenderOrConnectionClosed(),zn(r._context.connectionId,"messages",t),!PM(t)&&!Array.isArray(t)){Vh(t,ny);const s=t,{message:a,spanContext:l}=IM(s,n??{},r.entityPath,r._context.config.host,"publish");return Tn.withSpan("ServiceBusSender.send",n??{},f=>r._sender.send(a,f),Object.assign({spanLinks:l?[{tracingContext:l}]:[]},Xo({entityPath:r.entityPath,host:r._context.config.host},"publish","client")))}let o;if(PM(t))o=t;else{o=yield r.createMessageBatch(n);for(const s of t)if(Vh(s,ny),!o.tryAddMessage(s,n))throw new co("Messages were too big to fit in a single batch. Remove some messages and try again or create your own batch using createBatch(), which gives more fine-grained control.","MessageSizeExceeded")}const i=o._messageSpanContexts.map(s=>({tracingContext:s}));return Tn.withSpan("ServiceBusSender.send",n??{},s=>r._sender.sendBatch(o,s),Object.assign({spanLinks:i},Xo({entityPath:r.entityPath,host:r._context.config.host},"publish","client")))})()}createMessageBatch(t){var n=this;return(0,ge.Z)(function*(){return n._throwIfSenderOrConnectionClosed(),n._sender.createBatch(t)})()}scheduleMessages(t,n,r={}){var o=this;return(0,ge.Z)(function*(){o._throwIfSenderOrConnectionClosed(),zn(o._context.connectionId,"scheduledEnqueueTimeUtc",n),function W8(e,t,n,r){if(!(n instanceof r)){const o=new TypeError(`The parameter "${t}" should be an instance of "${r.name}"`);throw ar.warning(`[${e}] %O`,o),o}}(o._context.connectionId,"scheduledEnqueueTimeUtc",n,Date),zn(o._context.connectionId,"messages",t);const i=Array.isArray(t)?t:[t];for(const l of i)Vh(l,ny);const a={operation:function(){var l=(0,ge.Z)(function*(){return o._context.getManagementClient(o._entityPath).scheduleMessages(n,i,Object.assign(Object.assign({},r),{associatedLinkName:o._sender.name,requestName:"scheduleMessages",timeoutInMs:o._retryOptions.timeoutInMs}))});return function(){return l.apply(this,arguments)}}(),connectionId:o._context.connectionId,operationType:Sn.management,retryOptions:o._retryOptions,abortSignal:r?.abortSignal};return Mn(a)})()}cancelScheduledMessages(t,n={}){var r=this;return(0,ge.Z)(function*(){r._throwIfSenderOrConnectionClosed(),zn(r._context.connectionId,"sequenceNumbers",t),$h(r._context.connectionId,"sequenceNumbers",t);const o=Array.isArray(t)?t:[t],s={operation:function(){var a=(0,ge.Z)(function*(){return r._context.getManagementClient(r._entityPath).cancelScheduledMessages(o,Object.assign(Object.assign({},n),{associatedLinkName:r._sender.name,requestName:"cancelScheduledMessages",timeoutInMs:r._retryOptions.timeoutInMs}))});return function(){return a.apply(this,arguments)}}(),connectionId:r._context.connectionId,operationType:Sn.management,retryOptions:r._retryOptions,abortSignal:n?.abortSignal};return Mn(s)})()}close(){var t=this;return(0,ge.Z)(function*(){try{t._isClosed=!0,yield t._sender.close()}catch(n){throw Ut.logError(n,`${t.logPrefix} An error occurred while closing the Sender`),n}})()}}function PM(e){return null!=e&&("function"==typeof e.tryAddMessage&&"number"==typeof e.maxSizeInBytes&&"number"==typeof e.sizeInBytes)}class Qh extends Hh{get isReceivingMessages(){return this._batchingReceiverLite.isReceivingMessages||this._isReceivingMessagesForSubscriber}get receiverHelper(){return this._receiverHelper}_ensureSessionLockRenewal(){var t=this;if(this.autoRenewLock&&new Date(this._totalAutoLockRenewDuration)>this.sessionLockedUntilUtc&&Date.now()<this._totalAutoLockRenewDuration&&this.isOpen()){const n=aM(this.sessionLockedUntilUtc);this._sessionLockRenewalTimer=setTimeout((0,ge.Z)(function*(){try{Ie.verbose("%s Attempting to renew the session lock for MessageSession '%s' with name '%s'.",t.logPrefix,t.sessionId,t.name),t.sessionLockedUntilUtc=yield t._context.getManagementClient(t.entityPath).renewSessionLock(t.sessionId,{associatedLinkName:t.name,timeoutInMs:1e4}),Ie.verbose("%s Successfully renewed the session lock for MessageSession '%s' with name '%s'.",t.logPrefix,t.sessionId,t.name),Ie.verbose("%s Calling _ensureSessionLockRenewal() again for MessageSession '%s'.",t.logPrefix,t.sessionId),t._ensureSessionLockRenewal()}catch(r){Ie.logError(r,"%s An error occurred while renewing the session lock for MessageSession '%s'",t.logPrefix,t.sessionId)}}),n),Ie.verbose("%s MessageSession '%s' has next session lock renewal in %d milliseconds @(%s).",this.logPrefix,this.sessionId,n,new Date(Date.now()+n).toString())}}createRheaLink(t,n){var r=this;return(0,ge.Z)(function*(){var o,i;r._lastSBError=void 0;let s="";const a=yield r._context.connection.createReceiver(t),l=null===(i=null===(o=a.source)||void 0===o?void 0:o.filter)||void 0===i?void 0:i[we.sessionFilterName];if(r._providedSessionId||l)r._providedSessionId&&l!==r._providedSessionId&&(s=`Failed to create a receiver for the requested session '${r._providedSessionId}'. It may be locked by another receiver.`);else{if(t.source&&"string"!=typeof t.source&&t.source.filter&&we.sessionFilterName in t.source.filter&&void 0===t.source.filter[we.sessionFilterName]&&(yield bl(1),r._lastSBError))throw r._lastSBError;s="Failed to create a receiver. No unlocked sessions available."}if(s){const h=rt({description:s,condition:Mo.SessionCannotBeLockedError});throw Ie.logError(h,r.logPrefix),h}return a})()}_init(t={}){var n=this;return(0,ge.Z)(function*(){var r,o;try{const i=n._createMessageSessionOptions(n.identifier,t.timeoutInMs);if(yield n.initLink(i,t.abortSignal),!n.link)throw new Error("INTERNAL ERROR: failed to create receiver but without an error.");const s=null===(o=null===(r=n.link.source)||void 0===r?void 0:r.filter)||void 0===o?void 0:o[we.sessionFilterName];n._providedSessionId||(n.sessionId=s),n.sessionLockedUntilUtc=function R8(e){const r=Ai.fromBytesBE(e).sub(621355968e9).div(1e4).toNumber(),o=new Date(r);return ar.verbose("The converted date is: %s",o.toString()),o}(n.link.properties["com.microsoft:locked-until-utc"]),Ie.verbose("%s Session with id '%s' is locked until: '%s'.",n.logPrefix,n.sessionId,n.sessionLockedUntilUtc.toISOString()),Ie.verbose("%s Receiver created with receiver options: %O",n.logPrefix,i),n._context.messageSessions[n.name]||(n._context.messageSessions[n.name]=n),n._totalAutoLockRenewDuration=Date.now()+n.maxAutoRenewDurationInMs,n._ensureSessionLockRenewal()}catch(i){const s=rt(i);throw Ie.logError(s,"%s An error occured while creating the receiver",n.logPrefix),"OperationTimeoutError"===s.code&&(s.message=n._providedSessionId?`Failed to create a receiver for the requested session '${n._providedSessionId}' within allocated time and retry attempts.`:"Failed to create a receiver within allocated time and retry attempts."),s}})()}_createMessageSessionOptions(t,n){return EM(this.name,this.receiveMode,{address:this.address,filter:{[we.sessionFilterName]:this.sessionId}},t,{onClose:o=>this._onAmqpClose(o).catch(()=>{}),onSessionClose:o=>this._onSessionClose(o).catch(()=>{}),onError:this._onAmqpError,onSessionError:this._onSessionError,onSettled:this._onSettled},n)}constructor(t,n,r,o,i){var s;super(r,r,n,"session",Ie,{address:r,audience:`${n.config.endpoint}${r}`}),s=this,this.identifier=t,this._providedSessionId=o,this.maxConcurrentCalls=1,this._deliveryDispositionMap=new Map,this._receiverHelper=new bM(()=>({receiver:this.link,logPrefix:this.logPrefix})),this._retryOptions=i.retryOptions,this.autoComplete=!1,Dn(this._providedSessionId)&&(this.sessionId=this._providedSessionId),this.receiveMode=i.receiveMode||"peekLock",this.skipParsingBodyAsJson=i.skipParsingBodyAsJson,this.skipConvertingDate=i.skipConvertingDate,this.maxAutoRenewDurationInMs=null!=i.maxAutoLockRenewalDurationInMs?i.maxAutoLockRenewalDurationInMs:3e5,this._totalAutoLockRenewDuration=Date.now()+this.maxAutoRenewDurationInMs,this.autoRenewLock=this.maxAutoRenewDurationInMs>0&&"peekLock"===this.receiveMode,this._isReceivingMessagesForSubscriber=!1,this._batchingReceiverLite=new MM(n,r,function(){var a=(0,ge.Z)(function*(l){return s.link});return function(l){return a.apply(this,arguments)}}(),this.receiveMode,this.skipParsingBodyAsJson,this.skipConvertingDate),this._onSettled=a=>{CM(this.logPrefix,a.delivery,this._deliveryDispositionMap)},this._notifyError=a=>{this._onError&&(this._onError(a),Ie.verbose("%s Notified the user's error handler about the error received by the Receiver",this.logPrefix))},this._onAmqpError=a=>{const l=a.receiver&&a.receiver.error;if(l){const h=rt(l);"SessionLockLostError"===h.code&&(h.message=`The session lock has expired on the session with id ${this.sessionId}.`),this._lastSBError=h,Ie.logError(h,"%s An error occurred for Receiver",this.logPrefix),this._notifyError({error:h,errorSource:"receive",entityPath:this.entityPath,fullyQualifiedNamespace:this._context.config.host,identifier:this.identifier})}},this._onSessionError=a=>{const l=this._context.connectionId,h=a.session&&a.session.error;if(h){const f=rt(h);Ie.logError(f,"[%s] An error occurred on the session for Receiver '%s': %O.",l,this.name,f),this._notifyError({error:f,errorSource:"receive",entityPath:this.entityPath,fullyQualifiedNamespace:this._context.config.host,identifier:this.identifier})}},this._onAmqpClose=function(){var a=(0,ge.Z)(function*(l){const h=s._context.connectionId,f=l.receiver&&l.receiver.error,v=s.link||l.receiver;if(f){const x=rt(f);Ie.logError(x,"[%s] 'receiver_close' event occurred for receiver '%s' for sessionId '%s'. The associated error is: %O",h,s.name,s.sessionId,x)}if(v&&!v.isItselfClosed()){Ie.verbose("%s 'receiver_close' event occurred on the receiver for sessionId '%s' and the sdk did not initiate this. Hence, let's gracefully close the receiver.",s.logPrefix,s.sessionId);try{yield s.close()}catch(x){Ie.logError(x,"%s An error occurred while closing the receiver for sessionId '%s'.",s.logPrefix,s.sessionId)}}else Ie.verbose("%s 'receiver_close' event occurred on the receiver for sessionId '%s' because the sdk initiated it. Hence no need to gracefully close the receiver",s.logPrefix,s.sessionId)});return function(l){return a.apply(this,arguments)}}(),this._onSessionClose=function(){var a=(0,ge.Z)(function*(l){const h=s.link||l.receiver,f=l.session&&l.session.error;if(f){const v=rt(f);Ie.logError(v,"%s 'session_close' event occurred for receiver for sessionId '%s'. The associated error is",s.logPrefix,s.sessionId)}if(h&&!h.isSessionItselfClosed()){Ie.verbose("%s 'session_close' event occurred on the receiver for sessionId '%s' and the sdk did not initiate this. Hence, let's gracefully close the receiver.",s.logPrefix,s.sessionId);try{yield s.close()}catch(v){Ie.logError(v,"%s An error occurred while closing the receiver for sessionId '%s'",s.logPrefix,s.sessionId)}}else Ie.verbose("%s 'session_close' event occurred on the receiver for sessionId'%s' because the sdk initiated it. Hence no need to gracefully close the receiver",s.logPrefix,s.sessionId)});return function(l){return a.apply(this,arguments)}}()}close(t){var n=()=>super.close,r=this;return(0,ge.Z)(function*(){try{r._isReceivingMessagesForSubscriber=!1,r._sessionLockRenewalTimer&&clearTimeout(r._sessionLockRenewalTimer),Ie.verbose("%s Cleared the timers for 'no new message received' task and 'session lock renewal' task.",r.logPrefix),yield n().call(r),r._batchingReceiverLite.terminate(t)}catch(o){Ie.logError(o,"%s An error occurred while closing the message session with id '%s'",r.logPrefix,r.sessionId)}})()}isOpen(){const t=this.link&&this.link.isOpen();return Ie.verbose("%s Receiver for sessionId '%s' is open? -> %s",this.logPrefix,this.sessionId,t),t}subscribe(t,n,r){this.receiverHelper.resume(),this._subscribeImpl(t,n,r)}_subscribeImpl(t,n,r){var i,o=this;if(r||(r={}),null!==(i=r.abortSignal)&&void 0!==i&&i.aborted)throw new sr(Do);if(this._isReceivingMessagesForSubscriber=!0,"number"==typeof r.maxConcurrentCalls&&r.maxConcurrentCalls>0&&(this.maxConcurrentCalls=r.maxConcurrentCalls),this.autoComplete=!1!==r.autoCompleteMessages||r.autoCompleteMessages,this._onMessage=t,this._onError=n,this.link&&this.link.isOpen()){const s=function(){var a=(0,ge.Z)(function*(l){if(!("peekLock"!==o.receiveMode||o.link&&o.link.isOpen()))return void Ie.verbose("%s Not calling the user's message handler for the current message as the receiver is closed",o.logPrefix);const h=new Dl(l.message,l.delivery,!0,o.receiveMode,o.skipParsingBodyAsJson,o.skipConvertingDate);try{yield o._onMessage(h)}catch(f){Ie.logError(f,"%s An error occurred while running user's message handler for the message with id '%s' on the receiver",o.logPrefix,h.messageId),o._onError({error:f,errorSource:"processMessageCallback",entityPath:o.entityPath,fullyQualifiedNamespace:o._context.config.host,identifier:o.identifier});const v=rt(f);if(!h.delivery.remote_settled&&"peekLock"===o.receiveMode&&o.isOpen())try{Ie.logError(v,"%s Abandoning the message with id '%s' on the receiver since an error occured",o.logPrefix,h.messageId),yield Zh(h,o._context,o.entityPath,void 0,o._retryOptions)}catch(x){const W=rt(x);Ie.logError(W,"%s An error occurred while abandoning the message with id '%s' on the receiver",o.logPrefix,h.messageId,W),o._notifyError({error:W,errorSource:"abandon",entityPath:o.entityPath,fullyQualifiedNamespace:o._context.config.host,identifier:o.identifier})}return}finally{try{o.receiverHelper.addCredit(1)}catch(f){o.processCreditError(f)}}if(o.autoComplete&&"peekLock"===o.receiveMode&&!h.delivery.remote_settled)try{Ie.verbose("%s Auto completing the message with id '%s' on the receiver.",o.logPrefix,h.messageId),yield Wh(h,o._context,o.entityPath,o._retryOptions)}catch(f){const v=rt(f);Ie.logError(v,"%s An error occurred while completing the message with id '%s' on the receiver",o.logPrefix,h.messageId),o._notifyError({error:v,errorSource:"complete",entityPath:o.entityPath,fullyQualifiedNamespace:o._context.config.host,identifier:o.identifier})}});return function(h){return a.apply(this,arguments)}}();this.link.on(je.cz.message,s);try{this.receiverHelper.addCredit(this.maxConcurrentCalls)}catch(a){this.processCreditError(a)}}else{this._isReceivingMessagesForSubscriber=!1;const s=`MessageSession with sessionId '${this.sessionId}' and name '${this.name}' has either not been created or is not open.`;Ie.verbose("[%s] %s",this._context.connectionId,s),this._notifyError({error:new Error(s),errorSource:"receive",entityPath:this.entityPath,fullyQualifiedNamespace:this._context.config.host,identifier:this.identifier})}}processCreditError(t){if("AbortError"===t.name)return;Ie.logError(t,"Cannot request messages on the receiver");const n=new co("Cannot request messages on the receiver","SessionLockLost");n.retryable=!1,this._onError({error:n,errorSource:"processMessageCallback",entityPath:this.entityPath,fullyQualifiedNamespace:this._context.config.host,identifier:this.identifier})}receiveMessages(t,n,r,o){var i=this;return(0,ge.Z)(function*(){try{return yield i._batchingReceiverLite.receiveMessages(Object.assign({maxMessageCount:t,maxWaitTimeInMs:n,maxTimeAfterFirstMessageInMs:r},o))}catch(s){throw Ie.logError(s,`${i.logPrefix} Rejecting receiveMessages() with error`),s}})()}onDetached(t){var n=this;return(0,ge.Z)(function*(){Ie.error(rt(t),`${n.logPrefix} onDetached: closing link (session receiver will not reconnect)`);try{n._notifyError({entityPath:n.entityPath,fullyQualifiedNamespace:n._context.config.host,error:rt(t),errorSource:"receive",identifier:n.identifier})}catch(r){Ie.error(rt(r),`${n.logPrefix} onDetached: unexpected error seen when tried calling "_notifyError" with ${rt(t)}`)}yield n.close(t)})()}settleMessage(t,n,r){var o=this;return(0,ge.Z)(function*(){return new Promise((i,s)=>{if(null==n.match(/^(complete|abandon|defer|deadletter)$/))return s(new Error(`operation: '${n}' is not a valid operation.`));const a=t.delivery,l=setTimeout(()=>(o._deliveryDispositionMap.delete(a.id),Ie.verbose("[%s] Disposition for delivery id: %d, did not complete in %d milliseconds. Hence rejecting the promise with timeout error",o._context.connectionId,a.id,we.defaultOperationTimeoutInMs),s(rt({condition:Mo.ServiceUnavailableError,description:"Operation to settle the message has timed out. The disposition of the message may or may not be successful"}))),we.defaultOperationTimeoutInMs);if(o._deliveryDispositionMap.set(a.id,{resolve:i,reject:s,timer:l}),n===Ln.complete)a.accept();else if(n===Ln.abandon){const h={undeliverable_here:!1};r.propertiesToModify&&(h.message_annotations=r.propertiesToModify),a.modified(h)}else if(n===Ln.defer){const h={undeliverable_here:!0};r.propertiesToModify&&(h.message_annotations=r.propertiesToModify),a.modified(h)}else if(n===Ln.deadletter){const h={condition:we.deadLetterName,info:Object.assign(Object.assign({},r.propertiesToModify),{DeadLetterReason:r.deadLetterReason,DeadLetterErrorDescription:r.deadLetterDescription})};a.reject(h)}})})()}static create(t,n,r,o,i){return(0,ge.Z)(function*(){var s,a;xt(n);const l=new Qh(t,n,r,o,i);let h;if(void 0===o){h=null!==(a=null===(s=i.retryOptions)||void 0===s?void 0:s.timeoutInMs)&&void 0!==a?a:we.defaultOperationTimeoutInMs;const v=20,x=1e3,W=Math.min(.01*h,100);h=Math.floor(h-W*Math.random()),h>=x&&(h-=v)}return yield l._init({abortSignal:i?.abortSignal,timeoutInMs:h}),l})()}removeLinkFromContext(){delete this._context.messageSessions[this.name]}}class V6{constructor(t,n,r){if(function $6(e){return function H6(e){return e&&"function"==typeof e.getToken&&(void 0===e.signRequest||e.getToken.length>0)}(e)||xh(e)||U_(e)}(n)){const i=t,s=n;this._clientOptions=r||{},this._connectionContext=function d6(e,t,n={}){if("string"!=typeof t)throw new TypeError("`host` parameter is not a string");let r;return t.endsWith("/")||(t+="/"),r=xh(e)||U_(e)?FD(e):e,vM(`Endpoint=sb://${t};SharedAccessKeyName=defaultKeyName;SharedAccessKey=defaultKeyValue;`,r,n)}(s,i,this._clientOptions)}else{const i=t;this._clientOptions=n||{},this._connectionContext=function u6(e,t={}){const n=function a6(e){const t=N_(e);if(!t.Endpoint)throw new Error("Connection string should have an Endpoint key.");if(t.SharedAccessSignature){if(t.SharedAccessKey||t.SharedAccessKeyName)throw new Error("Connection string cannot have both SharedAccessSignature and SharedAccessKey keys.")}else{if(t.SharedAccessKey&&!t.SharedAccessKeyName)throw new Error("Connection string with SharedAccessKey should have SharedAccessKeyName.");if(!t.SharedAccessKey&&t.SharedAccessKeyName)throw new Error("Connection string with SharedAccessKeyName should have SharedAccessKey as well.")}const n={fullyQualifiedNamespace:(t.Endpoint.match(".*://([^/]*)")||[])[1],endpoint:t.Endpoint};return t.EntityPath&&(n.entityPath=t.EntityPath),t.SharedAccessSignature&&(n.sharedAccessSignature=t.SharedAccessSignature),t.SharedAccessKey&&t.SharedAccessKeyName&&(n.sharedAccessKey=t.SharedAccessKey,n.sharedAccessKeyName=t.SharedAccessKeyName),n}(e);return vM(e,FD(n),t)}(i,this._clientOptions)}this.fullyQualifiedNamespace=this._connectionContext.config.host,this.identifier=Al(this.fullyQualifiedNamespace,this._clientOptions.identifier),this._clientOptions.retryOptions=this._clientOptions.retryOptions||{};const o=this._clientOptions.retryOptions.timeoutInMs;if(Dn(o)&&("number"!=typeof o||!isFinite(o)||o<=0))throw new Error(`${o} is an invalid value for retryOptions.timeoutInMs`)}createReceiver(t,n,r){var o,i;xl(this._connectionContext.config,t);const{entityPath:s,receiveMode:a,options:l}=Nl(t,n,r);let h=s;if(l?.subQueueType)switch(l?.subQueueType){case"deadLetter":h+="/$DeadLetterQueue";break;case"transferDeadLetter":h+="/$Transfer/$DeadLetterQueue";break;default:throw new Error(`Invalid subQueueType '${l?.subQueueType}' provided. Valid values are 'deadLetter' and 'transferDeadLetter'`)}return new D6(this._connectionContext,h,a,null!=l?.maxAutoLockRenewalDurationInMs?l.maxAutoLockRenewalDurationInMs:3e5,null!==(o=l?.skipParsingBodyAsJson)&&void 0!==o&&o,null!==(i=l?.skipConvertingDate)&&void 0!==i&&i,this._clientOptions.retryOptions,l?.identifier)}createRuleManager(t,n){xl(this._connectionContext.config,t);const{entityPath:r}=Nl(t,n);return new x6(this._connectionContext,r,this._clientOptions.retryOptions)}acceptSession(t,n,r,o){var i=this;return(0,ge.Z)(function*(){var s,a,l,h;let f,v,x,W;if(xl(i._connectionContext.config,t),"string"==typeof t&&"string"==typeof n&&"string"==typeof r)f=r,({entityPath:v,receiveMode:x,options:W}=Nl(t,n,o));else{if("string"!=typeof t||"string"!=typeof n||"string"==typeof r)throw new Error("Unhandled set of parameters");f=n,({entityPath:v,receiveMode:x,options:W}=Nl(t,r,void 0))}const ne=yield Qh.create(Al(v,W?.identifier),i._connectionContext,v,f,{maxAutoLockRenewalDurationInMs:W?.maxAutoLockRenewalDurationInMs,receiveMode:x,abortSignal:W?.abortSignal,retryOptions:i._clientOptions.retryOptions,skipParsingBodyAsJson:null!==(s=W?.skipParsingBodyAsJson)&&void 0!==s&&s,skipConvertingDate:null!==(a=W?.skipConvertingDate)&&void 0!==a&&a});return new OM(ne,i._connectionContext,v,x,null!==(l=W?.skipParsingBodyAsJson)&&void 0!==l&&l,null!==(h=W?.skipConvertingDate)&&void 0!==h&&h,i._clientOptions.retryOptions)})()}acceptNextSession(t,n,r){var o=this;return(0,ge.Z)(function*(){var i,s,a,l;xl(o._connectionContext.config,t);const{entityPath:h,receiveMode:f,options:v}=Nl(t,n,r),x=yield Qh.create(Al(h,v?.identifier),o._connectionContext,h,void 0,{maxAutoLockRenewalDurationInMs:v?.maxAutoLockRenewalDurationInMs,receiveMode:f,abortSignal:v?.abortSignal,retryOptions:o._clientOptions.retryOptions,skipParsingBodyAsJson:null!==(i=v?.skipParsingBodyAsJson)&&void 0!==i&&i,skipConvertingDate:null!==(s=v?.skipConvertingDate)&&void 0!==s&&s});return new OM(x,o._connectionContext,h,f,null!==(a=v?.skipParsingBodyAsJson)&&void 0!==a&&a,null!==(l=v?.skipConvertingDate)&&void 0!==l&&l,o._clientOptions.retryOptions)})()}createSender(t,n={}){return xl(this._connectionContext.config,t),new j6(this._connectionContext,t,this._clientOptions.retryOptions,n.identifier)}close(){return zh.close(this._connectionContext)}}function Nl(e,t,n){let r,o,i;if("string"==typeof t?(r=`${e}/Subscriptions/${t}`,o=n):(r=e,o=t),o&&Dn(o.receiveMode)&&"peekLock"!==o.receiveMode){if("receiveAndDelete"!==o.receiveMode)throw new TypeError(`Invalid receiveMode '${o?.receiveMode}' provided. Valid values are 'peekLock' and 'receiveAndDelete'`);i="receiveAndDelete"}else i="peekLock";return null==o||delete o.receiveMode,{entityPath:r,receiveMode:i,options:o}}function xl(e,t){if(e.entityPath&&e.entityPath!==t)throw new Error("The queue or topic name provided does not match the EntityPath in the connection string passed to the ServiceBusClient constructor.")}const Gn=new Ve("NgValidators"),Mi=new Ve("NgAsyncValidators");function GM(e){return null!=e}function qM(e){return Rc(e)?kt(e):e}function KM(e){let t={};return e.forEach(n=>{t=null!=n?{...t,...n}:t}),0===Object.keys(t).length?null:t}function WM(e,t){return t.map(n=>n(e))}function ZM(e){return e.map(t=>function Z6(e){return!e.validate}(t)?t:n=>t.validate(n))}function my(e){return null!=e?function YM(e){if(!e)return null;const t=e.filter(GM);return 0==t.length?null:function(n){return KM(WM(n,t))}}(ZM(e)):null}function _y(e){return null!=e?function QM(e){if(!e)return null;const t=e.filter(GM);return 0==t.length?null:function(n){return h0(WM(n,t).map(qM)).pipe(be(KM))}}(ZM(e)):null}function JM(e,t){return null===e?[t]:Array.isArray(e)?[...e,t]:[e,t]}function yy(e){return e?Array.isArray(e)?e:[e]:[]}function Xh(e,t){return Array.isArray(e)?e.includes(t):e===t}function tR(e,t){const n=yy(t);return yy(e).forEach(o=>{Xh(n,o)||n.push(o)}),n}function nR(e,t){return yy(t).filter(n=>!Xh(e,n))}class rR{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=my(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=_y(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t=void 0){this.control&&this.control.reset(t)}hasError(t,n){return!!this.control&&this.control.hasError(t,n)}getError(t,n){return this.control?this.control.getError(t,n):null}}class cr extends rR{get formDirective(){return null}get path(){return null}}class oR{constructor(t){this._cd=t}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let iR=(()=>{class e extends oR{constructor(n){super(n)}static#e=this.\u0275fac=function(r){return new(r||e)(Pe(cr,10))};static#t=this.\u0275dir=lt({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,o){2&r&&Oc("ng-untouched",o.isUntouched)("ng-touched",o.isTouched)("ng-pristine",o.isPristine)("ng-dirty",o.isDirty)("ng-valid",o.isValid)("ng-invalid",o.isInvalid)("ng-pending",o.isPending)("ng-submitted",o.isSubmitted)},features:[jt]})}return e})();const Ll="VALID",tf="INVALID",Fa="PENDING",Fl="DISABLED";function nf(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}class lR{constructor(t,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(t),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===Ll}get invalid(){return this.status===tf}get pending(){return this.status==Fa}get disabled(){return this.status===Fl}get enabled(){return this.status!==Fl}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._assignValidators(t)}setAsyncValidators(t){this._assignAsyncValidators(t)}addValidators(t){this.setValidators(tR(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(tR(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(nR(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(nR(t,this._rawAsyncValidators))}hasValidator(t){return Xh(this._rawValidators,t)}hasAsyncValidator(t){return Xh(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=Fa,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const n=this._parentMarkedDirty(t.onlySelf);this.status=Fl,this.errors=null,this._forEachChild(r=>{r.disable({...t,onlySelf:!0})}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...t,skipPristineCheck:n}),this._onDisabledChange.forEach(r=>r(!0))}enable(t={}){const n=this._parentMarkedDirty(t.onlySelf);this.status=Ll,this._forEachChild(r=>{r.enable({...t,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors({...t,skipPristineCheck:n}),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Ll||this.status===Fa)&&this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Fl:Ll}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=Fa,this._hasOwnPendingAsyncValidator=!0;const n=qM(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,n={}){this.errors=t,this._updateControlsErrors(!1!==n.emitEvent)}get(t){let n=t;return null==n||(Array.isArray(n)||(n=n.split(".")),0===n.length)?null:n.reduce((r,o)=>r&&r._find(o),this)}getError(t,n){const r=n?this.get(n):this;return r&&r.errors?r.errors[t]:null}hasError(t,n){return!!this.getError(t,n)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new an,this.statusChanges=new an}_calculateStatus(){return this._allControlsDisabled()?Fl:this.errors?tf:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Fa)?Fa:this._anyControlsHaveStatus(tf)?tf:Ll}_anyControlsHaveStatus(t){return this._anyControls(n=>n.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){nf(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(t){return null}_assignValidators(t){this._rawValidators=Array.isArray(t)?t.slice():t,this._composedValidatorFn=function eG(e){return Array.isArray(e)?my(e):e||null}(this._rawValidators)}_assignAsyncValidators(t){this._rawAsyncValidators=Array.isArray(t)?t.slice():t,this._composedAsyncValidatorFn=function tG(e){return Array.isArray(e)?_y(e):e||null}(this._rawAsyncValidators)}}class by extends lR{constructor(t,n,r){super(function Ey(e){return(nf(e)?e.validators:e)||null}(n),function wy(e,t){return(nf(t)?t.asyncValidators:e)||null}(r,n)),this.controls=t,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,n){return this.controls[t]?this.controls[t]:(this.controls[t]=n,n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange),n)}addControl(t,n,r={}){this.registerControl(t,n),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(t,n={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}setControl(t,n,r={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],n&&this.registerControl(t,n),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,n={}){(function cR(e,t,n){e._forEachChild((r,o)=>{if(void 0===n[o])throw new Fe(1002,"")})})(this,0,t),Object.keys(t).forEach(r=>{(function aR(e,t,n){const r=e.controls;if(!(t?Object.keys(r):r).length)throw new Fe(1e3,"");if(!r[n])throw new Fe(1001,"")})(this,!0,r),this.controls[r].setValue(t[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(t,n={}){null!=t&&(Object.keys(t).forEach(r=>{const o=this.controls[r];o&&o.patchValue(t[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(t={},n={}){this._forEachChild((r,o)=>{r.reset(t?t[o]:null,{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n),this._updateTouched(n),this.updateValueAndValidity(n)}getRawValue(){return this._reduceChildren({},(t,n,r)=>(t[r]=n.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(n,r)=>!!r._syncPendingControls()||n);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(n=>{const r=this.controls[n];r&&t(r,n)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const[n,r]of Object.entries(this.controls))if(this.contains(n)&&t(r))return!0;return!1}_reduceValue(){return this._reduceChildren({},(n,r,o)=>((r.enabled||this.disabled)&&(n[o]=r.value),n))}_reduceChildren(t,n){let r=t;return this._forEachChild((o,i)=>{r=n(r,o,i)}),r}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(t){return this.controls.hasOwnProperty(t)?this.controls[t]:null}}const ls=new Ve("CallSetDisabledState",{providedIn:"root",factory:()=>Ul}),Ul="always";function af(e,t){e.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(t)})}function Iy(e,t){const n=function XM(e){return e._rawValidators}(e);null!==t.validator?e.setValidators(JM(n,t.validator)):"function"==typeof n&&e.setValidators([n]);const r=function eR(e){return e._rawAsyncValidators}(e);null!==t.asyncValidator?e.setAsyncValidators(JM(r,t.asyncValidator)):"function"==typeof r&&e.setAsyncValidators([r]);const o=()=>e.updateValueAndValidity();af(t._rawValidators,o),af(t._rawAsyncValidators,o)}function uR(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}const dG={provide:cr,useExisting:Rt(()=>lf)},jl=(()=>Promise.resolve())();let lf=(()=>{class e extends cr{constructor(n,r,o){super(),this.callSetDisabledState=o,this.submitted=!1,this._directives=new Set,this.ngSubmit=new an,this.form=new by({},my(n),_y(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(n){jl.then(()=>{const r=this._findContainer(n.path);n.control=r.registerControl(n.name,n.control),function Bl(e,t,n=Ul){Iy(e,t),t.valueAccessor.writeValue(e.value),(e.disabled||"always"===n)&&t.valueAccessor.setDisabledState?.(e.disabled),function oG(e,t){t.valueAccessor.registerOnChange(n=>{e._pendingValue=n,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&uR(e,t)})}(e,t),function sG(e,t){const n=(r,o)=>{t.valueAccessor.writeValue(r),o&&t.viewToModelUpdate(r)};e.registerOnChange(n),t._registerOnDestroy(()=>{e._unregisterOnChange(n)})}(e,t),function iG(e,t){t.valueAccessor.registerOnTouched(()=>{e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&uR(e,t),"submit"!==e.updateOn&&e.markAsTouched()})}(e,t),function rG(e,t){if(t.valueAccessor.setDisabledState){const n=r=>{t.valueAccessor.setDisabledState(r)};e.registerOnDisabledChange(n),t._registerOnDestroy(()=>{e._unregisterOnDisabledChange(n)})}}(e,t)}(n.control,n,this.callSetDisabledState),n.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(n)})}getControl(n){return this.form.get(n.path)}removeControl(n){jl.then(()=>{const r=this._findContainer(n.path);r&&r.removeControl(n.name),this._directives.delete(n)})}addFormGroup(n){jl.then(()=>{const r=this._findContainer(n.path),o=new by({});(function dR(e,t){Iy(e,t)})(o,n),r.registerControl(n.name,o),o.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(n){jl.then(()=>{const r=this._findContainer(n.path);r&&r.removeControl(n.name)})}getFormGroup(n){return this.form.get(n.path)}updateModel(n,r){jl.then(()=>{this.form.get(n.path).setValue(r)})}setValue(n){this.control.setValue(n)}onSubmit(n){return this.submitted=!0,function hR(e,t){e._syncPendingControls(),t.forEach(n=>{const r=n.control;"submit"===r.updateOn&&r._pendingChange&&(n.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}(this.form,this._directives),this.ngSubmit.emit(n),"dialog"===n?.target?.method}onReset(){this.resetForm()}resetForm(n=void 0){this.form.reset(n),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(n){return n.pop(),n.length?this.form.get(n):this.form}static#e=this.\u0275fac=function(r){return new(r||e)(Pe(Gn,10),Pe(Mi,10),Pe(ls,8))};static#t=this.\u0275dir=lt({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(r,o){1&r&&fn("submit",function(s){return o.onSubmit(s)})("reset",function(){return o.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[rn([dG]),jt]})}return e})(),CR=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275dir=lt({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}return e})(),wR=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275mod=Bn({type:e});static#n=this.\u0275inj=Se({})}return e})();const Dy=new Ve("NgModelWithFormControlWarning");let BR=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275mod=Bn({type:e});static#n=this.\u0275inj=Se({imports:[wR]})}return e})(),BG=(()=>{class e{static withConfig(n){return{ngModule:e,providers:[{provide:ls,useValue:n.callSetDisabledState??Ul}]}}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275mod=Bn({type:e});static#n=this.\u0275inj=Se({imports:[BR]})}return e})(),jG=(()=>{class e{static withConfig(n){return{ngModule:e,providers:[{provide:Dy,useValue:n.warnOnNgModelWithFormControl??"always"},{provide:ls,useValue:n.callSetDisabledState??Ul}]}}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275mod=Bn({type:e});static#n=this.\u0275inj=Se({imports:[BR]})}return e})();const HG=["payment__stripe"];function $G(e,t){if(1&e){const n=Ki();Je(0,"div")(1,"app-checkout-products",17),fn("onDelete",function(o){return Fi(n),Ui(Pr().deleteProduct(o))}),it()()}if(2&e){const n=t.$implicit;st(1),Et("item",n)}}function VG(e,t){if(1&e&&(Je(0,"div")(1,"small",18),yt(2),it()()),2&e){const n=Pr();st(2),to(n.btnError)}}function zG(e,t){1&e&&(ed(0),Je(1,"p"),yt(2,"Processing"),it(),td())}function GG(e,t){1&e&&yt(0," Buy Now ")}const qG=function(e){return{disabled:e}},jR=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];B0=!0;var o=Date.now();return U0.then(function(i){return function(t,n,r){if(null===t)return null;var o=t.apply(void 0,n);return function(t,n){!t||!t._registerWrapper||t._registerWrapper({name:"stripe-js",version:"2.2.1",startTime:n})}(o,r),o}(i,n,o)})}("pk_test_51OMxw0J6RW9kbSMXp5MMqGOfywl5PhxsY92EHgVwRYF5mKuAKsoefjQ6Q3K90sGfcL1ENpibuamnBJP0aIi2R9IN00Myj2OkPP");let KG=(()=>{class e{constructor(n,r,o){var i=this;this._basketService=n,this.router=r,this._authService=o,this.items=[],this.jwt="USER_TOKEN",this.baseUrl="https://azurepaymentfunc.azurewebsites.net/api/",this.cosmosOrderUrl="https://amazoncloneapi.azurewebsites.net/api/product/postneworder",this.totAmount=0,this.basketLength=0,this.shippingAddress="",this.btnProcessing=!1,this.btnError="",this.getClientSecret=(0,ge.Z)(function*(){const s=yield Dh({method:"post",url:i.baseUrl+`createPayment?amount=${i.totAmount}`});i.clientSecret=s.data.clientSecret})}ngOnInit(){this._basketService.basketLength$.subscribe(n=>{for(var r in this.basketLength=n,this.items=this._basketService.items,this.totAmount=0,this.items)this.totAmount+=parseFloat(this.items[r].price)}),this.addShippingAddress(this.jwt),this.initialize()}initialize(){var n=this;return(0,ge.Z)(function*(){n.stripe=yield jR;const o=n.stripe.elements().create("card");o.on("change",i=>{n.handleChange(i)}),o.mount(n.stripeCardHtml.nativeElement),n.cardElement=o})()}handleChange(n){this.btnError=n.error?n.error.message:""}handleSubmit(){var n=this;return(0,ge.Z)(function*(){n.btnProcessing=!0,yield n.getClientSecret(),(yield jR)?.confirmCardPayment(n.clientSecret,{payment_method:{card:n.cardElement}}).then(o=>{if(o.error)return n.btnError="Card Declined. Please enter correct card details. Hint: Use test card '4242 4242 4242 4242' and enter random expiry date & CVC",void(n.btnProcessing=!1);n.btnError="",n.sendToOrdersQueue(o.paymentIntent).then(()=>{n.router.navigate(["/orders"],{queryParams:{id:o.paymentIntent.id}}),n.btnProcessing=!1})})})()}deleteProduct(n){this.items=this.items.filter(r=>r.tempId!==n),this._basketService.removeFromBasket(n)}addShippingAddress(n){let r=localStorage.getItem(n);if(r){const o=JSON.parse(r);this.shippingAddress+=`<p> ${o.given_name} ${o.family_name} <br>\n                                   ${o.streetAddress}                   <br>\n                                   ${o.city}, ${o.state}            <br>\n                                   ${o.country} - ${o.postalCode}   </p>`}}sendToOrdersQueue(n){var r=this;return(0,ge.Z)(function*(){let o="";yield Dh.get("https://amazoncloneapi.azurewebsites.net/api/product/GetAzureMQSecret").then(f=>{o=f.data});const s=new V6(o),a=s.createSender("ordersqueue");try{var l=[];const f=JSON.parse(localStorage.getItem(r.jwt)||"");for(var h in r.items)l.push({prodId:r.items[h].tempId,price:r.items[h].price});const v={id:n.id,user:f.given_name+" "+f.family_name,email:f.emails[0],shippingAddress:f.streetAddress+" "+f.city+"-"+f.postalCode,shippingState:f.state,items:l,created:n.created,amount:n.amount/100},x={body:v,contentType:"application/json"};yield a.sendMessages(x),Dh.post(r.cosmosOrderUrl,v).then(W=>{}),console.log("Item sent to Message Queue successfully!")}catch(f){console.error("Some error occurred. Cannot send message to the message queue. Error Details: ",f)}finally{yield a.close(),yield s.close()}})()}static#e=this.\u0275fac=function(r){return new(r||e)(Pe(Ea),Pe(ir),Pe(rh))};static#t=this.\u0275cmp=Sr({type:e,selectors:[["app-payment"]],viewQuery:function(r,o){if(1&r&&function PI(e,t,n){const r=At();r.firstCreatePass&&(LI(r,new OI(e,t,n),-1),2==(2&t)&&(r.staticViewQueries=!0)),xI(r,Le(),t)}(HG,5),2&r){let i;xg(i=Lg())&&(o.stripeCardHtml=i.first)}},decls:37,vars:13,consts:[[1,"payment"],[1,"payment__container"],["routerLink","/checkout","routerLinkActive","active"],[1,"payment__section"],[1,"payment__title"],[1,"payment__address",3,"innerHTML"],[1,"payment__items"],[4,"ngFor","ngForOf"],[1,"payment__details",2,"flex","0.8"],[3,"submit"],[2,"width","100%"],["payment__stripe",""],[4,"ngIf"],[1,"payment__priceContainer",2,"flex-direction","column"],[3,"ngClass","disabled"],[4,"ngIf","ngIfElse"],["buyNowContent",""],[1,"item",3,"item","onDelete"],[2,"color","red"]],template:function(r,o){if(1&r&&($t(0,"app-header"),Je(1,"div",0)(2,"div",1)(3,"h1"),yt(4,"Checkout ("),Je(5,"a",2),yt(6),it(),yt(7,")"),it(),Je(8,"div",3)(9,"div",4)(10,"h3"),yt(11,"Delivery Address"),it()(),$t(12,"div",5),it(),Je(13,"div",3)(14,"div",4)(15,"h3"),yt(16,"Review items and delivery"),it()(),Je(17,"div",6),tr(18,$G,2,1,"div",7),it()(),Je(19,"div",3)(20,"div",4)(21,"h3"),yt(22,"Payment Method"),it()(),Je(23,"div",8)(24,"form",9),fn("submit",function(){return o.handleSubmit()}),$t(25,"div",10,11),tr(27,VG,3,1,"div",12),$t(28,"br"),Je(29,"div",13)(30,"strong"),yt(31),Bc(32,"currency"),it(),Je(33,"button",14),tr(34,zG,3,0,"ng-container",15),tr(35,GG,1,0,"ng-template",null,16,UI),it()()()()()()()),2&r){const i=function kw(e){return bs(function QO(){return at.lFrame.contextLView}(),bt+e)}(36);st(6),to(o.basketLength>1||0==o.basketLength?o.basketLength+" items":o.basketLength+" item"),st(6),Et("innerHTML",o.shippingAddress,Ru),st(6),Et("ngForOf",o.items),st(9),Et("ngIf",o.btnError),st(4),$o("Order Total: ",cd(32,9,o.totAmount),""),st(2),Et("ngClass",function gI(e,t,n,r){return mI(Le(),Qn(),e,t,n,r)}(11,qG,o.btnProcessing))("disabled",o.btnProcessing),st(1),Et("ngIf",o.btnProcessing)("ngIfElse",i)}},dependencies:[QS,Od,ua,ul,kA,CR,iR,lf,gh,d_,kd],styles:[".payment[_ngcontent-%COMP%]{background-color:#fff}.payment__container[_ngcontent-%COMP%] > h1[_ngcontent-%COMP%]{text-align:center;padding:10px;font-weight:400;background-color:#eaeded;border-bottom:1px solid lightgray}.payment__container[_ngcontent-%COMP%] > h1[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none}.payment__section[_ngcontent-%COMP%]{display:flex;padding:20px;margin:0 20px;border-bottom:1px solid lightgray}.payment__title[_ngcontent-%COMP%]{flex:.2}.payment__address[_ngcontent-%COMP%], .payment__items[_ngcontent-%COMP%]{flex:.8}.payment__details[_ngcontent-%COMP%] > form[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{background:#f0c14b;border-radius:2px;width:100%;height:30px;border:1px solid;margin-top:10px;border-color:#a88734 #9c7e31 #846a29;color:#111;cursor:pointer}.payment__details[_ngcontent-%COMP%] > form[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > button.disabled[_ngcontent-%COMP%]{background:#ccc;cursor:not-allowed}"]})}return e})();function WG(e,t){if(1&e&&(Je(0,"div"),$t(1,"app-checkout-products",5),it()),2&e){const n=t.$implicit;st(1),Et("isBtnHidden",!0)("item",n)}}function ZG(e,t){if(1&e&&(Je(0,"div",1)(1,"h2"),yt(2,"Order"),it(),Je(3,"p"),yt(4),it(),Je(5,"p",2)(6,"small"),yt(7),it()(),tr(8,WG,2,2,"div",3),Je(9,"h3",4),yt(10),Bc(11,"currency"),it()()),2&e){const n=Pr();st(4),to(n.createdDate),st(3),to(n.orderData.id),st(1),Et("ngForOf",n.items),st(2),$o("Order Total: ",cd(11,4,n.orderData.amount),"")}}let YG=(()=>{class e{constructor(n,r){this.datePipe=n,this._basketService=r,this.createdDate=""}ngOnChanges(n){n.orderData&&n.orderData.currentValue&&(this.createdDate=this.datePipe.transform(1e3*this.orderData.created,"medium")||"",this._basketService.items.length>0?(this.items=this._basketService.items,localStorage.setItem("order_item",JSON.stringify(this.items)),this._basketService.emptyBasket()):this.items=JSON.parse(localStorage.getItem("order_item")||""))}static#e=this.\u0275fac=function(r){return new(r||e)(Pe(ym),Pe(Ea))};static#t=this.\u0275cmp=Sr({type:e,selectors:[["app-order-items"]],inputs:{orderData:"orderData"},features:[Ar],decls:1,vars:1,consts:[["class","order",4,"ngIf"],[1,"order"],[1,"order__id"],[4,"ngFor","ngForOf"],[1,"order__total"],[3,"isBtnHidden","item"]],template:function(r,o){1&r&&tr(0,ZG,12,6,"div",0),2&r&&Et("ngIf",o.orderData)},dependencies:[Od,ua,d_,kd],styles:[".order[_ngcontent-%COMP%]{padding:40px;margin:20px 0;border:1px solid lightgray;background-color:#fff;position:relative}.order__id[_ngcontent-%COMP%]{position:absolute;top:40px;right:20px}.order__total[_ngcontent-%COMP%]{font-weight:500;text-align:right}"]})}return e})();function QG(e,t){if(1&e&&(Je(0,"div",2),$t(1,"app-order-items",3),it()),2&e){const n=Pr();st(1),Et("orderData",n.orderData)}}const JG=[{path:"home",component:N0},{path:"checkout",component:Tz},{path:"payment",component:KG},{path:"orders",component:(()=>{class e{constructor(n){this.route=n,this.orderDetailUrl="https://amazoncloneapi.azurewebsites.net/api/product/getorderbyid?id=",this.orderData=null}ngOnInit(){let n=this.route.snapshot.queryParamMap.get("id")||"";n?(this.getOrderDetails(n),localStorage.setItem("last_transaction",n)):this.getOrderDetails(localStorage.getItem("last_transaction")||"")}getOrderDetails(n){var r=this;return(0,ge.Z)(function*(){try{yield Dh.get(r.orderDetailUrl+n).then(o=>{r.orderData=o.data})}catch(o){console.log(`Some error occurred! Order Id: ${n} not found.`),console.error(o)}})()}static#e=this.\u0275fac=function(r){return new(r||e)(Pe(ns))};static#t=this.\u0275cmp=Sr({type:e,selectors:[["app-orders"]],decls:5,vars:1,consts:[[1,"orders"],["class","orders__order",4,"ngIf"],[1,"orders__order"],[3,"orderData"]],template:function(r,o){1&r&&($t(0,"app-header"),Je(1,"div",0)(2,"h1"),yt(3," Your Orders "),it(),tr(4,QG,2,1,"div",1),it()),2&r&&(st(4),Et("ngIf",o.orderData))},dependencies:[ua,gh,YG],styles:[".orders[_ngcontent-%COMP%]{padding:20px 80px}.orders[_ngcontent-%COMP%] > h1[_ngcontent-%COMP%]{margin:30px 0}"]})}return e})()},{path:"",component:N0}];let XG=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275mod=Bn({type:e});static#n=this.\u0275inj=Se({imports:[jA.forRoot(JG),jA]})}return e})(),eq=(()=>{class e{constructor(){this.title="amazon-clone-app"}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275cmp=Sr({type:e,selectors:[["app-root"]],decls:2,vars:0,consts:[[1,"app"]],template:function(r,o){1&r&&(Je(0,"div",0),$t(1,"router-outlet"),it())},dependencies:[qm]})}return e})();var HR=S(4630),tq=S(7803),$R=S(7580);class nq{constructor(t){this.browserEnvironment=typeof window<"u",this.config=(0,tq._7)(t,this.browserEnvironment),this.logger=new HR.Y(this.config.system.loggerOptions,$R.u,$R.i),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}let VR=(()=>{class e extends nq{getModuleName(){return e.MODULE_NAME}getId(){return e.ID}initialize(){var n=this;return(0,ge.Z)(function*(){return n.available=typeof window<"u",n.available})()}}return e.MODULE_NAME="",e.ID="StandardOperatingContext",e})();function xy(){return xy=(0,ge.Z)(function*(e){const t=new VR(e);return yield t.initialize(),yield(yield Promise.resolve().then(S.bind(S,877))).StandardController.createController(t)}),xy.apply(this,arguments)}var oq=S(877);class Fy{static createPublicClientApplication(t){return(0,ge.Z)(function*(){const n=yield function rq(e){return xy.apply(this,arguments)}(t);return new Fy(t,n)})()}constructor(t,n){if(n)this.controller=n;else{const r=new VR(t);this.controller=new oq.StandardController(r)}}initialize(){var t=this;return(0,ge.Z)(function*(){return t.controller.initialize()})()}acquireTokenPopup(t){var n=this;return(0,ge.Z)(function*(){return n.controller.acquireTokenPopup(t)})()}acquireTokenRedirect(t){return this.controller.acquireTokenRedirect(t)}acquireTokenSilent(t){return this.controller.acquireTokenSilent(t)}acquireTokenByCode(t){return this.controller.acquireTokenByCode(t)}addEventCallback(t){return this.controller.addEventCallback(t)}removeEventCallback(t){return this.controller.removeEventCallback(t)}addPerformanceCallback(t){return this.controller.addPerformanceCallback(t)}removePerformanceCallback(t){return this.controller.removePerformanceCallback(t)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(t){return this.controller.getAccount(t)}getAccountByHomeId(t){return this.controller.getAccountByHomeId(t)}getAccountByLocalId(t){return this.controller.getAccountByLocalId(t)}getAccountByUsername(t){return this.controller.getAccountByUsername(t)}getAllAccounts(t){return this.controller.getAllAccounts(t)}handleRedirectPromise(t){return this.controller.handleRedirectPromise(t)}loginPopup(t){return this.controller.loginPopup(t)}loginRedirect(t){return this.controller.loginRedirect(t)}logout(t){return this.controller.logout(t)}logoutRedirect(t){return this.controller.logoutRedirect(t)}logoutPopup(t){return this.controller.logoutPopup(t)}ssoSilent(t){return this.controller.ssoSilent(t)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(t){this.controller.setLogger(t)}setActiveAccount(t){this.controller.setActiveAccount(t)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(t,n){return this.controller.initializeWrapperLibrary(t,n)}setNavigationClient(t){this.controller.setNavigationClient(t)}getConfiguration(){return this.controller.getConfiguration()}hydrateCache(t,n){var r=this;return(0,ge.Z)(function*(){return r.controller.hydrateCache(t,n)})()}clearCache(t){return this.controller.clearCache(t)}}const iq=window.navigator.userAgent.indexOf("MSIE ")>-1||window.navigator.userAgent.indexOf("Trident/")>-1,sq={auth:{clientId:"b8e00d45-1c7e-4a18-92a0-16020ffc9228",authority:"https://myamazoncloneorg.b2clogin.com/myamazoncloneorg.onmicrosoft.com/B2C_1_SignUpSignIn",knownAuthorities:["myamazoncloneorg.b2clogin.com"],redirectUri:"https://zahidd02.github.io/Amazon_Clone_Hoster/",postLogoutRedirectUri:"https://zahidd02.github.io/Amazon_Clone_Hoster/"},cache:{cacheLocation:on.Ix.LocalStorage,storeAuthStateInCookie:iq},system:{allowRedirectInIframe:!0,loggerOptions:{loggerCallback(e,t){console.log(t)},logLevel:HR.i.Warning,piiLoggingEnabled:!1}}};function aq(){return new Fy(sq)}let cq=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275mod=Bn({type:e,bootstrap:[eq]});static#n=this.\u0275inj=Se({providers:[{provide:nh,useFactory:aq},dl,ym],imports:[Wj,XG,gz,Q3,jG,UV,BG]})}return e})();qj().bootstrapModule(cq).catch(e=>console.error(e))},9919:(fe,F)=>{"use strict";F.byteLength=function B(z){var C=H(z),K=C[1];return 3*(C[0]+K)/4-K},F.toByteArray=function M(z){var C,U,k=H(z),K=k[0],w=k[1],j=new p(function g(z,C,k){return 3*(C+k)/4-k}(0,K,w)),_=0,b=w>0?K-4:K;for(U=0;U<b;U+=4)C=E[z.charCodeAt(U)]<<18|E[z.charCodeAt(U+1)]<<12|E[z.charCodeAt(U+2)]<<6|E[z.charCodeAt(U+3)],j[_++]=C>>16&255,j[_++]=C>>8&255,j[_++]=255&C;return 2===w&&(C=E[z.charCodeAt(U)]<<2|E[z.charCodeAt(U+1)]>>4,j[_++]=255&C),1===w&&(C=E[z.charCodeAt(U)]<<10|E[z.charCodeAt(U+1)]<<4|E[z.charCodeAt(U+2)]>>2,j[_++]=C>>8&255,j[_++]=255&C),j},F.fromByteArray=function J(z){for(var C,k=z.length,K=k%3,w=[],j=16383,_=0,b=k-K;_<b;_+=j)w.push(V(z,_,_+j>b?b:_+j));return 1===K?w.push(S[(C=z[k-1])>>2]+S[C<<4&63]+"=="):2===K&&w.push(S[(C=(z[k-2]<<8)+z[k-1])>>10]+S[C>>4&63]+S[C<<2&63]+"="),w.join("")};for(var S=[],E=[],p=typeof Uint8Array<"u"?Uint8Array:Array,O="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",R=0;R<64;++R)S[R]=O[R],E[O.charCodeAt(R)]=R;function H(z){var C=z.length;if(C%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var k=z.indexOf("=");return-1===k&&(k=C),[k,k===C?0:4-k%4]}function D(z){return S[z>>18&63]+S[z>>12&63]+S[z>>6&63]+S[63&z]}function V(z,C,k){for(var w=[],j=C;j<k;j+=3)w.push(D((z[j]<<16&16711680)+(z[j+1]<<8&65280)+(255&z[j+2])));return w.join("")}E["-".charCodeAt(0)]=62,E["_".charCodeAt(0)]=63},9007:(fe,F,S)=>{"use strict";const p=S(9919),O=S(2601),R="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;F.lW=g,F.h2=50;const $=2147483647;function B(Y){if(Y>$)throw new RangeError('The value "'+Y+'" is invalid for option "size"');const I=new Uint8Array(Y);return Object.setPrototypeOf(I,g.prototype),I}function g(Y,I,P){if("number"==typeof Y){if("string"==typeof I)throw new TypeError('The "string" argument must be of type string. Received type number');return J(Y)}return M(Y,I,P)}function M(Y,I,P){if("string"==typeof Y)return function z(Y,I){if(("string"!=typeof I||""===I)&&(I="utf8"),!g.isEncoding(I))throw new TypeError("Unknown encoding: "+I);const P=0|b(Y,I);let X=B(P);const he=X.write(Y,I);return he!==P&&(X=X.slice(0,he)),X}(Y,I);if(ArrayBuffer.isView(Y))return function k(Y){if(Kn(Y,Uint8Array)){const I=new Uint8Array(Y);return K(I.buffer,I.byteOffset,I.byteLength)}return C(Y)}(Y);if(null==Y)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Y);if(Kn(Y,ArrayBuffer)||Y&&Kn(Y.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Kn(Y,SharedArrayBuffer)||Y&&Kn(Y.buffer,SharedArrayBuffer)))return K(Y,I,P);if("number"==typeof Y)throw new TypeError('The "value" argument must not be of type number. Received type number');const X=Y.valueOf&&Y.valueOf();if(null!=X&&X!==Y)return g.from(X,I,P);const he=function w(Y){if(g.isBuffer(Y)){const I=0|j(Y.length),P=B(I);return 0===P.length||Y.copy(P,0,0,I),P}return void 0!==Y.length?"number"!=typeof Y.length||dr(Y.length)?B(0):C(Y):"Buffer"===Y.type&&Array.isArray(Y.data)?C(Y.data):void 0}(Y);if(he)return he;if(typeof Symbol<"u"&&null!=Symbol.toPrimitive&&"function"==typeof Y[Symbol.toPrimitive])return g.from(Y[Symbol.toPrimitive]("string"),I,P);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Y)}function D(Y){if("number"!=typeof Y)throw new TypeError('"size" argument must be of type number');if(Y<0)throw new RangeError('The value "'+Y+'" is invalid for option "size"')}function J(Y){return D(Y),B(Y<0?0:0|j(Y))}function C(Y){const I=Y.length<0?0:0|j(Y.length),P=B(I);for(let X=0;X<I;X+=1)P[X]=255&Y[X];return P}function K(Y,I,P){if(I<0||Y.byteLength<I)throw new RangeError('"offset" is outside of buffer bounds');if(Y.byteLength<I+(P||0))throw new RangeError('"length" is outside of buffer bounds');let X;return X=void 0===I&&void 0===P?new Uint8Array(Y):void 0===P?new Uint8Array(Y,I):new Uint8Array(Y,I,P),Object.setPrototypeOf(X,g.prototype),X}function j(Y){if(Y>=$)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+$.toString(16)+" bytes");return 0|Y}function b(Y,I){if(g.isBuffer(Y))return Y.length;if(ArrayBuffer.isView(Y)||Kn(Y,ArrayBuffer))return Y.byteLength;if("string"!=typeof Y)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Y);const P=Y.length,X=arguments.length>2&&!0===arguments[2];if(!X&&0===P)return 0;let he=!1;for(;;)switch(I){case"ascii":case"latin1":case"binary":return P;case"utf8":case"utf-8":return qn(Y).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*P;case"hex":return P>>>1;case"base64":return vn(Y).length;default:if(he)return X?-1:qn(Y).length;I=(""+I).toLowerCase(),he=!0}}function U(Y,I,P){let X=!1;if((void 0===I||I<0)&&(I=0),I>this.length||((void 0===P||P>this.length)&&(P=this.length),P<=0)||(P>>>=0)<=(I>>>=0))return"";for(Y||(Y="utf8");;)switch(Y){case"hex":return ee(this,I,P);case"utf8":case"utf-8":return Be(this,I,P);case"ascii":return G(this,I,P);case"latin1":case"binary":return oe(this,I,P);case"base64":return He(this,I,P);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ue(this,I,P);default:if(X)throw new TypeError("Unknown encoding: "+Y);Y=(Y+"").toLowerCase(),X=!0}}function q(Y,I,P){const X=Y[I];Y[I]=Y[P],Y[P]=X}function te(Y,I,P,X,he){if(0===Y.length)return-1;if("string"==typeof P?(X=P,P=0):P>2147483647?P=2147483647:P<-2147483648&&(P=-2147483648),dr(P=+P)&&(P=he?0:Y.length-1),P<0&&(P=Y.length+P),P>=Y.length){if(he)return-1;P=Y.length-1}else if(P<0){if(!he)return-1;P=0}if("string"==typeof I&&(I=g.from(I,X)),g.isBuffer(I))return 0===I.length?-1:se(Y,I,P,X,he);if("number"==typeof I)return I&=255,"function"==typeof Uint8Array.prototype.indexOf?he?Uint8Array.prototype.indexOf.call(Y,I,P):Uint8Array.prototype.lastIndexOf.call(Y,I,P):se(Y,[I],P,X,he);throw new TypeError("val must be string, number or Buffer")}function se(Y,I,P,X,he){let wt,ye=1,Oe=Y.length,dt=I.length;if(void 0!==X&&("ucs2"===(X=String(X).toLowerCase())||"ucs-2"===X||"utf16le"===X||"utf-16le"===X)){if(Y.length<2||I.length<2)return-1;ye=2,Oe/=2,dt/=2,P/=2}function Kt(Gt,St){return 1===ye?Gt[St]:Gt.readUInt16BE(St*ye)}if(he){let Gt=-1;for(wt=P;wt<Oe;wt++)if(Kt(Y,wt)===Kt(I,-1===Gt?0:wt-Gt)){if(-1===Gt&&(Gt=wt),wt-Gt+1===dt)return Gt*ye}else-1!==Gt&&(wt-=wt-Gt),Gt=-1}else for(P+dt>Oe&&(P=Oe-dt),wt=P;wt>=0;wt--){let Gt=!0;for(let St=0;St<dt;St++)if(Kt(Y,wt+St)!==Kt(I,St)){Gt=!1;break}if(Gt)return wt}return-1}function ie(Y,I,P,X){P=Number(P)||0;const he=Y.length-P;X?(X=Number(X))>he&&(X=he):X=he;const ye=I.length;let Oe;for(X>ye/2&&(X=ye/2),Oe=0;Oe<X;++Oe){const dt=parseInt(I.substr(2*Oe,2),16);if(dr(dt))return Oe;Y[P+Oe]=dt}return Oe}function ce(Y,I,P,X){return ei(qn(I,Y.length-P),Y,P,X)}function me(Y,I,P,X){return ei(function Re(Y){const I=[];for(let P=0;P<Y.length;++P)I.push(255&Y.charCodeAt(P));return I}(I),Y,P,X)}function De(Y,I,P,X){return ei(vn(I),Y,P,X)}function Ee(Y,I,P,X){return ei(function qr(Y,I){let P,X,he;const ye=[];for(let Oe=0;Oe<Y.length&&!((I-=2)<0);++Oe)P=Y.charCodeAt(Oe),X=P>>8,he=P%256,ye.push(he),ye.push(X);return ye}(I,Y.length-P),Y,P,X)}function He(Y,I,P){return p.fromByteArray(0===I&&P===Y.length?Y:Y.slice(I,P))}function Be(Y,I,P){P=Math.min(Y.length,P);const X=[];let he=I;for(;he<P;){const ye=Y[he];let Oe=null,dt=ye>239?4:ye>223?3:ye>191?2:1;if(he+dt<=P){let Kt,wt,Gt,St;switch(dt){case 1:ye<128&&(Oe=ye);break;case 2:Kt=Y[he+1],128==(192&Kt)&&(St=(31&ye)<<6|63&Kt,St>127&&(Oe=St));break;case 3:Kt=Y[he+1],wt=Y[he+2],128==(192&Kt)&&128==(192&wt)&&(St=(15&ye)<<12|(63&Kt)<<6|63&wt,St>2047&&(St<55296||St>57343)&&(Oe=St));break;case 4:Kt=Y[he+1],wt=Y[he+2],Gt=Y[he+3],128==(192&Kt)&&128==(192&wt)&&128==(192&Gt)&&(St=(15&ye)<<18|(63&Kt)<<12|(63&wt)<<6|63&Gt,St>65535&&St<1114112&&(Oe=St))}}null===Oe?(Oe=65533,dt=1):Oe>65535&&(Oe-=65536,X.push(Oe>>>10&1023|55296),Oe=56320|1023&Oe),X.push(Oe),he+=dt}return function pe(Y){const I=Y.length;if(I<=ze)return String.fromCharCode.apply(String,Y);let P="",X=0;for(;X<I;)P+=String.fromCharCode.apply(String,Y.slice(X,X+=ze));return P}(X)}!(g.TYPED_ARRAY_SUPPORT=function H(){try{const Y=new Uint8Array(1),I={foo:function(){return 42}};return Object.setPrototypeOf(I,Uint8Array.prototype),Object.setPrototypeOf(Y,I),42===Y.foo()}catch{return!1}}())&&typeof console<"u"&&"function"==typeof console.error&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(g.prototype,"parent",{enumerable:!0,get:function(){if(g.isBuffer(this))return this.buffer}}),Object.defineProperty(g.prototype,"offset",{enumerable:!0,get:function(){if(g.isBuffer(this))return this.byteOffset}}),g.poolSize=8192,g.from=function(Y,I,P){return M(Y,I,P)},Object.setPrototypeOf(g.prototype,Uint8Array.prototype),Object.setPrototypeOf(g,Uint8Array),g.alloc=function(Y,I,P){return function V(Y,I,P){return D(Y),Y<=0?B(Y):void 0!==I?"string"==typeof P?B(Y).fill(I,P):B(Y).fill(I):B(Y)}(Y,I,P)},g.allocUnsafe=function(Y){return J(Y)},g.allocUnsafeSlow=function(Y){return J(Y)},g.isBuffer=function(I){return null!=I&&!0===I._isBuffer&&I!==g.prototype},g.compare=function(I,P){if(Kn(I,Uint8Array)&&(I=g.from(I,I.offset,I.byteLength)),Kn(P,Uint8Array)&&(P=g.from(P,P.offset,P.byteLength)),!g.isBuffer(I)||!g.isBuffer(P))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(I===P)return 0;let X=I.length,he=P.length;for(let ye=0,Oe=Math.min(X,he);ye<Oe;++ye)if(I[ye]!==P[ye]){X=I[ye],he=P[ye];break}return X<he?-1:he<X?1:0},g.isEncoding=function(I){switch(String(I).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},g.concat=function(I,P){if(!Array.isArray(I))throw new TypeError('"list" argument must be an Array of Buffers');if(0===I.length)return g.alloc(0);let X;if(void 0===P)for(P=0,X=0;X<I.length;++X)P+=I[X].length;const he=g.allocUnsafe(P);let ye=0;for(X=0;X<I.length;++X){let Oe=I[X];if(Kn(Oe,Uint8Array))ye+Oe.length>he.length?(g.isBuffer(Oe)||(Oe=g.from(Oe)),Oe.copy(he,ye)):Uint8Array.prototype.set.call(he,Oe,ye);else{if(!g.isBuffer(Oe))throw new TypeError('"list" argument must be an Array of Buffers');Oe.copy(he,ye)}ye+=Oe.length}return he},g.byteLength=b,g.prototype._isBuffer=!0,g.prototype.swap16=function(){const I=this.length;if(I%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let P=0;P<I;P+=2)q(this,P,P+1);return this},g.prototype.swap32=function(){const I=this.length;if(I%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let P=0;P<I;P+=4)q(this,P,P+3),q(this,P+1,P+2);return this},g.prototype.swap64=function(){const I=this.length;if(I%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let P=0;P<I;P+=8)q(this,P,P+7),q(this,P+1,P+6),q(this,P+2,P+5),q(this,P+3,P+4);return this},g.prototype.toLocaleString=g.prototype.toString=function(){const I=this.length;return 0===I?"":0===arguments.length?Be(this,0,I):U.apply(this,arguments)},g.prototype.equals=function(I){if(!g.isBuffer(I))throw new TypeError("Argument must be a Buffer");return this===I||0===g.compare(this,I)},g.prototype.inspect=function(){let I="";const P=F.h2;return I=this.toString("hex",0,P).replace(/(.{2})/g,"$1 ").trim(),this.length>P&&(I+=" ... "),"<Buffer "+I+">"},R&&(g.prototype[R]=g.prototype.inspect),g.prototype.compare=function(I,P,X,he,ye){if(Kn(I,Uint8Array)&&(I=g.from(I,I.offset,I.byteLength)),!g.isBuffer(I))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof I);if(void 0===P&&(P=0),void 0===X&&(X=I?I.length:0),void 0===he&&(he=0),void 0===ye&&(ye=this.length),P<0||X>I.length||he<0||ye>this.length)throw new RangeError("out of range index");if(he>=ye&&P>=X)return 0;if(he>=ye)return-1;if(P>=X)return 1;if(this===I)return 0;let Oe=(ye>>>=0)-(he>>>=0),dt=(X>>>=0)-(P>>>=0);const Kt=Math.min(Oe,dt),wt=this.slice(he,ye),Gt=I.slice(P,X);for(let St=0;St<Kt;++St)if(wt[St]!==Gt[St]){Oe=wt[St],dt=Gt[St];break}return Oe<dt?-1:dt<Oe?1:0},g.prototype.includes=function(I,P,X){return-1!==this.indexOf(I,P,X)},g.prototype.indexOf=function(I,P,X){return te(this,I,P,X,!0)},g.prototype.lastIndexOf=function(I,P,X){return te(this,I,P,X,!1)},g.prototype.write=function(I,P,X,he){if(void 0===P)he="utf8",X=this.length,P=0;else if(void 0===X&&"string"==typeof P)he=P,X=this.length,P=0;else{if(!isFinite(P))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");P>>>=0,isFinite(X)?(X>>>=0,void 0===he&&(he="utf8")):(he=X,X=void 0)}const ye=this.length-P;if((void 0===X||X>ye)&&(X=ye),I.length>0&&(X<0||P<0)||P>this.length)throw new RangeError("Attempt to write outside buffer bounds");he||(he="utf8");let Oe=!1;for(;;)switch(he){case"hex":return ie(this,I,P,X);case"utf8":case"utf-8":return ce(this,I,P,X);case"ascii":case"latin1":case"binary":return me(this,I,P,X);case"base64":return De(this,I,P,X);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ee(this,I,P,X);default:if(Oe)throw new TypeError("Unknown encoding: "+he);he=(""+he).toLowerCase(),Oe=!0}},g.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const ze=4096;function G(Y,I,P){let X="";P=Math.min(Y.length,P);for(let he=I;he<P;++he)X+=String.fromCharCode(127&Y[he]);return X}function oe(Y,I,P){let X="";P=Math.min(Y.length,P);for(let he=I;he<P;++he)X+=String.fromCharCode(Y[he]);return X}function ee(Y,I,P){const X=Y.length;(!I||I<0)&&(I=0),(!P||P<0||P>X)&&(P=X);let he="";for(let ye=I;ye<P;++ye)he+=Fn[Y[ye]];return he}function ue(Y,I,P){const X=Y.slice(I,P);let he="";for(let ye=0;ye<X.length-1;ye+=2)he+=String.fromCharCode(X[ye]+256*X[ye+1]);return he}function m(Y,I,P){if(Y%1!=0||Y<0)throw new RangeError("offset is not uint");if(Y+I>P)throw new RangeError("Trying to access beyond buffer length")}function T(Y,I,P,X,he,ye){if(!g.isBuffer(Y))throw new TypeError('"buffer" argument must be a Buffer instance');if(I>he||I<ye)throw new RangeError('"value" argument is out of bounds');if(P+X>Y.length)throw new RangeError("Index out of range")}function N(Y,I,P,X,he){tn(I,X,he,Y,P,7);let ye=Number(I&BigInt(4294967295));Y[P++]=ye,ye>>=8,Y[P++]=ye,ye>>=8,Y[P++]=ye,ye>>=8,Y[P++]=ye;let Oe=Number(I>>BigInt(32)&BigInt(4294967295));return Y[P++]=Oe,Oe>>=8,Y[P++]=Oe,Oe>>=8,Y[P++]=Oe,Oe>>=8,Y[P++]=Oe,P}function le(Y,I,P,X,he){tn(I,X,he,Y,P,7);let ye=Number(I&BigInt(4294967295));Y[P+7]=ye,ye>>=8,Y[P+6]=ye,ye>>=8,Y[P+5]=ye,ye>>=8,Y[P+4]=ye;let Oe=Number(I>>BigInt(32)&BigInt(4294967295));return Y[P+3]=Oe,Oe>>=8,Y[P+2]=Oe,Oe>>=8,Y[P+1]=Oe,Oe>>=8,Y[P]=Oe,P+8}function Ce(Y,I,P,X,he,ye){if(P+X>Y.length)throw new RangeError("Index out of range");if(P<0)throw new RangeError("Index out of range")}function Me(Y,I,P,X,he){return I=+I,P>>>=0,he||Ce(Y,0,P,4),O.write(Y,I,P,X,23,4),P+4}function Ke(Y,I,P,X,he){return I=+I,P>>>=0,he||Ce(Y,0,P,8),O.write(Y,I,P,X,52,8),P+8}g.prototype.slice=function(I,P){const X=this.length;(I=~~I)<0?(I+=X)<0&&(I=0):I>X&&(I=X),(P=void 0===P?X:~~P)<0?(P+=X)<0&&(P=0):P>X&&(P=X),P<I&&(P=I);const he=this.subarray(I,P);return Object.setPrototypeOf(he,g.prototype),he},g.prototype.readUintLE=g.prototype.readUIntLE=function(I,P,X){I>>>=0,P>>>=0,X||m(I,P,this.length);let he=this[I],ye=1,Oe=0;for(;++Oe<P&&(ye*=256);)he+=this[I+Oe]*ye;return he},g.prototype.readUintBE=g.prototype.readUIntBE=function(I,P,X){I>>>=0,P>>>=0,X||m(I,P,this.length);let he=this[I+--P],ye=1;for(;P>0&&(ye*=256);)he+=this[I+--P]*ye;return he},g.prototype.readUint8=g.prototype.readUInt8=function(I,P){return I>>>=0,P||m(I,1,this.length),this[I]},g.prototype.readUint16LE=g.prototype.readUInt16LE=function(I,P){return I>>>=0,P||m(I,2,this.length),this[I]|this[I+1]<<8},g.prototype.readUint16BE=g.prototype.readUInt16BE=function(I,P){return I>>>=0,P||m(I,2,this.length),this[I]<<8|this[I+1]},g.prototype.readUint32LE=g.prototype.readUInt32LE=function(I,P){return I>>>=0,P||m(I,4,this.length),(this[I]|this[I+1]<<8|this[I+2]<<16)+16777216*this[I+3]},g.prototype.readUint32BE=g.prototype.readUInt32BE=function(I,P){return I>>>=0,P||m(I,4,this.length),16777216*this[I]+(this[I+1]<<16|this[I+2]<<8|this[I+3])},g.prototype.readBigUInt64LE=Cn(function(I){qt(I>>>=0,"offset");const P=this[I],X=this[I+7];(void 0===P||void 0===X)&&ut(I,this.length-8);const he=P+256*this[++I]+65536*this[++I]+this[++I]*2**24,ye=this[++I]+256*this[++I]+65536*this[++I]+X*2**24;return BigInt(he)+(BigInt(ye)<<BigInt(32))}),g.prototype.readBigUInt64BE=Cn(function(I){qt(I>>>=0,"offset");const P=this[I],X=this[I+7];(void 0===P||void 0===X)&&ut(I,this.length-8);const he=P*2**24+65536*this[++I]+256*this[++I]+this[++I],ye=this[++I]*2**24+65536*this[++I]+256*this[++I]+X;return(BigInt(he)<<BigInt(32))+BigInt(ye)}),g.prototype.readIntLE=function(I,P,X){I>>>=0,P>>>=0,X||m(I,P,this.length);let he=this[I],ye=1,Oe=0;for(;++Oe<P&&(ye*=256);)he+=this[I+Oe]*ye;return ye*=128,he>=ye&&(he-=Math.pow(2,8*P)),he},g.prototype.readIntBE=function(I,P,X){I>>>=0,P>>>=0,X||m(I,P,this.length);let he=P,ye=1,Oe=this[I+--he];for(;he>0&&(ye*=256);)Oe+=this[I+--he]*ye;return ye*=128,Oe>=ye&&(Oe-=Math.pow(2,8*P)),Oe},g.prototype.readInt8=function(I,P){return I>>>=0,P||m(I,1,this.length),128&this[I]?-1*(255-this[I]+1):this[I]},g.prototype.readInt16LE=function(I,P){I>>>=0,P||m(I,2,this.length);const X=this[I]|this[I+1]<<8;return 32768&X?4294901760|X:X},g.prototype.readInt16BE=function(I,P){I>>>=0,P||m(I,2,this.length);const X=this[I+1]|this[I]<<8;return 32768&X?4294901760|X:X},g.prototype.readInt32LE=function(I,P){return I>>>=0,P||m(I,4,this.length),this[I]|this[I+1]<<8|this[I+2]<<16|this[I+3]<<24},g.prototype.readInt32BE=function(I,P){return I>>>=0,P||m(I,4,this.length),this[I]<<24|this[I+1]<<16|this[I+2]<<8|this[I+3]},g.prototype.readBigInt64LE=Cn(function(I){qt(I>>>=0,"offset");const P=this[I],X=this[I+7];return(void 0===P||void 0===X)&&ut(I,this.length-8),(BigInt(this[I+4]+256*this[I+5]+65536*this[I+6]+(X<<24))<<BigInt(32))+BigInt(P+256*this[++I]+65536*this[++I]+this[++I]*2**24)}),g.prototype.readBigInt64BE=Cn(function(I){qt(I>>>=0,"offset");const P=this[I],X=this[I+7];(void 0===P||void 0===X)&&ut(I,this.length-8);const he=(P<<24)+65536*this[++I]+256*this[++I]+this[++I];return(BigInt(he)<<BigInt(32))+BigInt(this[++I]*2**24+65536*this[++I]+256*this[++I]+X)}),g.prototype.readFloatLE=function(I,P){return I>>>=0,P||m(I,4,this.length),O.read(this,I,!0,23,4)},g.prototype.readFloatBE=function(I,P){return I>>>=0,P||m(I,4,this.length),O.read(this,I,!1,23,4)},g.prototype.readDoubleLE=function(I,P){return I>>>=0,P||m(I,8,this.length),O.read(this,I,!0,52,8)},g.prototype.readDoubleBE=function(I,P){return I>>>=0,P||m(I,8,this.length),O.read(this,I,!1,52,8)},g.prototype.writeUintLE=g.prototype.writeUIntLE=function(I,P,X,he){I=+I,P>>>=0,X>>>=0,he||T(this,I,P,X,Math.pow(2,8*X)-1,0);let ye=1,Oe=0;for(this[P]=255&I;++Oe<X&&(ye*=256);)this[P+Oe]=I/ye&255;return P+X},g.prototype.writeUintBE=g.prototype.writeUIntBE=function(I,P,X,he){I=+I,P>>>=0,X>>>=0,he||T(this,I,P,X,Math.pow(2,8*X)-1,0);let ye=X-1,Oe=1;for(this[P+ye]=255&I;--ye>=0&&(Oe*=256);)this[P+ye]=I/Oe&255;return P+X},g.prototype.writeUint8=g.prototype.writeUInt8=function(I,P,X){return I=+I,P>>>=0,X||T(this,I,P,1,255,0),this[P]=255&I,P+1},g.prototype.writeUint16LE=g.prototype.writeUInt16LE=function(I,P,X){return I=+I,P>>>=0,X||T(this,I,P,2,65535,0),this[P]=255&I,this[P+1]=I>>>8,P+2},g.prototype.writeUint16BE=g.prototype.writeUInt16BE=function(I,P,X){return I=+I,P>>>=0,X||T(this,I,P,2,65535,0),this[P]=I>>>8,this[P+1]=255&I,P+2},g.prototype.writeUint32LE=g.prototype.writeUInt32LE=function(I,P,X){return I=+I,P>>>=0,X||T(this,I,P,4,4294967295,0),this[P+3]=I>>>24,this[P+2]=I>>>16,this[P+1]=I>>>8,this[P]=255&I,P+4},g.prototype.writeUint32BE=g.prototype.writeUInt32BE=function(I,P,X){return I=+I,P>>>=0,X||T(this,I,P,4,4294967295,0),this[P]=I>>>24,this[P+1]=I>>>16,this[P+2]=I>>>8,this[P+3]=255&I,P+4},g.prototype.writeBigUInt64LE=Cn(function(I,P=0){return N(this,I,P,BigInt(0),BigInt("0xffffffffffffffff"))}),g.prototype.writeBigUInt64BE=Cn(function(I,P=0){return le(this,I,P,BigInt(0),BigInt("0xffffffffffffffff"))}),g.prototype.writeIntLE=function(I,P,X,he){if(I=+I,P>>>=0,!he){const Kt=Math.pow(2,8*X-1);T(this,I,P,X,Kt-1,-Kt)}let ye=0,Oe=1,dt=0;for(this[P]=255&I;++ye<X&&(Oe*=256);)I<0&&0===dt&&0!==this[P+ye-1]&&(dt=1),this[P+ye]=(I/Oe>>0)-dt&255;return P+X},g.prototype.writeIntBE=function(I,P,X,he){if(I=+I,P>>>=0,!he){const Kt=Math.pow(2,8*X-1);T(this,I,P,X,Kt-1,-Kt)}let ye=X-1,Oe=1,dt=0;for(this[P+ye]=255&I;--ye>=0&&(Oe*=256);)I<0&&0===dt&&0!==this[P+ye+1]&&(dt=1),this[P+ye]=(I/Oe>>0)-dt&255;return P+X},g.prototype.writeInt8=function(I,P,X){return I=+I,P>>>=0,X||T(this,I,P,1,127,-128),I<0&&(I=255+I+1),this[P]=255&I,P+1},g.prototype.writeInt16LE=function(I,P,X){return I=+I,P>>>=0,X||T(this,I,P,2,32767,-32768),this[P]=255&I,this[P+1]=I>>>8,P+2},g.prototype.writeInt16BE=function(I,P,X){return I=+I,P>>>=0,X||T(this,I,P,2,32767,-32768),this[P]=I>>>8,this[P+1]=255&I,P+2},g.prototype.writeInt32LE=function(I,P,X){return I=+I,P>>>=0,X||T(this,I,P,4,2147483647,-2147483648),this[P]=255&I,this[P+1]=I>>>8,this[P+2]=I>>>16,this[P+3]=I>>>24,P+4},g.prototype.writeInt32BE=function(I,P,X){return I=+I,P>>>=0,X||T(this,I,P,4,2147483647,-2147483648),I<0&&(I=4294967295+I+1),this[P]=I>>>24,this[P+1]=I>>>16,this[P+2]=I>>>8,this[P+3]=255&I,P+4},g.prototype.writeBigInt64LE=Cn(function(I,P=0){return N(this,I,P,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),g.prototype.writeBigInt64BE=Cn(function(I,P=0){return le(this,I,P,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),g.prototype.writeFloatLE=function(I,P,X){return Me(this,I,P,!0,X)},g.prototype.writeFloatBE=function(I,P,X){return Me(this,I,P,!1,X)},g.prototype.writeDoubleLE=function(I,P,X){return Ke(this,I,P,!0,X)},g.prototype.writeDoubleBE=function(I,P,X){return Ke(this,I,P,!1,X)},g.prototype.copy=function(I,P,X,he){if(!g.isBuffer(I))throw new TypeError("argument should be a Buffer");if(X||(X=0),!he&&0!==he&&(he=this.length),P>=I.length&&(P=I.length),P||(P=0),he>0&&he<X&&(he=X),he===X||0===I.length||0===this.length)return 0;if(P<0)throw new RangeError("targetStart out of bounds");if(X<0||X>=this.length)throw new RangeError("Index out of range");if(he<0)throw new RangeError("sourceEnd out of bounds");he>this.length&&(he=this.length),I.length-P<he-X&&(he=I.length-P+X);const ye=he-X;return this===I&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(P,X,he):Uint8Array.prototype.set.call(I,this.subarray(X,he),P),ye},g.prototype.fill=function(I,P,X,he){if("string"==typeof I){if("string"==typeof P?(he=P,P=0,X=this.length):"string"==typeof X&&(he=X,X=this.length),void 0!==he&&"string"!=typeof he)throw new TypeError("encoding must be a string");if("string"==typeof he&&!g.isEncoding(he))throw new TypeError("Unknown encoding: "+he);if(1===I.length){const Oe=I.charCodeAt(0);("utf8"===he&&Oe<128||"latin1"===he)&&(I=Oe)}}else"number"==typeof I?I&=255:"boolean"==typeof I&&(I=Number(I));if(P<0||this.length<P||this.length<X)throw new RangeError("Out of range index");if(X<=P)return this;let ye;if(P>>>=0,X=void 0===X?this.length:X>>>0,I||(I=0),"number"==typeof I)for(ye=P;ye<X;++ye)this[ye]=I;else{const Oe=g.isBuffer(I)?I:g.from(I,he),dt=Oe.length;if(0===dt)throw new TypeError('The value "'+I+'" is invalid for argument "value"');for(ye=0;ye<X-P;++ye)this[ye+P]=Oe[ye%dt]}return this};const be={};function xe(Y,I,P){be[Y]=class extends P{constructor(){super(),Object.defineProperty(this,"message",{value:I.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${Y}]`,delete this.name}get code(){return Y}set code(he){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:he,writable:!0})}toString(){return`${this.name} [${Y}]: ${this.message}`}}}function ft(Y){let I="",P=Y.length;const X="-"===Y[0]?1:0;for(;P>=X+4;P-=3)I=`_${Y.slice(P-3,P)}${I}`;return`${Y.slice(0,P)}${I}`}function tn(Y,I,P,X,he,ye){if(Y>P||Y<I){const Oe="bigint"==typeof I?"n":"";let dt;throw dt=ye>3?0===I||I===BigInt(0)?`>= 0${Oe} and < 2${Oe} ** ${8*(ye+1)}${Oe}`:`>= -(2${Oe} ** ${8*(ye+1)-1}${Oe}) and < 2 ** ${8*(ye+1)-1}${Oe}`:`>= ${I}${Oe} and <= ${P}${Oe}`,new be.ERR_OUT_OF_RANGE("value",dt,Y)}!function Ge(Y,I,P){qt(I,"offset"),(void 0===Y[I]||void 0===Y[I+P])&&ut(I,Y.length-(P+1))}(X,he,ye)}function qt(Y,I){if("number"!=typeof Y)throw new be.ERR_INVALID_ARG_TYPE(I,"number",Y)}function ut(Y,I,P){throw Math.floor(Y)!==Y?(qt(Y,P),new be.ERR_OUT_OF_RANGE(P||"offset","an integer",Y)):I<0?new be.ERR_BUFFER_OUT_OF_BOUNDS:new be.ERR_OUT_OF_RANGE(P||"offset",`>= ${P?1:0} and <= ${I}`,Y)}xe("ERR_BUFFER_OUT_OF_BOUNDS",function(Y){return Y?`${Y} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),xe("ERR_INVALID_ARG_TYPE",function(Y,I){return`The "${Y}" argument must be of type number. Received type ${typeof I}`},TypeError),xe("ERR_OUT_OF_RANGE",function(Y,I,P){let X=`The value of "${Y}" is out of range.`,he=P;return Number.isInteger(P)&&Math.abs(P)>2**32?he=ft(String(P)):"bigint"==typeof P&&(he=String(P),(P>BigInt(2)**BigInt(32)||P<-(BigInt(2)**BigInt(32)))&&(he=ft(he)),he+="n"),X+=` It must be ${I}. Received ${he}`,X},RangeError);const tt=/[^+/0-9A-Za-z-_]/g;function qn(Y,I){let P;I=I||1/0;const X=Y.length;let he=null;const ye=[];for(let Oe=0;Oe<X;++Oe){if(P=Y.charCodeAt(Oe),P>55295&&P<57344){if(!he){if(P>56319){(I-=3)>-1&&ye.push(239,191,189);continue}if(Oe+1===X){(I-=3)>-1&&ye.push(239,191,189);continue}he=P;continue}if(P<56320){(I-=3)>-1&&ye.push(239,191,189),he=P;continue}P=65536+(he-55296<<10|P-56320)}else he&&(I-=3)>-1&&ye.push(239,191,189);if(he=null,P<128){if((I-=1)<0)break;ye.push(P)}else if(P<2048){if((I-=2)<0)break;ye.push(P>>6|192,63&P|128)}else if(P<65536){if((I-=3)<0)break;ye.push(P>>12|224,P>>6&63|128,63&P|128)}else{if(!(P<1114112))throw new Error("Invalid code point");if((I-=4)<0)break;ye.push(P>>18|240,P>>12&63|128,P>>6&63|128,63&P|128)}}return ye}function vn(Y){return p.toByteArray(function ur(Y){if((Y=(Y=Y.split("=")[0]).trim().replace(tt,"")).length<2)return"";for(;Y.length%4!=0;)Y+="=";return Y}(Y))}function ei(Y,I,P,X){let he;for(he=0;he<X&&!(he+P>=I.length||he>=Y.length);++he)I[he+P]=Y[he];return he}function Kn(Y,I){return Y instanceof I||null!=Y&&null!=Y.constructor&&null!=Y.constructor.name&&Y.constructor.name===I.name}function dr(Y){return Y!=Y}const Fn=function(){const Y="0123456789abcdef",I=new Array(256);for(let P=0;P<16;++P){const X=16*P;for(let he=0;he<16;++he)I[X+he]=Y[P]+Y[he]}return I}();function Cn(Y){return typeof BigInt>"u"?Oo:Y}function Oo(){throw new Error("BigInt not supported")}},1098:(fe,F,S)=>{"use strict";var E=S(491),p=S(5436),O=p(E("String.prototype.indexOf"));fe.exports=function($,H){var B=E($,!!H);return"function"==typeof B&&O($,".prototype.")>-1?p(B):B}},5436:(fe,F,S)=>{"use strict";var E=S(5333),p=S(491),O=S(2245),R=p("%TypeError%"),$=p("%Function.prototype.apply%"),H=p("%Function.prototype.call%"),B=p("%Reflect.apply%",!0)||E.call(H,$),g=p("%Object.defineProperty%",!0),M=p("%Math.max%");if(g)try{g({},"a",{value:1})}catch{g=null}fe.exports=function(J){if("function"!=typeof J)throw new R("a function is required");var z=B(E,H,arguments);return O(z,1+M(0,J.length-(arguments.length-1)),!0)};var D=function(){return B(E,$,arguments)};g?g(fe.exports,"apply",{value:D}):fe.exports.apply=D},563:(fe,F,S)=>{F.formatArgs=function p(B){if(B[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+B[0]+(this.useColors?"%c ":" ")+"+"+fe.exports.humanize(this.diff),!this.useColors)return;const g="color: "+this.color;B.splice(1,0,g,"color: inherit");let M=0,D=0;B[0].replace(/%[a-zA-Z%]/g,V=>{"%%"!==V&&(M++,"%c"===V&&(D=M))}),B.splice(D,0,g)},F.save=function O(B){try{B?F.storage.setItem("debug",B):F.storage.removeItem("debug")}catch{}},F.load=function R(){let B;try{B=F.storage.getItem("debug")}catch{}return!B&&typeof process<"u"&&"env"in process&&(B=process.env.DEBUG),B},F.useColors=function E(){return!(!(typeof window<"u"&&window.process)||"renderer"!==window.process.type&&!window.process.__nwjs)||!(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},F.storage=function $(){try{return localStorage}catch{}}(),F.destroy=(()=>{let B=!1;return()=>{B||(B=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),F.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],F.log=console.debug||console.log||(()=>{}),fe.exports=S(6018)(F);const{formatters:H}=fe.exports;H.j=function(B){try{return JSON.stringify(B)}catch(g){return"[UnexpectedJSONParseError]: "+g.message}}},6018:(fe,F,S)=>{fe.exports=function E(p){function R(J){let z,k,K,C=null;function w(...j){if(!w.enabled)return;const _=w,b=Number(new Date);_.diff=b-(z||b),_.prev=z,_.curr=b,z=b,j[0]=R.coerce(j[0]),"string"!=typeof j[0]&&j.unshift("%O");let q=0;j[0]=j[0].replace(/%([a-zA-Z%])/g,(se,ie)=>{if("%%"===se)return"%";q++;const ce=R.formatters[ie];return"function"==typeof ce&&(se=ce.call(_,j[q]),j.splice(q,1),q--),se}),R.formatArgs.call(_,j),(_.log||R.log).apply(_,j)}return w.namespace=J,w.useColors=R.useColors(),w.color=R.selectColor(J),w.extend=$,w.destroy=R.destroy,Object.defineProperty(w,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==C?C:(k!==R.namespaces&&(k=R.namespaces,K=R.enabled(J)),K),set:j=>{C=j}}),"function"==typeof R.init&&R.init(w),w}function $(J,z){const C=R(this.namespace+(typeof z>"u"?":":z)+J);return C.log=this.log,C}function M(J){return J.toString().substring(2,J.toString().length-2).replace(/\.\*\?$/,"*")}return R.debug=R,R.default=R,R.coerce=function D(J){return J instanceof Error?J.stack||J.message:J},R.disable=function B(){const J=[...R.names.map(M),...R.skips.map(M).map(z=>"-"+z)].join(",");return R.enable(""),J},R.enable=function H(J){let z;R.save(J),R.namespaces=J,R.names=[],R.skips=[];const C=("string"==typeof J?J:"").split(/[\s,]+/),k=C.length;for(z=0;z<k;z++)C[z]&&("-"===(J=C[z].replace(/\*/g,".*?"))[0]?R.skips.push(new RegExp("^"+J.slice(1)+"$")):R.names.push(new RegExp("^"+J+"$")))},R.enabled=function g(J){if("*"===J[J.length-1])return!0;let z,C;for(z=0,C=R.skips.length;z<C;z++)if(R.skips[z].test(J))return!1;for(z=0,C=R.names.length;z<C;z++)if(R.names[z].test(J))return!0;return!1},R.humanize=S(7253),R.destroy=function V(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(p).forEach(J=>{R[J]=p[J]}),R.names=[],R.skips=[],R.formatters={},R.selectColor=function O(J){let z=0;for(let C=0;C<J.length;C++)z=(z<<5)-z+J.charCodeAt(C),z|=0;return R.colors[Math.abs(z)%R.colors.length]},R.enable(R.load()),R}},9224:(fe,F,S)=>{"use strict";var E=S(2486)(),p=S(491),O=E&&p("%Object.defineProperty%",!0);if(O)try{O({},"a",{value:1})}catch{O=!1}var R=p("%SyntaxError%"),$=p("%TypeError%"),H=S(9262);fe.exports=function(g,M,D){if(!g||"object"!=typeof g&&"function"!=typeof g)throw new $("`obj` must be an object or a function`");if("string"!=typeof M&&"symbol"!=typeof M)throw new $("`property` must be a string or a symbol`");if(arguments.length>3&&"boolean"!=typeof arguments[3]&&null!==arguments[3])throw new $("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&"boolean"!=typeof arguments[4]&&null!==arguments[4])throw new $("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&"boolean"!=typeof arguments[5]&&null!==arguments[5])throw new $("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&"boolean"!=typeof arguments[6])throw new $("`loose`, if provided, must be a boolean");var V=arguments.length>3?arguments[3]:null,J=arguments.length>4?arguments[4]:null,z=arguments.length>5?arguments[5]:null,C=arguments.length>6&&arguments[6],k=!!H&&H(g,M);if(O)O(g,M,{configurable:null===z&&k?k.configurable:!z,enumerable:null===V&&k?k.enumerable:!V,value:D,writable:null===J&&k?k.writable:!J});else{if(!C&&(V||J||z))throw new R("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.");g[M]=D}}},2016:fe=>{"use strict";var E,F="object"==typeof Reflect?Reflect:null,S=F&&"function"==typeof F.apply?F.apply:function(b,U,q){return Function.prototype.apply.call(b,U,q)};E=F&&"function"==typeof F.ownKeys?F.ownKeys:Object.getOwnPropertySymbols?function(b){return Object.getOwnPropertyNames(b).concat(Object.getOwnPropertySymbols(b))}:function(b){return Object.getOwnPropertyNames(b)};var O=Number.isNaN||function(b){return b!=b};function R(){R.init.call(this)}fe.exports=R,fe.exports.once=function K(_,b){return new Promise(function(U,q){function te(ie){_.removeListener(b,se),q(ie)}function se(){"function"==typeof _.removeListener&&_.removeListener("error",te),U([].slice.call(arguments))}j(_,b,se,{once:!0}),"error"!==b&&function w(_,b,U){"function"==typeof _.on&&j(_,"error",b,U)}(_,te,{once:!0})})},R.EventEmitter=R,R.prototype._events=void 0,R.prototype._eventsCount=0,R.prototype._maxListeners=void 0;var $=10;function H(_){if("function"!=typeof _)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof _)}function B(_){return void 0===_._maxListeners?R.defaultMaxListeners:_._maxListeners}function g(_,b,U,q){var te,se,ie;if(H(U),void 0===(se=_._events)?(se=_._events=Object.create(null),_._eventsCount=0):(void 0!==se.newListener&&(_.emit("newListener",b,U.listener?U.listener:U),se=_._events),ie=se[b]),void 0===ie)ie=se[b]=U,++_._eventsCount;else if("function"==typeof ie?ie=se[b]=q?[U,ie]:[ie,U]:q?ie.unshift(U):ie.push(U),(te=B(_))>0&&ie.length>te&&!ie.warned){ie.warned=!0;var ce=new Error("Possible EventEmitter memory leak detected. "+ie.length+" "+String(b)+" listeners added. Use emitter.setMaxListeners() to increase limit");ce.name="MaxListenersExceededWarning",ce.emitter=_,ce.type=b,ce.count=ie.length,function p(_){console&&console.warn&&console.warn(_)}(ce)}return _}function M(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function D(_,b,U){var q={fired:!1,wrapFn:void 0,target:_,type:b,listener:U},te=M.bind(q);return te.listener=U,q.wrapFn=te,te}function V(_,b,U){var q=_._events;if(void 0===q)return[];var te=q[b];return void 0===te?[]:"function"==typeof te?U?[te.listener||te]:[te]:U?function k(_){for(var b=new Array(_.length),U=0;U<b.length;++U)b[U]=_[U].listener||_[U];return b}(te):z(te,te.length)}function J(_){var b=this._events;if(void 0!==b){var U=b[_];if("function"==typeof U)return 1;if(void 0!==U)return U.length}return 0}function z(_,b){for(var U=new Array(b),q=0;q<b;++q)U[q]=_[q];return U}function j(_,b,U,q){if("function"==typeof _.on)q.once?_.once(b,U):_.on(b,U);else{if("function"!=typeof _.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof _);_.addEventListener(b,function te(se){q.once&&_.removeEventListener(b,te),U(se)})}}Object.defineProperty(R,"defaultMaxListeners",{enumerable:!0,get:function(){return $},set:function(_){if("number"!=typeof _||_<0||O(_))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+_+".");$=_}}),R.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},R.prototype.setMaxListeners=function(b){if("number"!=typeof b||b<0||O(b))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+b+".");return this._maxListeners=b,this},R.prototype.getMaxListeners=function(){return B(this)},R.prototype.emit=function(b){for(var U=[],q=1;q<arguments.length;q++)U.push(arguments[q]);var te="error"===b,se=this._events;if(void 0!==se)te=te&&void 0===se.error;else if(!te)return!1;if(te){var ie;if(U.length>0&&(ie=U[0]),ie instanceof Error)throw ie;var ce=new Error("Unhandled error."+(ie?" ("+ie.message+")":""));throw ce.context=ie,ce}var me=se[b];if(void 0===me)return!1;if("function"==typeof me)S(me,this,U);else{var De=me.length,Ee=z(me,De);for(q=0;q<De;++q)S(Ee[q],this,U)}return!0},R.prototype.on=R.prototype.addListener=function(b,U){return g(this,b,U,!1)},R.prototype.prependListener=function(b,U){return g(this,b,U,!0)},R.prototype.once=function(b,U){return H(U),this.on(b,D(this,b,U)),this},R.prototype.prependOnceListener=function(b,U){return H(U),this.prependListener(b,D(this,b,U)),this},R.prototype.off=R.prototype.removeListener=function(b,U){var q,te,se,ie,ce;if(H(U),void 0===(te=this._events))return this;if(void 0===(q=te[b]))return this;if(q===U||q.listener===U)0==--this._eventsCount?this._events=Object.create(null):(delete te[b],te.removeListener&&this.emit("removeListener",b,q.listener||U));else if("function"!=typeof q){for(se=-1,ie=q.length-1;ie>=0;ie--)if(q[ie]===U||q[ie].listener===U){ce=q[ie].listener,se=ie;break}if(se<0)return this;0===se?q.shift():function C(_,b){for(;b+1<_.length;b++)_[b]=_[b+1];_.pop()}(q,se),1===q.length&&(te[b]=q[0]),void 0!==te.removeListener&&this.emit("removeListener",b,ce||U)}return this},R.prototype.removeAllListeners=function(b){var U,q,te;if(void 0===(q=this._events))return this;if(void 0===q.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==q[b]&&(0==--this._eventsCount?this._events=Object.create(null):delete q[b]),this;if(0===arguments.length){var ie,se=Object.keys(q);for(te=0;te<se.length;++te)"removeListener"!==(ie=se[te])&&this.removeAllListeners(ie);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(U=q[b]))this.removeListener(b,U);else if(void 0!==U)for(te=U.length-1;te>=0;te--)this.removeListener(b,U[te]);return this},R.prototype.listeners=function(b){return V(this,b,!0)},R.prototype.rawListeners=function(b){return V(this,b,!1)},R.listenerCount=function(_,b){return"function"==typeof _.listenerCount?_.listenerCount(b):J.call(_,b)},R.prototype.listenerCount=J,R.prototype.eventNames=function(){return this._eventsCount>0?E(this._events):[]}},3307:(fe,F,S)=>{"use strict";var E=S(2238),p=Object.prototype.toString,O=Object.prototype.hasOwnProperty;fe.exports=function(M,D,V){if(!E(D))throw new TypeError("iterator must be a function");var J;arguments.length>=3&&(J=V),"[object Array]"===p.call(M)?function(M,D,V){for(var J=0,z=M.length;J<z;J++)O.call(M,J)&&(null==V?D(M[J],J,M):D.call(V,M[J],J,M))}(M,D,J):"string"==typeof M?function(M,D,V){for(var J=0,z=M.length;J<z;J++)null==V?D(M.charAt(J),J,M):D.call(V,M.charAt(J),J,M)}(M,D,J):function(M,D,V){for(var J in M)O.call(M,J)&&(null==V?D(M[J],J,M):D.call(V,M[J],J,M))}(M,D,J)}},238:fe=>{"use strict";var S=Object.prototype.toString,E=Math.max,O=function(B,g){for(var M=[],D=0;D<B.length;D+=1)M[D]=B[D];for(var V=0;V<g.length;V+=1)M[V+B.length]=g[V];return M};fe.exports=function(B){var g=this;if("function"!=typeof g||"[object Function]"!==S.apply(g))throw new TypeError("Function.prototype.bind called on incompatible "+g);for(var D,M=function(B,g){for(var M=[],D=1,V=0;D<B.length;D+=1,V+=1)M[V]=B[D];return M}(arguments),J=E(0,g.length-M.length),z=[],C=0;C<J;C++)z[C]="$"+C;if(D=Function("binder","return function ("+function(H,B){for(var g="",M=0;M<H.length;M+=1)g+=H[M],M+1<H.length&&(g+=",");return g}(z)+"){ return binder.apply(this,arguments); }")(function(){if(this instanceof D){var K=g.apply(this,O(M,arguments));return Object(K)===K?K:this}return g.apply(B,O(M,arguments))}),g.prototype){var k=function(){};k.prototype=g.prototype,D.prototype=new k,k.prototype=null}return D}},5333:(fe,F,S)=>{"use strict";var E=S(238);fe.exports=Function.prototype.bind||E},491:(fe,F,S)=>{"use strict";var E,p=SyntaxError,O=Function,R=TypeError,$=function(Ee){try{return O('"use strict"; return ('+Ee+").constructor;")()}catch{}},H=Object.getOwnPropertyDescriptor;if(H)try{H({},"")}catch{H=null}var B=function(){throw new R},g=H?function(){try{return B}catch{try{return H(arguments,"callee").get}catch{return B}}}():B,M=S(6152)(),D=S(9028)(),V=Object.getPrototypeOf||(D?function(Ee){return Ee.__proto__}:null),J={},z=typeof Uint8Array>"u"||!V?E:V(Uint8Array),C={"%AggregateError%":typeof AggregateError>"u"?E:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?E:ArrayBuffer,"%ArrayIteratorPrototype%":M&&V?V([][Symbol.iterator]()):E,"%AsyncFromSyncIteratorPrototype%":E,"%AsyncFunction%":J,"%AsyncGenerator%":J,"%AsyncGeneratorFunction%":J,"%AsyncIteratorPrototype%":J,"%Atomics%":typeof Atomics>"u"?E:Atomics,"%BigInt%":typeof BigInt>"u"?E:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?E:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?E:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?E:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?E:Float32Array,"%Float64Array%":typeof Float64Array>"u"?E:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?E:FinalizationRegistry,"%Function%":O,"%GeneratorFunction%":J,"%Int8Array%":typeof Int8Array>"u"?E:Int8Array,"%Int16Array%":typeof Int16Array>"u"?E:Int16Array,"%Int32Array%":typeof Int32Array>"u"?E:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":M&&V?V(V([][Symbol.iterator]())):E,"%JSON%":"object"==typeof JSON?JSON:E,"%Map%":typeof Map>"u"?E:Map,"%MapIteratorPrototype%":typeof Map>"u"||!M||!V?E:V((new Map)[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?E:Promise,"%Proxy%":typeof Proxy>"u"?E:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?E:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?E:Set,"%SetIteratorPrototype%":typeof Set>"u"||!M||!V?E:V((new Set)[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?E:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":M&&V?V(""[Symbol.iterator]()):E,"%Symbol%":M?Symbol:E,"%SyntaxError%":p,"%ThrowTypeError%":g,"%TypedArray%":z,"%TypeError%":R,"%Uint8Array%":typeof Uint8Array>"u"?E:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?E:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?E:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?E:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?E:WeakMap,"%WeakRef%":typeof WeakRef>"u"?E:WeakRef,"%WeakSet%":typeof WeakSet>"u"?E:WeakSet};if(V)try{null.error}catch(Ee){var k=V(V(Ee));C["%Error.prototype%"]=k}var K=function Ee(He){var Be;if("%AsyncFunction%"===He)Be=$("async function () {}");else if("%GeneratorFunction%"===He)Be=$("function* () {}");else if("%AsyncGeneratorFunction%"===He)Be=$("async function* () {}");else if("%AsyncGenerator%"===He){var ze=Ee("%AsyncGeneratorFunction%");ze&&(Be=ze.prototype)}else if("%AsyncIteratorPrototype%"===He){var pe=Ee("%AsyncGenerator%");pe&&V&&(Be=V(pe.prototype))}return C[He]=Be,Be},w={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},j=S(5333),_=S(836),b=j.call(Function.call,Array.prototype.concat),U=j.call(Function.apply,Array.prototype.splice),q=j.call(Function.call,String.prototype.replace),te=j.call(Function.call,String.prototype.slice),se=j.call(Function.call,RegExp.prototype.exec),ie=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,ce=/\\(\\)?/g,De=function(He,Be){var pe,ze=He;if(_(w,ze)&&(ze="%"+(pe=w[ze])[0]+"%"),_(C,ze)){var G=C[ze];if(G===J&&(G=K(ze)),typeof G>"u"&&!Be)throw new R("intrinsic "+He+" exists, but is not available. Please file an issue!");return{alias:pe,name:ze,value:G}}throw new p("intrinsic "+He+" does not exist!")};fe.exports=function(He,Be){if("string"!=typeof He||0===He.length)throw new R("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof Be)throw new R('"allowMissing" argument must be a boolean');if(null===se(/^%?[^%]*%?$/,He))throw new p("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var ze=function(He){var Be=te(He,0,1),ze=te(He,-1);if("%"===Be&&"%"!==ze)throw new p("invalid intrinsic syntax, expected closing `%`");if("%"===ze&&"%"!==Be)throw new p("invalid intrinsic syntax, expected opening `%`");var pe=[];return q(He,ie,function(G,oe,ee,ue){pe[pe.length]=ee?q(ue,ce,"$1"):oe||G}),pe}(He),pe=ze.length>0?ze[0]:"",G=De("%"+pe+"%",Be),oe=G.name,ee=G.value,ue=!1,m=G.alias;m&&(pe=m[0],U(ze,b([0,1],m)));for(var T=1,N=!0;T<ze.length;T+=1){var le=ze[T],Ce=te(le,0,1),Me=te(le,-1);if(('"'===Ce||"'"===Ce||"`"===Ce||'"'===Me||"'"===Me||"`"===Me)&&Ce!==Me)throw new p("property names with quotes must have matching quotes");if(("constructor"===le||!N)&&(ue=!0),_(C,oe="%"+(pe+="."+le)+"%"))ee=C[oe];else if(null!=ee){if(!(le in ee)){if(!Be)throw new R("base intrinsic for "+He+" exists, but the property is not available.");return}if(H&&T+1>=ze.length){var Ke=H(ee,le);ee=(N=!!Ke)&&"get"in Ke&&!("originalValue"in Ke.get)?Ke.get:ee[le]}else N=_(ee,le),ee=ee[le];N&&!ue&&(C[oe]=ee)}}return ee}},9262:(fe,F,S)=>{"use strict";var p=S(491)("%Object.getOwnPropertyDescriptor%",!0);if(p)try{p([],"length")}catch{p=null}fe.exports=p},2486:(fe,F,S)=>{"use strict";var p=S(491)("%Object.defineProperty%",!0),O=function(){if(p)try{return p({},"a",{value:1}),!0}catch{return!1}return!1};O.hasArrayLengthDefineBug=function(){if(!O())return null;try{return 1!==p([],"length",{value:1}).length}catch{return!0}},fe.exports=O},9028:fe=>{"use strict";var F={foo:{}},S=Object;fe.exports=function(){return{__proto__:F}.foo===F.foo&&!({__proto__:null}instanceof S)}},6152:(fe,F,S)=>{"use strict";var E=typeof Symbol<"u"&&Symbol,p=S(5441);fe.exports=function(){return"function"==typeof E&&"function"==typeof Symbol&&"symbol"==typeof E("foo")&&"symbol"==typeof Symbol("bar")&&p()}},5441:fe=>{"use strict";fe.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var S={},E=Symbol("test"),p=Object(E);if("string"==typeof E||"[object Symbol]"!==Object.prototype.toString.call(E)||"[object Symbol]"!==Object.prototype.toString.call(p))return!1;for(E in S[E]=42,S)return!1;if("function"==typeof Object.keys&&0!==Object.keys(S).length||"function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(S).length)return!1;var R=Object.getOwnPropertySymbols(S);if(1!==R.length||R[0]!==E||!Object.prototype.propertyIsEnumerable.call(S,E))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var $=Object.getOwnPropertyDescriptor(S,E);if(42!==$.value||!0!==$.enumerable)return!1}return!0}},8041:(fe,F,S)=>{"use strict";var E=S(5441);fe.exports=function(){return E()&&!!Symbol.toStringTag}},836:(fe,F,S)=>{"use strict";var E=Function.prototype.call,p=Object.prototype.hasOwnProperty,O=S(5333);fe.exports=O.call(E,p)},2601:(fe,F)=>{F.read=function(S,E,p,O,R){var $,H,B=8*R-O-1,g=(1<<B)-1,M=g>>1,D=-7,V=p?R-1:0,J=p?-1:1,z=S[E+V];for(V+=J,$=z&(1<<-D)-1,z>>=-D,D+=B;D>0;$=256*$+S[E+V],V+=J,D-=8);for(H=$&(1<<-D)-1,$>>=-D,D+=O;D>0;H=256*H+S[E+V],V+=J,D-=8);if(0===$)$=1-M;else{if($===g)return H?NaN:1/0*(z?-1:1);H+=Math.pow(2,O),$-=M}return(z?-1:1)*H*Math.pow(2,$-O)},F.write=function(S,E,p,O,R,$){var H,B,g,M=8*$-R-1,D=(1<<M)-1,V=D>>1,J=23===R?Math.pow(2,-24)-Math.pow(2,-77):0,z=O?0:$-1,C=O?1:-1,k=E<0||0===E&&1/E<0?1:0;for(E=Math.abs(E),isNaN(E)||E===1/0?(B=isNaN(E)?1:0,H=D):(H=Math.floor(Math.log(E)/Math.LN2),E*(g=Math.pow(2,-H))<1&&(H--,g*=2),(E+=H+V>=1?J/g:J*Math.pow(2,1-V))*g>=2&&(H++,g/=2),H+V>=D?(B=0,H=D):H+V>=1?(B=(E*g-1)*Math.pow(2,R),H+=V):(B=E*Math.pow(2,V-1)*Math.pow(2,R),H=0));R>=8;S[p+z]=255&B,z+=C,B/=256,R-=8);for(H=H<<R|B,M+=R;M>0;S[p+z]=255&H,z+=C,H/=256,M-=8);S[p+z-C]|=128*k}},6698:fe=>{fe.exports="function"==typeof Object.create?function(S,E){E&&(S.super_=E,S.prototype=Object.create(E.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}}))}:function(S,E){if(E){S.super_=E;var p=function(){};p.prototype=E.prototype,S.prototype=new p,S.prototype.constructor=S}}},8147:(fe,F,S)=>{"use strict";var E=S(8041)(),O=S(1098)("Object.prototype.toString"),R=function(g){return!(E&&g&&"object"==typeof g&&Symbol.toStringTag in g)&&"[object Arguments]"===O(g)},$=function(g){return!!R(g)||null!==g&&"object"==typeof g&&"number"==typeof g.length&&g.length>=0&&"[object Array]"!==O(g)&&"[object Function]"===O(g.callee)},H=function(){return R(arguments)}();R.isLegacyArguments=$,fe.exports=H?R:$},3678:fe=>{fe.exports=function(S){return null!=S&&null!=S.constructor&&"function"==typeof S.constructor.isBuffer&&S.constructor.isBuffer(S)}},2238:fe=>{"use strict";var E,p,F=Function.prototype.toString,S="object"==typeof Reflect&&null!==Reflect&&Reflect.apply;if("function"==typeof S&&"function"==typeof Object.defineProperty)try{E=Object.defineProperty({},"length",{get:function(){throw p}}),p={},S(function(){throw 42},null,E)}catch(w){w!==p&&(S=null)}else S=null;var O=/^\s*class\b/,R=function(j){try{var _=F.call(j);return O.test(_)}catch{return!1}},$=function(j){try{return!R(j)&&(F.call(j),!0)}catch{return!1}},H=Object.prototype.toString,z="function"==typeof Symbol&&!!Symbol.toStringTag,C=!(0 in[,]),k=function(){return!1};if("object"==typeof document){var K=document.all;H.call(K)===H.call(document.all)&&(k=function(j){if((C||!j)&&(typeof j>"u"||"object"==typeof j))try{var _=H.call(j);return("[object HTMLAllCollection]"===_||"[object HTML document.all class]"===_||"[object HTMLCollection]"===_||"[object Object]"===_)&&null==j("")}catch{}return!1})}fe.exports=S?function(j){if(k(j))return!0;if(!j||"function"!=typeof j&&"object"!=typeof j)return!1;try{S(j,null,E)}catch(_){if(_!==p)return!1}return!R(j)&&$(j)}:function(j){if(k(j))return!0;if(!j||"function"!=typeof j&&"object"!=typeof j)return!1;if(z)return $(j);if(R(j))return!1;var _=H.call(j);return!("[object Function]"!==_&&"[object GeneratorFunction]"!==_&&!/^\[object HTML/.test(_))&&$(j)}},3286:(fe,F,S)=>{"use strict";var B,E=Object.prototype.toString,p=Function.prototype.toString,O=/^\s*(?:function)?\*/,R=S(8041)(),$=Object.getPrototypeOf;fe.exports=function(M){if("function"!=typeof M)return!1;if(O.test(p.call(M)))return!0;if(!R)return"[object GeneratorFunction]"===E.call(M);if(!$)return!1;if(typeof B>"u"){var V=function(){if(!R)return!1;try{return Function("return function*() {}")()}catch{}}();B=!!V&&$(V)}return $(M)===B}},2462:(fe,F,S)=>{"use strict";var E=S(6326);fe.exports=function(O){return!!E(O)}},7253:fe=>{var F=1e3,S=60*F,E=60*S,p=24*E;function g(M,D,V,J){var z=D>=1.5*V;return Math.round(M/V)+" "+J+(z?"s":"")}fe.exports=function(M,D){D=D||{};var V=typeof M;if("string"===V&&M.length>0)return function $(M){if(!((M=String(M)).length>100)){var D=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(M);if(D){var V=parseFloat(D[1]);switch((D[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*V;case"weeks":case"week":case"w":return 6048e5*V;case"days":case"day":case"d":return V*p;case"hours":case"hour":case"hrs":case"hr":case"h":return V*E;case"minutes":case"minute":case"mins":case"min":case"m":return V*S;case"seconds":case"second":case"secs":case"sec":case"s":return V*F;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return V;default:return}}}}(M);if("number"===V&&isFinite(M))return D.long?function B(M){var D=Math.abs(M);return D>=p?g(M,D,p,"day"):D>=E?g(M,D,E,"hour"):D>=S?g(M,D,S,"minute"):D>=F?g(M,D,F,"second"):M+" ms"}(M):function H(M){var D=Math.abs(M);return D>=p?Math.round(M/p)+"d":D>=E?Math.round(M/E)+"h":D>=S?Math.round(M/S)+"m":D>=F?Math.round(M/F)+"s":M+"ms"}(M);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(M))}},5323:(fe,F,S)=>{fe.exports=S(5323)},5799:fe=>{fe.exports="function"==typeof Object.create?function(S,E){S.super_=E,S.prototype=Object.create(E.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}})}:function(S,E){S.super_=E;var p=function(){};p.prototype=E.prototype,S.prototype=new p,S.prototype.constructor=S}},4603:fe=>{fe.exports=function(S){return S&&"object"==typeof S&&"function"==typeof S.copy&&"function"==typeof S.fill&&"function"==typeof S.readUInt8}},2837:(fe,F,S)=>{var E=/%[sdj%]/g;F.format=function(pe){if(!_(pe)){for(var G=[],oe=0;oe<arguments.length;oe++)G.push(R(arguments[oe]));return G.join(" ")}oe=1;for(var ee=arguments,ue=ee.length,m=String(pe).replace(E,function(N){if("%%"===N)return"%";if(oe>=ue)return N;switch(N){case"%s":return String(ee[oe++]);case"%d":return Number(ee[oe++]);case"%j":try{return JSON.stringify(ee[oe++])}catch{return"[Circular]"}default:return N}}),T=ee[oe];oe<ue;T=ee[++oe])K(T)||!te(T)?m+=" "+T:m+=" "+R(T);return m},F.deprecate=function(pe,G){if(U(global.process))return function(){return F.deprecate(pe,G).apply(this,arguments)};if(!0===process.noDeprecation)return pe;var oe=!1;return function ee(){if(!oe){if(process.throwDeprecation)throw new Error(G);process.traceDeprecation?console.trace(G):console.error(G),oe=!0}return pe.apply(this,arguments)}};var O,p={};function R(pe,G){var oe={seen:[],stylize:H};return arguments.length>=3&&(oe.depth=arguments[2]),arguments.length>=4&&(oe.colors=arguments[3]),k(G)?oe.showHidden=G:G&&F._extend(oe,G),U(oe.showHidden)&&(oe.showHidden=!1),U(oe.depth)&&(oe.depth=2),U(oe.colors)&&(oe.colors=!1),U(oe.customInspect)&&(oe.customInspect=!0),oe.colors&&(oe.stylize=$),g(oe,pe,oe.depth)}function $(pe,G){var oe=R.styles[G];return oe?"\x1b["+R.colors[oe][0]+"m"+pe+"\x1b["+R.colors[oe][1]+"m":pe}function H(pe,G){return pe}function g(pe,G,oe){if(pe.customInspect&&G&&ce(G.inspect)&&G.inspect!==F.inspect&&(!G.constructor||G.constructor.prototype!==G)){var ee=G.inspect(oe,pe);return _(ee)||(ee=g(pe,ee,oe)),ee}var ue=function M(pe,G){if(U(G))return pe.stylize("undefined","undefined");if(_(G)){var oe="'"+JSON.stringify(G).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return pe.stylize(oe,"string")}return j(G)?pe.stylize(""+G,"number"):k(G)?pe.stylize(""+G,"boolean"):K(G)?pe.stylize("null","null"):void 0}(pe,G);if(ue)return ue;var m=Object.keys(G),T=function B(pe){var G={};return pe.forEach(function(oe,ee){G[oe]=!0}),G}(m);if(pe.showHidden&&(m=Object.getOwnPropertyNames(G)),ie(G)&&(m.indexOf("message")>=0||m.indexOf("description")>=0))return D(G);if(0===m.length){if(ce(G))return pe.stylize("[Function"+(G.name?": "+G.name:"")+"]","special");if(q(G))return pe.stylize(RegExp.prototype.toString.call(G),"regexp");if(se(G))return pe.stylize(Date.prototype.toString.call(G),"date");if(ie(G))return D(G)}var be,le="",Ce=!1,Me=["{","}"];return C(G)&&(Ce=!0,Me=["[","]"]),ce(G)&&(le=" [Function"+(G.name?": "+G.name:"")+"]"),q(G)&&(le=" "+RegExp.prototype.toString.call(G)),se(G)&&(le=" "+Date.prototype.toUTCString.call(G)),ie(G)&&(le=" "+D(G)),0!==m.length||Ce&&0!=G.length?oe<0?q(G)?pe.stylize(RegExp.prototype.toString.call(G),"regexp"):pe.stylize("[Object]","special"):(pe.seen.push(G),be=Ce?function V(pe,G,oe,ee,ue){for(var m=[],T=0,N=G.length;T<N;++T)ze(G,String(T))?m.push(J(pe,G,oe,ee,String(T),!0)):m.push("");return ue.forEach(function(le){le.match(/^\d+$/)||m.push(J(pe,G,oe,ee,le,!0))}),m}(pe,G,oe,T,m):m.map(function(xe){return J(pe,G,oe,T,xe,Ce)}),pe.seen.pop(),function z(pe,G,oe){var ue=pe.reduce(function(m,T){return T.indexOf("\n"),m+T.replace(/\u001b\[\d\d?m/g,"").length+1},0);return ue>60?oe[0]+(""===G?"":G+"\n ")+" "+pe.join(",\n  ")+" "+oe[1]:oe[0]+G+" "+pe.join(", ")+" "+oe[1]}(be,le,Me)):Me[0]+le+Me[1]}function D(pe){return"["+Error.prototype.toString.call(pe)+"]"}function J(pe,G,oe,ee,ue,m){var T,N,le;if((le=Object.getOwnPropertyDescriptor(G,ue)||{value:G[ue]}).get?N=pe.stylize(le.set?"[Getter/Setter]":"[Getter]","special"):le.set&&(N=pe.stylize("[Setter]","special")),ze(ee,ue)||(T="["+ue+"]"),N||(pe.seen.indexOf(le.value)<0?(N=K(oe)?g(pe,le.value,null):g(pe,le.value,oe-1)).indexOf("\n")>-1&&(N=m?N.split("\n").map(function(Ce){return"  "+Ce}).join("\n").substr(2):"\n"+N.split("\n").map(function(Ce){return"   "+Ce}).join("\n")):N=pe.stylize("[Circular]","special")),U(T)){if(m&&ue.match(/^\d+$/))return N;(T=JSON.stringify(""+ue)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(T=T.substr(1,T.length-2),T=pe.stylize(T,"name")):(T=T.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),T=pe.stylize(T,"string"))}return T+": "+N}function C(pe){return Array.isArray(pe)}function k(pe){return"boolean"==typeof pe}function K(pe){return null===pe}function j(pe){return"number"==typeof pe}function _(pe){return"string"==typeof pe}function U(pe){return void 0===pe}function q(pe){return te(pe)&&"[object RegExp]"===De(pe)}function te(pe){return"object"==typeof pe&&null!==pe}function se(pe){return te(pe)&&"[object Date]"===De(pe)}function ie(pe){return te(pe)&&("[object Error]"===De(pe)||pe instanceof Error)}function ce(pe){return"function"==typeof pe}function De(pe){return Object.prototype.toString.call(pe)}function Ee(pe){return pe<10?"0"+pe.toString(10):pe.toString(10)}F.debuglog=function(pe){if(U(O)&&(O=process.env.NODE_DEBUG||""),pe=pe.toUpperCase(),!p[pe])if(new RegExp("\\b"+pe+"\\b","i").test(O)){var G=process.pid;p[pe]=function(){var oe=F.format.apply(F,arguments);console.error("%s %d: %s",pe,G,oe)}}else p[pe]=function(){};return p[pe]},F.inspect=R,R.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},R.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},F.isArray=C,F.isBoolean=k,F.isNull=K,F.isNullOrUndefined=function w(pe){return null==pe},F.isNumber=j,F.isString=_,F.isSymbol=function b(pe){return"symbol"==typeof pe},F.isUndefined=U,F.isRegExp=q,F.isObject=te,F.isDate=se,F.isError=ie,F.isFunction=ce,F.isPrimitive=function me(pe){return null===pe||"boolean"==typeof pe||"number"==typeof pe||"string"==typeof pe||"symbol"==typeof pe||typeof pe>"u"},F.isBuffer=S(4603);var He=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function ze(pe,G){return Object.prototype.hasOwnProperty.call(pe,G)}F.log=function(){console.log("%s - %s",function Be(){var pe=new Date,G=[Ee(pe.getHours()),Ee(pe.getMinutes()),Ee(pe.getSeconds())].join(":");return[pe.getDate(),He[pe.getMonth()],G].join(" ")}(),F.format.apply(F,arguments))},F.inherits=S(5799),F._extend=function(pe,G){if(!G||!te(G))return pe;for(var oe=Object.keys(G),ee=oe.length;ee--;)pe[oe[ee]]=G[oe[ee]];return pe}},9361:(fe,F,S)=>{"use strict";var E="win32"===process.platform,p=S(2837);function O(C,k){for(var K=[],w=0;w<C.length;w++){var j=C[w];!j||"."===j||(".."===j?K.length&&".."!==K[K.length-1]?K.pop():k&&K.push(".."):K.push(j))}return K}function R(C){for(var k=C.length-1,K=0;K<=k&&!C[K];K++);for(var w=k;w>=0&&!C[w];w--);return 0===K&&w===k?C:K>w?[]:C.slice(K,w+1)}var $=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,H=/^([\s\S]*?)((?:\.{1,2}|[^\\\/]+?|)(\.[^.\/\\]*|))(?:[\\\/]*)$/,B={};function g(C){var k=$.exec(C),K=(k[1]||"")+(k[2]||""),j=H.exec(k[3]||"");return[K,j[1],j[2],j[3]]}function M(C){var k=$.exec(C),K=k[1]||"",w=!!K&&":"!==K[1];return{device:K,isUnc:w,isAbsolute:w||!!k[2],tail:k[3]}}function D(C){return"\\\\"+C.replace(/^[\\\/]+/,"").replace(/[\\\/]+/g,"\\")}B.resolve=function(){for(var C="",k="",K=!1,w=arguments.length-1;w>=-1;w--){var j;if(w>=0?j=arguments[w]:C?(!(j=process.env["="+C])||j.substr(0,3).toLowerCase()!==C.toLowerCase()+"\\")&&(j=C+"\\"):j=process.cwd(),!p.isString(j))throw new TypeError("Arguments to path.resolve must be strings");if(j){var _=M(j),b=_.device,U=_.isUnc,q=_.isAbsolute,te=_.tail;if((!b||!C||b.toLowerCase()===C.toLowerCase())&&(C||(C=b),K||(k=te+"\\"+k,K=q),C&&K))break}}return U&&(C=D(C)),C+(K?"\\":"")+(k=O(k.split(/[\\\/]+/),!K).join("\\"))||"."},B.normalize=function(C){var k=M(C),K=k.device,w=k.isUnc,j=k.isAbsolute,_=k.tail,b=/[\\\/]$/.test(_);return!(_=O(_.split(/[\\\/]+/),!j).join("\\"))&&!j&&(_="."),_&&b&&(_+="\\"),w&&(K=D(K)),K+(j?"\\":"")+_},B.isAbsolute=function(C){return M(C).isAbsolute},B.join=function(){for(var C=[],k=0;k<arguments.length;k++){var K=arguments[k];if(!p.isString(K))throw new TypeError("Arguments to path.join must be strings");K&&C.push(K)}var w=C.join("\\");return/^[\\\/]{2}[^\\\/]/.test(C[0])||(w=w.replace(/^[\\\/]{2,}/,"\\")),B.normalize(w)},B.relative=function(C,k){C=B.resolve(C),k=B.resolve(k);for(var K=C.toLowerCase(),w=k.toLowerCase(),j=R(k.split("\\")),_=R(K.split("\\")),b=R(w.split("\\")),U=Math.min(_.length,b.length),q=U,te=0;te<U;te++)if(_[te]!==b[te]){q=te;break}if(0==q)return k;var se=[];for(te=q;te<_.length;te++)se.push("..");return(se=se.concat(j.slice(q))).join("\\")},B._makeLong=function(C){if(!p.isString(C))return C;if(!C)return"";var k=B.resolve(C);return/^[a-zA-Z]\:\\/.test(k)?"\\\\?\\"+k:/^\\\\[^?.]/.test(k)?"\\\\?\\UNC\\"+k.substring(2):C},B.dirname=function(C){var k=g(C),K=k[0],w=k[1];return K||w?(w&&(w=w.substr(0,w.length-1)),K+w):"."},B.basename=function(C,k){var K=g(C)[2];return k&&K.substr(-1*k.length)===k&&(K=K.substr(0,K.length-k.length)),K},B.extname=function(C){return g(C)[3]},B.format=function(C){if(!p.isObject(C))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof C);if(!p.isString(C.root||""))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof C.root);var K=C.dir,w=C.base||"";return K?K[K.length-1]===B.sep?K+w:K+B.sep+w:w},B.parse=function(C){if(!p.isString(C))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof C);var k=g(C);if(!k||4!==k.length)throw new TypeError("Invalid path '"+C+"'");return{root:k[0],dir:k[0]+k[1].slice(0,-1),base:k[2],ext:k[3],name:k[2].slice(0,k[2].length-k[3].length)}},B.sep="\\",B.delimiter=";";var V=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,J={};function z(C){return V.exec(C).slice(1)}J.resolve=function(){for(var C="",k=!1,K=arguments.length-1;K>=-1&&!k;K--){var w=K>=0?arguments[K]:process.cwd();if(!p.isString(w))throw new TypeError("Arguments to path.resolve must be strings");w&&(C=w+"/"+C,k="/"===w[0])}return(k?"/":"")+(C=O(C.split("/"),!k).join("/"))||"."},J.normalize=function(C){var k=J.isAbsolute(C),K=C&&"/"===C[C.length-1];return!(C=O(C.split("/"),!k).join("/"))&&!k&&(C="."),C&&K&&(C+="/"),(k?"/":"")+C},J.isAbsolute=function(C){return"/"===C.charAt(0)},J.join=function(){for(var C="",k=0;k<arguments.length;k++){var K=arguments[k];if(!p.isString(K))throw new TypeError("Arguments to path.join must be strings");K&&(C+=C?"/"+K:K)}return J.normalize(C)},J.relative=function(C,k){C=J.resolve(C).substr(1),k=J.resolve(k).substr(1);for(var K=R(C.split("/")),w=R(k.split("/")),j=Math.min(K.length,w.length),_=j,b=0;b<j;b++)if(K[b]!==w[b]){_=b;break}var U=[];for(b=_;b<K.length;b++)U.push("..");return(U=U.concat(w.slice(_))).join("/")},J._makeLong=function(C){return C},J.dirname=function(C){var k=z(C),K=k[0],w=k[1];return K||w?(w&&(w=w.substr(0,w.length-1)),K+w):"."},J.basename=function(C,k){var K=z(C)[2];return k&&K.substr(-1*k.length)===k&&(K=K.substr(0,K.length-k.length)),K},J.extname=function(C){return z(C)[3]},J.format=function(C){if(!p.isObject(C))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof C);if(!p.isString(C.root||""))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof C.root);return(C.dir?C.dir+J.sep:"")+(C.base||"")},J.parse=function(C){if(!p.isString(C))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof C);var k=z(C);if(!k||4!==k.length)throw new TypeError("Invalid path '"+C+"'");return k[1]=k[1]||"",k[2]=k[2]||"",k[3]=k[3]||"",{root:k[0],dir:k[0]+k[1].slice(0,-1),base:k[2],ext:k[3],name:k[2].slice(0,k[2].length-k[3].length)}},J.sep="/",J.delimiter=":",fe.exports=E?B:J,fe.exports.posix=J,fe.exports.win32=B},7572:(fe,F,S)=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0}),F.AwaitableSender=void 0;const E=S(1474),p=S(6454),O=S(7282),R=S(1474),$=S(5338),H=S(3240);F.AwaitableSender=class B extends O.BaseSender{constructor(M,D,V={}){super(M,D,V),this.deliveryDispositionMap=new Map;const J=k=>{const K=k.id;if(this.deliveryDispositionMap.has(k.id)){const w=this.deliveryDispositionMap.get(K);clearTimeout(w.timer);const j=this.deliveryDispositionMap.delete(K);return p.sender("[%s] Event: 'Accepted', Successfully deleted the delivery with id %d from the map of sender '%s' on amqp session '%s' and cleared the timer: %s.",this.connection.id,K,this.name,this.session.id,j),w.resolve(k)}},z=(k,K,w)=>{if(this.deliveryDispositionMap.has(K)){const j=this.deliveryDispositionMap.get(K);clearTimeout(j.timer);const _=this.deliveryDispositionMap.delete(K);p.sender("[%s] Event: '%s', Successfully deleted the delivery with id %d from the  map of sender '%s' on amqp session '%s' and cleared the timer: %s.",this.connection.id,k,K,this.name,this.session.id,_);const b=`Sender '${this.name}' on amqp session '${this.session.id}', received a '${k}' disposition. Hence we are rejecting the promise.`,U=new $.SendOperationFailedError(b,k,w);return p.error("[%s] %s",this.connection.id,b),j.reject(U)}},C=(k,K)=>{for(const w of this.deliveryDispositionMap.keys())z(k,w,K)};this.on(R.SenderEvents.accepted,k=>{J(k.delivery)}),this.on(R.SenderEvents.rejected,k=>{const K=k.delivery;z(R.SenderEvents.rejected,K.id,K.remote_state&&K.remote_state.error)}),this.on(R.SenderEvents.released,k=>{const K=k.delivery;z(R.SenderEvents.released,K.id,K.remote_state&&K.remote_state.error)}),this.on(R.SenderEvents.modified,k=>{const K=k.delivery;z(R.SenderEvents.modified,K.id,K.remote_state&&K.remote_state.error)}),V.onError||this.on(R.SenderEvents.senderError,k=>{C(R.SenderEvents.senderError,k.sender.error)}),V.onSessionError||this.session.on(E.SessionEvents.sessionError,k=>{C(E.SessionEvents.sessionError,k.session.error)})}send(M,D={}){return new Promise((V,J)=>{p.sender("[%s] Sender '%s' on amqp session '%s', credit: %d available: %d",this.connection.id,this.name,this.session.id,this.credit,this.session.outgoing.available());const z=D&&D.abortSignal,C=D.timeoutInSeconds||20;if(z&&z.aborted){const k=H.createAbortError();return p.error("[%s] %s",this.connection.id,k.message),J(k)}if(this.sendable()){const k=setTimeout(()=>{this.deliveryDispositionMap.delete(j.id);const _=`Sender '${this.name}' on amqp session '${this.session.id}', with address '${this.address}' was not able to send the message with delivery id ${j.id} right now, due to operation timeout.`;return p.error("[%s] %s",this.connection.id,_),J(new $.OperationTimeoutError(_))},1e3*C),K=()=>{if(this.deliveryDispositionMap.has(j.id)){const _=this.deliveryDispositionMap.get(j.id);clearTimeout(_.timer);const b=this.deliveryDispositionMap.delete(j.id);p.sender("[%s] Event: 'abort', Successfully deleted the delivery with id %d from the  map of sender '%s' on amqp session '%s' and cleared the timer: %s.",this.connection.id,j.id,this.name,this.session.id,b);const U=H.createAbortError();p.error("[%s] %s",this.connection.id,U.message),_.reject(U)}},w=()=>{z&&z.removeEventListener("abort",K)},j=this._link.send(M,D.tag,D.format);this.deliveryDispositionMap.set(j.id,{resolve:_=>{V(_),w()},reject:_=>{J(_),w()},timer:k}),z&&z.addEventListener("abort",K)}else{const k=`Sender "${this.name}" on amqp session "${this.session.id}", with address ${this.address} cannot send the message right now as it does not have enough credit. Please try later.`;p.error("[%s] %s",this.connection.id,k),J(new $.InsufficientCreditError(k))}})}}},7921:(fe,F,S)=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0}),F.Connection=void 0;const E=S(7582),p=S(6454),O=S(9818),R=S(6348),$=S(7936),H=S(3240),B=S(1474),g=S(6853),M=S(5338);F.Connection=class V extends g.Entity{constructor(z){var C;if(super(),function D(J){return J&&"object"==typeof J.container&&"object"==typeof J.rheaConnection}(z))this._connection=z.rheaConnection,this.container=z.container;else{let k=z;if(k||(k={transport:"tls"}),k.operationTimeoutInSeconds||(k.operationTimeoutInSeconds=$.defaultOperationTimeoutInSeconds),k.webSocketOptions){const K=B.websocket_connect(k.webSocketOptions.webSocket);k.connection_details=K(k.webSocketOptions.url,k.webSocketOptions.protocol,k.webSocketOptions.options)}this._connection=B.create_connection(k),this.container=R.Container.copyFromContainerInstance(this._connection.container),z=k}this.options=this._connection.options,this.options.operationTimeoutInSeconds=null!==(C=z?.operationTimeoutInSeconds)&&void 0!==C?C:$.defaultOperationTimeoutInSeconds,this._initializeEventListeners()}get id(){return this._connection.options.id}get properties(){return this._connection.properties}get maxFrameSize(){return this._connection.max_frame_size}get idleTimeout(){return this._connection.idle_time_out}get channelMax(){return this._connection.channel_max}get error(){return this._connection.error}removeSession(z){return z.remove()}open(z){return new Promise((C,k)=>{if(this.isOpen())return C(this);{let K,w,j;const _=z&&z.abortSignal;let b;const U=()=>{clearTimeout(b),this.actionInitiated--,this._connection.removeListener(B.ConnectionEvents.connectionOpen,K),this._connection.removeListener(B.ConnectionEvents.connectionClose,w),this._connection.removeListener(B.ConnectionEvents.disconnected,w),_&&_.removeEventListener("abort",j)};K=te=>(U(),p.connection("[%s] Resolving the promise with amqp connection.",this.id),C(this)),w=te=>{U();const se=te.error||te.connection.error||Error("Failed to connect");return p.error("[%s] Error occurred while establishing amqp connection: %O",this.id,se),k(se)},j=()=>{U(),this._connection.close();const te=H.createAbortError();return p.error("[%s] [%s]",this.id,te.message),k(te)};const q=()=>{U();const te=`Unable to open the amqp connection "${this.id}" due to operation timeout.`;return p.error("[%s] %s",this.id,te),k(new Error(te))};this._connection.once(B.ConnectionEvents.connectionOpen,K),this._connection.once(B.ConnectionEvents.connectionClose,w),this._connection.once(B.ConnectionEvents.disconnected,w),b=setTimeout(q,1e3*this.options.operationTimeoutInSeconds),p.connection("[%s] Trying to create a new amqp connection.",this.id),this._connection.connect(),this.actionInitiated++,_&&(_.aborted?j():_.addEventListener("abort",j))}})}close(z){return new Promise((C,k)=>{if(p.error("[%s] The connection is open ? -> %s",this.id,this.isOpen()),!this.isOpen())return C();{let K,w,j,_;const b=z&&z.abortSignal;let U;const q=()=>{clearTimeout(U),this.actionInitiated--,this._connection.removeListener(B.ConnectionEvents.connectionError,w),this._connection.removeListener(B.ConnectionEvents.connectionClose,K),this._connection.removeListener(B.ConnectionEvents.disconnected,j),b&&b.removeEventListener("abort",_)};K=se=>(q(),p.connection("[%s] Resolving the promise as the connection has been successfully closed.",this.id),C()),w=se=>(q(),p.error("[%s] Error occurred while closing amqp connection: %O.",this.id,se.connection.error),k(se.connection.error)),j=se=>{q(),p.error("[%s] Connection got disconnected while closing itself: %O.",this.id,se.connection&&se.connection.error?se.connection.error:se.error)},_=()=>{q();const se=H.createAbortError();return p.error("[%s] [%s]",this.id,se.message),k(se)};const te=()=>{q();const se=`Unable to close the amqp connection "${this.id}" due to operation timeout.`;return p.error("[%s] %s",this.id,se),k(new Error(se))};this._connection.once(B.ConnectionEvents.connectionClose,K),this._connection.once(B.ConnectionEvents.connectionError,w),this._connection.once(B.ConnectionEvents.disconnected,j),U=setTimeout(te,1e3*this.options.operationTimeoutInSeconds),this._connection.close(),this.actionInitiated++,b&&(b.aborted?_():b.addEventListener("abort",_))}})}isOpen(){let z=!1;return this._connection&&this._connection.is_open&&this._connection.is_open()&&(z=!0),z}removeAllSessions(){this._connection&&this._connection.remove_all_sessions()}isRemoteOpen(){return this._connection.is_remote_open()}getError(){return this._connection.get_error()}getPeerCertificate(){return this._connection.get_peer_certificate()}getTlsSocket(){return this._connection.get_tls_socket()}wasCloseInitiated(){return this._connection.is_closed()}createSession(z){return new Promise((C,k)=>{const K=z&&z.abortSignal;let w;if(K){const ce=()=>{const me=H.createAbortError();return p.error("[%s] [%s]",this.id,me.message),k(me)};if(w=()=>(se(),j.is_open()?j.close():j.is_closed()||j.once(B.SessionEvents.sessionOpen,()=>{j.close()}),ce()),K.aborted)return ce();K.addEventListener("abort",w)}const j=this._connection.create_session(),_=new O.Session(this,j);let b,U,q,te;_.actionInitiated++;const se=()=>{clearTimeout(te),_.actionInitiated--,j.removeListener(B.SessionEvents.sessionOpen,b),j.removeListener(B.SessionEvents.sessionClose,U),j.connection.removeListener(B.ConnectionEvents.disconnected,q),K&&K.removeEventListener("abort",w)};b=ce=>(se(),p.session("[%s] Resolving the promise with amqp session '%s'.",this.id,_.id),C(_)),U=ce=>(se(),p.error("[%s] Error occurred while establishing a session over amqp connection: %O.",this.id,ce.session.error),k(ce.session.error)),q=ce=>{se();const me=ce.connection&&ce.connection.error?ce.connection.error:ce.error;return p.error("[%s] Connection got disconnected while creating amqp session '%s': %O.",this.id,_.id,me),k(me)},j.once(B.SessionEvents.sessionOpen,b),j.once(B.SessionEvents.sessionClose,U),j.connection.once(B.ConnectionEvents.disconnected,q),p.session("[%s] Calling amqp session.begin().",this.id),te=setTimeout(()=>{se();const ce="Unable to create the amqp session due to operation timeout.";return p.error("[%s] %s",this.id,ce),k(new M.OperationTimeoutError(ce))},1e3*this.options.operationTimeoutInSeconds),j.begin()})}createSender(z){return E.__awaiter(this,void 0,void 0,function*(){return z&&z.session&&z.session.createSender?z.session.createSender(z):(yield this.createSession({abortSignal:z&&z.abortSignal})).createSender(z)})}createAwaitableSender(z){return E.__awaiter(this,void 0,void 0,function*(){return z&&z.session&&z.session.createAwaitableSender?z.session.createAwaitableSender(z):(yield this.createSession({abortSignal:z&&z.abortSignal})).createAwaitableSender(z)})}createReceiver(z){return E.__awaiter(this,void 0,void 0,function*(){return z&&z.session&&z.session.createReceiver?z.session.createReceiver(z):(yield this.createSession({abortSignal:z&&z.abortSignal})).createReceiver(z)})}createRequestResponseLink(z,C,k={}){return E.__awaiter(this,void 0,void 0,function*(){if(!z)throw new Error("Please provide sender options.");if(!C)throw new Error("Please provide receiver options.");const{session:K,abortSignal:w}=k,j=K||(yield this.createSession({abortSignal:w})),[_,b]=yield Promise.all([j.createSender(Object.assign(Object.assign({},z),{abortSignal:w})),j.createReceiver(Object.assign(Object.assign({},C),{abortSignal:w}))]);return p.connection("[%s] Successfully created the sender '%s' and receiver '%s' on the same amqp session '%s'.",this.id,_.name,b.name,j.id),{session:j,sender:_,receiver:b}})}_initializeEventListeners(){for(const z of Object.keys(B.ConnectionEvents))this._connection.on(B.ConnectionEvents[z],C=>{const k={rheaContext:C,emitter:this,eventName:B.ConnectionEvents[z],emitterType:"connection",connectionId:this.id};B.ConnectionEvents[z]===B.ConnectionEvents.protocolError&&p.connection("[%s] ProtocolError is: %O.",this.id,C),H.emitEvent(k)});this._connection.on(B.SenderEvents.senderError,z=>{H.emitEvent({rheaContext:z,emitter:this,eventName:B.SenderEvents.senderError,emitterType:"connection",connectionId:this.id})}),this._connection.on(B.SenderEvents.senderClose,z=>{H.emitEvent({rheaContext:z,emitter:this,eventName:B.SenderEvents.senderClose,emitterType:"connection",connectionId:this.id})}),this._connection.on(B.ReceiverEvents.receiverError,z=>{H.emitEvent({rheaContext:z,emitter:this,eventName:B.ReceiverEvents.receiverError,emitterType:"connection",connectionId:this.id})}),this._connection.on(B.ReceiverEvents.receiverClose,z=>{H.emitEvent({rheaContext:z,emitter:this,eventName:B.ReceiverEvents.receiverClose,emitterType:"connection",connectionId:this.id})}),this._connection.on(B.SessionEvents.sessionError,z=>{H.emitEvent({rheaContext:z,emitter:this,eventName:B.SessionEvents.sessionError,emitterType:"connection",connectionId:this.id})}),this._connection.on(B.SessionEvents.sessionClose,z=>{H.emitEvent({rheaContext:z,emitter:this,eventName:B.SessionEvents.sessionClose,emitterType:"connection",connectionId:this.id})}),"function"==typeof this._connection.eventNames&&p.eventHandler("[%s] rhea-promise 'connection' object is listening for events: %o emitted by rhea's 'connection' object.",this.id,this._connection.eventNames())}}},6348:(fe,F,S)=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0}),F.Container=void 0;const E=S(7582),p=S(1474),O=S(2016),R=S(7921);class $ extends O.EventEmitter{constructor(B){B||(B={}),super(),B.createdInstance?(this._container=B.createdInstance,delete B.createdInstance):this._container=p.create_container(B),this.options=this._container.options}get id(){return this._container.id}get filter(){return this._container.filter}get types(){return this._container.types}get message(){return this._container.message}get sasl(){return this._container.sasl}get saslServerMechanisms(){return this._container.sasl_server_mechanisms}createConnection(B){const g=this._container.create_connection(B);return new R.Connection({rheaConnection:g,container:this})}connect(B){return E.__awaiter(this,void 0,void 0,function*(){return this.createConnection(B).open()})}listen(B){return this._container.listen(B)}generateUUid(){return this._container.generate_uuid()}stringToUuid(B){return this._container.string_to_uuid(B)}uuidToString(B){return this._container.uuid_to_string(B)}websocketAccept(B,g){return this._container.websocket_accept(B,g)}websocketConnect(B){return this._container.websocket_connect(B)}static create(B){return new $(B)}static copyFromContainerInstance(B){return new $({createdInstance:B})}}F.Container=$},6853:(fe,F,S)=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0}),F.Entity=void 0;const E=S(2016);F.Entity=class p extends E.EventEmitter{constructor(){super(),this.actionInitiated=0}}},5338:(fe,F)=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0}),F.SendOperationFailedError=F.InsufficientCreditError=F.OperationTimeoutError=void 0;class S extends Error{constructor(R){super(R),this.name="OperationTimeoutError"}}F.OperationTimeoutError=S;class E extends Error{constructor(R){super(R),this.name="InsufficientCreditError"}}F.InsufficientCreditError=E;class p extends Error{constructor(R,$,H){super(R),this.message=R,this.code=$,this.innerError=H,this.name="SendOperationFailedError",this.code=$,this.innerError=H}}F.SendOperationFailedError=p},2155:(fe,F,S)=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0}),F.EventContext=void 0;const E=S(7921),p=S(9818),O=S(7888),R=S(6454);(F.EventContext||(F.EventContext={})).translate=function B(g,M,D){const V=M instanceof E.Connection?M:M.connection;R.contextTranslator("[%s] Translating the context for event: '%s'.",V.id,D);const J=Object.assign({_context:g},g);return J.connection=V,J.container=V.container,M instanceof O.Link?(J.session=M.session,M.type===O.LinkType.receiver&&g.receiver?J.receiver=M:M.type===O.LinkType.sender&&g.sender&&(J.sender=M)):M instanceof p.Session&&(J.session=M),J}},4588:(fe,F,S)=>{"use strict";F.S$=F.zV=F.Zm=F.ew=F.qW=F.h2=F.KO=F.cz=F.Rg=F.kE=F.nq=F.yw=F.V5=void 0;var p=S(1474);Object.defineProperty(F,"V5",{enumerable:!0,get:function(){return p.types}}),Object.defineProperty(F,"yw",{enumerable:!0,get:function(){return p.message}}),Object.defineProperty(F,"nq",{enumerable:!0,get:function(){return p.uuid_to_string}}),Object.defineProperty(F,"kE",{enumerable:!0,get:function(){return p.generate_uuid}}),Object.defineProperty(F,"Rg",{enumerable:!0,get:function(){return p.string_to_uuid}}),Object.defineProperty(F,"cz",{enumerable:!0,get:function(){return p.ReceiverEvents}}),Object.defineProperty(F,"KO",{enumerable:!0,get:function(){return p.SenderEvents}}),Object.defineProperty(F,"h2",{enumerable:!0,get:function(){return p.ConnectionEvents}}),Object.defineProperty(F,"qW",{enumerable:!0,get:function(){return p.SessionEvents}});S(2155),S(6348);var $=S(7921);Object.defineProperty(F,"ew",{enumerable:!0,get:function(){return $.Connection}});S(9818),S(9012),S(7282),S(7572);var D=S(3240);Object.defineProperty(F,"Zm",{enumerable:!0,get:function(){return D.isAmqpError}}),Object.defineProperty(F,"zV",{enumerable:!0,get:function(){return D.messageProperties}});var V=S(5338);Object.defineProperty(F,"S$",{enumerable:!0,get:function(){return V.OperationTimeoutError}})},7888:(fe,F,S)=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0}),F.Link=F.LinkType=void 0;const E=S(7582),p=S(6454),O=S(1474),R=S(3240),$=S(6853),H=S(5338);var B,M;(M=B=F.LinkType||(F.LinkType={})).sender="sender",M.receiver="receiver",F.Link=class g extends $.Entity{constructor(D,V,J,z){super(),this.type=D,this._session=V,this._link=J,this.linkOptions=z,this._initializeEventListeners()}get name(){return this._link.name}get error(){return this._link.error}get properties(){return this._link.properties}get sendSettleMode(){return this._link.snd_settle_mode}get receiveSettleMode(){return this._link.rcv_settle_mode}get source(){return this._link.source}set source(D){this._link.set_source(D)}get target(){return this._link.target}set target(D){this._link.set_source(D)}get maxMessageSize(){return this._link.max_message_size}get offeredCapabilities(){return this._link.offered_capabilities}get desiredCapabilities(){return this._link.desired_capabilities}get address(){return this.source.address}get credit(){return this._link.credit}get session(){return this._session}get connection(){return this._session.connection}isOpen(){let D=!1;return this._session.isOpen()&&this._link.is_open()&&(D=!0),D}isRemoteOpen(){return this._link.is_remote_open()}hasCredit(){return this._link.has_credit()}isSender(){return this._link.is_sender()}isReceiver(){return this._link.is_receiver()}isClosed(){return this._link.is_closed()}isItselfClosed(){return this._link.is_itself_closed()}isSessionClosed(){return this._session.isClosed()}isSessionItselfClosed(){return this._session.isItselfClosed()}remove(){this._link&&(this.removeAllListeners(),this._link.removeAllListeners(),this._link.remove()),this._session&&this._session.remove()}close(D){return E.__awaiter(this,void 0,void 0,function*(){D||(D={}),null==D.closeSession&&(D.closeSession=!0);const V=new Promise((J,z)=>{if(p.error("[%s] The %s '%s' on amqp session '%s' is open ? -> %s",this.connection.id,this.type,this.name,this.session.id,this.isOpen()),!this.isOpen())return J();{const C=this.type===B.sender?O.SenderEvents.senderError:O.ReceiverEvents.receiverError,k=this.type===B.sender?O.SenderEvents.senderClose:O.ReceiverEvents.receiverClose;let K,w,j,_;const b=()=>{clearTimeout(_),this.actionInitiated--,this._link.removeListener(C,K),this._link.removeListener(k,w),this._link.connection.removeListener(O.ConnectionEvents.disconnected,j)};w=q=>(b(),p[this.type]("[%s] Resolving the promise as the %s '%s' on amqp session '%s' has been closed.",this.connection.id,this.type,this.name,this.session.id),J()),K=q=>{b();let te=q.session.error;return this.type===B.sender&&q.sender&&q.sender.error?te=q.sender.error:this.type===B.receiver&&q.receiver&&q.receiver.error&&(te=q.receiver.error),p.error("[%s] Error occurred while closing %s '%s' on amqp session '%s': %O.",this.connection.id,this.type,this.name,this.session.id,te),z(te)},j=q=>{b(),p.error("[%s] Connection got disconnected while closing amqp %s '%s' on amqp session '%s': %O.",this.connection.id,this.type,this.name,this.session.id,q.connection&&q.connection.error?q.connection.error:q.error)};const U=()=>{b();const q=`Unable to close the ${this.type} '${this.name}' on amqp session '${this.session.id}' due to operation timeout.`;return p.error("[%s] %s",this.connection.id,q),z(new H.OperationTimeoutError(q))};this._link.once(k,w),this._link.once(C,K),this._link.connection.once(O.ConnectionEvents.disconnected,j),_=setTimeout(U,1e3*this.connection.options.operationTimeoutInSeconds),this._link.close(),this.actionInitiated++}});try{yield V}finally{this.removeAllListeners()}if(D.closeSession)return p[this.type]("[%s] %s '%s' has been closed, now closing it's amqp session '%s'.",this.connection.id,this.type,this.name,this.session.id),this._session.close()})}_initializeEventListeners(){const D=this.type===B.sender?O.SenderEvents:O.ReceiverEvents;for(const V of Object.keys(D))this._link.on(D[V],J=>{R.emitEvent({rheaContext:J,emitter:this,eventName:D[V],emitterType:this.type,connectionId:this.connection.id})});"function"==typeof this._link.eventNames&&p.eventHandler("[%s] rhea-promise '%s' object is listening for events: %o emitted by rhea's '%s' object.",this.connection.id,this.type,this._link.eventNames(),this.type),"function"==typeof this._link.listenerCount&&p.eventHandler("[%s] ListenerCount for event '%s_error' on rhea's '%s' object is: %d.",this.connection.id,this.type,this.type,this._link.listenerCount(`${this.type}_error`))}}},6454:(fe,F,S)=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0}),F.contextTranslator=F.eventHandler=F.error=F.receiver=F.sender=F.session=F.connection=F.container=void 0;const E=S(2708);F.container=E("rhea-promise:container"),F.connection=E("rhea-promise:connection"),F.session=E("rhea-promise:session"),F.sender=E("rhea-promise:sender"),F.receiver=E("rhea-promise:receiver"),F.error=E("rhea-promise:error"),F.eventHandler=E("rhea-promise:eventhandler"),F.contextTranslator=E("rhea-promise:translate")},9012:(fe,F,S)=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0}),F.Receiver=void 0;const E=S(7888);F.Receiver=class p extends E.Link{constructor(R,$,H){super(E.LinkType.receiver,R,$,H)}get drain(){return this._link.drain}set drain(R){this._link.drain=R}addCredit(R){this._link.add_credit(R)}drainCredit(){this._link.drain_credit()}setCreditWindow(R){this._link.set_credit_window(R)}}},7282:(fe,F,S)=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0}),F.Sender=F.SenderSendOptions=F.BaseSender=void 0;const E=S(7888);class p extends E.Link{constructor(H,B,g){super(E.LinkType.sender,H,B,g)}setDrained(H){this._link.set_drained(H)}sendable(){return this._link.sendable()}}F.BaseSender=p,F.SenderSendOptions=class O{},F.Sender=class R extends p{constructor(H,B,g){super(H,B,g)}send(H,B={}){return this._link.send(H,B.tag,B.format)}}},9818:(fe,F,S)=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0}),F.Session=void 0;const E=S(7582),p=S(6454),O=S(9012),R=S(7282),$=S(1474),H=S(3240),B=S(6853),g=S(5338),M=S(7572);var D=function(J){return J.sender="sender",J.AwaitableSender="AwaitableSender",J}(D||{});F.Session=class V extends B.Entity{constructor(z,C){super(),this._connection=z,this._session=C,this._initializeEventListeners()}get connection(){return this._connection}get incoming(){return this._session.incoming}get outgoing(){return this._session.outgoing}get error(){return this._session.error}get id(){let z="";const C=this._session;return C.local&&(z+=`local-${C.local.channel}_`),C.remote&&(z+=`remote-${C.remote.channel}_`),z&&(z+=`${this._connection.id}`),z}isOpen(){let z=!1;return this._connection.isOpen()&&this._session.is_open()&&(z=!0),z}isClosed(){return this._session.is_closed()}isItselfClosed(){return this._session.is_itself_closed()}remove(){this._session&&(this.removeAllListeners(),this._session.removeAllListeners(),this._session.remove())}begin(){this._session&&this._session.begin()}close(z){return E.__awaiter(this,void 0,void 0,function*(){const C=new Promise((k,K)=>{if(p.error("[%s] The amqp session '%s' is open ? -> %s",this.connection.id,this.id,this.isOpen()),!this.isOpen())return k();{let w,j,_,b;const U=z&&z.abortSignal;let q;const te=()=>{clearTimeout(q),this.actionInitiated--,this._session.removeListener($.SessionEvents.sessionError,w),this._session.removeListener($.SessionEvents.sessionClose,j),this._session.connection.removeListener($.ConnectionEvents.disconnected,_),U&&U.removeEventListener("abort",b)};j=ie=>(te(),p.session("[%s] Resolving the promise as the amqp session '%s' has been closed.",this.connection.id,this.id),k()),w=ie=>{te(),p.error("[%s] Error occurred while closing amqp session '%s'.",this.connection.id,this.id,ie.session.error),K(ie.session.error)},_=ie=>{te(),p.error("[%s] Connection got disconnected while closing amqp session '%s': %O.",this.connection.id,this.id,ie.connection&&ie.connection.error?ie.connection.error:ie.error)},b=()=>{te();const ie=H.createAbortError();return p.error("[%s] [%s]",this.connection.id,ie.message),K(ie)};const se=()=>{te();const ie=`Unable to close the amqp session ${this.id} due to operation timeout.`;p.error("[%s] %s",this.connection.id,ie),K(new g.OperationTimeoutError(ie))};this._session.once($.SessionEvents.sessionClose,j),this._session.once($.SessionEvents.sessionError,w),this._session.connection.once($.ConnectionEvents.disconnected,_),p.session("[%s] Calling session.close() for amqp session '%s'.",this.connection.id,this.id),q=setTimeout(se,1e3*this.connection.options.operationTimeoutInSeconds),this._session.close(),this.actionInitiated++,U&&(U.aborted?b():U.addEventListener("abort",b))}});try{yield C}finally{this.removeAllListeners()}})}createReceiver(z){return new Promise((C,k)=>{if(z&&(z.onMessage&&!z.onError||z.onError&&!z.onMessage)&&0!==z.credit_window)return k(new Error("Either provide both 'onMessage' and 'onError' handlers, or please set the credit_window to 0, if you want to provide only the 'onError' handler. This ensures no messages are lost between the receiver getting created  and the 'onMessage' handler being added."));const K=z&&z.abortSignal;let w;if(K){const ce=()=>{const me=H.createAbortError();return p.error("[%s] [%s]",this.connection.id,me.message),k(me)};if(w=()=>(se(),j.is_open()?j.close():j.is_closed()||j.once($.ReceiverEvents.receiverOpen,()=>{j.close()}),ce()),K.aborted)return ce();K.addEventListener("abort",w)}z&&z.onSessionError&&(this.on($.SessionEvents.sessionError,z.onSessionError),p.session("[%s] Added event handler for event '%s' on rhea-promise 'session: %s', while creating the 'receiver'.",this.connection.id,$.SessionEvents.sessionError,this.id)),z&&z.onSessionClose&&(this.on($.SessionEvents.sessionClose,z.onSessionClose),p.session("[%s] Added event handler for event '%s' on rhea-promise 'session: %s',  while creating the 'receiver'.",this.connection.id,$.SessionEvents.sessionClose,this.id));const j=this._session.attach_receiver(z),_=new O.Receiver(this,j,z);let b,U,q,te;_.actionInitiated++,z&&z.onMessage&&(_.on($.ReceiverEvents.message,z.onMessage),p.receiver("[%s] Added event handler for event '%s' on rhea-promise 'receiver'.",this.connection.id,$.ReceiverEvents.message)),z&&z.onError&&(_.on($.ReceiverEvents.receiverError,z.onError),p.receiver("[%s] Added event handler for event '%s' on rhea-promise 'receiver'.",this.connection.id,$.ReceiverEvents.receiverError)),z&&z.onClose&&(_.on($.ReceiverEvents.receiverClose,z.onClose),p.receiver("[%s] Added event handler for event '%s' on rhea-promise 'receiver'.",this.connection.id,$.ReceiverEvents.receiverClose)),z&&z.onSettled&&(_.on($.ReceiverEvents.settled,z.onSettled),p.receiver("[%s] Added event handler for event '%s' on rhea-promise 'receiver'.",this.connection.id,$.ReceiverEvents.settled));const se=()=>{clearTimeout(te),_.actionInitiated--,j.removeListener($.ReceiverEvents.receiverOpen,b),j.removeListener($.ReceiverEvents.receiverClose,U),j.session.connection.removeListener($.ConnectionEvents.disconnected,q),K&&K.removeEventListener("abort",w)};b=ce=>(se(),p.receiver("[%s] Resolving the promise with amqp receiver '%s' on amqp session '%s'.",this.connection.id,_.name,this.id),C(_)),U=ce=>(se(),p.error("[%s] Error occurred while creating the amqp receiver '%s' on amqp session '%s' over amqp connection: %O.",this.connection.id,_.name,this.id,ce.receiver.error),k(ce.receiver.error)),q=ce=>{se();const me=ce.connection&&ce.connection.error?ce.connection.error:ce.error;return p.error("[%s] Connection got disconnected while creating amqp receiver '%s' on amqp session '%s': %O.",this.connection.id,_.name,this.id,me),k(me)},j.once($.ReceiverEvents.receiverOpen,b),j.once($.ReceiverEvents.receiverClose,U),j.session.connection.on($.ConnectionEvents.disconnected,q),te=setTimeout(()=>{se();const ce=`Unable to create the amqp receiver '${_.name}' on amqp session '${this.id}' due to operation timeout.`;return p.error("[%s] %s",this.connection.id,ce),k(new g.OperationTimeoutError(ce))},1e3*this.connection.options.operationTimeoutInSeconds)})}createSender(z){return this._createSender(D.sender,z)}createAwaitableSender(z){return this._createSender(D.AwaitableSender,z)}_createSender(z,C){return new Promise((k,K)=>{const w=C&&C.abortSignal;let j;if(w){const me=()=>{const De=H.createAbortError();return p.error("[%s] [%s]",this.connection.id,De.message),K(De)};if(j=()=>(ie(),_.is_open()?_.close():_.is_closed()||_.once($.SenderEvents.senderOpen,()=>{_.close()}),me()),w.aborted)return me();w.addEventListener("abort",j)}C&&C.onSessionError&&(this.on($.SessionEvents.sessionError,C.onSessionError),p.session("[%s] Added event handler for event '%s' on rhea-promise 'session: %s', while creating the sender.",this.connection.id,$.SessionEvents.sessionError,this.id)),C&&C.onSessionClose&&(this.on($.SessionEvents.sessionClose,C.onSessionClose),p.session("[%s] Added event handler for event '%s' on rhea-promise 'session: %s', while creating the sender.",this.connection.id,$.SessionEvents.sessionClose,this.id));const _=this._session.attach_sender(C);let b,U,q,te,se;b=z===D.sender?new R.Sender(this,_,C):new M.AwaitableSender(this,_,C),b.actionInitiated++,C&&(C.onError&&b.on($.SenderEvents.senderError,C.onError),C.onClose&&b.on($.SenderEvents.senderClose,C.onClose),z===D.sender&&(C.onAccepted&&b.on($.SenderEvents.accepted,C.onAccepted),C.onRejected&&b.on($.SenderEvents.rejected,C.onRejected),C.onReleased&&b.on($.SenderEvents.released,C.onReleased),C.onModified&&b.on($.SenderEvents.modified,C.onModified)));const ie=()=>{clearTimeout(se),b.actionInitiated--,_.removeListener($.SenderEvents.senderOpen,U),_.removeListener($.SenderEvents.senderClose,q),_.session.connection.removeListener($.ConnectionEvents.disconnected,te),w&&w.removeEventListener("abort",j)};U=me=>(ie(),p.sender("[%s] Resolving the promise with amqp sender '%s' on amqp session '%s'.",this.connection.id,b.name,this.id),k(b)),q=me=>(ie(),p.error("[%s] Error occurred while creating the amqp sender '%s' on amqp session '%s' over amqp connection: %O.",this.connection.id,b.name,this.id,me.sender.error),K(me.sender.error)),te=me=>{ie();const De=me.connection&&me.connection.error?me.connection.error:me.error;return p.error("[%s] Connection got disconnected while creating amqp sender '%s' on amqp session '%s': %O.",this.connection.id,b.name,this.id,De),K(De)},_.once($.SenderEvents.sendable,U),_.once($.SenderEvents.senderClose,q),_.session.connection.on($.ConnectionEvents.disconnected,te),se=setTimeout(()=>{ie();const me=`Unable to create the amqp sender '${b.name}' on amqp session '${this.id}' due to operation timeout.`;return p.error("[%s] %s",this.connection.id,me),K(new g.OperationTimeoutError(me))},1e3*this.connection.options.operationTimeoutInSeconds)})}_initializeEventListeners(){for(const z of Object.keys($.SessionEvents))this._session.on($.SessionEvents[z],C=>{H.emitEvent({rheaContext:C,emitter:this,eventName:$.SessionEvents[z],emitterType:"session",connectionId:this.connection.id})});this._session.on($.SenderEvents.senderError,z=>{H.emitEvent({rheaContext:z,emitter:this,eventName:$.SenderEvents.senderError,emitterType:"session",connectionId:this.connection.id})}),this._session.on($.SenderEvents.senderClose,z=>{H.emitEvent({rheaContext:z,emitter:this,eventName:$.SenderEvents.senderClose,emitterType:"session",connectionId:this.connection.id})}),this._session.on($.ReceiverEvents.receiverError,z=>{H.emitEvent({rheaContext:z,emitter:this,eventName:$.ReceiverEvents.receiverError,emitterType:"session",connectionId:this.connection.id})}),this._session.on($.ReceiverEvents.receiverClose,z=>{H.emitEvent({rheaContext:z,emitter:this,eventName:$.ReceiverEvents.receiverClose,emitterType:"session",connectionId:this.connection.id})}),"function"==typeof this._session.eventNames&&p.eventHandler("[%s] rhea-promise 'session' object '%s' is listening for events: %o emitted by rhea's 'session' object.",this.connection.id,this.id,this._session.eventNames())}}},7936:(fe,F)=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0}),F.defaultOperationTimeoutInSeconds=void 0,F.defaultOperationTimeoutInSeconds=60},3240:(fe,F,S)=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0}),F.createAbortError=F.abortErrorName=F.emitEvent=F.parseConnectionString=F.delay=F.isAmqpError=F.messageHeader=F.messageProperties=F.AmqpResponseStatusCode=void 0;const E=S(6454),p=S(2155);var M;(M=F.AmqpResponseStatusCode||(F.AmqpResponseStatusCode={}))[M.Continue=100]="Continue",M[M.SwitchingProtocols=101]="SwitchingProtocols",M[M.OK=200]="OK",M[M.Created=201]="Created",M[M.Accepted=202]="Accepted",M[M.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",M[M.NoContent=204]="NoContent",M[M.ResetContent=205]="ResetContent",M[M.PartialContent=206]="PartialContent",M[M.Ambiguous=300]="Ambiguous",M[M.MultipleChoices=300]="MultipleChoices",M[M.Moved=301]="Moved",M[M.MovedPermanently=301]="MovedPermanently",M[M.Found=302]="Found",M[M.Redirect=302]="Redirect",M[M.RedirectMethod=303]="RedirectMethod",M[M.SeeOther=303]="SeeOther",M[M.NotModified=304]="NotModified",M[M.UseProxy=305]="UseProxy",M[M.Unused=306]="Unused",M[M.RedirectKeepVerb=307]="RedirectKeepVerb",M[M.TemporaryRedirect=307]="TemporaryRedirect",M[M.BadRequest=400]="BadRequest",M[M.Unauthorized=401]="Unauthorized",M[M.PaymentRequired=402]="PaymentRequired",M[M.Forbidden=403]="Forbidden",M[M.NotFound=404]="NotFound",M[M.MethodNotAllowed=405]="MethodNotAllowed",M[M.NotAcceptable=406]="NotAcceptable",M[M.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",M[M.RequestTimeout=408]="RequestTimeout",M[M.Conflict=409]="Conflict",M[M.Gone=410]="Gone",M[M.LengthRequired=411]="LengthRequired",M[M.PreconditionFailed=412]="PreconditionFailed",M[M.RequestEntityTooLarge=413]="RequestEntityTooLarge",M[M.RequestUriTooLong=414]="RequestUriTooLong",M[M.UnsupportedMediaType=415]="UnsupportedMediaType",M[M.RequestedRangeNotSatisfiable=416]="RequestedRangeNotSatisfiable",M[M.ExpectationFailed=417]="ExpectationFailed",M[M.UpgradeRequired=426]="UpgradeRequired",M[M.InternalServerError=500]="InternalServerError",M[M.NotImplemented=501]="NotImplemented",M[M.BadGateway=502]="BadGateway",M[M.ServiceUnavailable=503]="ServiceUnavailable",M[M.GatewayTimeout=504]="GatewayTimeout",M[M.HttpVersionNotSupported=505]="HttpVersionNotSupported",F.messageProperties=["message_id","reply_to","to","correlation_id","content_type","absolute_expiry_time","group_id","group_sequence","reply_to_group_id","content_encoding","creation_time","subject","user_id"],F.messageHeader=["first_acquirer","delivery_count","ttl","durable","priority"],F.isAmqpError=function R(M){if(!M||"object"!=typeof M)throw new Error("err is a required parameter and must be of type 'object'.");let D=!1;return(M.condition&&"string"==typeof M.condition&&M.description&&"string"==typeof M.description||M.value&&Array.isArray(M.value)||M.constructor&&"c"===M.constructor.name)&&(D=!0),D},F.delay=function $(M,D){return new Promise(V=>setTimeout(()=>V(D),M))},F.parseConnectionString=function H(M,D){D||(D={});const J=D.keyValueSeparator||"=";return M.split(D.entitySeperator||";").reduce((z,C)=>{const k=C.indexOf(J);return Object.assign(Object.assign({},z),{[C.substring(0,k)]:C.substring(k+1)})},{})},F.emitEvent=function B(M){const D=()=>{E[M.emitterType]("[%s] %s '%s' got event: '%s'. Re-emitting the translated context.",M.connectionId,M.emitterType,M.emitter&&(M.emitter.id||M.emitter.name),M.eventName),M.emitter.emit(M.eventName,p.EventContext.translate(M.rheaContext,M.emitter,M.eventName))};-1!==M.eventName.indexOf("error")&&M.emitter.actionInitiated>0?(E[M.emitterType]("[%s] %s got event: '%s'. Will re-emit in the next tick, since this happened before the promise for create/close was resolved.",M.connectionId,M.emitterType,M.eventName),setTimeout(D)):D()},F.abortErrorName="AbortError",F.createAbortError=function g(){const M=new Error("The operation was aborted.");return M.name=F.abortErrorName,M}},2708:(fe,F,S)=>{"use strict";function E(M){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(V){return typeof V}:function(V){return V&&"function"==typeof Symbol&&V.constructor===Symbol&&V!==Symbol.prototype?"symbol":typeof V})(M)}F.log=function R(){var M;return"object"===(typeof console>"u"?"undefined":E(console))&&console.log&&(M=console).log.apply(M,arguments)},F.formatArgs=function O(M){if(M[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+M[0]+(this.useColors?"%c ":" ")+"+"+fe.exports.humanize(this.diff),this.useColors){var D="color: "+this.color;M.splice(1,0,D,"color: inherit");var V=0,J=0;M[0].replace(/%[a-zA-Z%]/g,function(z){"%%"!==z&&(V++,"%c"===z&&(J=V))}),M.splice(J,0,D)}},F.save=function $(M){try{M?F.storage.setItem("debug",M):F.storage.removeItem("debug")}catch{}},F.load=function H(){var M;try{M=F.storage.getItem("debug")}catch{}return!M&&typeof process<"u"&&"env"in process&&(M=process.env.DEBUG),M},F.useColors=function p(){return!(!(typeof window<"u"&&window.process)||"renderer"!==window.process.type&&!window.process.__nwjs)||!(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},F.storage=function B(){try{return localStorage}catch{}}(),F.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],fe.exports=S(4186)(F),fe.exports.formatters.j=function(M){try{return JSON.stringify(M)}catch(D){return"[UnexpectedJSONParseError]: "+D.message}}},4186:(fe,F,S)=>{"use strict";fe.exports=function E(p){function O(V){for(var J=0,z=0;z<V.length;z++)J=(J<<5)-J+V.charCodeAt(z),J|=0;return R.colors[Math.abs(J)%R.colors.length]}function R(V){var J;function z(){if(z.enabled){for(var C=arguments.length,k=new Array(C),K=0;K<C;K++)k[K]=arguments[K];var w=z,j=Number(new Date);w.diff=j-(J||j),w.prev=J,w.curr=j,J=j,k[0]=R.coerce(k[0]),"string"!=typeof k[0]&&k.unshift("%O");var b=0;k[0]=k[0].replace(/%([a-zA-Z%])/g,function(q,te){if("%%"===q)return q;b++;var se=R.formatters[te];return"function"==typeof se&&(q=se.call(w,k[b]),k.splice(b,1),b--),q}),R.formatArgs.call(w,k),(w.log||R.log).apply(w,k)}}return z.namespace=V,z.enabled=R.enabled(V),z.useColors=R.useColors(),z.color=O(V),z.destroy=$,z.extend=H,"function"==typeof R.init&&R.init(z),R.instances.push(z),z}function $(){var V=R.instances.indexOf(this);return-1!==V&&(R.instances.splice(V,1),!0)}function H(V,J){return R(this.namespace+(typeof J>"u"?":":J)+V)}return R.debug=R,R.default=R,R.coerce=function D(V){return V instanceof Error?V.stack||V.message:V},R.disable=function g(){R.enable("")},R.enable=function B(V){R.save(V),R.names=[],R.skips=[];var J,z=("string"==typeof V?V:"").split(/[\s,]+/),C=z.length;for(J=0;J<C;J++)z[J]&&("-"===(V=z[J].replace(/\*/g,".*?"))[0]?R.skips.push(new RegExp("^"+V.substr(1)+"$")):R.names.push(new RegExp("^"+V+"$")));for(J=0;J<R.instances.length;J++){var k=R.instances[J];k.enabled=R.enabled(k.namespace)}},R.enabled=function M(V){if("*"===V[V.length-1])return!0;var J,z;for(J=0,z=R.skips.length;J<z;J++)if(R.skips[J].test(V))return!1;for(J=0,z=R.names.length;J<z;J++)if(R.names[J].test(V))return!0;return!1},R.humanize=S(7253),Object.keys(p).forEach(function(V){R[V]=p[V]}),R.instances=[],R.names=[],R.skips=[],R.formatters={},R.selectColor=O,R.enable(R.load()),R}},9382:(fe,F,S)=>{"use strict";var E=S(2709),p=S(1786),O=S(287),R=S(2908),$=S(6362),H=S(7079),B=S(5012),g=S(2689),M=S(5868),D=S(5323),V=S(9361),J=S(90),z=S(5041),C=S(2016).EventEmitter;function j(G){return G.get_id_string?G.get_id_string():G.localAddress+":"+G.localPort+" -> "+G.remoteAddress+":"+G.remotePort}function b(G,oe){if(G){var ue,ee=G;return function(m){return ue!==m&&(ee=G,ue=m),ee--?oe(m):-1}}return oe}function q(G){if(void 0===G.transport||"tcp"===G.transport)return J.connect;if("tls"===G.transport||"ssl"===G.transport)return z.connect;throw Error("Unrecognised transport: "+G.transport)}var se=["container_id","hostname","max_frame_size","channel_max","idle_time_out","outgoing_locales","incoming_locales","offered_capabilities","desired_capabilities","properties"];function ie(G){return function(){return this.remote.open?this.remote.open[G]:void 0}}function me(G,oe){if("boolean"==typeof G)if(G){var ee=oe.get_option("initial_reconnect_delay",100),ue=oe.get_option("max_reconnect_delay",6e4);oe.options.reconnect=b(oe.get_option("reconnect_limit"),function U(G,oe){var ue,ee=G;return function(m){ue!==m&&(ee=G,ue=m);var T=ee,N=2*ee;return ee=oe>N?N:oe,T}}(ee,ue))}else oe.options.reconnect=!1;else if("number"==typeof G){var m=oe.options.reconnect;oe.options.reconnect=b(oe.get_option("reconnect_limit"),function(){return m})}}var De=1,Ee=function(G,oe){if(this.options={},G){for(var ee in G)this.options[ee]=G[ee];("tls"===G.transport||"ssl"===G.transport)&&void 0===G.servername&&void 0!==G.host&&(this.options.servername=G.host)}else this.options=function w(){var G=function K(){var G;G=process.env.MESSAGING_CONNECT_FILE?[process.env.MESSAGING_CONNECT_FILE]:[process.cwd(),V.join(D.homedir(),".config/messaging"),"/etc/messaging"].map(function(ue){return V.join(ue,"/connect.json")});for(var oe=0;oe<G.length;oe++)if(M.existsSync(G[oe])){var ee=JSON.parse(M.readFileSync(G[oe],"utf8"));return O.config("using config from %s: %j",G[oe],ee),ee}return{}}(),oe={};return"amqps"===G.scheme&&(oe.transport="tls"),G.host&&(oe.host=G.host),oe.port="amqp"===G.port?5672:"amqps"===G.port?5671:G.port,G.sasl&&!1===G.sasl.enabled||(oe.username=G.user?G.user:"anonymous",G.password&&(oe.password=G.password),G.sasl_mechanisms&&(oe.sasl_mechanisms=G.sasl_mechanisms)),G.tls&&(G.tls.key&&(oe.key=M.readFileSync(G.tls.key)),G.tls.cert&&(oe.cert=M.readFileSync(G.tls.cert)),G.tls.ca&&(oe.ca=[M.readFileSync(G.tls.ca)]),(!1===G.verify||!1===G.tls.verify)&&(oe.rejectUnauthorized=!1)),"tls"===oe.transport&&(oe.servername=oe.host),oe}();if(this.container=oe,this.options.id||(this.options.id="connection-"+De++),this.options.container_id||(this.options.container_id=oe?oe.id:$.generate_uuid()),!this.options.connection_details){var m=this;this.options.connection_details=function(){return function te(G){var oe={};return oe.connect=G.connect?G.connect:q(G),oe.host=G.host?G.host:"localhost",oe.port=G.port?G.port:5672,oe.options=G,oe}(m.options)}}me(this.get_option("reconnect",!0),this),this.registered=!1,this.state=new H,this.local_channel_map={},this.remote_channel_map={},this.local={},this.remote={},this.local.open=p.open(function ce(G){var oe={};return se.forEach(function(ee){void 0!==G[ee]&&(oe[ee]=G[ee])}),oe}(this.options)),this.local.close=p.close({}),this.session_policy=function _(G){var oe=null;return{get_session:function(){return oe||((oe=G.create_session()).observers.on("session_close",function(){oe=null}),oe.begin()),oe}}}(this),this.amqp_transport=new g(this.options.id,0,p.TYPE_AMQP,this),this.sasl_transport=void 0,this.transport=this.amqp_transport,this.conn_established_counter=0,this.heartbeat_out=void 0,this.heartbeat_in=void 0,this.abort_idle=void 0,this.socket_ready=!1,this.scheduled_reconnect=void 0,this.default_sender=void 0,this.closed_with_non_fatal_error=!1,m=this,se.forEach(function(T){Object.defineProperty(m,T,{get:ie(T)})}),Object.defineProperty(this,"error",{get:function(){return this.remote.close?this.remote.close.error:void 0}})};function He(G){return G<16?"0x0"+Number(G).toString(16):"0x"+Number(G).toString(16)}function ze(G){for(var oe in G)Object.prototype.hasOwnProperty.call(G,oe)&&delete G[oe]}function pe(G){Ee.prototype["on_"+G]=function(oe){var ee=this.remote_channel_map[oe.channel];if(!ee)throw new E.ProtocolError(G+" received on invalid channel "+oe.channel);ee["on_"+G](oe)}}(Ee.prototype=Object.create(C.prototype)).constructor=Ee,Ee.prototype.dispatch=function(G){return O.events("[%s] Connection got event: %s",this.options.id,G),this.listeners(G).length?(C.prototype.emit.apply(this,arguments),!0):!!this.container&&this.container.dispatch.apply(this.container,arguments)},Ee.prototype._disconnect=function(){for(var G in this.state.disconnected(),this.local_channel_map)this.local_channel_map[G]._disconnect();this.socket_ready=!1},Ee.prototype._reconnect=function(){this.abort_idle&&(clearTimeout(this.abort_idle),this.abort_idle=void 0,this.local.close.error=void 0,this.state=new H,this.state.open()),this.state.reconnect(),this._reset_remote_state()},Ee.prototype._reset_remote_state=function(){this.amqp_transport=new g(this.options.id,0,p.TYPE_AMQP,this),this.sasl_transport=void 0,this.transport=this.amqp_transport,this.remote={},this.remote_channel_map={};var G=this.local_channel_map;for(var oe in G)G[oe]._reconnect()},Ee.prototype.connect=function(){return this.is_server=!1,this.abort_idle&&(clearTimeout(this.abort_idle),this.abort_idle=void 0),this._reset_remote_state(),this._connect(this.options.connection_details(this.conn_established_counter)),this.open(),this},Ee.prototype.reconnect=function(){return this.scheduled_reconnect=void 0,O.reconnect("[%s] reconnecting...",this.options.id),this._reconnect(),this._connect(this.options.connection_details(this.conn_established_counter)),process.nextTick(this._process.bind(this)),this},Ee.prototype.set_reconnect=function(G){me(G,this)},Ee.prototype._connect=function(G){return this.init(G.connect?G.connect(G.port,G.host,G.options,this.connected.bind(this)):q(G)(G.port,G.host,G.options,this.connected.bind(this))),this},Ee.prototype.accept=function(G){return this.is_server=!0,O.io("[%s] client accepted: %s",this.id,j(G)),this.socket_ready=!0,this.init(G)},Ee.prototype.abort_socket=function(G){G===this.socket&&(this.abort_idle=void 0,O.io("[%s] aborting socket",this.options.id),this.socket.end(),this.socket.removeAllListeners&&(this.socket.removeAllListeners("data"),this.socket.removeAllListeners("error"),this.socket.removeAllListeners("end")),"function"==typeof this.socket.destroy&&this.socket.destroy(),this._disconnected())},Ee.prototype.init=function(G){if(this.socket=G,this.get_option("tcp_no_delay",!1)&&this.socket.setNoDelay&&this.socket.setNoDelay(!0),this.socket.on("data",this.input.bind(this)),this.socket.on("error",this.on_error.bind(this)),this.socket.on("end",this.eof.bind(this)),this.is_server){var oe;if(this.container&&Object.getOwnPropertyNames(this.container.sasl_server_mechanisms).length&&(oe=this.container.sasl_server_mechanisms),this.socket.encrypted&&this.socket.authorized&&this.get_option("enable_sasl_external",!1)&&(oe=R.server_add_external(oe?$.clone(oe):{})),oe)this.sasl_transport=void 0===oe.ANONYMOUS||this.get_option("require_sasl",!1)?new R.Server(this,oe):new R.Selective(this,oe);else if(!this.get_option("disable_sasl",!1)){var ee=R.server_mechanisms();ee.enable_anonymous(),this.sasl_transport=new R.Selective(this,ee)}}else{var ue=this.get_option("sasl_mechanisms");if(!ue){var m=this.get_option("username"),T=this.get_option("password"),N=this.get_option("token");m&&(ue=R.client_mechanisms(),T?ue.enable_plain(m,T):N?ue.enable_xoauth2(m,N):ue.enable_anonymous(m))}this.socket.encrypted&&this.options.cert&&this.get_option("enable_sasl_external",!1)&&(ue||(ue=R.client_mechanisms()),ue.enable_external()),ue&&(this.sasl_transport=new R.Client(this,ue,this.options.sasl_init_hostname||this.options.servername||this.options.host))}return this.transport=this.sasl_transport?this.sasl_transport:this.amqp_transport,this},Ee.prototype.open_sender=Ee.prototype.attach_sender=function(G){return this.session_policy.get_session().attach_sender(G)},Ee.prototype.open_receiver=Ee.prototype.attach_receiver=function(G){return this.get_option("tcp_no_delay",!0)&&this.socket.setNoDelay&&this.socket.setNoDelay(!0),this.session_policy.get_session().attach_receiver(G)},Ee.prototype.get_option=function(G,oe){return void 0!==this.options[G]?this.options[G]:this.container?this.container.get_option(G,oe):oe},Ee.prototype.send=function(G){return void 0===this.default_sender&&(this.default_sender=this.open_sender({target:{}})),this.default_sender.send(G)},Ee.prototype.connected=function(){this.socket_ready=!0,this.conn_established_counter++,O.io("[%s] connected %s",this.options.id,j(this.socket)),this.output()},Ee.prototype.sasl_failed=function(G,oe){this.transport_error=new E.ConnectionError(G,oe||"amqp:unauthorized-access",this),this._handle_error(),this.socket.end()},Ee.prototype._is_fatal=function(G){return!this.get_option("all_errors_non_fatal",!1)&&this.get_option("non_fatal_errors",["amqp:connection:forced"]).indexOf(G)<0},Ee.prototype._handle_error=function(){var G=this.get_error();if(G){var oe=this.dispatch("connection_error",this._context({error:G}));return oe=this.dispatch("connection_close",this._context({error:G}))||oe,this._is_fatal(G.condition)?oe||this.dispatch("error",new E.ConnectionError(G.description,G.condition,this)):this.state.local_open&&(this.closed_with_non_fatal_error=!0),!0}return!1},Ee.prototype.get_error=function(){return this.transport_error?this.transport_error:this.remote.close&&this.remote.close.error?new E.ConnectionError(this.remote.close.error.description,this.remote.close.error.condition,this):void 0},Ee.prototype._get_peer_details=function(){var G="";return this.remote.open&&this.remote.open.container&&(G+=this.remote.open.container+" "),this.remote.open&&this.remote.open.properties&&(G+=JSON.stringify(this.remote.open.properties)),G},Ee.prototype.output=function(){try{this.socket&&this.socket_ready&&(this.heartbeat_out&&clearTimeout(this.heartbeat_out),this.transport.write(this.socket),(this.is_closed()&&this.state.has_settled()||this.abort_idle||this.transport_error)&&!this.transport.has_writes_pending()?this.socket.end():this.is_open()&&this.remote.open.idle_time_out&&(this.heartbeat_out=setTimeout(this._write_frame.bind(this),this.remote.open.idle_time_out/2)),this.local.open.idle_time_out&&void 0===this.heartbeat_in&&(this.heartbeat_in=setTimeout(this.idle.bind(this),this.local.open.idle_time_out)))}catch(G){this.saved_error=G,"ProtocolError"===G.name?(console.error("["+this.options.id+"] error on write: "+G+" "+this._get_peer_details()+" "+G.name),this.dispatch("protocol_error",G)||console.error("["+this.options.id+"] error on write: "+G+" "+this._get_peer_details())):this.dispatch("error",G),this.socket.end()}},Ee.prototype.input=function(G){var oe;try{if(this.heartbeat_in&&clearTimeout(this.heartbeat_in),O.io("[%s] read %d bytes",this.options.id,G.length),this.frame_size){if(this.received_bytes+=G.length,this.chunks.push(G),!(this.frame_size<=this.received_bytes))return void O.io("[%s] pushed %d bytes",this.options.id,G.length);oe=Buffer.concat(this.chunks,this.received_bytes),this.chunks=null,this.frame_size=void 0}else this.previous_input?(oe=Buffer.concat([this.previous_input,G]),this.previous_input=null):oe=G;const ee=this.transport.read(oe,this);if(ee<oe.length){const ue=oe.slice(ee);this.frame_size=this.transport.peek_size(ue),this.frame_size?(this.chunks=[ue],this.received_bytes=ue.length,O.io("[%s] waiting frame_size %s",this.options.id,this.frame_size)):this.previous_input=ue}this.local.open.idle_time_out&&(this.heartbeat_in=setTimeout(this.idle.bind(this),this.local.open.idle_time_out)),this.transport.has_writes_pending()?this.output():this.is_closed()&&this.state.has_settled()?this.socket.end():this.is_open()&&this.remote.open.idle_time_out&&!this.heartbeat_out&&(this.heartbeat_out=setTimeout(this._write_frame.bind(this),this.remote.open.idle_time_out/2))}catch(ee){this.saved_error=ee,"ProtocolError"===ee.name?this.dispatch("protocol_error",ee)||console.error("["+this.options.id+"] error on read: "+ee+" "+this._get_peer_details()+" (buffer:"+function Be(G){for(var oe=[],ee=0;ee<G.length;ee++)oe.push(He(G[ee]));return oe.join(",")}(oe)+")"):this.dispatch("error",ee),this.socket.end()}},Ee.prototype.idle=function(){this.is_closed()||(this.closed_with_non_fatal_error=!0,this.local.close.error={condition:"amqp:resource-limit-exceeded",description:"max idle time exceeded"},this.close(),this.abort_idle=setTimeout(this.abort_socket.bind(this,this.socket),1e3))},Ee.prototype.on_error=function(G){this._disconnected(G)},Ee.prototype.eof=function(G){var oe=G||this.saved_error;this.saved_error=void 0,this._disconnected(oe)},Ee.prototype._disconnected=function(G){this.heartbeat_out&&(clearTimeout(this.heartbeat_out),this.heartbeat_out=void 0),this.heartbeat_in&&(clearTimeout(this.heartbeat_in),this.heartbeat_in=void 0),this.abort_idle&&(clearTimeout(this.abort_idle),this.abort_idle=void 0);var oe=this.closed_with_non_fatal_error;if(this.closed_with_non_fatal_error&&(this.closed_with_non_fatal_error=!1,this.options.reconnect&&this.open()),(!this.is_closed()||oe)&&void 0===this.scheduled_reconnect){this._disconnect();var ee={};if(G&&(ee.error=G),!this.is_server&&!this.transport_error&&this.options.reconnect){var ue=this.options.reconnect(this.conn_established_counter);ue>=0?(O.reconnect("[%s] Scheduled reconnect in "+ue+"ms",this.options.id),this.scheduled_reconnect=setTimeout(this.reconnect.bind(this),ue),ee.reconnecting=!0):ee.reconnecting=!1}this.dispatch("disconnected",this._context(ee))||console.warn("["+this.options.id+"] disconnected %s",ee.error||"")}},Ee.prototype.open=function(){this.state.open()&&this._register()},Ee.prototype.close=function(G){G&&(this.local.close.error=G),this.state.close()&&this._register()},Ee.prototype.is_open=function(){return this.state.is_open()},Ee.prototype.is_remote_open=function(){return this.state.remote_open},Ee.prototype.is_closed=function(){return this.state.is_closed()},Ee.prototype.create_session=function(){for(var G=0;this.local_channel_map[G];)G++;var oe=new B(this,G);return this.local_channel_map[G]=oe,oe},Ee.prototype.find_sender=function(G){return this.find_link($.sender_filter(G))},Ee.prototype.find_receiver=function(G){return this.find_link($.receiver_filter(G))},Ee.prototype.find_link=function(G){for(var oe in this.local_channel_map){var ue=this.local_channel_map[oe].find_link(G);if(ue)return ue}},Ee.prototype.each_receiver=function(G,oe){this.each_link(G,$.receiver_filter(oe))},Ee.prototype.each_sender=function(G,oe){this.each_link(G,$.sender_filter(oe))},Ee.prototype.each_link=function(G,oe){for(var ee in this.local_channel_map)this.local_channel_map[ee].each_link(G,oe)},Ee.prototype.on_open=function(G){if(!this.state.remote_opened())throw new E.ProtocolError("Open already received");this.remote.open=G.performative,this.open(),this.dispatch("connection_open",this._context())},Ee.prototype.on_close=function(G){if(!this.state.remote_closed())throw new E.ProtocolError("Close already received");this.remote.close=G.performative,this.remote.close.error?this._handle_error():this.dispatch("connection_close",this._context()),this.heartbeat_out&&clearTimeout(this.heartbeat_out);var oe=this;process.nextTick(function(){oe.close()})},Ee.prototype._register=function(){this.registered||(this.registered=!0,process.nextTick(this._process.bind(this)))},Ee.prototype._process=function(){this.registered=!1;do{this.state.need_open()&&this._write_open();var G=this.local_channel_map;for(var oe in G)G[oe]._process();this.state.need_close()&&this._write_close()}while(!this.state.has_settled())},Ee.prototype._write_frame=function(G,oe,ee){this.amqp_transport.encode(p.amqp_frame(G,oe,ee)),this.output()},Ee.prototype._write_open=function(){this._write_frame(0,this.local.open)},Ee.prototype._write_close=function(){this._write_frame(0,this.local.close),this.local.close.error=void 0},Ee.prototype.on_begin=function(G){var oe;if(null==G.performative.remote_channel)(oe=this.create_session()).local.begin.remote_channel=G.channel;else if(!(oe=this.local_channel_map[G.performative.remote_channel]))throw new E.ProtocolError("Invalid value for remote channel "+G.performative.remote_channel);oe.on_begin(G),this.remote_channel_map[G.channel]=oe},Ee.prototype.get_peer_certificate=function(){if(this.socket&&this.socket.getPeerCertificate)return this.socket.getPeerCertificate()},Ee.prototype.get_tls_socket=function(){if(this.socket&&("tls"===this.options.transport||"ssl"===this.options.transport))return this.socket},Ee.prototype._context=function(G){var oe=G||{};return oe.connection=this,this.container&&(oe.container=this.container),oe},Ee.prototype.remove_session=function(G){this.remote_channel_map[G.remote.channel]===G&&delete this.remote_channel_map[G.remote.channel],this.local_channel_map[G.local.channel]===G&&delete this.local_channel_map[G.local.channel]},Ee.prototype.remove_all_sessions=function(){ze(this.remote_channel_map),ze(this.local_channel_map)},pe("end"),pe("attach"),pe("detach"),pe("transfer"),pe("disposition"),pe("flow"),fe.exports=Ee},1474:(fe,F,S)=>{"use strict";var E=S(9382),p=S(287),O=S(2908),R=S(6362),$=S(8679),H=S(90),B=S(5041),g=S(2016).EventEmitter,M=function(V){this.options=V?Object.create(V):{},this.options.id||(this.options.id=R.generate_uuid()),this.id=this.options.id,this.sasl_server_mechanisms=O.server_mechanisms()};(M.prototype=Object.create(g.prototype)).constructor=M,M.prototype.dispatch=function(V){return p.events("[%s] Container got event: "+V,this.id),g.prototype.emit.apply(this,arguments),!!this.listeners(V).length},M.prototype.connect=function(V){return new E(V,this).connect()},M.prototype.create_connection=function(V){return new E(V,this)},M.prototype.listen=function(V){var z,J=this;if(void 0===V.transport||"tcp"===V.transport)(z=H.createServer(V)).on("connection",function(C){new E(V,J).accept(C)});else{if("tls"!==V.transport&&"ssl"!==V.transport)throw Error("Unrecognised transport: "+V.transport);(z=B.createServer(V)).on("secureConnection",function(C){new E(V,J).accept(C)})}return process.version.match(/v0\.10\.\d+/)?z.listen(V.port,V.host):z.listen(V),z},M.prototype.create_container=function(V){return new M(V)},M.prototype.get_option=function(V,J){return void 0!==this.options[V]?this.options[V]:J},M.prototype.generate_uuid=R.generate_uuid,M.prototype.string_to_uuid=R.string_to_uuid,M.prototype.uuid_to_string=R.uuid_to_string;var D=S(977);M.prototype.websocket_accept=function(V,J){new E(J,this).accept(D.wrap(V))},M.prototype.websocket_connect=D.connect,M.prototype.filter=S(2211),M.prototype.types=S(3011),M.prototype.message=S(5120),M.prototype.sasl=O,M.prototype.ReceiverEvents=$.ReceiverEvents,M.prototype.SenderEvents=$.SenderEvents,M.prototype.SessionEvents=$.SessionEvents,M.prototype.ConnectionEvents=$.ConnectionEvents,fe.exports=new M},7079:fe=>{"use strict";var F=function(){this.init()};F.prototype.init=function(){this.local_open=!1,this.remote_open=!1,this.open_requests=0,this.close_requests=0,this.initialised=!1,this.marker=void 0},F.prototype.mark=function(S){return this.marker=S||Date.now(),this.marker},F.prototype.open=function(){return this.marker=void 0,this.initialised=!0,!this.local_open&&(this.local_open=!0,this.open_requests++,!0)},F.prototype.close=function(){return this.marker=void 0,!!this.local_open&&(this.local_open=!1,this.close_requests++,!0)},F.prototype.disconnected=function(){var S=this.initialised;this.was_open=this.local_open,this.init(),this.initialised=S},F.prototype.reconnect=function(){this.was_open&&(this.open(),this.was_open=void 0)},F.prototype.remote_opened=function(){return!this.remote_open&&(this.remote_open=!0,!0)},F.prototype.remote_closed=function(){return!!this.remote_open&&(this.remote_open=!1,!0)},F.prototype.is_open=function(){return this.local_open&&this.remote_open},F.prototype.is_closed=function(){return this.initialised&&!(this.local_open||this.was_open)&&!this.remote_open},F.prototype.has_settled=function(){return 0===this.open_requests&&0===this.close_requests},F.prototype.need_open=function(){return this.open_requests>0&&(this.open_requests--,!0)},F.prototype.need_close=function(){return this.close_requests>0&&(this.close_requests--,!0)},fe.exports=F},2709:(fe,F,S)=>{"use strict";var E=S(179);function p($){Error.captureStackTrace(this,p),this.message=$,this.name="ProtocolError"}function O($){Error.captureStackTrace(this,O),this.message=$,this.name="TypeError"}function R($,H,B){Error.captureStackTrace(this,R),this.message=$,this.name="ConnectionError",this.condition=H,this.description=$,Object.defineProperty(this,"connection",{value:B})}E.inherits(p,Error),E.inherits(O,p),E.inherits(R,Error),R.prototype.toJSON=function(){return{type:this.name,code:this.condition,message:this.description}},fe.exports={ProtocolError:p,TypeError:O,ConnectionError:R}},8679:fe=>{"use strict";var p,O,F=function(O){return O.message="message",O.receiverOpen="receiver_open",O.receiverDrained="receiver_drained",O.receiverFlow="receiver_flow",O.receiverError="receiver_error",O.receiverClose="receiver_close",O.settled="settled",O}(F||{}),S=function(O){return O.sendable="sendable",O.senderOpen="sender_open",O.senderDraining="sender_draining",O.senderFlow="sender_flow",O.senderError="sender_error",O.senderClose="sender_close",O.accepted="accepted",O.released="released",O.rejected="rejected",O.modified="modified",O.settled="settled",O}(S||{}),E=function(O){return O.sessionOpen="session_open",O.sessionError="session_error",O.sessionClose="session_close",O.settled="settled",O}(E||{});(O=p||(p={})).connectionOpen="connection_open",O.connectionClose="connection_close",O.connectionError="connection_error",O.protocolError="protocol_error",O.error="error",O.disconnected="disconnected",O.settled="settled",fe.exports={ReceiverEvents:F,SenderEvents:S,SessionEvents:E,ConnectionEvents:p}},2211:(fe,F,S)=>{"use strict";var E=S(3011);fe.exports={selector:function(p){return{"jms-selector":E.wrap_described(p,77567109365764)}}}},1786:(fe,F,S)=>{"use strict";var E=S(3011),p=S(2709),O={},R={};function $(b,U){var q=E.define_composite(U);O[U.name]=q.create,R[Number(q.descriptor.numeric).toString(10)]=q,R[q.descriptor.symbolic]=q}O.read_header=function(b){var U=4,q={};if("AMQP"!==b.toString("ascii",0,U))throw new p.ProtocolError("Invalid protocol header for AMQP: "+b.toString("hex",0,U));if(q.protocol_id=b.readUInt8(U++),q.major=b.readUInt8(U++),q.minor=b.readUInt8(U++),q.revision=b.readUInt8(U++),0===q.protocol_id&&0===q.major&&9===q.minor&&1===q.revision)throw new p.ProtocolError("Unsupported AMQP version: 0-9-1");if(1===q.protocol_id&&1===q.major&&0===q.minor&&10===q.revision)throw new p.ProtocolError("Unsupported AMQP version: 0-10");if(1!==q.major||0!==q.minor)throw new p.ProtocolError("Unsupported AMQP version: "+JSON.stringify(q));return q},O.write_header=function(b,U){var q=4;return b.write("AMQP",0,q,"ascii"),b.writeUInt8(U.protocol_id,q++),b.writeUInt8(U.major,q++),b.writeUInt8(U.minor,q++),b.writeUInt8(U.revision,q++),8},O.TYPE_AMQP=0,O.TYPE_SASL=1,O.read_frame=function(b){var U=new E.Reader(b),q={};if(q.size=U.read_uint(4),U.remaining()<q.size-4)return null;var te=U.read_uint(1);if(te<2)throw new p.ProtocolError("Invalid data offset, must be at least 2 was "+te);if(q.type=U.read_uint(1),q.type===O.TYPE_AMQP)q.channel=U.read_uint(2);else{if(q.type!==O.TYPE_SASL)throw new p.ProtocolError("Unknown frame type "+q.type);U.skip(2),q.channel=0}if(te>1&&U.skip(4*te-8),U.remaining()){q.performative=U.read();var se=R[q.performative.descriptor.value];se&&(q.performative=new se(q.performative.value)),U.remaining()&&(q.payload=U.read_bytes(U.remaining()))}return q},O.write_frame=function(b){var U=new E.Writer;if(U.skip(4),U.write_uint(2,1),U.write_uint(b.type,1),b.type===O.TYPE_AMQP)U.write_uint(b.channel,2);else{if(b.type!==O.TYPE_SASL)throw new p.ProtocolError("Unknown frame type "+b.type);U.write_uint(0,2)}b.performative&&(U.write(b.performative),b.payload&&U.write_bytes(b.payload));var q=U.toBuffer();return q.writeUInt32BE(q.length,0),q},O.amqp_frame=function(b,U,q){return{channel:b||0,type:O.TYPE_AMQP,performative:U,payload:q}},O.sasl_frame=function(b){return{channel:0,type:O.TYPE_SASL,performative:b}},$(0,{name:"open",code:16,fields:[{name:"container_id",type:"string",mandatory:!0},{name:"hostname",type:"string"},{name:"max_frame_size",type:"uint",default_value:4294967295},{name:"channel_max",type:"ushort",default_value:65535},{name:"idle_time_out",type:"uint"},{name:"outgoing_locales",type:"symbol",multiple:!0},{name:"incoming_locales",type:"symbol",multiple:!0},{name:"offered_capabilities",type:"symbol",multiple:!0},{name:"desired_capabilities",type:"symbol",multiple:!0},{name:"properties",type:"symbolic_map"}]}),$(0,{name:"begin",code:17,fields:[{name:"remote_channel",type:"ushort"},{name:"next_outgoing_id",type:"uint",mandatory:!0},{name:"incoming_window",type:"uint",mandatory:!0},{name:"outgoing_window",type:"uint",mandatory:!0},{name:"handle_max",type:"uint",default_value:"4294967295"},{name:"offered_capabilities",type:"symbol",multiple:!0},{name:"desired_capabilities",type:"symbol",multiple:!0},{name:"properties",type:"symbolic_map"}]}),$(0,{name:"attach",code:18,fields:[{name:"name",type:"string",mandatory:!0},{name:"handle",type:"uint",mandatory:!0},{name:"role",type:"boolean",mandatory:!0},{name:"snd_settle_mode",type:"ubyte",default_value:2},{name:"rcv_settle_mode",type:"ubyte",default_value:0},{name:"source",type:"*"},{name:"target",type:"*"},{name:"unsettled",type:"map"},{name:"incomplete_unsettled",type:"boolean",default_value:!1},{name:"initial_delivery_count",type:"uint"},{name:"max_message_size",type:"ulong"},{name:"offered_capabilities",type:"symbol",multiple:!0},{name:"desired_capabilities",type:"symbol",multiple:!0},{name:"properties",type:"symbolic_map"}]}),$(0,{name:"flow",code:19,fields:[{name:"next_incoming_id",type:"uint"},{name:"incoming_window",type:"uint",mandatory:!0},{name:"next_outgoing_id",type:"uint",mandatory:!0},{name:"outgoing_window",type:"uint",mandatory:!0},{name:"handle",type:"uint"},{name:"delivery_count",type:"uint"},{name:"link_credit",type:"uint"},{name:"available",type:"uint"},{name:"drain",type:"boolean",default_value:!1},{name:"echo",type:"boolean",default_value:!1},{name:"properties",type:"symbolic_map"}]}),$(0,{name:"transfer",code:20,fields:[{name:"handle",type:"uint",mandatory:!0},{name:"delivery_id",type:"uint"},{name:"delivery_tag",type:"binary"},{name:"message_format",type:"uint"},{name:"settled",type:"boolean"},{name:"more",type:"boolean",default_value:!1},{name:"rcv_settle_mode",type:"ubyte"},{name:"state",type:"delivery_state"},{name:"resume",type:"boolean",default_value:!1},{name:"aborted",type:"boolean",default_value:!1},{name:"batchable",type:"boolean",default_value:!1}]}),$(0,{name:"disposition",code:21,fields:[{name:"role",type:"boolean",mandatory:!0},{name:"first",type:"uint",mandatory:!0},{name:"last",type:"uint"},{name:"settled",type:"boolean",default_value:!1},{name:"state",type:"*"},{name:"batchable",type:"boolean",default_value:!1}]}),$(0,{name:"detach",code:22,fields:[{name:"handle",type:"uint",mandatory:!0},{name:"closed",type:"boolean",default_value:!1},{name:"error",type:"error"}]}),$(0,{name:"end",code:23,fields:[{name:"error",type:"error"}]}),$(0,{name:"close",code:24,fields:[{name:"error",type:"error"}]}),$(0,{name:"sasl_mechanisms",code:64,fields:[{name:"sasl_server_mechanisms",type:"symbol",multiple:!0,mandatory:!0}]}),$(0,{name:"sasl_init",code:65,fields:[{name:"mechanism",type:"symbol",mandatory:!0},{name:"initial_response",type:"binary"},{name:"hostname",type:"string"}]}),$(0,{name:"sasl_challenge",code:66,fields:[{name:"challenge",type:"binary",mandatory:!0}]}),$(0,{name:"sasl_response",code:67,fields:[{name:"response",type:"binary",mandatory:!0}]}),$(0,{name:"sasl_outcome",code:68,fields:[{name:"code",type:"ubyte",mandatory:!0},{name:"additional_data",type:"binary"}]}),fe.exports=O},3978:(fe,F,S)=>{"use strict";var E=S(1786),p=S(287),O=S(5120),R=S(9428),$=S(7079),H=function(w){this.window=w};function B(w){w.delivery.settled=!0}function g(w){w.delivery.update(void 0,O.accepted().described())}function M(w,j,_){Error.call(this),Error.captureStackTrace(this,this.constructor),this.message=w,this.condition=j,this.description=w,Object.defineProperty(this,"link",{value:_})}H.prototype.update=function(w){var j=this.window-w.receiver.credit;j>=this.window/4&&w.receiver.flow(j)},S(179).inherits(M,Error);var D=S(2016).EventEmitter,V=Object.create(D.prototype);function J(w){switch(w){case"name":case"handle":case"role":case"initial_delivery_count":return!0;default:return!1}}V.dispatch=function(w){return p.events("[%s] Link got event: %s",this.connection.options.id,w),D.prototype.emit.apply(this.observers,arguments),this.listeners(w).length?(D.prototype.emit.apply(this,arguments),!0):this.session.dispatch.apply(this.session,arguments)},V.set_source=function(w){this.local.attach.source=R.source(w).described()},V.set_target=function(w){this.local.attach.target=R.target(w).described()},V.attach=function(){this.state.open()&&this.connection._register()},V.open=V.attach,V.detach=function(){this.local.detach.closed=!1,this.state.close()&&this.connection._register()},V.close=function(w){w&&(this.local.detach.error=w),this.local.detach.closed=!0,this.state.close()&&this.connection._register()},V.remove=function(){this.session.remove_link(this)},V.is_open=function(){return this.session.is_open()&&this.state.is_open()},V.is_remote_open=function(){return this.session.is_remote_open()&&this.state.remote_open},V.is_itself_closed=function(){return this.state.is_closed()},V.is_closed=function(){return this.session.is_closed()||this.is_itself_closed()},V._process=function(){do{this.state.need_open()&&this.session.output(this.local.attach),this.issue_flow&&this.state.local_open&&(this.session._write_flow(this),this.issue_flow=!1),this.state.need_close()&&this.session.output(this.local.detach)}while(!this.state.has_settled())},V.on_attach=function(w){if(!this.state.remote_opened())throw Error("Attach already received");this.remote.handle||(this.remote.handle=w.handle),w.performative.source=R.unwrap(w.performative.source),w.performative.target=R.unwrap(w.performative.target),this.remote.attach=w.performative,this.open(),this.dispatch(this.is_receiver()?"receiver_open":"sender_open",this._context())},V.prefix_event=function(w){return(this.local.attach.role?"receiver_":"sender_")+w},V.on_detach=function(w){if(!this.state.remote_closed())throw Error("Detach already received");this._incomplete&&(this._incomplete.settled=!0),this.remote.detach=w.performative;var j=this.remote.detach.error;if(j){var _=this.dispatch(this.prefix_event("error"),this._context());(_=this.dispatch(this.prefix_event("close"),this._context())||_)||D.prototype.emit.call(this.connection.container,"error",new M(j.description,j.condition,this))}else this.dispatch(this.prefix_event("close"),this._context());var b=this,U=this.state.mark();process.nextTick(function(){b.state.marker===U&&(b.close(),process.nextTick(function(){b.remove()}))})};var z=["snd_settle_mode","rcv_settle_mode","source","target","max_message_size","offered_capabilities","desired_capabilities","properties"];function C(w){return function(){return this.remote.attach?this.remote.attach[w]:void 0}}V.init=function(w,j,_,b,U){for(var q in this.session=w,this.connection=w.connection,this.name=j,this.options=void 0===b?{}:b,this.state=new $,this.issue_flow=!1,this.local={handle:_},this.local.attach=E.attach({handle:_,name:j,role:U}),this.local.attach)!J(q)&&void 0!==this.options[q]&&(this.local.attach[q]=this.options[q]);this.local.detach=E.detach({handle:_,closed:!0}),this.remote={handle:void 0},this.delivery_count=0,this.credit=0,this.observers=new D;var te=this;z.forEach(function(se){Object.defineProperty(te,se,{get:C(se)})}),Object.defineProperty(this,"error",{get:function(){return this.remote.detach?this.remote.detach.error:void 0}})},V._disconnect=function(){this.state.disconnected(),this.state.was_open||this.remove()},V._reconnect=function(){this.state.reconnect(),this.remote={handle:void 0},this.delivery_count=0,this.credit=0},V.has_credit=function(){return this.credit>0},V.is_receiver=function(){return this.local.attach.role},V.is_sender=function(){return!this.is_receiver()},V._context=function(w){var j=w||{};return this.is_receiver()?j.receiver=this:j.sender=this,this.session._context(j)},V.get_option=function(w,j){return void 0!==this.options[w]?this.options[w]:this.session.get_option(w,j)};var k=function(w,j,_,b){this.init(w,j,_,b,!1),this._draining=!1,this._drained=!1,this.local.attach.initial_delivery_count=0,this.tag=0,this.get_option("autosettle",!0)&&this.observers.on("settled",B);var U=this;this.get_option("treat_modified_as_released",!0)&&this.observers.on("modified",function(q){U.dispatch("released",q)})};(k.prototype=Object.create(V)).constructor=k,k.prototype._get_drain=function(){if(this._draining&&this._drained&&this.credit){for(;this.credit;)++this.delivery_count,--this.credit;return!0}return!1},k.prototype.set_drained=function(w){this._drained=w,this._draining&&this._drained&&(this.issue_flow=!0)},k.prototype.next_tag=function(){return Buffer.from(new String(this.tag++))},k.prototype.sendable=function(){return!(!this.credit||!this.session.outgoing.available())},k.prototype.on_flow=function(w){var j=w.performative;this.credit=j.delivery_count+j.link_credit-this.delivery_count,this._draining=j.drain,this._drained=this.credit>0,this.is_open()&&(this.dispatch("sender_flow",this._context()),this._draining&&this.dispatch("sender_draining",this._context()),this.sendable()&&this.dispatch("sendable",this._context()))},k.prototype.on_transfer=function(){throw Error("got transfer on sending link")},k.prototype.send=function(w,j,_){var b=void 0===_?O.encode(w):w,U=this.session.send(this,j||this.next_tag(),b,_);return 1===this.local.attach.snd_settle_mode&&(U.settled=!0),U};var K=function(w,j,_,b){this.init(w,j,_,b,!0),this.drain=!1,this.set_credit_window(this.get_option("credit_window",1e3)),this.get_option("autoaccept",!0)&&this.observers.on("message",g),1===this.local.attach.rcv_settle_mode&&this.get_option("autosettle",!0)&&this.observers.on("settled",B)};(K.prototype=Object.create(V)).constructor=K,K.prototype.on_flow=function(w){this.dispatch("receiver_flow",this._context()),w.performative.drain&&(this.credit=w.performative.link_credit,this.delivery_count=w.performative.delivery_count,w.performative.link_credit>0?console.error("ERROR: received flow with drain set, but non zero credit"):this.dispatch("receiver_drained",this._context()))},K.prototype.flow=function(w){w>0&&(this.credit+=w,this.issue_flow=!0,this.connection._register())},K.prototype.drain_credit=function(){this.drain=!0,this.issue_flow=!0,this.connection._register()},K.prototype.add_credit=K.prototype.flow,K.prototype._get_drain=function(){return this.drain},K.prototype.set_credit_window=function(w){if(w>0){var j=new H(w),_=j.update.bind(j);this.observers.on("message",_),this.observers.on("receiver_open",_)}},fe.exports={Sender:k,Receiver:K}},287:(fe,F,S)=>{"use strict";var E=S(563);E.formatters&&(E.formatters.h=function(p){return p.toString("hex")}),fe.exports={config:E("rhea:config"),frames:E("rhea:frames"),raw:E("rhea:raw"),reconnect:E("rhea:reconnect"),events:E("rhea:events"),message:E("rhea:message"),flow:E("rhea:flow"),io:E("rhea:io")}},5120:(fe,F,S)=>{"use strict";var E=S(287),p=S(3011),O={},R={},$=[],H={};function B(w,j,_){j.descriptor=w,R[w.symbolic]=j,R[Number(w.numeric).toString(10)]=j,_&&$.push(_)}function g(w){var j=p.define_composite(w);H[w.name]=j.create,O[Number(j.descriptor.numeric).toString(10)]=j,O[j.descriptor.symbolic]=j,B(j.descriptor,function(U,q){for(var te=new j(q.value),se=0;se<w.fields.length;se++){var ie=w.fields[se],ce=te[ie.name];null!=ce&&(U[ie.name]=ce)}},function(U,q){U.push(j.create(q).described())})}function M(w,j){var _=j?p.wrap_symbolic_map:p.wrap_map,b={numeric:w.code};b.symbolic="amqp:"+w.name.replace(/_/g,"-")+":map",B(b,function(te,se){te[w.name]=p.unwrap_map_simple(se)},function(te,se){se[w.name]&&te.push(p.described_nc(p.wrap_ulong(b.numeric),_(se[w.name])))})}function D(w,j,_){this.typecode=w,this.content=j,this.multiple=_}function V(w,j,_){void 0===w.body?w.body=new D(_,p.unwrap(j)):w.body.constructor===D&&w.body.typecode===_&&(w.body.multiple?w.body.content.push(p.unwrap(j)):(w.body.multiple=!0,w.body.content=[w.body.content,p.unwrap(j)]))}function z(w,j){for(var _ in w){var b=w[_];"object"==typeof b?z(b,j[_]):j[_]=b}}function C(w){w&&z(w,this)}D.prototype.described=function(w){return p.described(p.wrap_ulong(this.typecode),p.wrap(w||this.content))},D.prototype.collect_sections=function(w){if(this.multiple)for(var j=0;j<this.content.length;j++)w.push(this.described(this.content[j]));else w.push(this.described())},g({name:"header",code:112,fields:[{name:"durable",type:"boolean",default_value:!1},{name:"priority",type:"ubyte",default_value:4},{name:"ttl",type:"uint"},{name:"first_acquirer",type:"boolean",default_value:!1},{name:"delivery_count",type:"uint",default_value:0}]}),M({name:"delivery_annotations",code:113},!0),M({name:"message_annotations",code:114},!0),g({name:"properties",code:115,fields:[{name:"message_id",type:"message_id"},{name:"user_id",type:"binary"},{name:"to",type:"string"},{name:"subject",type:"string"},{name:"reply_to",type:"string"},{name:"correlation_id",type:"message_id"},{name:"content_type",type:"symbol"},{name:"content_encoding",type:"symbol"},{name:"absolute_expiry_time",type:"timestamp"},{name:"creation_time",type:"timestamp"},{name:"group_id",type:"string"},{name:"group_sequence",type:"uint"},{name:"reply_to_group_id",type:"string"}]}),M({name:"application_properties",code:116}),B({numeric:117,symbolic:"amqp:data:binary"},function(w,j){V(w,j,117)}),B({numeric:118,symbolic:"amqp:amqp-sequence:list"},function(w,j){V(w,j,118)}),B({numeric:119,symbolic:"amqp:value:*"},function(w,j){w.body=p.unwrap(j)}),M({name:"footer",code:120}),$.push(function J(w,j){j.body&&j.body.collect_sections?j.body.collect_sections(w):w.push(p.described(p.wrap_ulong(119),p.wrap(j.body)))}),H.data_section=function(w){return new D(117,w)},H.sequence_section=function(w){return new D(118,w)},H.data_sections=function(w){return new D(117,w,!0)},H.sequence_sections=function(w){return new D(118,w,!0)},C.prototype.toJSON=function(){var w={};for(var j in this)"function"!=typeof this[j]&&(w[j]=this[j]);return w},C.prototype.toString=function(){return JSON.stringify(this.toJSON())},H.encode=function(w){var j=[];$.forEach(function(q){q(j,w)});for(var _=new p.Writer,b=0;b<j.length;b++)E.message("Encoding section %d of %d: %o",b+1,j.length,j[b]),_.write(j[b]);var U=_.toBuffer();return E.message("encoded %d bytes",U.length),U},H.decode=function(w){for(var j=new C,_=new p.Reader(w);_.remaining();){var b=_.read();if(E.message("decoding section: %o of type: %o",b,b.descriptor),b.descriptor){var U=R[b.descriptor.value];U?U(j,b):console.warn("WARNING: did not recognise message section with descriptor "+b.descriptor)}else console.warn("WARNING: expected described message section got "+JSON.stringify(b))}return j};var k={};function K(w){var j=p.define_composite(w);j.composite_type=w.name,H[w.name]=j.create,k[Number(j.descriptor.numeric).toString(10)]=j,k[j.descriptor.symbolic]=j,H["is_"+w.name]=function(_){if(_&&_.descriptor){var b=k[_.descriptor.value];if(b)return b.descriptor.numeric===w.code}return!1}}H.unwrap_outcome=function(w){if(w&&w.descriptor){var j=k[w.descriptor.value];if(j)return new j(w.value)}return console.error("unrecognised outcome: "+JSON.stringify(w)),w},H.are_outcomes_equivalent=function(w,j){return void 0===w&&void 0===j||void 0!==w&&void 0!==j&&w.descriptor.value===j.descriptor.value&&36===w.descriptor.value},K({name:"received",code:35,fields:[{name:"section_number",type:"uint",mandatory:!0},{name:"section_offset",type:"ulong",mandatory:!0}]}),K({name:"accepted",code:36,fields:[]}),K({name:"rejected",code:37,fields:[{name:"error",type:"error"}]}),K({name:"released",code:38,fields:[]}),K({name:"modified",code:39,fields:[{name:"delivery_failed",type:"boolean"},{name:"undeliverable_here",type:"boolean"},{name:"message_annotations",type:"map"}]}),fe.exports=H},2908:(fe,F,S)=>{"use strict";var E=S(2709),p=S(1786),O=S(2689),R=S(6362),g=function(b){this.callback=b,this.outcome=void 0,this.username=void 0};g.prototype.start=function(b,U){var q=function B(b){for(var U=[],q=0,te=0;te<b.length;)0===b[te]?(U.push(te>q?b.toString("utf8",q,te):null),q=++te):++te;return U.push(te>q?b.toString("utf8",q,te):null),U}(b);if(3!==q.length)return Promise.reject("Unexpected response in PLAIN, got "+q.length+" fields, expected 3");var te=this;return Promise.resolve(this.callback(q[1],q[2],U)).then(function(se){se?(te.outcome=!0,te.username=q[1]):te.outcome=!1})};var M=function(b,U){this.username=b,this.password=U};M.prototype.start=function(b){var U=R.allocate_buffer(1+this.username.length+1+this.password.length);U.writeUInt8(0,0),U.write(this.username,1),U.writeUInt8(0,1+this.username.length),U.write(this.password,1+this.username.length+1),b(void 0,U)};var D=function(){this.outcome=void 0,this.username=void 0};D.prototype.start=function(b){this.outcome=!0,this.username=b?b.toString("utf8"):"anonymous"};var V=function(b){this.username=b||"anonymous"};V.prototype.start=function(b){var U=R.allocate_buffer(1+this.username.length);U.writeUInt8(0,0),U.write(this.username,1),b(void 0,U)};var J=function(){this.outcome=void 0,this.username=void 0};J.prototype.start=function(){this.outcome=!0};var z=function(){this.username=void 0};z.prototype.start=function(b){b(void 0,"")},z.prototype.step=function(b){b(void 0,"")};var C=function(b,U){this.username=b,this.token=U};C.prototype.start=function(b){var U=R.allocate_buffer(this.username.length+this.token.length+5+12+3),q=0;U.write("user=",q),U.write(this.username,q+=5),U.writeUInt8(1,q+=this.username.length),U.write("auth=Bearer ",q+=1),U.write(this.token,q+=12),U.writeUInt8(1,q+=this.token.length),U.writeUInt8(1,q+=1),q+=1,b(void 0,U)};var k=function(b,U){this.connection=b,this.transport=new O(b.amqp_transport.identifier,3,p.TYPE_SASL,this),this.next=b.amqp_transport,this.mechanisms=U,this.mechanism=void 0,this.outcome=void 0,this.username=void 0;var q=Object.getOwnPropertyNames(U);this.transport.encode(p.sasl_frame(p.sasl_mechanisms({sasl_server_mechanisms:q})))};k.prototype.do_step=function(b){if(void 0===this.mechanism.outcome)this.transport.encode(p.sasl_frame(p.sasl_challenge({challenge:b}))),this.connection.output();else{this.outcome=this.mechanism.outcome?0:1;var U=p.sasl_frame(p.sasl_outcome({code:this.outcome}));this.transport.encode(U),this.connection.output(),0===this.outcome&&(this.username=this.mechanism.username,this.transport.write_complete=!0,this.transport.read_complete=!0)}},k.prototype.on_sasl_init=function(b){var U=this.mechanisms[b.performative.mechanism];U?(this.mechanism=U(),Promise.resolve(this.mechanism.start(b.performative.initial_response,b.performative.hostname)).then(this.do_step.bind(this)).catch(this.do_fail.bind(this))):(this.outcome=1,this.transport.encode(p.sasl_frame(p.sasl_outcome({code:this.outcome}))))},k.prototype.on_sasl_response=function(b){Promise.resolve(this.mechanism.step(b.performative.response)).then(this.do_step.bind(this)).catch(this.do_fail.bind(this))},k.prototype.do_fail=function(b){var U=p.sasl_frame(p.sasl_outcome({code:2}));this.transport.encode(U),this.connection.output();try{this.connection.sasl_failed("Sasl callback promise failed with "+b,"amqp:internal-error")}catch(q){console.error("Uncaught error: ",q.message)}},k.prototype.has_writes_pending=function(){return this.transport.has_writes_pending()||this.next.has_writes_pending()},k.prototype.write=function(b){return this.transport.write_complete&&0===this.transport.pending.length?this.next.write(b):this.transport.write(b)},k.prototype.peek_size=function(b){return this.transport.read_complete?this.next.peek_size(b):this.transport.peek_size(b)},k.prototype.read=function(b){return this.transport.read_complete?this.next.read(b):this.transport.read(b)};var K=function(b,U,q){this.connection=b,this.transport=new O(b.amqp_transport.identifier,3,p.TYPE_SASL,this),this.next=b.amqp_transport,this.mechanisms=U,this.mechanism=void 0,this.mechanism_name=void 0,this.hostname=q,this.failed=!1};K.prototype.on_sasl_mechanisms=function(b){var U=[];Array.isArray(b.performative.sasl_server_mechanisms)?U=b.performative.sasl_server_mechanisms:b.performative.sasl_server_mechanisms&&(U=[b.performative.sasl_server_mechanisms]);for(var q=0;void 0===this.mechanism&&q<U.length;q++){var te=U[q],se=this.mechanisms[te];se&&(this.mechanism="function"==typeof se?se():se,this.mechanism_name=te)}if(this.mechanism){var ie=this;this.mechanism.start(function(ce,me){if(ce)ie.failed=!0,ie.connection.sasl_failed("SASL mechanism init failed: "+ce);else{var De={mechanism:ie.mechanism_name,initial_response:me};ie.hostname&&(De.hostname=ie.hostname),ie.transport.encode(p.sasl_frame(p.sasl_init(De))),ie.connection.output()}})}else this.failed=!0,this.connection.sasl_failed("No suitable mechanism; server supports "+b.performative.sasl_server_mechanisms)},K.prototype.on_sasl_challenge=function(b){var U=this;this.mechanism.step(b.performative.challenge,function(q,te){q?(U.failed=!0,U.connection.sasl_failed("SASL mechanism challenge failed: "+q)):(U.transport.encode(p.sasl_frame(p.sasl_response({response:te}))),U.connection.output())})},K.prototype.on_sasl_outcome=function(b){switch(b.performative.code){case 0:this.transport.read_complete=!0,this.transport.write_complete=!0;break;case 2:case 3:case 4:this.transport.write_complete=!0,this.connection.sasl_failed("Failed to authenticate: "+b.performative.code,"amqp:internal-error");break;default:this.transport.write_complete=!0,this.connection.sasl_failed("Failed to authenticate: "+b.performative.code)}},K.prototype.has_writes_pending=function(){return this.transport.has_writes_pending()||this.next.has_writes_pending()},K.prototype.write=function(b){return this.transport.write_complete?this.next.write(b):this.transport.write(b)},K.prototype.peek_size=function(b){return this.transport.read_complete?this.next.peek_size(b):this.transport.peek_size(b)},K.prototype.read=function(b){return this.transport.read_complete?this.next.read(b):this.transport.read(b)};var w=function(b,U){this.header_received=!1,this.transports={0:b.amqp_transport,3:new k(b,U)},this.selected=void 0};w.prototype.has_writes_pending=function(){return this.header_received&&this.selected.has_writes_pending()},w.prototype.write=function(b){return this.selected?this.selected.write(b):0},w.prototype.peek_size=function(b){if(this.header_received)return this.selected.peek_size(b)},w.prototype.read=function(b){if(!this.header_received){if(b.length<8)return 0;if(this.header_received=p.read_header(b),this.selected=this.transports[this.header_received.protocol_id],void 0===this.selected)throw new E.ProtocolError("Invalid AMQP protocol id "+this.header_received.protocol_id)}return this.selected.read(b)};var j={enable_anonymous:function(){this.ANONYMOUS=function(){return new D}},enable_plain:function(b){this.PLAIN=function(){return new g(b)}}},_={enable_anonymous:function(b){this.ANONYMOUS=function(){return new V(b)}},enable_plain:function(b,U){this.PLAIN=function(){return new M(b,U)}},enable_external:function(){this.EXTERNAL=function(){return new z}},enable_xoauth2:function(b,U){if(b&&U)this.XOAUTH2=function(){return new C(b,U)};else{if(void 0===U)throw Error("token must be specified");if(void 0===b)throw Error("username must be specified")}}};fe.exports={Client:K,Server:k,Selective:w,server_mechanisms:function(){return Object.create(j)},client_mechanisms:function(){return Object.create(_)},server_add_external:function(b){return b.EXTERNAL=function(){return new J},b}}},5012:(fe,F,S)=>{"use strict";var E=S(1786),p=S(3978),O=S(287),R=S(5120),$=S(3011),H=S(6362),B=S(7079),g=S(2016).EventEmitter;function M(_,b,U){Error.call(this),Error.captureStackTrace(this,this.constructor),this.message=_,this.condition=b,this.description=_,Object.defineProperty(this,"session",{value:U})}S(179).inherits(M,Error);var D=function(_){this.capacity=_,this.size=0,this.head=0,this.tail=0,this.entries=[]};function V(_){var b,U,q,te,se;for(te=0;te<_.length;te++)se=_[te],void 0===b&&(b=se,U=se,q=se.id),b!==U&&!R.are_outcomes_equivalent(U.state,se.state)||U.settled!==se.settled||q!==se.id?(b.link.session.output(E.disposition({role:b.link.is_receiver(),first:b.id,last:U.id,state:b.state,settled:b.settled})),b=se,U=se,q=se.id):(U.id!==se.id&&(U=se),q++);void 0!==b&&void 0!==U&&b.link.session.output(E.disposition({role:b.link.is_receiver(),first:b.id,last:U.id,state:b.state,settled:b.settled}))}D.prototype.available=function(){return this.capacity-this.size},D.prototype.push=function(_){if(!(this.size<this.capacity))throw Error("circular buffer overflow: head="+this.head+" tail="+this.tail+" size="+this.size+" capacity="+this.capacity);this.entries[this.tail]=_,this.tail=(this.tail+1)%this.capacity,this.size++},D.prototype.pop_if=function(_){for(var b=0;this.size&&_(this.entries[this.head]);)this.entries[this.head]=void 0,this.head=(this.head+1)%this.capacity,this.size--,b++;return b},D.prototype.by_id=function(_){if(this.size>0){var b=_-this.entries[this.head].id;if(b<this.size)return this.entries[(this.head+b)%this.capacity]}},D.prototype.get_head=function(){return this.size>0?this.entries[this.head]:void 0},D.prototype.get_tail=function(){return this.size>0?this.entries[(this.head+this.size-1)%this.capacity]:void 0};var J=function(_){this.deliveries=new D(2048),this.updated=[],this.pending_dispositions=[],this.next_delivery_id=0,this.next_pending_delivery=0,this.next_transfer_id=0,this.window=$.MAX_UINT,this.remote_next_transfer_id=void 0,this.remote_window=void 0,this.connection=_};J.prototype.available=function(){return this.deliveries.available()},J.prototype.compute_max_payload=function(_){if(this.connection.max_frame_size)return this.connection.max_frame_size-(50+_.length)},J.prototype.send=function(_,b,U,q){var te=[],se=this.compute_max_payload(b);if(se&&U.length>se)for(var ie=0;ie<U.length;){var ce=Math.min(ie+se,U.length);te.push(U.slice(ie,ce)),ie=ce}else te.push(U);var me={id:this.next_delivery_id++,tag:b,link:_,data:te,format:q||0,next_to_send:0,sent:!1,settled:!1,state:void 0,remote_settled:!1,remote_state:void 0},De=this;return me.update=function(Ee,He){De.update(me,Ee,He)},this.deliveries.push(me),me},J.prototype.on_begin=function(_){this.remote_window=_.incoming_window},J.prototype.on_flow=function(_){this.remote_next_transfer_id=_.next_incoming_id,this.remote_window=_.incoming_window},J.prototype.on_disposition=function(_){for(var b=_.last?_.last:_.first,U=_.first;U<=b;U++){var q=this.deliveries.by_id(U);if(q&&!q.remote_settled){var te=!1;_.settled&&(q.remote_settled=_.settled,te=!0),_.state&&_.state!==q.remote_state&&(q.remote_state=R.unwrap_outcome(_.state),te=!0),te&&this.updated.push(q)}}},J.prototype.update=function(_,b,U){_&&(_.settled=b,void 0!==U&&(_.state=U),_.remote_settled||this.pending_dispositions.push(_),_.link.connection._register())},J.prototype.transfer_window=function(){return this.remote_window?this.remote_window-(this.next_transfer_id-this.remote_next_transfer_id):0},J.prototype.process=function(){for(var _;this.next_pending_delivery<this.next_delivery_id;){if(!(_=this.deliveries.by_id(this.next_pending_delivery))){console.error("ERROR: Next pending delivery not found: "+this.next_pending_delivery);break}if(!_.link.has_credit()){O.flow("[%s] Link has no credit",this.connection.options.id);break}{const te=Math.min(this.transfer_window(),_.data.length-_.next_to_send);if(!(te>0)){O.flow("[%s] Incoming window of peer preventing sending further transfers: remote_window=%d, remote_next_transfer_id=%d, next_transfer_id=%d",this.connection.options.id,this.remote_window,this.remote_next_transfer_id,this.next_transfer_id);break}{this.window-=te;const se=_.next_to_send+te;for(var b=_.next_to_send;b<se;b++){this.next_transfer_id++;var q=E.transfer({handle:_.link.local.handle,message_format:_.format,delivery_id:_.id,delivery_tag:_.tag,settled:_.settled,more:b+1<_.data.length});_.link.session.output(q,_.data[b])}if(se<_.data.length){_.next_to_send=se;break}_.settled&&(_.remote_settled=!0),_.link.credit--,_.link.delivery_count++,this.next_pending_delivery++}}}for(b=0;b<this.updated.length;b++)(_=this.updated[b]).remote_state&&_.remote_state.constructor.composite_type&&_.link.dispatch(_.remote_state.constructor.composite_type,_.link._context({delivery:_})),_.remote_settled&&_.link.dispatch("settled",_.link._context({delivery:_}));this.updated=[],this.pending_dispositions.length&&(V(this.pending_dispositions),this.pending_dispositions=[]),this.deliveries.pop_if(function(te){return te.settled&&te.remote_settled})};var z=function(){this.deliveries=new D(2048),this.updated=[],this.next_transfer_id=0,this.next_delivery_id=void 0,Object.defineProperty(this,"window",{get:function(){return this.deliveries.available()}}),this.remote_next_transfer_id=void 0,this.remote_window=void 0,this.max_transfer_id=this.next_transfer_id+this.window};z.prototype.update=function(_,b,U){_&&(_.settled=b,void 0!==U&&(_.state=U),_.remote_settled||this.updated.push(_),_.link.connection._register())},z.prototype.on_transfer=function(_,b){if(this.next_transfer_id++,!b.is_remote_open())throw Error("transfer after detach");var U;if(void 0===this.next_delivery_id&&(this.next_delivery_id=_.performative.delivery_id),b._incomplete){if(U=b._incomplete,H.is_defined(_.performative.delivery_id)&&U.id!==_.performative.delivery_id)throw Error("frame sequence error: delivery "+U.id+" not complete, got "+_.performative.delivery_id);_.payload&&U.frames.push(_.payload)}else{if(this.next_delivery_id!==_.performative.delivery_id)throw Error("frame sequence error: expected "+this.next_delivery_id+", got "+_.performative.delivery_id);var q=this;(U={id:_.performative.delivery_id,tag:_.performative.delivery_tag,format:_.performative.message_format,link:b,settled:!1,state:void 0,remote_settled:void 0!==_.performative.settled&&_.performative.settled,remote_state:_.performative.state,frames:[_.payload]}).update=function(se,ie){var ce=se;void 0===ce&&(ce=1!==b.local.attach.rcv_settle_mode),q.update(U,ce,ie)},U.accept=function(){this.update(void 0,R.accepted().described())},U.release=function(se){this.update(void 0,se?R.modified(se).described():R.released().described())},U.reject=function(se){this.update(void 0,R.rejected({error:se}).described())},U.modified=function(se){this.update(void 0,R.modified(se).described())},this.deliveries.push(U),this.next_delivery_id++}if(U.incomplete=_.performative.more,U.incomplete)b._incomplete=U;else{b._incomplete=void 0;const se=1===U.frames.length?U.frames[0]:Buffer.concat(U.frames);delete U.frames,b.credit>0?b.credit--:console.error("Received transfer when credit was %d",b.credit),b.delivery_count++;var te=0===U.format?{message:R.decode(se),delivery:U}:{message:se,delivery:U,format:U.format};b.dispatch("message",b._context(te))}},z.prototype.process=function(_){this.updated.length>0&&(V(this.updated),this.updated=[]),this.deliveries.pop_if(function(b){return b.settled}),this.max_transfer_id-this.next_transfer_id<this.window/2&&_._write_flow()},z.prototype.on_begin=function(_){this.remote_window=_.outgoing_window,this.remote_next_transfer_id=_.next_outgoing_id},z.prototype.on_flow=function(_){this.remote_next_transfer_id=_.next_outgoing_id,this.remote_window=_.outgoing_window},z.prototype.on_disposition=function(_){for(var b=_.last?_.last:_.first,U=_.first;U<=b;U++){var q=this.deliveries.by_id(U);q&&!q.remote_settled&&(_.state&&_.state!==q.remote_state&&(q.remote_state=R.unwrap_outcome(_.state)),_.settled&&(q.remote_settled=_.settled,q.link.dispatch("settled",q.link._context({delivery:q}))))}};var C=function(_,b){this.connection=_,this.outgoing=new J(_),this.incoming=new z,this.state=new B,this.local={channel:b,handles:{}},this.local.begin=E.begin({next_outgoing_id:this.outgoing.next_transfer_id,incoming_window:this.incoming.window,outgoing_window:this.outgoing.window}),this.local.end=E.end(),this.remote={handles:{}},this.links={},this.options={},Object.defineProperty(this,"error",{get:function(){return this.remote.end?this.remote.end.error:void 0}}),this.observers=new g};function k(_,b){for(var U in b)"properties"===U&&_.properties?k(_.properties,b.properties):_[U]=b[U]}function K(_,b,U,q){var te=Object.create(q||{});"string"==typeof b?te[U]=b:b&&k(te,b),te.name||(te.name=H.generate_uuid());var se=_(te.name,te);for(var ie in{source:0,target:0})te[ie]&&("string"==typeof te[ie]&&(te[ie]={address:te[ie]}),se["set_"+ie](te[ie]));return se.is_sender()&&void 0===te.source&&(te.source=se.set_source({})),se.is_receiver()&&void 0===te.target&&(te.target=se.set_target({})),se.attach(),se}function w(_){_.dispatch("sendable",_._context())}function j(_){return _.is_open()&&_.sendable()}(C.prototype=Object.create(g.prototype)).constructor=C,C.prototype._disconnect=function(){for(var _ in this.state.disconnected(),this.links)this.links[_]._disconnect();this.state.was_open||this.remove()},C.prototype._reconnect=function(){for(var _ in this.state.reconnect(),this.outgoing=new J(this.connection),this.incoming=new z,this.remote={handles:{}},this.links)this.links[_]._reconnect()},C.prototype.dispatch=function(_){return O.events("[%s] Session got event: %s",this.connection.options.id,_),g.prototype.emit.apply(this.observers,arguments),this.listeners(_).length?(g.prototype.emit.apply(this,arguments),!0):this.connection.dispatch.apply(this.connection,arguments)},C.prototype.output=function(_,b){this.connection._write_frame(this.local.channel,_,b)},C.prototype.create_sender=function(_,b){return b||(b=this.get_option("sender_options",{})),this.create_link(_,p.Sender,b)},C.prototype.create_receiver=function(_,b){return b||(b=this.get_option("receiver_options",{})),this.create_link(_,p.Receiver,b)},C.prototype.get_option=function(_,b){return void 0!==this.options[_]?this.options[_]:this.connection.get_option(_,b)},C.prototype.open_sender=C.prototype.attach_sender=function(_){return K(this.create_sender.bind(this),_,"target",this.get_option("sender_options",{}))},C.prototype.open_receiver=C.prototype.attach_receiver=function(_){return K(this.create_receiver.bind(this),_,"source",this.get_option("receiver_options",{}))},C.prototype.find_sender=function(_){return this.find_link(H.sender_filter(_))},C.prototype.find_receiver=function(_){return this.find_link(H.receiver_filter(_))},C.prototype.find_link=function(_){for(var b in this.links){var U=this.links[b];if(_(U))return U}},C.prototype.each_receiver=function(_,b){this.each_link(_,H.receiver_filter(b))},C.prototype.each_sender=function(_,b){this.each_link(_,H.sender_filter(b))},C.prototype.each_link=function(_,b){for(var U in this.links){var q=this.links[U];(void 0===b||b(q))&&_(q)}},C.prototype.create_link=function(_,b,U){for(var q=0;this.local.handles[q];)q++;var te=new b(this,_,q,U);return this.links[_]=te,this.local.handles[q]=te,te},C.prototype.open=C.prototype.begin=function(){this.state.open()&&this.connection._register()},C.prototype.close=C.prototype.end=function(_){_&&(this.local.end.error=_),this.state.close()&&this.connection._register()},C.prototype.is_open=function(){return this.connection.is_open()&&this.state.is_open()},C.prototype.is_remote_open=function(){return this.connection.is_remote_open()&&this.state.remote_open},C.prototype.is_itself_closed=function(){return this.state.is_closed()},C.prototype.is_closed=function(){return this.connection.is_closed()||this.is_itself_closed()},C.prototype._process=function(){do{this.state.need_open()&&this.output(this.local.begin);var _=0===this.outgoing.deliveries.available();for(var b in this.outgoing.process(),_&&this.outgoing.deliveries.available()&&this.each_sender(w,j),this.incoming.process(this),this.links)this.links[b]._process();this.state.need_close()&&this.output(this.local.end)}while(!this.state.has_settled())},C.prototype.send=function(_,b,U,q){var te=this.outgoing.send(_,b,U,q);return this.connection._register(),te},C.prototype._write_flow=function(_){var b={next_incoming_id:this.incoming.next_transfer_id,incoming_window:this.incoming.window,next_outgoing_id:this.outgoing.next_transfer_id,outgoing_window:this.outgoing.window};this.incoming.max_transfer_id=b.next_incoming_id+b.incoming_window,_&&(_._get_drain()&&(b.drain=!0),b.delivery_count=_.delivery_count,b.handle=_.local.handle,b.link_credit=_.credit),this.output(E.flow(b))},C.prototype.on_begin=function(_){if(!this.state.remote_opened())throw Error("Begin already received");this.remote.channel||(this.remote.channel=_.channel),this.remote.begin=_.performative,this.outgoing.on_begin(_.performative),this.incoming.on_begin(_.performative),this.open(),this.dispatch("session_open",this._context())},C.prototype.on_end=function(_){if(!this.state.remote_closed())throw Error("End already received");this.remote.end=_.performative;var b=this.remote.end.error;if(b){var U=this.dispatch("session_error",this._context());(U=this.dispatch("session_close",this._context())||U)||g.prototype.emit.call(this.connection.container,"error",new M(b.description,b.condition,this))}else this.dispatch("session_close",this._context());var q=this,te=this.state.mark();process.nextTick(function(){q.state.marker===te&&(q.close(),process.nextTick(function(){q.remove()}))})},C.prototype.on_attach=function(_){var b=_.performative.name,U=this.links[b];U||(U=_.performative.role?this.create_sender(b):this.create_receiver(b)),this.remote.handles[_.performative.handle]=U,U.on_attach(_),U.remote.attach=_.performative},C.prototype.on_disposition=function(_){_.performative.role?(O.events("[%s] Received disposition for outgoing transfers",this.connection.options.id),this.outgoing.on_disposition(_.performative)):(O.events("[%s] Received disposition for incoming transfers",this.connection.options.id),this.incoming.on_disposition(_.performative)),this.connection._register()},C.prototype.on_flow=function(_){this.outgoing.on_flow(_.performative),this.incoming.on_flow(_.performative),H.is_defined(_.performative.handle)&&this._get_link(_).on_flow(_),this.connection._register()},C.prototype._context=function(_){var b=_||{};return b.session=this,this.connection._context(b)},C.prototype._get_link=function(_){var b=_.performative.handle,U=this.remote.handles[b];if(!U)throw Error("Invalid handle "+b);return U},C.prototype.on_detach=function(_){this._get_link(_).on_detach(_)},C.prototype.remove_link=function(_){delete this.remote.handles[_.remote.handle],delete this.local.handles[_.local.handle],delete this.links[_.name]},C.prototype.remove=function(){this.connection.remove_session(this)},C.prototype.on_transfer=function(_){this.incoming.on_transfer(_,this._get_link(_))},fe.exports=C},9428:(fe,F,S)=>{"use strict";var E=S(3011),p={},O={};function R($){var H=E.define_composite($);p[$.name]=H.create,O[Number(H.descriptor.numeric).toString(10)]=H,O[H.descriptor.symbolic]=H}p.unwrap=function($){if($&&$.descriptor){var H=O[$.descriptor.value];if(H)return new H($.value);console.warn("Unknown terminus: "+$.descriptor)}return null},R({name:"source",code:40,fields:[{name:"address",type:"string"},{name:"durable",type:"uint",default_value:0},{name:"expiry_policy",type:"symbol",default_value:"session-end"},{name:"timeout",type:"uint",default_value:0},{name:"dynamic",type:"boolean",default_value:!1},{name:"dynamic_node_properties",type:"symbolic_map"},{name:"distribution_mode",type:"symbol"},{name:"filter",type:"symbolic_map"},{name:"default_outcome",type:"*"},{name:"outcomes",type:"symbol",multiple:!0},{name:"capabilities",type:"symbol",multiple:!0}]}),R({name:"target",code:41,fields:[{name:"address",type:"string"},{name:"durable",type:"uint",default_value:0},{name:"expiry_policy",type:"symbol",default_value:"session-end"},{name:"timeout",type:"uint",default_value:0},{name:"dynamic",type:"boolean",default_value:!1},{name:"dynamic_node_properties",type:"symbolic_map"},{name:"capabilities",type:"symbol",multiple:!0}]}),fe.exports=p},2689:(fe,F,S)=>{"use strict";var E=S(2709),p=S(1786),O=S(287),R=S(6362),$=function(H,B,g,M){this.identifier=H,this.protocol_id=B,this.frame_type=g,this.handler=M,this.pending=[],this.header_sent=void 0,this.header_received=void 0,this.write_complete=!1,this.read_complete=!1};$.prototype.has_writes_pending=function(){return this.pending.length>0||!this.header_sent},$.prototype.encode=function(H){this.pending.push(H)},$.prototype.write=function(H){if(!this.header_sent){var B=R.allocate_buffer(8),g={protocol_id:this.protocol_id,major:1,minor:0,revision:0};O.frames("[%s] -> %o",this.identifier,g),p.write_header(B,g),H.write(B),this.header_sent=g}for(var M=0;M<this.pending.length;M++){var D=this.pending[M];B=p.write_frame(D),H.write(B),D.performative?O.frames("[%s]:%s -> %s %j",this.identifier,D.channel,D.performative.constructor,D.performative,D.payload||""):O.frames("[%s]:%s -> empty",this.identifier,D.channel),O.raw("[%s] SENT: %d %h",this.identifier,B.length,B)}this.pending=[]},$.prototype.peek_size=function(H){if(O.frames("[%s] peek_size %o, %d",this.identifier,this.header_received,H.length),this.header_received&&H.length>=4)return H.readUInt32BE()},$.prototype.read=function(H){var B=0;if(!this.header_received){if(H.length<8)return B;if(this.header_received=p.read_header(H),O.frames("[%s] <- %o",this.identifier,this.header_received),this.header_received.protocol_id!==this.protocol_id)throw new E.ProtocolError(3===this.protocol_id&&0===this.header_received.protocol_id?"Expecting SASL layer":0===this.protocol_id&&3===this.header_received.protocol_id?"SASL layer not enabled":"Invalid AMQP protocol id "+this.header_received.protocol_id+" expecting: "+this.protocol_id);B=8}for(;B<H.length-4&&!this.read_complete;){var g=H.readUInt32BE(B);if(O.io("[%s] got frame of size %d",this.identifier,g),H.length<B+g){O.io("[%s] incomplete frame; have only %d of %d",this.identifier,H.length-B,g);break}var M=H.slice(B,B+g);O.raw("[%s] RECV: %d %h",this.identifier,M.length,M);var D=p.read_frame(M);if(D.performative?O.frames("[%s]:%s <- %s %j",this.identifier,D.channel,D.performative.constructor,D.performative,D.payload||""):O.frames("[%s]:%s <- empty",this.identifier,D.channel),D.type!==this.frame_type)throw new E.ProtocolError("Invalid frame type: "+D.type);B+=g,D.performative&&D.performative.dispatch(this.handler,D)}return B},fe.exports=$},3011:(fe,F,S)=>{"use strict";var E=S(2709),p=S(6362),O=1,R=2,$=3,H=4;function B(m,T,N,le){this.type=m,this.value=T,N&&(this.array_constructor={typecode:N},le&&(this.array_constructor.descriptor=le))}function g(m,T,N,le){this.name=m,this.typecode=T;var Ce=T>>>4;switch(Ce){case 4:this.width=0,this.category=O;break;case 5:this.width=1,this.category=O;break;case 6:this.width=2,this.category=O;break;case 7:this.width=4,this.category=O;break;case 8:this.width=8,this.category=O;break;case 9:this.width=16,this.category=O;break;case 10:this.width=1,this.category=R;break;case 11:this.width=4,this.category=R;break;case 12:this.width=1,this.category=$;break;case 13:this.width=4,this.category=$;break;case 14:this.width=1,this.category=H;break;case 15:this.width=4,this.category=H}N&&(N.read&&(this.read=N.read),N.write&&(this.write=N.write),N.encoding&&(this.encoding=N.encoding));var Me=this;this.create=4===Ce?function(){return new B(Me,le)}:14===Ce||15===Ce?function(Ke,be,xe){return new B(Me,Ke,be,xe)}:function(Ke){return new B(Me,Ke)}}function M(m){return Number(m).toString(16)}B.prototype.toString=function(){return this.value?this.value.toString():null},B.prototype.toLocaleString=function(){return this.value?this.value.toLocaleString():null},B.prototype.valueOf=function(){return this.value},B.prototype.toJSON=function(){return this.value&&this.value.toJSON?this.value.toJSON():this.value},B.prototype.toRheaTyped=function(){return this},g.prototype.toString=function(){return this.name+"#"+M(this.typecode)};var D={by_code:{}};function V(m,T,N,le){var Ce=new g(m,T,N,le);Ce.create.typecode=Ce.typecode,D.by_code[Ce.typecode]=Ce,D[m]=Ce.create}Object.defineProperty(D,"MAX_UINT",{value:4294967295,writable:!1,configurable:!1}),Object.defineProperty(D,"MAX_USHORT",{value:65535,writable:!1,configurable:!1});var b=4294967296;function se(m,T,N){if("number"==typeof T||T instanceof Number){var le=Math.abs(T),Ce=Math.floor(le/b),Me=le%b;if(m.writeInt32BE(Ce,N),m.writeUInt32BE(Me,N+4),T<0)for(var Ke=1,be=0;be<8;be++){var xe=N+(7-be),ft=(255^m[xe])+Ke;m[xe]=255&ft,Ke=ft>>8}}else T.copy(m,N)}function ce(m,T){var N=m.readInt32BE(T),le=m.readUInt32BE(T+4);return N<2097153&&N>-2097153?N*b+le:m.slice(T,T+8)}function De(m,T){for(var N=0;N<T.length;N++)if(m.type.typecode===T[N].typecode)return!0;return!1}function Ee(m,T,N){for(var le=0;le<T&&le<m.length;le++)if(m[le]!==(N?255:0))return!1;return!0}function He(m){for(var T={},N=0;N+1<m.length;)T[m[N++]]=m[N++];return T}V("Null",64,void 0,null),V("Boolean",86,{read:function(m,T){return m.readUInt8(T)},write:function(m,T,N){m.writeUInt8(T,N)}}),V("True",65,void 0,!0),V("False",66,void 0,!1),V("Ubyte",80,{read:function(m,T){return m.readUInt8(T)},write:function(m,T,N){m.writeUInt8(T,N)}}),V("Ushort",96,{read:function(m,T){return m.readUInt16BE(T)},write:function(m,T,N){m.writeUInt16BE(T,N)}}),V("Uint",112,{read:function(m,T){return m.readUInt32BE(T)},write:function(m,T,N){m.writeUInt32BE(T,N)}}),V("SmallUint",82,{read:function(m,T){return m.readUInt8(T)},write:function(m,T,N){m.writeUInt8(T,N)}}),V("Uint0",67,void 0,0),V("Ulong",128,{write:function q(m,T,N){if("number"==typeof T||T instanceof Number){var le=Math.floor(T/b),Ce=T%b;m.writeUInt32BE(le,N),m.writeUInt32BE(Ce,N+4)}else T.copy(m,N)},read:function te(m,T){var N=m.readUInt32BE(T),le=m.readUInt32BE(T+4);return N<2097153?N*b+le:m.slice(T,T+8)}}),V("SmallUlong",83,{read:function(m,T){return m.readUInt8(T)},write:function(m,T,N){m.writeUInt8(T,N)}}),V("Ulong0",68,void 0,0),V("Byte",81,{read:function(m,T){return m.readInt8(T)},write:function(m,T,N){m.writeInt8(T,N)}}),V("Short",97,{read:function(m,T){return m.readInt16BE(T)},write:function(m,T,N){m.writeInt16BE(T,N)}}),V("Int",113,{read:function(m,T){return m.readInt32BE(T)},write:function(m,T,N){m.writeInt32BE(T,N)}}),V("SmallInt",84,{read:function(m,T){return m.readInt8(T)},write:function(m,T,N){m.writeInt8(T,N)}}),V("Long",129,{write:se,read:ce}),V("SmallLong",85,{read:function(m,T){return m.readInt8(T)},write:function(m,T,N){m.writeInt8(T,N)}}),V("Float",114,{read:function(m,T){return m.readFloatBE(T)},write:function(m,T,N){m.writeFloatBE(T,N)}}),V("Double",130,{read:function(m,T){return m.readDoubleBE(T)},write:function(m,T,N){m.writeDoubleBE(T,N)}}),V("Decimal32",116),V("Decimal64",132),V("Decimal128",148),V("CharUTF32",115,{read:function(m,T){return m.readUInt32BE(T)},write:function(m,T,N){m.writeUInt32BE(T,N)}}),V("Timestamp",131,{write:function ie(m,T,N){return"object"==typeof T&&null!==T&&"function"==typeof T.getTime&&(T=T.getTime()),se(m,T,N)},read:function me(m,T){const N=ce(m,T);return new Date(N)}}),V("Uuid",152),V("Vbin8",160),V("Vbin32",176),V("Str8",161,{encoding:"utf8"}),V("Str32",177,{encoding:"utf8"}),V("Sym8",163,{encoding:"ascii"}),V("Sym32",179,{encoding:"ascii"}),V("List0",69,void 0,[]),V("List8",192),V("List32",208),V("Map8",193),V("Map32",209),V("Array8",224),V("Array32",240),D.is_ulong=function(m){return De(m,[D.Ulong,D.Ulong0,D.SmallUlong])},D.is_string=function(m){return De(m,[D.Str8,D.Str32])},D.is_symbol=function(m){return De(m,[D.Sym8,D.Sym32])},D.is_list=function(m){return De(m,[D.List0,D.List8,D.List32])},D.is_map=function(m){return De(m,[D.Map8,D.Map32])},D.wrap_boolean=function(m){return m?D.True():D.False()},D.wrap_ulong=function(m){return Buffer.isBuffer(m)?Ee(m,8,!1)?D.Ulong0():Ee(m,7,!1)?D.SmallUlong(m[7]):D.Ulong(m):0===m?D.Ulong0():m>255?D.Ulong(m):D.SmallUlong(m)},D.wrap_uint=function(m){return 0===m?D.Uint0():m>255?D.Uint(m):D.SmallUint(m)},D.wrap_ushort=function(m){return D.Ushort(m)},D.wrap_ubyte=function(m){return D.Ubyte(m)},D.wrap_long=function(m){if(Buffer.isBuffer(m)){var T=0!=(128&m[0]);return Ee(m,7,T)&&(128&m[7])==(T?128:0)?D.SmallLong(T?-(1+(255^m[7])):m[7]):D.Long(m)}return m>127||m<-128?D.Long(m):D.SmallLong(m)},D.wrap_int=function(m){return m>127||m<-128?D.Int(m):D.SmallInt(m)},D.wrap_short=function(m){return D.Short(m)},D.wrap_byte=function(m){return D.Byte(m)},D.wrap_float=function(m){return D.Float(m)},D.wrap_double=function(m){return D.Double(m)},D.wrap_timestamp=function(m){return D.Timestamp(m)},D.wrap_char=function(m){return D.CharUTF32(m)},D.wrap_uuid=function(m){return D.Uuid(m)},D.wrap_binary=function(m){return m.length>255?D.Vbin32(m):D.Vbin8(m)},D.wrap_string=function(m){return Buffer.byteLength(m)>255?D.Str32(m):D.Str8(m)},D.wrap_symbol=function(m){return Buffer.byteLength(m)>255?D.Sym32(m):D.Sym8(m)},D.wrap_list=function(m){if(0===m.length)return D.List0();var T=m.map(D.wrap);return D.List32(T)},D.wrap_set_as_list=function(m){if(0===m.size)return D.List0();var T=Array.from(m,D.wrap);return D.List32(T)},D.wrap_map=function(m,T){var N=[];for(var le in m)N.push(T?T(le):D.wrap(le)),N.push(D.wrap(m[le]));return D.Map32(N)},D.wrap_map_as_map=function(m){var T=[];for(var[N,le]of m)T.push(D.wrap(N)),T.push(D.wrap(le));return D.Map32(T)},D.wrap_symbolic_map=function(m){return D.wrap_map(m,D.wrap_symbol)},D.wrap_array=function(m,T,N){if(T)return D.Array32(m,T,N);throw console.trace("An array must specify a type for its elements"),new E.TypeError("An array must specify a type for its elements")},D.wrap=function(m){var T=typeof m;return"object"===T&&null!==m&&"function"==typeof m.toRheaTyped?m.toRheaTyped():"string"===T?D.wrap_string(m):"boolean"===T?m?D.True():D.False():"number"===T||m instanceof Number?isNaN(m)?D.Null():Math.floor(m)-m!=0?D.Double(m):m>0?m<b?D.wrap_uint(m):D.wrap_ulong(m):m>-2147483647?D.wrap_int(m):D.wrap_long(m):m instanceof Date?D.wrap_timestamp(m.getTime()):m instanceof Buffer||m instanceof Uint8Array?D.wrap_binary(m):"undefined"===T||null===m?D.Null():Array.isArray(m)?D.wrap_list(m):m instanceof Map?D.wrap_map_as_map(m):m instanceof Set?D.wrap_set_as_list(m):D.wrap_map(m)},D.wrap_described=function(m,T){var N=D.wrap(m);return T&&("string"==typeof T?N=D.described(D.wrap_symbol(T),N):("number"==typeof T||T instanceof Number)&&(N=D.described(D.wrap_ulong(T),N))),N},D.wrap_message_id=function(m){var T=typeof m;if("string"===T)return D.wrap_string(m);if("number"===T||m instanceof Number)return D.wrap_ulong(m);if(Buffer.isBuffer(m))return D.wrap_uuid(m);if(m instanceof B)return m;throw new E.TypeError("invalid message id:"+m)};var Be={};function ze(m){var T=D.by_code[m];if(!T)throw new E.TypeError("Unrecognised typecode: "+M(m));return T}function ee(m,T){return{get:"*"===T.type?function(){return this.value[m]}:function(){return D.unwrap(this.value[m])},set:function(Ce){this.value[m]=function oe(m,T){if(null!=T){if(Array.isArray(T)){if(!m.multiple)throw new E.TypeError("Field "+m.name+" does not support multiple values, got "+JSON.stringify(T));var N=function G(m){if("symbol"===m)return{typecode:D.Sym8.typecode};throw new E.TypeError("TODO: Array of type "+m+" not yet supported")}(m.type);return D.wrap_array(T,N.typecode,N.descriptor)}if("*"===m.type)return T;var le=D["wrap_"+m.type];if(le)return le(T);throw new E.TypeError("No wrapper for field "+m.name+" of type "+m.type)}if(m.mandatory)throw new E.TypeError("Field "+m.name+" is mandatory");return D.Null()}(T,Ce)},enumerable:!0,configurable:!1}}D.unwrap_map_simple=function(m){return He(m.value.map(function(T){return D.unwrap(T,!0)}))},D.unwrap=function(m,T){if(m instanceof B){if(m.descriptor){var N=Be[m.descriptor.value];if(N)return new N(m.value);if(T)return m}var le=D.unwrap(m.value,!0);return D.is_map(m)?He(le):le}return Array.isArray(m)?m.map(function(Ce){return D.unwrap(Ce,!0)}):m},D.described_nc=function(m,T){return m.length?(T.descriptor=m.shift(),D.described(m,T)):(T.descriptor=m,T)},D.described=D.described_nc,D.Reader=function(m){this.buffer=m,this.position=0},D.Reader.prototype.read_typecode=function(){return this.read_uint(1)},D.Reader.prototype.read_uint=function(m){var T=this.position;if(this.position+=m,1===m)return this.buffer.readUInt8(T);if(2===m)return this.buffer.readUInt16BE(T);if(4===m)return this.buffer.readUInt32BE(T);throw new E.TypeError("Unexpected width for uint "+m)},D.Reader.prototype.read_fixed_width=function(m){var T=this.position;return this.position+=m.width,m.read?m.read(this.buffer,T):this.buffer.slice(T,this.position)},D.Reader.prototype.read_variable_width=function(m){var T=this.read_uint(m.width),N=this.read_bytes(T);return m.encoding?N.toString(m.encoding):N},D.Reader.prototype.read=function(){var m=this.read_constructor(),T=this.read_value(ze(m.typecode));return m.descriptor?D.described_nc(m.descriptor,T):T},D.Reader.prototype.read_constructor=function(m){var T=this.read_typecode();return 0===T?(void 0===m&&(m=[]),m.push(this.read()),this.read_constructor(m)):void 0===m?{typecode:T}:1===m.length?{typecode:T,descriptor:m[0]}:{typecode:T,descriptor:m[0],descriptors:m}},D.Reader.prototype.read_value=function(m){if(0===m.width)return m.create();if(m.category===O)return m.create(this.read_fixed_width(m));if(m.category===R)return m.create(this.read_variable_width(m));if(m.category===$)return this.read_compound(m);if(m.category===H)return this.read_array(m);throw new E.TypeError("Invalid category for type: "+m)},D.Reader.prototype.read_array_items=function(m,T){for(var N=[];N.length<m;)N.push(this.read_value(T));return N},D.Reader.prototype.read_n=function(m){for(var T=new Array(m),N=0;N<m;N++)T[N]=this.read();return T},D.Reader.prototype.read_size_count=function(m){return{size:this.read_uint(m),count:this.read_uint(m)}},D.Reader.prototype.read_compound=function(m){var T=this.read_size_count(m.width);return m.create(this.read_n(T.count))},D.Reader.prototype.read_array=function(m){var T=this.read_size_count(m.width),N=this.read_constructor();return m.create(this.read_array_items(T.count,ze(N.typecode)),N.typecode,N.descriptor)},D.Reader.prototype.toString=function(){var m="buffer@"+this.position;this.position&&(m+=": ");for(var T=this.position;T<this.buffer.length;T++)T>0&&(m+=","),m+="0x"+Number(this.buffer[T]).toString(16);return m},D.Reader.prototype.reset=function(){this.position=0},D.Reader.prototype.skip=function(m){this.position+=m},D.Reader.prototype.read_bytes=function(m){var T=this.position;return this.position+=m,this.buffer.slice(T,this.position)},D.Reader.prototype.remaining=function(){return this.buffer.length-this.position},D.Writer=function(m){this.buffer=m||p.allocate_buffer(1024),this.position=0},D.Writer.prototype.toBuffer=function(){return this.buffer.slice(0,this.position)},D.Writer.prototype.ensure=function(m){if(this.buffer.length<m){var T=p.allocate_buffer(function pe(m,T){return m>T?m:T}(2*this.buffer.length,m));this.buffer.copy(T),this.buffer=T}},D.Writer.prototype.write_typecode=function(m){this.write_uint(m,1)},D.Writer.prototype.write_uint=function(m,T){var N=this.position;if(this.ensure(this.position+T),this.position+=T,1===T)return this.buffer.writeUInt8(m,N);if(2===T)return this.buffer.writeUInt16BE(m,N);if(4===T)return this.buffer.writeUInt32BE(m,N);throw new E.TypeError("Unexpected width for uint "+T)},D.Writer.prototype.write_fixed_width=function(m,T){var N=this.position;if(this.ensure(this.position+m.width),this.position+=m.width,m.write)m.write(this.buffer,T,N);else{if(!T.copy)throw new E.TypeError("Cannot handle write for "+m);T.copy(this.buffer,N)}},D.Writer.prototype.write_variable_width=function(m,T){var N=m.encoding?Buffer.from(T,m.encoding):Buffer.from(T);this.write_uint(N.length,m.width),this.write_bytes(N)},D.Writer.prototype.write_bytes=function(m){var T=this.position;this.ensure(this.position+m.length),this.position+=m.length,m.copy(this.buffer,T)},D.Writer.prototype.write_constructor=function(m,T){T&&(this.write_typecode(0),this.write(T)),this.write_typecode(m)},D.Writer.prototype.write=function(m){if(void 0===m.type){if(!m.described)throw new E.TypeError("Cannot write "+JSON.stringify(m));this.write(m.described())}else this.write_constructor(m.type.typecode,m.descriptor),this.write_value(m.type,m.value,m.array_constructor)},D.Writer.prototype.write_value=function(m,T,N){if(0!==m.width)if(m.category===O)this.write_fixed_width(m,T);else if(m.category===R)this.write_variable_width(m,T);else if(m.category===$)this.write_compound(m,T);else{if(m.category!==H)throw new E.TypeError("Invalid category "+m.category+" for type: "+m);this.write_array(m,T,N)}},D.Writer.prototype.backfill_size=function(m,T){var N=this.position-T;this.position=T,this.write_uint(N-m,m),this.position+=N-m},D.Writer.prototype.write_compound=function(m,T){var N=this.position;this.position+=m.width,this.write_uint(T.length,m.width);for(var le=0;le<T.length;le++)this.write(null==T[le]?D.Null():T[le]);this.backfill_size(m.width,N)},D.Writer.prototype.write_array=function(m,T,N){var le=this.position;this.position+=m.width,this.write_uint(T.length,m.width),this.write_constructor(N.typecode,N.descriptor);for(var Ce=ze(N.typecode),Me=0;Me<T.length;Me++)this.write_value(Ce,T[Me]);this.backfill_size(m.width,le)},D.Writer.prototype.toString=function(){var m="buffer@"+this.position;this.position&&(m+=": ");for(var T=0;T<this.position;T++)T>0&&(m+=","),m+=("00"+Number(this.buffer[T]).toString(16)).slice(-2);return m},D.Writer.prototype.skip=function(m){this.ensure(this.position+m),this.position+=m},D.Writer.prototype.clear=function(){this.buffer.fill(0),this.position=0},D.Writer.prototype.remaining=function(){return this.buffer.length-this.position},D.define_composite=function(m){var T=function(Ce){this.value=Ce||[]};T.descriptor={numeric:m.code,symbolic:"amqp:"+m.name+":list"},T.prototype.dispatch=function(Ce,Me){Ce["on_"+m.name](Me)};for(var N=0;N<m.fields.length;N++){var le=m.fields[N];Object.defineProperty(T.prototype,le.name,ee(N,le))}return T.toString=function(){return m.name+"#"+Number(m.code).toString(16)},T.prototype.toJSON=function(){var Ce={};for(var Me in this)"value"!==Me&&this[Me]&&(Ce[Me]=this[Me]);return Ce},T.create=function(Ce){var Me=new T;for(var Ke in Ce)Me[Ke]=Ce[Ke];return Me},T.prototype.described=function(){return D.described_nc(D.wrap_ulong(T.descriptor.numeric),D.wrap_list(this.value))},T},function ue(m){var T=D.define_composite(m);D["wrap_"+m.name]=function(N){return T.create(N).described()},Be[Number(T.descriptor.numeric).toString(10)]=T,Be[T.descriptor.symbolic]=T}({name:"error",code:29,fields:[{name:"condition",type:"symbol",mandatory:!0},{name:"description",type:"string"},{name:"info",type:"map"}]}),fe.exports=D},6362:(fe,F,S)=>{"use strict";var E=S(2709),p={allocate_buffer:function(R){return Buffer.alloc?Buffer.alloc(R):new Buffer(R)},generate_uuid:function(){return p.uuid_to_string(p.uuid4())},uuid4:function(){for(var R=p.allocate_buffer(16),$=0;$<R.length;$++)R[$]=255*Math.random()|0;return R[7]&=15,R[7]|=64,R[8]&=63,R[8]|=128,R},uuid_to_string:function(R){if(16===R.length)return[R.slice(0,4),R.slice(4,6),R.slice(6,8),R.slice(8,10),R.slice(10,16)].map(function(H){return H.toString("hex")}).join("-");throw new E.TypeError("Not a UUID, expecting 16 byte buffer")}},O=/^([0-9a-f]{8})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{12})$/;p.string_to_uuid=function(R){var $=O.exec(R.toLowerCase());if($)return Buffer.from($.slice(1).join(""),"hex");throw new E.TypeError("Not a valid UUID string: "+R)},p.clone=function(R){for(var $=Object.create(R.prototype||{}),H=Object.getOwnPropertyNames(R),B=0;B<H.length;B++){var g=H[B];$[g]=R[g]}return $},p.and=function(R,$){return void 0===$?R:function(H){return R(H)&&$(H)}},p.is_sender=function(R){return R.is_sender()},p.is_receiver=function(R){return R.is_receiver()},p.sender_filter=function(R){return p.and(p.is_sender,R)},p.receiver_filter=function(R){return p.and(p.is_receiver,R)},p.is_defined=function(R){return null!=R},fe.exports=p},977:fe=>{"use strict";function F(O){return O}function S(O){return O instanceof ArrayBuffer?Buffer.from(new Uint8Array(O)):Buffer.from(O)}function E(O){return new Uint8Array(O)}function p(O){var R=F,$=F;return O.binaryType&&(O.binaryType="arraybuffer",R=S,$=E),{end:function(){O.close()},write:function(H){try{O.send($(H),{binary:!0})}catch(B){O.onerror(B)}},on:function(H,B){"data"===H?O.onmessage=function(g){B(R(g.data))}:"end"===H?O.onclose=B:"error"===H?O.onerror=B:console.error("ERROR: Attempt to set unrecognised handler on websocket wrapper: "+H)},get_id_string:function(){return O.url}}}fe.exports={connect:function(O){return function(R,$,H){return function(){return{connect:function(B,g,M,D){var V=new O(R,$,H);return V.onopen=D,p(V)}}}}},wrap:p}},2245:(fe,F,S)=>{"use strict";var E=S(491),p=S(9224),O=S(2486)(),R=S(9262),$=E("%TypeError%"),H=E("%Math.floor%");fe.exports=function(g,M){if("function"!=typeof g)throw new $("`fn` is not a function");if("number"!=typeof M||M<0||M>4294967295||H(M)!==M)throw new $("`length` must be a positive 32-bit integer");var D=arguments.length>2&&!!arguments[2],V=!0,J=!0;if("length"in g&&R){var z=R(g,"length");z&&!z.configurable&&(V=!1),z&&!z.writable&&(J=!1)}return(V||J||!D)&&(O?p(g,"length",M,!0,!0):p(g,"length",M)),g}},4750:fe=>{fe.exports=function(S){return S&&"object"==typeof S&&"function"==typeof S.copy&&"function"==typeof S.fill&&"function"==typeof S.readUInt8}},6758:(fe,F,S)=>{"use strict";var E=S(8147),p=S(3286),O=S(6326),R=S(2462);function $(Re){return Re.call.bind(Re)}var H=typeof BigInt<"u",B=typeof Symbol<"u",g=$(Object.prototype.toString),M=$(Number.prototype.valueOf),D=$(String.prototype.valueOf),V=$(Boolean.prototype.valueOf);if(H)var J=$(BigInt.prototype.valueOf);if(B)var z=$(Symbol.prototype.valueOf);function C(Re,qr){if("object"!=typeof Re)return!1;try{return qr(Re),!0}catch{return!1}}function De(Re){return"[object Map]"===g(Re)}function He(Re){return"[object Set]"===g(Re)}function ze(Re){return"[object WeakMap]"===g(Re)}function G(Re){return"[object WeakSet]"===g(Re)}function ee(Re){return"[object ArrayBuffer]"===g(Re)}function ue(Re){return!(typeof ArrayBuffer>"u")&&(ee.working?ee(Re):Re instanceof ArrayBuffer)}function m(Re){return"[object DataView]"===g(Re)}function T(Re){return!(typeof DataView>"u")&&(m.working?m(Re):Re instanceof DataView)}F.isArgumentsObject=E,F.isGeneratorFunction=p,F.isTypedArray=R,F.isPromise=function k(Re){return typeof Promise<"u"&&Re instanceof Promise||null!==Re&&"object"==typeof Re&&"function"==typeof Re.then&&"function"==typeof Re.catch},F.isArrayBufferView=function K(Re){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(Re):R(Re)||T(Re)},F.isUint8Array=function w(Re){return"Uint8Array"===O(Re)},F.isUint8ClampedArray=function j(Re){return"Uint8ClampedArray"===O(Re)},F.isUint16Array=function _(Re){return"Uint16Array"===O(Re)},F.isUint32Array=function b(Re){return"Uint32Array"===O(Re)},F.isInt8Array=function U(Re){return"Int8Array"===O(Re)},F.isInt16Array=function q(Re){return"Int16Array"===O(Re)},F.isInt32Array=function te(Re){return"Int32Array"===O(Re)},F.isFloat32Array=function se(Re){return"Float32Array"===O(Re)},F.isFloat64Array=function ie(Re){return"Float64Array"===O(Re)},F.isBigInt64Array=function ce(Re){return"BigInt64Array"===O(Re)},F.isBigUint64Array=function me(Re){return"BigUint64Array"===O(Re)},De.working=typeof Map<"u"&&De(new Map),F.isMap=function Ee(Re){return!(typeof Map>"u")&&(De.working?De(Re):Re instanceof Map)},He.working=typeof Set<"u"&&He(new Set),F.isSet=function Be(Re){return!(typeof Set>"u")&&(He.working?He(Re):Re instanceof Set)},ze.working=typeof WeakMap<"u"&&ze(new WeakMap),F.isWeakMap=function pe(Re){return!(typeof WeakMap>"u")&&(ze.working?ze(Re):Re instanceof WeakMap)},G.working=typeof WeakSet<"u"&&G(new WeakSet),F.isWeakSet=function oe(Re){return G(Re)},ee.working=typeof ArrayBuffer<"u"&&ee(new ArrayBuffer),F.isArrayBuffer=ue,m.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&m(new DataView(new ArrayBuffer(1),0,1)),F.isDataView=T;var N=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function le(Re){return"[object SharedArrayBuffer]"===g(Re)}function Ce(Re){return!(typeof N>"u")&&(typeof le.working>"u"&&(le.working=le(new N)),le.working?le(Re):Re instanceof N)}function Ge(Re){return C(Re,M)}function tn(Re){return C(Re,D)}function qt(Re){return C(Re,V)}function ut(Re){return H&&C(Re,J)}function tt(Re){return B&&C(Re,z)}F.isSharedArrayBuffer=Ce,F.isAsyncFunction=function Me(Re){return"[object AsyncFunction]"===g(Re)},F.isMapIterator=function Ke(Re){return"[object Map Iterator]"===g(Re)},F.isSetIterator=function be(Re){return"[object Set Iterator]"===g(Re)},F.isGeneratorObject=function xe(Re){return"[object Generator]"===g(Re)},F.isWebAssemblyCompiledModule=function ft(Re){return"[object WebAssembly.Module]"===g(Re)},F.isNumberObject=Ge,F.isStringObject=tn,F.isBooleanObject=qt,F.isBigIntObject=ut,F.isSymbolObject=tt,F.isBoxedPrimitive=function ur(Re){return Ge(Re)||tn(Re)||qt(Re)||ut(Re)||tt(Re)},F.isAnyArrayBuffer=function qn(Re){return typeof Uint8Array<"u"&&(ue(Re)||Ce(Re))},["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(Re){Object.defineProperty(F,Re,{enumerable:!1,value:function(){throw new Error(Re+" is not supported in userland")}})})},179:(fe,F,S)=>{var E=Object.getOwnPropertyDescriptors||function(T){for(var N=Object.keys(T),le={},Ce=0;Ce<N.length;Ce++)le[N[Ce]]=Object.getOwnPropertyDescriptor(T,N[Ce]);return le},p=/%[sdj%]/g;F.format=function(m){if(!U(m)){for(var T=[],N=0;N<arguments.length;N++)T.push(H(arguments[N]));return T.join(" ")}N=1;for(var le=arguments,Ce=le.length,Me=String(m).replace(p,function(be){if("%%"===be)return"%";if(N>=Ce)return be;switch(be){case"%s":return String(le[N++]);case"%d":return Number(le[N++]);case"%j":try{return JSON.stringify(le[N++])}catch{return"[Circular]"}default:return be}}),Ke=le[N];N<Ce;Ke=le[++N])j(Ke)||!ie(Ke)?Me+=" "+Ke:Me+=" "+H(Ke);return Me},F.deprecate=function(m,T){if(typeof process<"u"&&!0===process.noDeprecation)return m;if(typeof process>"u")return function(){return F.deprecate(m,T).apply(this,arguments)};var N=!1;return function le(){if(!N){if(process.throwDeprecation)throw new Error(T);process.traceDeprecation?console.trace(T):console.error(T),N=!0}return m.apply(this,arguments)}};var O={},R=/^$/;if(process.env.NODE_DEBUG){var $=process.env.NODE_DEBUG;$=$.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),R=new RegExp("^"+$+"$","i")}function H(m,T){var N={seen:[],stylize:g};return arguments.length>=3&&(N.depth=arguments[2]),arguments.length>=4&&(N.colors=arguments[3]),w(T)?N.showHidden=T:T&&F._extend(N,T),te(N.showHidden)&&(N.showHidden=!1),te(N.depth)&&(N.depth=2),te(N.colors)&&(N.colors=!1),te(N.customInspect)&&(N.customInspect=!0),N.colors&&(N.stylize=B),D(N,m,N.depth)}function B(m,T){var N=H.styles[T];return N?"\x1b["+H.colors[N][0]+"m"+m+"\x1b["+H.colors[N][1]+"m":m}function g(m,T){return m}function D(m,T,N){if(m.customInspect&&T&&De(T.inspect)&&T.inspect!==F.inspect&&(!T.constructor||T.constructor.prototype!==T)){var le=T.inspect(N,m);return U(le)||(le=D(m,le,N)),le}var Ce=function V(m,T){if(te(T))return m.stylize("undefined","undefined");if(U(T)){var N="'"+JSON.stringify(T).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return m.stylize(N,"string")}return b(T)?m.stylize(""+T,"number"):w(T)?m.stylize(""+T,"boolean"):j(T)?m.stylize("null","null"):void 0}(m,T);if(Ce)return Ce;var Me=Object.keys(T),Ke=function M(m){var T={};return m.forEach(function(N,le){T[N]=!0}),T}(Me);if(m.showHidden&&(Me=Object.getOwnPropertyNames(T)),me(T)&&(Me.indexOf("message")>=0||Me.indexOf("description")>=0))return J(T);if(0===Me.length){if(De(T))return m.stylize("[Function"+(T.name?": "+T.name:"")+"]","special");if(se(T))return m.stylize(RegExp.prototype.toString.call(T),"regexp");if(ce(T))return m.stylize(Date.prototype.toString.call(T),"date");if(me(T))return J(T)}var qt,xe="",ft=!1,Ge=["{","}"];return K(T)&&(ft=!0,Ge=["[","]"]),De(T)&&(xe=" [Function"+(T.name?": "+T.name:"")+"]"),se(T)&&(xe=" "+RegExp.prototype.toString.call(T)),ce(T)&&(xe=" "+Date.prototype.toUTCString.call(T)),me(T)&&(xe=" "+J(T)),0!==Me.length||ft&&0!=T.length?N<0?se(T)?m.stylize(RegExp.prototype.toString.call(T),"regexp"):m.stylize("[Object]","special"):(m.seen.push(T),qt=ft?function z(m,T,N,le,Ce){for(var Me=[],Ke=0,be=T.length;Ke<be;++Ke)G(T,String(Ke))?Me.push(C(m,T,N,le,String(Ke),!0)):Me.push("");return Ce.forEach(function(xe){xe.match(/^\d+$/)||Me.push(C(m,T,N,le,xe,!0))}),Me}(m,T,N,Ke,Me):Me.map(function(ut){return C(m,T,N,Ke,ut,ft)}),m.seen.pop(),function k(m,T,N){var Ce=m.reduce(function(Me,Ke){return Ke.indexOf("\n"),Me+Ke.replace(/\u001b\[\d\d?m/g,"").length+1},0);return Ce>60?N[0]+(""===T?"":T+"\n ")+" "+m.join(",\n  ")+" "+N[1]:N[0]+T+" "+m.join(", ")+" "+N[1]}(qt,xe,Ge)):Ge[0]+xe+Ge[1]}function J(m){return"["+Error.prototype.toString.call(m)+"]"}function C(m,T,N,le,Ce,Me){var Ke,be,xe;if((xe=Object.getOwnPropertyDescriptor(T,Ce)||{value:T[Ce]}).get?be=m.stylize(xe.set?"[Getter/Setter]":"[Getter]","special"):xe.set&&(be=m.stylize("[Setter]","special")),G(le,Ce)||(Ke="["+Ce+"]"),be||(m.seen.indexOf(xe.value)<0?(be=j(N)?D(m,xe.value,null):D(m,xe.value,N-1)).indexOf("\n")>-1&&(be=Me?be.split("\n").map(function(ft){return"  "+ft}).join("\n").slice(2):"\n"+be.split("\n").map(function(ft){return"   "+ft}).join("\n")):be=m.stylize("[Circular]","special")),te(Ke)){if(Me&&Ce.match(/^\d+$/))return be;(Ke=JSON.stringify(""+Ce)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(Ke=Ke.slice(1,-1),Ke=m.stylize(Ke,"name")):(Ke=Ke.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),Ke=m.stylize(Ke,"string"))}return Ke+": "+be}function K(m){return Array.isArray(m)}function w(m){return"boolean"==typeof m}function j(m){return null===m}function b(m){return"number"==typeof m}function U(m){return"string"==typeof m}function te(m){return void 0===m}function se(m){return ie(m)&&"[object RegExp]"===He(m)}function ie(m){return"object"==typeof m&&null!==m}function ce(m){return ie(m)&&"[object Date]"===He(m)}function me(m){return ie(m)&&("[object Error]"===He(m)||m instanceof Error)}function De(m){return"function"==typeof m}function He(m){return Object.prototype.toString.call(m)}function Be(m){return m<10?"0"+m.toString(10):m.toString(10)}F.debuglog=function(m){if(m=m.toUpperCase(),!O[m])if(R.test(m)){var T=process.pid;O[m]=function(){var N=F.format.apply(F,arguments);console.error("%s %d: %s",m,T,N)}}else O[m]=function(){};return O[m]},F.inspect=H,H.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},H.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},F.types=S(6758),F.isArray=K,F.isBoolean=w,F.isNull=j,F.isNullOrUndefined=function _(m){return null==m},F.isNumber=b,F.isString=U,F.isSymbol=function q(m){return"symbol"==typeof m},F.isUndefined=te,F.isRegExp=se,F.types.isRegExp=se,F.isObject=ie,F.isDate=ce,F.types.isDate=ce,F.isError=me,F.types.isNativeError=me,F.isFunction=De,F.isPrimitive=function Ee(m){return null===m||"boolean"==typeof m||"number"==typeof m||"string"==typeof m||"symbol"==typeof m||typeof m>"u"},F.isBuffer=S(4750);var ze=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function G(m,T){return Object.prototype.hasOwnProperty.call(m,T)}F.log=function(){console.log("%s - %s",function pe(){var m=new Date,T=[Be(m.getHours()),Be(m.getMinutes()),Be(m.getSeconds())].join(":");return[m.getDate(),ze[m.getMonth()],T].join(" ")}(),F.format.apply(F,arguments))},F.inherits=S(6698),F._extend=function(m,T){if(!T||!ie(T))return m;for(var N=Object.keys(T),le=N.length;le--;)m[N[le]]=T[N[le]];return m};var oe=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;function ee(m,T){if(!m){var N=new Error("Promise was rejected with a falsy value");N.reason=m,m=N}return T(m)}F.promisify=function(T){if("function"!=typeof T)throw new TypeError('The "original" argument must be of type Function');if(oe&&T[oe]){var N;if("function"!=typeof(N=T[oe]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(N,oe,{value:N,enumerable:!1,writable:!1,configurable:!0}),N}function N(){for(var le,Ce,Me=new Promise(function(xe,ft){le=xe,Ce=ft}),Ke=[],be=0;be<arguments.length;be++)Ke.push(arguments[be]);Ke.push(function(xe,ft){xe?Ce(xe):le(ft)});try{T.apply(this,Ke)}catch(xe){Ce(xe)}return Me}return Object.setPrototypeOf(N,Object.getPrototypeOf(T)),oe&&Object.defineProperty(N,oe,{value:N,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(N,E(T))},F.promisify.custom=oe,F.callbackify=function ue(m){if("function"!=typeof m)throw new TypeError('The "original" argument must be of type Function');function T(){for(var N=[],le=0;le<arguments.length;le++)N.push(arguments[le]);var Ce=N.pop();if("function"!=typeof Ce)throw new TypeError("The last argument must be of type Function");var Me=this,Ke=function(){return Ce.apply(Me,arguments)};m.apply(this,N).then(function(be){process.nextTick(Ke.bind(null,null,be))},function(be){process.nextTick(ee.bind(null,be,Ke))})}return Object.setPrototypeOf(T,Object.getPrototypeOf(m)),Object.defineProperties(T,E(m)),T}},6326:(fe,F,S)=>{"use strict";var E=S(3307),p=S(9067),O=S(5436),R=S(1098),$=S(9262),H=R("Object.prototype.toString"),B=S(8041)(),g=typeof globalThis>"u"?global:globalThis,M=p(),D=R("String.prototype.slice"),V=Object.getPrototypeOf,J=R("Array.prototype.indexOf",!0)||function(w,j){for(var _=0;_<w.length;_+=1)if(w[_]===j)return _;return-1},z={__proto__:null};E(M,B&&$&&V?function(K){var w=new g[K];if(Symbol.toStringTag in w){var j=V(w),_=$(j,Symbol.toStringTag);if(!_){var b=V(j);_=$(b,Symbol.toStringTag)}z["$"+K]=O(_.get)}}:function(K){var w=new g[K],j=w.slice||w.set;j&&(z["$"+K]=O(j))}),fe.exports=function(w){if(!w||"object"!=typeof w)return!1;if(!B){var j=D(H(w),8,-1);return J(M,j)>-1?j:"Object"===j&&function(w){var j=!1;return E(z,function(_,b){if(!j)try{_(w),j=D(b,1)}catch{}}),j}(w)}return $?function(w){var j=!1;return E(z,function(_,b){if(!j)try{"$"+_(w)===b&&(j=D(b,1))}catch{}}),j}(w):null}},5868:()=>{},90:()=>{},5041:()=>{},9067:fe=>{"use strict";var F=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],S=typeof globalThis>"u"?global:globalThis;fe.exports=function(){for(var p=[],O=0;O<F.length;O++)"function"==typeof S[F[O]]&&(p[p.length]=F[O]);return p}},6475:(fe,F,S)=>{"use strict";S.d(F,{k:()=>E});class E{constructor(){this.cache=new Map}getItem(O){return this.cache.get(O)||null}setItem(O,R){this.cache.set(O,R)}removeItem(O){this.cache.delete(O)}getKeys(){const O=[];return this.cache.forEach((R,$)=>{O.push($)}),O}containsKey(O){return this.cache.has(O)}clear(){this.cache.clear()}}},7803:(fe,F,S)=>{"use strict";S.d(F,{Is:()=>U,_7:()=>se});var E=S(5500),p=S(6132),O=S(2286),R=S(4630),$=S(6703),H=S(5140),B=S(5841);const g={sendGetRequestAsync:()=>Promise.reject((0,H.zP)(B.M2)),sendPostRequestAsync:()=>Promise.reject((0,H.zP)(B.M2))};var M=S(7979);class D{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class V{generateId(){return"callback-id"}startMeasurement(ce,me){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:M.$L.InProgress,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:ce,startTimeMs:Date.now(),correlationId:me||""},measurement:new D}}startPerformanceMeasurement(){return new D}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}var J=S(4680),z=S(7299),C=S(8593);class k{navigateInternal(ce,me){return k.defaultNavigateWindow(ce,me)}navigateExternal(ce,me){return k.defaultNavigateWindow(ce,me)}static defaultNavigateWindow(ce,me){return me.noHistory?window.location.replace(ce):window.location.assign(ce),new Promise(De=>{setTimeout(()=>{De(!0)},me.timeout)})}}var K=S(5861),w=S(8293),j=S(7377);class _{sendGetRequestAsync(ce,me){var De=this;return(0,K.Z)(function*(){let Ee;try{Ee=yield fetch(ce,{method:C.EC.GET,headers:De.getFetchHeaders(me)})}catch{throw window.navigator.onLine?(0,w.Z_)(j.C8):(0,w.Z_)(j.Mq)}try{return{headers:De.getHeaderDict(Ee.headers),body:yield Ee.json(),status:Ee.status}}catch{throw(0,w.Z_)(j.w6)}})()}sendPostRequestAsync(ce,me){var De=this;return(0,K.Z)(function*(){const Ee=me&&me.body||E.gT.EMPTY_STRING;let He;try{He=yield fetch(ce,{method:C.EC.POST,headers:De.getFetchHeaders(me),body:Ee})}catch{throw window.navigator.onLine?(0,w.Z_)(j.Dc):(0,w.Z_)(j.Mq)}try{return{headers:De.getHeaderDict(He.headers),body:yield He.json(),status:He.status}}catch{throw(0,w.Z_)(j.w6)}})()}getFetchHeaders(ce){const me=new Headers;if(!ce||!ce.headers)return me;const De=ce.headers;return Object.keys(De).forEach(Ee=>{me.append(Ee,De[Ee])}),me}getHeaderDict(ce){const me={};return ce.forEach((De,Ee)=>{me[Ee]=De}),me}}const b=6e4,U=6e3,q=3e4,te=2e3;function se({auth:ie,cache:ce,system:me,telemetry:De},Ee){const He={clientId:E.gT.EMPTY_STRING,authority:`${E.gT.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:E.gT.EMPTY_STRING,authorityMetadata:E.gT.EMPTY_STRING,redirectUri:E.gT.EMPTY_STRING,postLogoutRedirectUri:E.gT.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:p.A.AAD,OIDCOptions:{serverResponseType:E.rg.FRAGMENT,defaultScopes:[E.gT.OPENID_SCOPE,E.gT.PROFILE_SCOPE,E.gT.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:O.z.None,tenant:E.gT.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1},Be={cacheLocation:C.Ix.SessionStorage,temporaryCacheLocation:C.Ix.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!(!ce||ce.cacheLocation!==C.Ix.LocalStorage),claimsBasedCachingEnabled:!1},ze={loggerCallback:()=>{},logLevel:R.i.Info,piiLoggingEnabled:!1},G={...{...$.z,loggerOptions:ze,networkClient:Ee?new _:g,navigationClient:new k,loadFrameTimeout:0,windowHashTimeout:me?.loadFrameTimeout||b,iframeHashTimeout:me?.loadFrameTimeout||U,navigateFrameWait:0,redirectNavigationTimeout:q,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:me?.nativeBrokerHandshakeTimeout||te,pollIntervalMilliseconds:C.qx.DEFAULT_POLL_INTERVAL_MS},...me,loggerOptions:me?.loggerOptions||ze},oe={application:{appName:E.gT.EMPTY_STRING,appVersion:E.gT.EMPTY_STRING},client:new V};if(ie?.protocolMode!==p.A.OIDC&&ie?.OIDCOptions&&new R.Y(G.loggerOptions).warning(JSON.stringify((0,J.ei)(z.qz))),ie?.protocolMode&&ie.protocolMode!==p.A.AAD&&G?.allowNativeBroker)throw(0,J.ei)(z.Ol);return{auth:{...He,...ie,OIDCOptions:{...He.OIDCOptions,...ie?.OIDCOptions}},cache:{...Be,...ce},system:G,telemetry:{...oe,...De}}}},877:(fe,F,S)=>{"use strict";S.r(F),S.d(F,{StandardController:()=>Va});var E=S(5861),p=S(2341),O=S(8214),R=S(63),H=S(7581),B=S(5140),g=S(5500),M=S(1322),D=S(4680),V=S(6132),J=S(4441);class z{constructor(){this.expiresAt=J.I.nowSeconds()+g.QU.REFRESH_TIME_SECONDS}updateCloudDiscoveryMetadata(c,u){this.aliases=c.aliases,this.preferred_cache=c.preferred_cache,this.preferred_network=c.preferred_network,this.aliasesFromNetwork=u}updateEndpointMetadata(c,u){this.authorization_endpoint=c.authorization_endpoint,this.token_endpoint=c.token_endpoint,this.end_session_endpoint=c.end_session_endpoint,this.issuer=c.issuer,this.endpointsFromNetwork=u,this.jwks_uri=c.jwks_uri}updateCanonicalAuthority(c){this.canonical_authority=c}resetExpiresAt(){this.expiresAt=J.I.nowSeconds()+g.QU.REFRESH_TIME_SECONDS}isExpired(){return this.expiresAt<=J.I.nowSeconds()}static isAuthorityMetadataEntity(c,u){return!!u&&0===c.indexOf(g.QU.CACHE_KEY)&&u.hasOwnProperty("aliases")&&u.hasOwnProperty("preferred_cache")&&u.hasOwnProperty("preferred_network")&&u.hasOwnProperty("canonical_authority")&&u.hasOwnProperty("authorization_endpoint")&&u.hasOwnProperty("token_endpoint")&&u.hasOwnProperty("issuer")&&u.hasOwnProperty("aliasesFromNetwork")&&u.hasOwnProperty("endpointsFromNetwork")&&u.hasOwnProperty("expiresAt")&&u.hasOwnProperty("jwks_uri")}}var C=S(2286),w=S(7979);const j=(ke,c,u,d,y)=>(...L)=>{u.trace(`Executing function ${c}`);const Q=d?.startMeasurement(c,y);try{const re=ke(...L);return Q?.end({success:!0}),u.trace(`Returning result from ${c}`),re}catch(re){u.trace(`Error occurred in ${c}`);try{u.trace(JSON.stringify(re))}catch{u.trace("Unable to print error message.")}throw Q?.end({success:!1}),re}},_=(ke,c,u,d,y)=>(...L)=>{u.trace(`Executing function ${c}`);const Q=d?.startMeasurement(c,y);return d?.setPreQueueTime(c,y),ke(...L).then(re=>(u.trace(`Returning result from ${c}`),Q?.end({success:!0}),re)).catch(re=>{u.trace(`Error occurred in ${c}`);try{u.trace(JSON.stringify(re))}catch{u.trace("Unable to print error message.")}throw Q?.end({success:!1}),re})};let b=(()=>{class ke{constructor(u,d,y,L){this.networkInterface=u,this.logger=d,this.performanceClient=y,this.correlationId=L}detectRegion(u,d){var y=this;return(0,E.Z)(function*(){y.performanceClient?.addQueueMeasurement(w.Ak.RegionDiscoveryDetectRegion,y.correlationId);let L=u;if(L)d.region_source=g.W.ENVIRONMENT_VARIABLE;else{const Q=ke.IMDS_OPTIONS;try{const re=yield _(y.getRegionFromIMDS.bind(y),w.Ak.RegionDiscoveryGetRegionFromIMDS,y.logger,y.performanceClient,y.correlationId)(g.gT.IMDS_VERSION,Q);if(re.status===g.YY.httpSuccess&&(L=re.body,d.region_source=g.W.IMDS),re.status===g.YY.httpBadRequest){const de=yield _(y.getCurrentVersion.bind(y),w.Ak.RegionDiscoveryGetCurrentVersion,y.logger,y.performanceClient,y.correlationId)(Q);if(!de)return d.region_source=g.W.FAILED_AUTO_DETECTION,null;const Te=yield _(y.getRegionFromIMDS.bind(y),w.Ak.RegionDiscoveryGetRegionFromIMDS,y.logger,y.performanceClient,y.correlationId)(de,Q);Te.status===g.YY.httpSuccess&&(L=Te.body,d.region_source=g.W.IMDS)}}catch{return d.region_source=g.W.FAILED_AUTO_DETECTION,null}}return L||(d.region_source=g.W.FAILED_AUTO_DETECTION),L||null})()}getRegionFromIMDS(u,d){var y=this;return(0,E.Z)(function*(){return y.performanceClient?.addQueueMeasurement(w.Ak.RegionDiscoveryGetRegionFromIMDS,y.correlationId),y.networkInterface.sendGetRequestAsync(`${g.gT.IMDS_ENDPOINT}?api-version=${u}&format=text`,d,g.gT.IMDS_TIMEOUT)})()}getCurrentVersion(u){var d=this;return(0,E.Z)(function*(){d.performanceClient?.addQueueMeasurement(w.Ak.RegionDiscoveryGetCurrentVersion,d.correlationId);try{const y=yield d.networkInterface.sendGetRequestAsync(`${g.gT.IMDS_ENDPOINT}?format=json`,u);return y.status===g.YY.httpBadRequest&&y.body&&y.body["newest-versions"]&&y.body["newest-versions"].length>0?y.body["newest-versions"][0]:null}catch{return null}})()}}return ke.IMDS_OPTIONS={headers:{Metadata:"true"}},ke})();var U=S(7481),q=S(5841),te=S(7299);class se{constructor(c,u,d,y,L,Q,re){this.canonicalAuthority=c,this._canonicalAuthority.validateAsUri(),this.networkInterface=u,this.cacheManager=d,this.authorityOptions=y,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=L,this.performanceClient=Q,this.correlationId=re,this.regionDiscovery=new b(u,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(c){if(c.HostNameAndPort.endsWith(g.gT.CIAM_AUTH_URL))return R.a.Ciam;const u=c.PathSegments;if(u.length)switch(u[0].toLowerCase()){case g.gT.ADFS:return R.a.Adfs;case g.gT.DSTS:return R.a.Dsts}return R.a.Default}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(c){this._canonicalAuthority=new H.G(c),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw(0,B.zP)(q.HO)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw(0,B.zP)(q.HO)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw(0,B.zP)(q.HO)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw(0,B.zP)(q.ig);return this.replacePath(this.metadata.end_session_endpoint)}throw(0,B.zP)(q.HO)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw(0,B.zP)(q.HO)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw(0,B.zP)(q.HO)}canReplaceTenant(c){return 1===c.PathSegments.length&&!se.reservedTenantDomains.has(c.PathSegments[0])&&this.getAuthorityType(c)===R.a.Default&&this.protocolMode===V.A.AAD}replaceTenant(c){return c.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(c){let u=c;const y=new H.G(this.metadata.canonical_authority).getUrlComponents(),L=y.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((re,de)=>{let Te=L[de];if(0===de&&this.canReplaceTenant(y)){const Se=new H.G(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];Te!==Se&&(this.logger.verbose(`Replacing tenant domain name ${Te} with id ${Se}`),Te=Se)}re!==Te&&(u=u.replace(`/${Te}/`,`/${re}/`))}),this.replaceTenant(u)}get defaultOpenIdConfigurationEndpoint(){const c=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===R.a.Adfs||this.protocolMode!==V.A.AAD&&!this.isAliasOfKnownMicrosoftAuthority(c)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}resolveEndpointsAsync(){var c=this;return(0,E.Z)(function*(){c.performanceClient?.addQueueMeasurement(w.Ak.AuthorityResolveEndpointsAsync,c.correlationId);const u=c.getCurrentMetadataEntity(),d=yield _(c.updateCloudDiscoveryMetadata.bind(c),w.Ak.AuthorityUpdateCloudDiscoveryMetadata,c.logger,c.performanceClient,c.correlationId)(u);c.canonicalAuthority=c.canonicalAuthority.replace(c.hostnameAndPort,u.preferred_network);const y=yield _(c.updateEndpointMetadata.bind(c),w.Ak.AuthorityUpdateEndpointMetadata,c.logger,c.performanceClient,c.correlationId)(u);c.updateCachedMetadata(u,d,{source:y})})()}getCurrentMetadataEntity(){let c=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return c||(c=new z,c.updateCanonicalAuthority(this.canonicalAuthority)),c}updateCachedMetadata(c,u,d){u!==g.pQ.CACHE&&d?.source!==g.pQ.CACHE&&(c.resetExpiresAt(),c.updateCanonicalAuthority(this.canonicalAuthority));const y=this.cacheManager.generateAuthorityMetadataCacheKey(c.preferred_cache);this.cacheManager.setAuthorityMetadata(y,c),this.metadata=c}updateEndpointMetadata(c){var u=this;return(0,E.Z)(function*(){u.performanceClient?.addQueueMeasurement(w.Ak.AuthorityUpdateEndpointMetadata,u.correlationId);const d=u.updateEndpointMetadataFromLocalSources(c);if(d){if(d.source===g.pQ.HARDCODED_VALUES&&u.authorityOptions.azureRegionConfiguration?.azureRegion&&d.metadata){const L=yield _(u.updateMetadataWithRegionalInformation.bind(u),w.Ak.AuthorityUpdateMetadataWithRegionalInformation,u.logger,u.performanceClient,u.correlationId)(d.metadata);c.updateEndpointMetadata(L,!1)}return d.source}let y=yield _(u.getEndpointMetadataFromNetwork.bind(u),w.Ak.AuthorityGetEndpointMetadataFromNetwork,u.logger,u.performanceClient,u.correlationId)();if(y)return u.authorityOptions.azureRegionConfiguration?.azureRegion&&(y=yield _(u.updateMetadataWithRegionalInformation.bind(u),w.Ak.AuthorityUpdateMetadataWithRegionalInformation,u.logger,u.performanceClient,u.correlationId)(y)),c.updateEndpointMetadata(y,!0),g.pQ.NETWORK;throw(0,B.zP)(q.Ce,u.defaultOpenIdConfigurationEndpoint)})()}updateEndpointMetadataFromLocalSources(c){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");const u=this.getEndpointMetadataFromConfig();if(u)return this.logger.verbose("Found endpoint metadata in authority configuration"),c.updateEndpointMetadata(u,!1),{source:g.pQ.CONFIG};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{const y=this.getEndpointMetadataFromHardcodedValues();if(y)return c.updateEndpointMetadata(y,!1),{source:g.pQ.HARDCODED_VALUES,metadata:y};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const d=c.isExpired();return this.isAuthoritySameType(c)&&c.endpointsFromNetwork&&!d?(this.logger.verbose("Found endpoint metadata in the cache."),{source:g.pQ.CACHE}):(d&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(c){return new H.G(c.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch{throw(0,D.ei)(te.zx)}return null}getEndpointMetadataFromNetwork(){var c=this;return(0,E.Z)(function*(){c.performanceClient?.addQueueMeasurement(w.Ak.AuthorityGetEndpointMetadataFromNetwork,c.correlationId);const u={},d=c.defaultOpenIdConfigurationEndpoint;c.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${d}`);try{const y=yield c.networkInterface.sendGetRequestAsync(d,u);return function $(ke){return ke.hasOwnProperty("authorization_endpoint")&&ke.hasOwnProperty("token_endpoint")&&ke.hasOwnProperty("issuer")&&ke.hasOwnProperty("jwks_uri")}(y.body)?y.body:(c.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(y){return c.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${y}`),null}})()}getEndpointMetadataFromHardcodedValues(){return this.canonicalAuthority in M.Qh?M.Qh[this.canonicalAuthority]:null}updateMetadataWithRegionalInformation(c){var u=this;return(0,E.Z)(function*(){u.performanceClient?.addQueueMeasurement(w.Ak.AuthorityUpdateMetadataWithRegionalInformation,u.correlationId);const d=u.authorityOptions.azureRegionConfiguration?.azureRegion;if(d){if(d!==g.gT.AZURE_REGION_AUTO_DISCOVER_FLAG)return u.regionDiscoveryMetadata.region_outcome=g.ki.CONFIGURED_NO_AUTO_DETECTION,u.regionDiscoveryMetadata.region_used=d,se.replaceWithRegionalInformation(c,d);const y=yield _(u.regionDiscovery.detectRegion.bind(u.regionDiscovery),w.Ak.RegionDiscoveryDetectRegion,u.logger,u.performanceClient,u.correlationId)(u.authorityOptions.azureRegionConfiguration?.environmentRegion,u.regionDiscoveryMetadata);if(y)return u.regionDiscoveryMetadata.region_outcome=g.ki.AUTO_DETECTION_REQUESTED_SUCCESSFUL,u.regionDiscoveryMetadata.region_used=y,se.replaceWithRegionalInformation(c,y);u.regionDiscoveryMetadata.region_outcome=g.ki.AUTO_DETECTION_REQUESTED_FAILED}return c})()}updateCloudDiscoveryMetadata(c){var u=this;return(0,E.Z)(function*(){u.performanceClient?.addQueueMeasurement(w.Ak.AuthorityUpdateCloudDiscoveryMetadata,u.correlationId);const d=u.updateCloudDiscoveryMetadataFromLocalSources(c);if(d)return d;const y=yield _(u.getCloudDiscoveryMetadataFromNetwork.bind(u),w.Ak.AuthorityGetCloudDiscoveryMetadataFromNetwork,u.logger,u.performanceClient,u.correlationId)();if(y)return c.updateCloudDiscoveryMetadata(y,!0),g.pQ.NETWORK;throw(0,D.ei)(te.o_)})()}updateCloudDiscoveryMetadataFromLocalSources(c){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||g.gT.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||g.gT.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${c.canonical_authority||g.gT.NOT_APPLICABLE}`);const u=this.getCloudDiscoveryMetadataFromConfig();if(u)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),c.updateCloudDiscoveryMetadata(u,!1),g.pQ.CONFIG;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const y=(0,M.ix)(this.hostnameAndPort);if(y)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),c.updateCloudDiscoveryMetadata(y,!1),g.pQ.HARDCODED_VALUES;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}const d=c.isExpired();return this.isAuthoritySameType(c)&&c.aliasesFromNetwork&&!d?(this.logger.verbose("Found cloud discovery metadata in the cache."),g.pQ.CACHE):(d&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===R.a.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),se.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const c=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),u=(0,M.eM)(c.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),u)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),u;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch{throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),(0,D.ei)(te.E)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),se.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}getCloudDiscoveryMetadataFromNetwork(){var c=this;return(0,E.Z)(function*(){c.performanceClient?.addQueueMeasurement(w.Ak.AuthorityGetCloudDiscoveryMetadataFromNetwork,c.correlationId);const u=`${g.gT.AAD_INSTANCE_DISCOVERY_ENDPT}${c.canonicalAuthority}oauth2/v2.0/authorize`,d={};let y=null;try{const L=yield c.networkInterface.sendGetRequestAsync(u,d);let Q,re;if(function k(ke){return ke.hasOwnProperty("tenant_discovery_endpoint")&&ke.hasOwnProperty("metadata")}(L.body))Q=L.body,re=Q.metadata,c.logger.verbosePii(`tenant_discovery_endpoint is: ${Q.tenant_discovery_endpoint}`);else{if(!function K(ke){return ke.hasOwnProperty("error")&&ke.hasOwnProperty("error_description")}(L.body))return c.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;if(c.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${L.status}`),Q=L.body,Q.error===g.gT.INVALID_INSTANCE)return c.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;c.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${Q.error}`),c.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${Q.error_description}`),c.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),re=[]}c.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),y=(0,M.eM)(re,c.hostnameAndPort)}catch(L){return c.logger.error(L instanceof U.l4?`There was a network error while attempting to get the cloud discovery instance metadata.\nError: ${L.errorCode}\nError Description: ${L.errorMessage}`:`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: ${L.name}\nError Description: ${L.message}`),null}return y||(c.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),c.logger.verbose("Creating custom Authority for custom domain scenario."),y=se.createCloudDiscoveryMetadataFromHost(c.hostnameAndPort)),y})()}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(u=>H.G.getDomainFromUrl(u).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(c,u){let d;return u&&u.azureCloudInstance!==C.z.None&&(d=`${u.azureCloudInstance}/${u.tenant?u.tenant:g.gT.DEFAULT_COMMON_TENANT}/`),d||c}static createCloudDiscoveryMetadataFromHost(c){return{preferred_network:c,preferred_cache:c,aliases:[c]}}getPreferredCache(){if(this.discoveryComplete())return this.metadata.preferred_cache;throw(0,B.zP)(q.HO)}isAlias(c){return this.metadata.aliases.indexOf(c)>-1}isAliasOfKnownMicrosoftAuthority(c){return M.wn.has(c)}static isPublicCloudAuthority(c){return g.gT.KNOWN_PUBLIC_CLOUDS.indexOf(c)>=0}static buildRegionalAuthorityString(c,u,d){const y=new H.G(c);y.validateAsUri();const L=y.getUrlComponents();let Q=`${u}.${L.HostNameAndPort}`;this.isPublicCloudAuthority(L.HostNameAndPort)&&(Q=`${u}.${g.gT.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);const re=H.G.constructAuthorityUriFromObject({...y.getUrlComponents(),HostNameAndPort:Q}).urlString;return d?`${re}?${d}`:re}static replaceWithRegionalInformation(c,u){const d={...c};return d.authorization_endpoint=se.buildRegionalAuthorityString(d.authorization_endpoint,u),d.token_endpoint=se.buildRegionalAuthorityString(d.token_endpoint,u),d.end_session_endpoint&&(d.end_session_endpoint=se.buildRegionalAuthorityString(d.end_session_endpoint,u)),d}static transformCIAMAuthority(c){let u=c;const y=new H.G(c).getUrlComponents();return 0===y.PathSegments.length&&y.HostNameAndPort.endsWith(g.gT.CIAM_AUTH_URL)&&(u=`${u}${y.HostNameAndPort.split(".")[0]}${g.gT.AAD_TENANT_DOMAIN_SUFFIX}`),u}}function ie(ke){return ke.endsWith(g.gT.FORWARD_SLASH)?ke:`${ke}${g.gT.FORWARD_SLASH}`}se.reservedTenantDomains=new Set(["{tenant}","{tenantid}",g.Nb.COMMON,g.Nb.CONSUMERS,g.Nb.ORGANIZATIONS]);var me=S(544),De=S(6603),Ee=S(6490),He=S(9723),Be=S(8821);class ze{generateAppMetadataKey(){return ze.generateAppMetadataCacheKey(this.environment,this.clientId)}static generateAppMetadataCacheKey(c,u){return[g.dg,c,u].join(g.Bv.CACHE_KEY_SEPARATOR).toLowerCase()}static createAppMetadataEntity(c,u,d){const y=new ze;return y.clientId=c,y.environment=u,d&&(y.familyId=d),y}static isAppMetadataEntity(c,u){return!!u&&0===c.indexOf(g.dg)&&u.hasOwnProperty("clientId")&&u.hasOwnProperty("environment")}}class pe{static isThrottlingEntity(c,u){let d=!1;c&&(d=0===c.indexOf(g.bb.THROTTLING_PREFIX));let y=!0;return u&&(y=u.hasOwnProperty("throttleTime")),d&&y}}var G=S(9092);class oe{static setRequestState(c,u,d){const y=oe.generateLibraryState(c,d);return u?`${y}${g.gT.RESOURCE_DELIM}${u}`:y}static generateLibraryState(c,u){if(!c)throw(0,B.zP)(q.QL);const d={id:c.createNewGuid()};u&&(d.meta=u);const y=JSON.stringify(d);return c.base64Encode(y)}static parseRequestState(c,u){if(!c)throw(0,B.zP)(q.QL);if(!u)throw(0,B.zP)(q.r8);try{const d=u.split(g.gT.RESOURCE_DELIM),y=d[0],L=d.length>1?d.slice(1).join(g.gT.RESOURCE_DELIM):g.gT.EMPTY_STRING,Q=c.base64Decode(y),re=JSON.parse(Q);return{userRequestState:L||g.gT.EMPTY_STRING,libraryState:re}}catch{throw(0,B.zP)(q.r8)}}}var ue=S(9082);class m{constructor(c,u,d,y,L){this.account=c||null,this.idToken=u||null,this.accessToken=d||null,this.refreshToken=y||null,this.appMetadata=L||null}}var T=S(8293),N=S(8593),le=S(3325),Ce=S(3094);class Me{constructor(c){this.validateWindowStorage(c),this.windowStorage=window[c]}validateWindowStorage(c){if(c!==N.Ix.LocalStorage&&c!==N.Ix.SessionStorage||!window[c])throw(0,le.Z1)(Ce.m4)}getItem(c){return this.windowStorage.getItem(c)}setItem(c,u){this.windowStorage.setItem(c,u)}removeItem(c){this.windowStorage.removeItem(c)}getKeys(){return Object.keys(this.windowStorage)}containsKey(c){return this.windowStorage.hasOwnProperty(c)}}var Ke=S(6475);function be(ke,c){if(!c)return null;try{return oe.parseRequestState(ke,c).libraryState.meta}catch{throw(0,B.zP)(q.r8)}}var xe=S(6787),ft=S(1173),Ge=S(7377);class tn extends He.L{constructor(c,u,d,y,L){super(c,d,y,L),this.COOKIE_LIFE_MULTIPLIER=864e5,this.cacheConfig=u,this.logger=y,this.internalStorage=new Ke.k,this.browserStorage=this.setupBrowserStorage(this.cacheConfig.cacheLocation),this.temporaryCacheStorage=this.setupTemporaryCacheStorage(this.cacheConfig.temporaryCacheLocation,this.cacheConfig.cacheLocation),u.cacheMigrationEnabled&&(this.migrateCacheEntries(),this.createKeyMaps())}setupBrowserStorage(c){switch(c){case N.Ix.LocalStorage:case N.Ix.SessionStorage:try{return new Me(c)}catch(u){this.logger.verbose(u);break}}return this.cacheConfig.cacheLocation=N.Ix.MemoryStorage,new Ke.k}setupTemporaryCacheStorage(c,u){switch(u){case N.Ix.LocalStorage:case N.Ix.SessionStorage:try{return new Me(c||N.Ix.SessionStorage)}catch(d){return this.logger.verbose(d),this.internalStorage}default:return this.internalStorage}}migrateCacheEntries(){const u=`${g.gT.CACHE_PREFIX}.${g.Vi.CLIENT_INFO}`,d=`${g.gT.CACHE_PREFIX}.${g.Vi.ERROR}`,y=`${g.gT.CACHE_PREFIX}.${g.Vi.ERROR_DESC}`,Te=[this.browserStorage.getItem(`${g.gT.CACHE_PREFIX}.${g.Vi.ID_TOKEN}`),this.browserStorage.getItem(u),this.browserStorage.getItem(d),this.browserStorage.getItem(y)];[g.Vi.ID_TOKEN,g.Vi.CLIENT_INFO,g.Vi.ERROR,g.Vi.ERROR_DESC].forEach((nt,gt)=>this.migrateCacheEntry(nt,Te[gt]))}migrateCacheEntry(c,u){u&&this.setTemporaryCache(c,u,!0)}createKeyMaps(){this.logger.trace("BrowserCacheManager - createKeyMaps called.");const c=this.getItem(N.Oq.ACCOUNT_KEYS),u=this.getItem(`${N.Oq.TOKEN_KEYS}.${this.clientId}`);c&&u?this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration."):this.browserStorage.getKeys().forEach(y=>{if(this.isCredentialKey(y)){const L=this.getItem(y);if(L){const Q=this.validateAndParseJson(L);if(Q&&Q.hasOwnProperty("credentialType"))switch(Q.credentialType){case g.d3.ID_TOKEN:if(Be.Bq(Q)){this.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - idToken with key: ${y} found, saving key to token key map`);const de=this.updateCredentialCacheKey(y,Q);return void this.addTokenKey(de,g.d3.ID_TOKEN)}this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed idToken validation on key: ${y}`);break;case g.d3.ACCESS_TOKEN:case g.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(Be.Om(Q)){this.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - accessToken with key: ${y} found, saving key to token key map`);const de=this.updateCredentialCacheKey(y,Q);return void this.addTokenKey(de,g.d3.ACCESS_TOKEN)}this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed accessToken validation on key: ${y}`);break;case g.d3.REFRESH_TOKEN:if(Be.x4(Q)){this.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - refreshToken with key: ${y} found, saving key to token key map`);const de=this.updateCredentialCacheKey(y,Q);return void this.addTokenKey(de,g.d3.REFRESH_TOKEN)}this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: ${y}`)}}}if(this.isAccountKey(y)){const L=this.getItem(y);if(L){const Q=this.validateAndParseJson(L);Q&&De.r.isAccountEntity(Q)&&(this.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - account with key: ${y} found, saving key to account key map`),this.addAccountKeyToMap(y))}}})}validateAndParseJson(c){try{const u=JSON.parse(c);return u&&"object"==typeof u?u:null}catch{return null}}getItem(c){return this.browserStorage.getItem(c)}setItem(c,u){this.browserStorage.setItem(c,u)}getAccount(c){this.logger.trace("BrowserCacheManager.getAccount called");const u=this.getItem(c);if(!u)return this.removeAccountKeyFromMap(c),null;const d=this.validateAndParseJson(u);return d&&De.r.isAccountEntity(d)?He.L.toObject(new De.r,d):(this.removeAccountKeyFromMap(c),null)}setAccount(c){this.logger.trace("BrowserCacheManager.setAccount called");const u=c.generateAccountKey();this.setItem(u,JSON.stringify(c)),this.addAccountKeyToMap(u)}getAccountKeys(){this.logger.trace("BrowserCacheManager.getAccountKeys called");const c=this.getItem(N.Oq.ACCOUNT_KEYS);return c?JSON.parse(c):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])}addAccountKeyToMap(c){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${c}`);const u=this.getAccountKeys();-1===u.indexOf(c)?(u.push(c),this.setItem(N.Oq.ACCOUNT_KEYS,JSON.stringify(u)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")}removeAccountKeyFromMap(c){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${c}`);const u=this.getAccountKeys(),d=u.indexOf(c);d>-1?(u.splice(d,1),this.setItem(N.Oq.ACCOUNT_KEYS,JSON.stringify(u)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}removeAccount(c){var u=()=>super.removeAccount,d=this;return(0,E.Z)(function*(){u().call(d,c),d.removeAccountKeyFromMap(c)})()}removeIdToken(c){super.removeIdToken(c),this.removeTokenKey(c,g.d3.ID_TOKEN)}removeAccessToken(c){var u=()=>super.removeAccessToken,d=this;return(0,E.Z)(function*(){u().call(d,c),d.removeTokenKey(c,g.d3.ACCESS_TOKEN)})()}removeRefreshToken(c){super.removeRefreshToken(c),this.removeTokenKey(c,g.d3.REFRESH_TOKEN)}getTokenKeys(){this.logger.trace("BrowserCacheManager.getTokenKeys called");const c=this.getItem(`${N.Oq.TOKEN_KEYS}.${this.clientId}`);if(c){const u=this.validateAndParseJson(c);if(u&&u.hasOwnProperty("idToken")&&u.hasOwnProperty("accessToken")&&u.hasOwnProperty("refreshToken"))return u;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}}addTokenKey(c,u){this.logger.trace("BrowserCacheManager addTokenKey called");const d=this.getTokenKeys();switch(u){case g.d3.ID_TOKEN:-1===d.idToken.indexOf(c)&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),d.idToken.push(c));break;case g.d3.ACCESS_TOKEN:-1===d.accessToken.indexOf(c)&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),d.accessToken.push(c));break;case g.d3.REFRESH_TOKEN:-1===d.refreshToken.indexOf(c)&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),d.refreshToken.push(c));break;default:throw this.logger.error(`BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: ${u}`),(0,B.zP)(q.cy)}this.setItem(`${N.Oq.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(d))}removeTokenKey(c,u){this.logger.trace("BrowserCacheManager removeTokenKey called");const d=this.getTokenKeys();switch(u){case g.d3.ID_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: ${c} from map`);const y=d.idToken.indexOf(c);y>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),d.idToken.splice(y,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case g.d3.ACCESS_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: ${c} from map`);const L=d.accessToken.indexOf(c);L>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),d.accessToken.splice(L,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case g.d3.REFRESH_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: ${c} from map`);const Q=d.refreshToken.indexOf(c);Q>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),d.refreshToken.splice(Q,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:throw this.logger.error(`BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: ${u}`),(0,B.zP)(q.cy)}this.setItem(`${N.Oq.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(d))}getIdTokenCredential(c){const u=this.getItem(c);if(!u)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(c,g.d3.ID_TOKEN),null;const d=this.validateAndParseJson(u);return d&&Be.Bq(d)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),d):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(c,g.d3.ID_TOKEN),null)}setIdTokenCredential(c){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const u=Be.Mk(c);this.setItem(u,JSON.stringify(c)),this.addTokenKey(u,g.d3.ID_TOKEN)}getAccessTokenCredential(c){const u=this.getItem(c);if(!u)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(c,g.d3.ACCESS_TOKEN),null;const d=this.validateAndParseJson(u);return d&&Be.Om(d)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),d):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(c,g.d3.ACCESS_TOKEN),null)}setAccessTokenCredential(c){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const u=Be.Mk(c);this.setItem(u,JSON.stringify(c)),this.addTokenKey(u,g.d3.ACCESS_TOKEN)}getRefreshTokenCredential(c){const u=this.getItem(c);if(!u)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(c,g.d3.REFRESH_TOKEN),null;const d=this.validateAndParseJson(u);return d&&Be.x4(d)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),d):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(c,g.d3.REFRESH_TOKEN),null)}setRefreshTokenCredential(c){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const u=Be.Mk(c);this.setItem(u,JSON.stringify(c)),this.addTokenKey(u,g.d3.REFRESH_TOKEN)}getAppMetadata(c){const u=this.getItem(c);if(!u)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const d=this.validateAndParseJson(u);return d&&ze.isAppMetadataEntity(c,d)?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),He.L.toObject(new ze,d)):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null)}setAppMetadata(c){this.logger.trace("BrowserCacheManager.setAppMetadata called");const u=c.generateAppMetadataKey();this.setItem(u,JSON.stringify(c))}getServerTelemetry(c){const u=this.getItem(c);if(!u)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const d=this.validateAndParseJson(u);return d&&Be.Js(c,d)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),d):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)}setServerTelemetry(c,u){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(c,JSON.stringify(u))}getAuthorityMetadata(c){const u=this.internalStorage.getItem(c);if(!u)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const d=this.validateAndParseJson(u);return d&&z.isAuthorityMetadataEntity(c,d)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),He.L.toObject(new z,d)):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter(u=>this.isAuthorityMetadata(u))}setWrapperMetadata(c,u){this.internalStorage.setItem(N.Bs.WRAPPER_SKU,c),this.internalStorage.setItem(N.Bs.WRAPPER_VER,u)}getWrapperMetadata(){return[this.internalStorage.getItem(N.Bs.WRAPPER_SKU)||g.gT.EMPTY_STRING,this.internalStorage.getItem(N.Bs.WRAPPER_VER)||g.gT.EMPTY_STRING]}setAuthorityMetadata(c,u){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(c,JSON.stringify(u))}getActiveAccount(){const c=this.generateCacheKey(g.Vi.ACTIVE_ACCOUNT_FILTERS),u=this.getItem(c);if(!u){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");const y=this.generateCacheKey(g.Vi.ACTIVE_ACCOUNT),L=this.getItem(y);if(!L)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;const Q=this.getAccountInfoFilteredBy({localAccountId:L});return Q?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(Q),Q):null}const d=this.validateAndParseJson(u);return d?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:d.homeAccountId,localAccountId:d.localAccountId})):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(c){const u=this.generateCacheKey(g.Vi.ACTIVE_ACCOUNT_FILTERS),d=this.generateCacheKey(g.Vi.ACTIVE_ACCOUNT);c?(this.logger.verbose("setActiveAccount: Active account set"),this.browserStorage.setItem(u,JSON.stringify({homeAccountId:c.homeAccountId,localAccountId:c.localAccountId})),this.browserStorage.setItem(d,c.localAccountId)):(this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(u),this.browserStorage.removeItem(d))}getThrottlingCache(c){const u=this.getItem(c);if(!u)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const d=this.validateAndParseJson(u);return d&&pe.isThrottlingEntity(c,d)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),He.L.toObject(new pe,d)):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)}setThrottlingCache(c,u){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(c,JSON.stringify(u))}getTemporaryCache(c,u){const d=u?this.generateCacheKey(c):c;if(this.cacheConfig.storeAuthStateInCookie){const L=this.getItemCookie(d);if(L)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),L}const y=this.temporaryCacheStorage.getItem(d);if(!y){if(this.cacheConfig.cacheLocation===N.Ix.LocalStorage){const L=this.browserStorage.getItem(d);if(L)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),L}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),y}setTemporaryCache(c,u,d){const y=d?this.generateCacheKey(c):c;this.temporaryCacheStorage.setItem(y,u),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(y,u))}removeItem(c){this.browserStorage.removeItem(c),this.temporaryCacheStorage.removeItem(c),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(c))}containsKey(c){return this.browserStorage.containsKey(c)||this.temporaryCacheStorage.containsKey(c)}getKeys(){return[...this.browserStorage.getKeys(),...this.temporaryCacheStorage.getKeys()]}clear(){var c=this;return(0,E.Z)(function*(){yield c.removeAllAccounts(),c.removeAppMetadata(),c.getKeys().forEach(u=>{(c.browserStorage.containsKey(u)||c.temporaryCacheStorage.containsKey(u))&&(-1!==u.indexOf(g.gT.CACHE_PREFIX)||-1!==u.indexOf(c.clientId))&&c.removeItem(u)}),c.internalStorage.clear()})()}clearTokensAndKeysWithClaims(c){var u=this;return(0,E.Z)(function*(){c.addQueueMeasurement(w.Ak.ClearTokensAndKeysWithClaims);const d=u.getTokenKeys(),y=[];d.accessToken.forEach(L=>{const Q=u.getAccessTokenCredential(L);Q?.requestedClaimsHash&&L.includes(Q.requestedClaimsHash.toLowerCase())&&y.push(u.removeAccessToken(L))}),yield Promise.all(y),y.length>0&&u.logger.warning(`${y.length} access tokens with claims in the cache keys have been removed from the cache.`)})()}setItemCookie(c,u,d){let y=`${encodeURIComponent(c)}=${encodeURIComponent(u)};path=/;SameSite=Lax;`;d&&(y+=`expires=${this.getCookieExpirationTime(d)};`),this.cacheConfig.secureCookies&&(y+="Secure;"),document.cookie=y}getItemCookie(c){const u=`${encodeURIComponent(c)}=`,d=document.cookie.split(";");for(let y=0;y<d.length;y++){let L=d[y];for(;" "===L.charAt(0);)L=L.substring(1);if(0===L.indexOf(u))return decodeURIComponent(L.substring(u.length,L.length))}return g.gT.EMPTY_STRING}clearMsalCookies(){const c=`${g.gT.CACHE_PREFIX}.${this.clientId}`;document.cookie.split(";").forEach(d=>{for(;" "===d.charAt(0);)d=d.substring(1);if(0===d.indexOf(c)){const y=d.split("=")[0];this.clearItemCookie(y)}})}clearItemCookie(c){this.setItemCookie(c,g.gT.EMPTY_STRING,-1)}getCookieExpirationTime(c){return new Date((new Date).getTime()+c*this.COOKIE_LIFE_MULTIPLIER).toUTCString()}getCache(){return this.browserStorage}setCache(){}generateCacheKey(c){return this.validateAndParseJson(c)?JSON.stringify(c):G.x.startsWith(c,g.gT.CACHE_PREFIX)||G.x.startsWith(c,g.Vi.ADAL_ID_TOKEN)?c:`${g.gT.CACHE_PREFIX}.${this.clientId}.${c}`}generateAuthorityKey(c){const{libraryState:{id:u}}=oe.parseRequestState(this.cryptoImpl,c);return this.generateCacheKey(`${N.c4.AUTHORITY}.${u}`)}generateNonceKey(c){const{libraryState:{id:u}}=oe.parseRequestState(this.cryptoImpl,c);return this.generateCacheKey(`${N.c4.NONCE_IDTOKEN}.${u}`)}generateStateKey(c){const{libraryState:{id:u}}=oe.parseRequestState(this.cryptoImpl,c);return this.generateCacheKey(`${N.c4.REQUEST_STATE}.${u}`)}getCachedAuthority(c){const u=this.generateStateKey(c),d=this.getTemporaryCache(u);if(!d)return null;const y=this.generateAuthorityKey(d);return this.getTemporaryCache(y)}updateCacheEntries(c,u,d,y,L){this.logger.trace("BrowserCacheManager.updateCacheEntries called");const Q=this.generateStateKey(c);this.setTemporaryCache(Q,c,!1);const re=this.generateNonceKey(c);this.setTemporaryCache(re,u,!1);const de=this.generateAuthorityKey(c);this.setTemporaryCache(de,d,!1),L?this.setTemporaryCache(N.c4.CCS_CREDENTIAL,JSON.stringify({credential:L.homeAccountId,type:"home_account_id"}),!0):y&&this.setTemporaryCache(N.c4.CCS_CREDENTIAL,JSON.stringify({credential:y,type:"UPN"}),!0)}resetRequestCache(c){this.logger.trace("BrowserCacheManager.resetRequestCache called"),c&&(this.getKeys().forEach(u=>{-1!==u.indexOf(c)&&this.removeItem(u)}),this.removeItem(this.generateStateKey(c)),this.removeItem(this.generateNonceKey(c)),this.removeItem(this.generateAuthorityKey(c))),this.removeItem(this.generateCacheKey(N.c4.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(N.c4.ORIGIN_URI)),this.removeItem(this.generateCacheKey(N.c4.URL_HASH)),this.removeItem(this.generateCacheKey(N.c4.CORRELATION_ID)),this.removeItem(this.generateCacheKey(N.c4.CCS_CREDENTIAL)),this.removeItem(this.generateCacheKey(N.c4.NATIVE_REQUEST)),this.setInteractionInProgress(!1)}cleanRequestByState(c){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),c){const u=this.generateStateKey(c),d=this.temporaryCacheStorage.getItem(u);this.logger.infoPii(`BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: ${d}`),this.resetRequestCache(d||g.gT.EMPTY_STRING)}this.clearMsalCookies()}cleanRequestByInteractionType(c){this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.getKeys().forEach(u=>{if(-1===u.indexOf(N.c4.REQUEST_STATE))return;const d=this.temporaryCacheStorage.getItem(u);if(!d)return;const y=be(this.cryptoImpl,d);y&&y.interactionType===c&&(this.logger.infoPii(`BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: ${d}`),this.resetRequestCache(d))}),this.clearMsalCookies(),this.setInteractionInProgress(!1)}cacheCodeRequest(c){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");const u=(0,ft.h$)(JSON.stringify(c));this.setTemporaryCache(N.c4.REQUEST_PARAMS,u,!0)}getCachedRequest(c){this.logger.trace("BrowserCacheManager.getCachedRequest called");const u=this.getTemporaryCache(N.c4.REQUEST_PARAMS,!0);if(!u)throw(0,T.Z_)(Ge.QO);let d;try{d=JSON.parse((0,xe.t)(u))}catch(y){throw this.logger.errorPii(`Attempted to parse: ${u}`),this.logger.error(`Parsing cached token request threw with error: ${y}`),(0,T.Z_)(Ge.e$)}if(this.removeItem(this.generateCacheKey(N.c4.REQUEST_PARAMS)),!d.authority){const y=this.generateAuthorityKey(c),L=this.getTemporaryCache(y);if(!L)throw(0,T.Z_)(Ge.dT);d.authority=L}return d}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const c=this.getTemporaryCache(N.c4.NATIVE_REQUEST,!0);return c?this.validateAndParseJson(c)||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null):(this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null)}isInteractionInProgress(c){const u=this.getInteractionInProgress();return c?u===this.clientId:!!u}getInteractionInProgress(){return this.getTemporaryCache(`${g.gT.CACHE_PREFIX}.${N.c4.INTERACTION_STATUS_KEY}`,!1)}setInteractionInProgress(c){const u=`${g.gT.CACHE_PREFIX}.${N.c4.INTERACTION_STATUS_KEY}`;if(c){if(this.getInteractionInProgress())throw(0,T.Z_)(Ge.Ck);this.setTemporaryCache(u,this.clientId,!1)}else!c&&this.getInteractionInProgress()===this.clientId&&this.removeItem(u)}getLegacyLoginHint(){const c=this.getTemporaryCache(g.Vi.ADAL_ID_TOKEN);c&&(this.browserStorage.removeItem(g.Vi.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));const u=this.getTemporaryCache(g.Vi.ID_TOKEN,!0);u&&(this.removeItem(this.generateCacheKey(g.Vi.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));const d=u||c;if(d){const y=ue.Z_(d,xe.t);if(y.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),y.preferred_username;if(y.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),y.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null}updateCredentialCacheKey(c,u){const d=Be.Mk(u);if(c!==d){const y=this.getItem(c);if(y)return this.removeItem(c),this.setItem(d,y),this.logger.verbose(`Updated an outdated ${u.credentialType} cache key`),d;this.logger.error(`Attempted to update an outdated ${u.credentialType} cache key but no item matching the outdated key was found in storage`)}return c}getRedirectRequestContext(){return this.getTemporaryCache(N.c4.REDIRECT_CONTEXT,!0)}setRedirectRequestContext(c){this.setTemporaryCache(N.c4.REDIRECT_CONTEXT,c,!0)}hydrateCache(c,u){var d=this;return(0,E.Z)(function*(){const y=Be.Md(c.account?.homeAccountId,c.account?.environment,c.idToken,d.clientId,c.tenantId);let L;u.claims&&(L=yield d.cryptoImpl.hashString(u.claims));const Q=Be.Ds(c.account?.homeAccountId,c.account.environment,c.accessToken,d.clientId,c.tenantId,c.scopes.join(" "),c.expiresOn?.getTime()||0,c.extExpiresOn?.getTime()||0,xe.t,void 0,c.tokenType,void 0,u.sshKid,u.claims,L),re=new m(void 0,y,Q);return d.saveCacheRecord(re)})()}}var ut=S(5291),tt=S(6097),ur=S(4076),qn=S(4498);class Re{static generateThrottlingStorageKey(c){return`${g.bb.THROTTLING_PREFIX}.${JSON.stringify(c)}`}static preProcess(c,u){const d=Re.generateThrottlingStorageKey(u),y=c.getThrottlingCache(d);if(y){if(y.throttleTime<Date.now())return void c.removeItem(d);throw new qn.n(y.errorCodes?.join(" ")||g.gT.EMPTY_STRING,y.errorMessage,y.subError)}}static postProcess(c,u,d){if(Re.checkResponseStatus(d)||Re.checkResponseForRetryAfter(d)){const y={throttleTime:Re.calculateThrottleTime(parseInt(d.headers[g.SZ.RETRY_AFTER])),error:d.body.error,errorCodes:d.body.error_codes,errorMessage:d.body.error_description,subError:d.body.suberror};c.setThrottlingCache(Re.generateThrottlingStorageKey(u),y)}}static checkResponseStatus(c){return 429===c.status||c.status>=500&&c.status<600}static checkResponseForRetryAfter(c){return!!c.headers&&c.headers.hasOwnProperty(g.SZ.RETRY_AFTER)&&(c.status<200||c.status>=300)}static calculateThrottleTime(c){const u=c<=0?0:c,d=Date.now()/1e3;return Math.floor(1e3*Math.min(d+(u||g.bb.DEFAULT_THROTTLE_TIME_SECONDS),d+g.bb.DEFAULT_MAX_THROTTLE_TIME_SECONDS))}static removeThrottle(c,u,d,y){const Q=this.generateThrottlingStorageKey({clientId:u,authority:d.authority,scopes:d.scopes,homeAccountIdentifier:y,claims:d.claims,authenticationScheme:d.authenticationScheme,resourceRequestMethod:d.resourceRequestMethod,resourceRequestUri:d.resourceRequestUri,shrClaims:d.shrClaims,sshKid:d.sshKid});c.removeItem(Q)}}var qr=S(6703);class vn{constructor(c,u){this.networkClient=c,this.cacheManager=u}sendPostRequest(c,u,d){var y=this;return(0,E.Z)(function*(){let L;Re.preProcess(y.cacheManager,c);try{L=yield y.networkClient.sendPostRequestAsync(u,d)}catch(Q){throw Q instanceof U.l4?Q:(0,B.zP)(q.EF)}return Re.postProcess(y.cacheManager,c,L),L})()}}var ei=S(4630),Kn=S(1667),dr=S(1758),Fn=S(7795);class Cn{static validateRedirectUri(c){if(!c)throw(0,D.ei)(te.RV)}static validatePrompt(c){const u=[];for(const d in g.NJ)u.push(g.NJ[d]);if(u.indexOf(c)<0)throw(0,D.ei)(te.z_)}static validateClaims(c){try{JSON.parse(c)}catch{throw(0,D.ei)(te.nm)}}static validateCodeChallengeParams(c,u){if(!c||!u)throw(0,D.ei)(te.TU);this.validateCodeChallengeMethod(u)}static validateCodeChallengeMethod(c){if([g.VX.PLAIN,g.VX.S256].indexOf(c)<0)throw(0,D.ei)(te.d6)}static sanitizeEQParams(c,u){return c?(u.forEach((d,y)=>{c[y]&&delete c[y]}),Object.fromEntries(Object.entries(c).filter(d=>""!==d[1]))):{}}}class Oo{constructor(){this.parameters=new Map}addResponseTypeCode(){this.parameters.set(g.Fo.RESPONSE_TYPE,encodeURIComponent(g.gT.CODE_RESPONSE_TYPE))}addResponseTypeForTokenAndIdToken(){this.parameters.set(g.Fo.RESPONSE_TYPE,encodeURIComponent(`${g.gT.TOKEN_RESPONSE_TYPE} ${g.gT.ID_TOKEN_RESPONSE_TYPE}`))}addResponseMode(c){this.parameters.set(g.Fo.RESPONSE_MODE,encodeURIComponent(c||g.vw.QUERY))}addNativeBroker(){this.parameters.set(g.Fo.NATIVE_BROKER,encodeURIComponent("1"))}addScopes(c,u=!0,d=g.f_){u&&!d.includes("openid")&&!c.includes("openid")&&d.push("openid");const y=u?[...c||[],...d]:c||[],L=new Fn.i(y);this.parameters.set(g.Fo.SCOPE,encodeURIComponent(L.printScopes()))}addClientId(c){this.parameters.set(g.Fo.CLIENT_ID,encodeURIComponent(c))}addRedirectUri(c){Cn.validateRedirectUri(c),this.parameters.set(g.Fo.REDIRECT_URI,encodeURIComponent(c))}addPostLogoutRedirectUri(c){Cn.validateRedirectUri(c),this.parameters.set(g.Fo.POST_LOGOUT_URI,encodeURIComponent(c))}addIdTokenHint(c){this.parameters.set(g.Fo.ID_TOKEN_HINT,encodeURIComponent(c))}addDomainHint(c){this.parameters.set(g.VO.DOMAIN_HINT,encodeURIComponent(c))}addLoginHint(c){this.parameters.set(g.VO.LOGIN_HINT,encodeURIComponent(c))}addCcsUpn(c){this.parameters.set(g.SZ.CCS_HEADER,encodeURIComponent(`UPN:${c}`))}addCcsOid(c){this.parameters.set(g.SZ.CCS_HEADER,encodeURIComponent(`Oid:${c.uid}@${c.utid}`))}addSid(c){this.parameters.set(g.VO.SID,encodeURIComponent(c))}addClaims(c,u){const d=this.addClientCapabilitiesToClaims(c,u);Cn.validateClaims(d),this.parameters.set(g.Fo.CLAIMS,encodeURIComponent(d))}addCorrelationId(c){this.parameters.set(g.Fo.CLIENT_REQUEST_ID,encodeURIComponent(c))}addLibraryInfo(c){this.parameters.set(g.Fo.X_CLIENT_SKU,c.sku),this.parameters.set(g.Fo.X_CLIENT_VER,c.version),c.os&&this.parameters.set(g.Fo.X_CLIENT_OS,c.os),c.cpu&&this.parameters.set(g.Fo.X_CLIENT_CPU,c.cpu)}addApplicationTelemetry(c){c?.appName&&this.parameters.set(g.Fo.X_APP_NAME,c.appName),c?.appVersion&&this.parameters.set(g.Fo.X_APP_VER,c.appVersion)}addPrompt(c){Cn.validatePrompt(c),this.parameters.set(`${g.Fo.PROMPT}`,encodeURIComponent(c))}addState(c){c&&this.parameters.set(g.Fo.STATE,encodeURIComponent(c))}addNonce(c){this.parameters.set(g.Fo.NONCE,encodeURIComponent(c))}addCodeChallengeParams(c,u){if(Cn.validateCodeChallengeParams(c,u),!c||!u)throw(0,D.ei)(te.TU);this.parameters.set(g.Fo.CODE_CHALLENGE,encodeURIComponent(c)),this.parameters.set(g.Fo.CODE_CHALLENGE_METHOD,encodeURIComponent(u))}addAuthorizationCode(c){this.parameters.set(g.Fo.CODE,encodeURIComponent(c))}addDeviceCode(c){this.parameters.set(g.Fo.DEVICE_CODE,encodeURIComponent(c))}addRefreshToken(c){this.parameters.set(g.Fo.REFRESH_TOKEN,encodeURIComponent(c))}addCodeVerifier(c){this.parameters.set(g.Fo.CODE_VERIFIER,encodeURIComponent(c))}addClientSecret(c){this.parameters.set(g.Fo.CLIENT_SECRET,encodeURIComponent(c))}addClientAssertion(c){c&&this.parameters.set(g.Fo.CLIENT_ASSERTION,encodeURIComponent(c))}addClientAssertionType(c){c&&this.parameters.set(g.Fo.CLIENT_ASSERTION_TYPE,encodeURIComponent(c))}addOboAssertion(c){this.parameters.set(g.Fo.OBO_ASSERTION,encodeURIComponent(c))}addRequestTokenUse(c){this.parameters.set(g.Fo.REQUESTED_TOKEN_USE,encodeURIComponent(c))}addGrantType(c){this.parameters.set(g.Fo.GRANT_TYPE,encodeURIComponent(c))}addClientInfo(){this.parameters.set(g.sR,"1")}addExtraQueryParameters(c){const u=Cn.sanitizeEQParams(c,this.parameters);Object.keys(u).forEach(d=>{this.parameters.set(d,c[d])})}addClientCapabilitiesToClaims(c,u){let d;if(c)try{d=JSON.parse(c)}catch{throw(0,D.ei)(te.nm)}else d={};return u&&u.length>0&&(d.hasOwnProperty(g.As.ACCESS_TOKEN)||(d[g.As.ACCESS_TOKEN]={}),d[g.As.ACCESS_TOKEN][g.As.XMS_CC]={values:u}),JSON.stringify(d)}addUsername(c){this.parameters.set(g.Ge.username,encodeURIComponent(c))}addPassword(c){this.parameters.set(g.Ge.password,encodeURIComponent(c))}addPopToken(c){c&&(this.parameters.set(g.Fo.TOKEN_TYPE,g.hO.POP),this.parameters.set(g.Fo.REQ_CNF,encodeURIComponent(c)))}addSshJwk(c){c&&(this.parameters.set(g.Fo.TOKEN_TYPE,g.hO.SSH),this.parameters.set(g.Fo.REQ_CNF,encodeURIComponent(c)))}addServerTelemetry(c){this.parameters.set(g.Fo.X_CLIENT_CURR_TELEM,c.generateCurrentRequestHeaderValue()),this.parameters.set(g.Fo.X_CLIENT_LAST_TELEM,c.generateLastRequestHeaderValue())}addThrottling(){this.parameters.set(g.Fo.X_MS_LIB_CAPABILITY,g.bb.X_MS_LIB_CAPABILITY_VALUE)}addLogoutHint(c){this.parameters.set(g.Fo.LOGOUT_HINT,encodeURIComponent(c))}createQueryString(){const c=new Array;return this.parameters.forEach((u,d)=>{c.push(`${d}=${u}`)}),c.join("&")}}class Y{static createDiscoveredInstance(c,u,d,y,L,Q,re){return(0,E.Z)(function*(){Q?.addQueueMeasurement(w.Ak.AuthorityFactoryCreateDiscoveredInstance,re);const de=se.transformCIAMAuthority(ie(c)),Te=Y.createInstance(de,u,d,y,L,Q,re);try{return yield _(Te.resolveEndpointsAsync.bind(Te),w.Ak.AuthorityResolveEndpointsAsync,L,Q,re)(),Te}catch{throw(0,B.zP)(q.HO)}})()}static createInstance(c,u,d,y,L,Q,re){if(!c)throw(0,D.ei)(te.To);return new se(c,u,d,y,L,Q,re)}}class I{constructor(c,u){this.config=(0,qr.j6)(c),this.logger=new ei.Y(this.config.loggerOptions,Kn.u,Kn.i),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new vn(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=u}createTokenRequestHeaders(c){const u={};if(u[g.SZ.CONTENT_TYPE]=g.gT.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&c)switch(c.type){case"home_account_id":try{const d=(0,dr.j)(c.credential);u[g.SZ.CCS_HEADER]=`Oid:${d.uid}@${d.utid}`}catch(d){this.logger.verbose("Could not parse home account ID for CCS Header: "+d)}break;case"UPN":u[g.SZ.CCS_HEADER]=`UPN: ${c.credential}`}return u}executePostToTokenEndpoint(c,u,d,y,L,Q){var re=this;return(0,E.Z)(function*(){Q&&re.performanceClient?.addQueueMeasurement(Q,L);const de=yield re.networkManager.sendPostRequest(y,c,{body:u,headers:d});return re.performanceClient?.addFields({refreshTokenSize:de.body.refresh_token?.length||0,httpVerToken:de.headers?.[g.SZ.X_MS_HTTP_VERSION]||""},L),re.config.serverTelemetryManager&&de.status<500&&429!==de.status&&re.config.serverTelemetryManager.clearTelemetryCache(),de})()}updateAuthority(c,u){var d=this;return(0,E.Z)(function*(){d.performanceClient?.addQueueMeasurement(w.Ak.UpdateTokenEndpointAuthority,u);const y=`https://${c}/${d.authority.tenant}/`,L=yield Y.createDiscoveredInstance(y,d.networkClient,d.cacheManager,d.authority.options,d.logger,d.performanceClient,u);d.authority=L})()}createTokenQueryParameters(c){const u=new Oo;return c.tokenQueryParameters&&u.addExtraQueryParameters(c.tokenQueryParameters),u.createQueryString()}}class X{constructor(c,u){this.cryptoUtils=c,this.performanceClient=u}generateCnf(c,u){var d=this;return(0,E.Z)(function*(){d.performanceClient?.addQueueMeasurement(w.Ak.PopTokenGenerateCnf,c.correlationId);const y=yield _(d.generateKid.bind(d),w.Ak.PopTokenGenerateCnf,u,d.performanceClient,c.correlationId)(c),L=d.cryptoUtils.base64Encode(JSON.stringify(y));return{kid:y.kid,reqCnfString:L,reqCnfHash:yield d.cryptoUtils.hashString(L)}})()}generateKid(c){var u=this;return(0,E.Z)(function*(){return u.performanceClient?.addQueueMeasurement(w.Ak.PopTokenGenerateKid,c.correlationId),{kid:yield u.cryptoUtils.getPublicKeyThumbprint(c),xms_ksl:"sw"}})()}signPopToken(c,u,d){var y=this;return(0,E.Z)(function*(){return y.signPayload(c,u,d)})()}signPayload(c,u,d,y){var L=this;return(0,E.Z)(function*(){const{resourceRequestMethod:Q,resourceRequestUri:re,shrClaims:de,shrNonce:Te,shrOptions:Se}=d,gt=(re?new H.G(re):void 0)?.getUrlComponents();return yield L.cryptoUtils.signJwt({at:c,ts:J.I.nowSeconds(),m:Q?.toUpperCase(),u:gt?.HostNameAndPort,nonce:Te||L.cryptoUtils.createNewGuid(),p:gt?.AbsolutePath,q:gt?.QueryString?[[],gt.QueryString]:void 0,client_claims:de||void 0,...y},u,Se,d.correlationId)})()}}class he{constructor(c,u){this.cache=c,this.hasChanged=u}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}class ye{constructor(c,u,d,y,L,Q,re){this.clientId=c,this.cacheStorage=u,this.cryptoObj=d,this.logger=y,this.serializableCache=L,this.persistencePlugin=Q,this.performanceClient=re}validateServerAuthorizationCodeResponse(c,u){if(!c.state||!u)throw(0,B.zP)(q.LV,c.state?"Cached State":"Server State");let d,y;try{d=decodeURIComponent(c.state)}catch{throw(0,B.zP)(q.r8,c.state)}try{y=decodeURIComponent(u)}catch{throw(0,B.zP)(q.r8,c.state)}if(d!==y)throw(0,B.zP)(q.Tu);if(c.error||c.error_description||c.suberror)throw(0,me.Cf)(c.error,c.error_description,c.suberror)?new me.Yo(c.error||"",c.error_description,c.suberror,c.timestamp||"",c.trace_id||"",c.correlation_id||"",c.claims||""):new qn.n(c.error||"",c.error_description,c.suberror)}validateTokenResponse(c,u){if(c.error||c.error_description||c.suberror){const y=new qn.n(c.error,`${c.error_codes} - [${c.timestamp}]: ${c.error_description} - Correlation ID: ${c.correlation_id} - Trace ID: ${c.trace_id}`,c.suberror);if(u&&c.status&&c.status>=g.oj.SERVER_ERROR_RANGE_START&&c.status<=g.oj.SERVER_ERROR_RANGE_END)return void this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.\n${y}`);if(u&&c.status&&c.status>=g.oj.CLIENT_ERROR_RANGE_START&&c.status<=g.oj.CLIENT_ERROR_RANGE_END)return void this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.\n${y}`);throw(0,me.Cf)(c.error,c.error_description,c.suberror)?new me.Yo(c.error,c.error_description,c.suberror,c.timestamp||g.gT.EMPTY_STRING,c.trace_id||g.gT.EMPTY_STRING,c.correlation_id||g.gT.EMPTY_STRING,c.claims||g.gT.EMPTY_STRING):y}}handleServerTokenResponse(c,u,d,y,L,Q,re,de,Te){var Se=this;return(0,E.Z)(function*(){let nt,gt;if(Se.performanceClient?.addQueueMeasurement(w.Ak.HandleServerTokenResponse,c.correlation_id),c.id_token){if(nt=(0,ue.Z_)(c.id_token||g.gT.EMPTY_STRING,Se.cryptoObj.base64Decode),L&&L.nonce&&nt.nonce!==L.nonce)throw(0,B.zP)(q.vR);if(y.maxAge||0===y.maxAge){const En=nt.auth_time;if(!En)throw(0,B.zP)(q.w7);(0,ue.ky)(En,y.maxAge)}}Se.homeAccountIdentifier=De.r.generateHomeAccountId(c.client_info||g.gT.EMPTY_STRING,u.authorityType,Se.logger,Se.cryptoObj,nt),L&&L.state&&(gt=oe.parseRequestState(Se.cryptoObj,L.state)),c.key_id=c.key_id||y.sshKid||void 0;const Bt=Se.generateCacheRecord(c,u,d,y,nt,Q,L);let Un;try{if(Se.persistencePlugin&&Se.serializableCache&&(Se.logger.verbose("Persistence enabled, calling beforeCacheAccess"),Un=new he(Se.serializableCache,!0),yield Se.persistencePlugin.beforeCacheAccess(Un)),re&&!de&&Bt.account){const En=Bt.account.generateAccountKey();if(!Se.cacheStorage.getAccount(En))return Se.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),ye.generateAuthenticationResult(Se.cryptoObj,u,Bt,!1,y,nt,gt,void 0,Te)}yield Se.cacheStorage.saveCacheRecord(Bt,y.storeInCache)}finally{Se.persistencePlugin&&Se.serializableCache&&Un&&(Se.logger.verbose("Persistence enabled, calling afterCacheAccess"),yield Se.persistencePlugin.afterCacheAccess(Un))}return ye.generateAuthenticationResult(Se.cryptoObj,u,Bt,!1,y,nt,gt,c,Te)})()}generateCacheRecord(c,u,d,y,L,Q,re){const de=u.getPreferredCache();if(!de)throw(0,B.zP)(q.Q9);let Te,Se;c.id_token&&L&&(Te=(0,Be.Md)(this.homeAccountIdentifier,de,c.id_token,this.clientId,L.tid||""),Se=De.r.createAccount({homeAccountId:this.homeAccountIdentifier,idTokenClaims:L,clientInfo:c.client_info,cloudGraphHostName:re?.cloud_graph_host_name,msGraphHost:re?.msgraph_host},u));let nt=null;if(c.access_token){const Un=c.scope?Fn.i.fromString(c.scope):new Fn.i(y.scopes||[]),En=("string"==typeof c.expires_in?parseInt(c.expires_in,10):c.expires_in)||0,Ir=("string"==typeof c.ext_expires_in?parseInt(c.ext_expires_in,10):c.ext_expires_in)||0,hr=("string"==typeof c.refresh_in?parseInt(c.refresh_in,10):c.refresh_in)||void 0,ii=d+En,Ni=ii+Ir,mt=hr&&hr>0?d+hr:void 0;nt=(0,Be.Ds)(this.homeAccountIdentifier,de,c.access_token,this.clientId,L?.tid||u.tenant,Un.printScopes(),ii,Ni,this.cryptoObj.base64Decode,mt,c.token_type,Q,c.key_id,y.claims,y.requestedClaimsHash)}let gt=null;c.refresh_token&&(gt=(0,Be.OJ)(this.homeAccountIdentifier,de,c.refresh_token,this.clientId,c.foci,Q));let Bt=null;return c.foci&&(Bt=ze.createAppMetadataEntity(this.clientId,de,c.foci)),new m(Se,Te,nt,gt,Bt)}static generateAuthenticationResult(c,u,d,y,L,Q,re,de,Te){return(0,E.Z)(function*(){let Bt,Un,Se=g.gT.EMPTY_STRING,nt=[],gt=null,En=g.gT.EMPTY_STRING;if(d.accessToken){if(d.accessToken.tokenType===g.hO.POP){const Ni=new X(c),{secret:mt,keyId:ps}=d.accessToken;if(!ps)throw(0,B.zP)(q.Of);Se=yield Ni.signPopToken(mt,ps,L)}else Se=d.accessToken.secret;nt=Fn.i.fromString(d.accessToken.target).asArray(),gt=new Date(1e3*Number(d.accessToken.expiresOn)),Bt=new Date(1e3*Number(d.accessToken.extendedExpiresOn)),d.accessToken.refreshOn&&(Un=new Date(1e3*Number(d.accessToken.refreshOn)))}d.appMetadata&&(En=d.appMetadata.familyId===g.ch?g.ch:"");const Ir=Q?.oid||Q?.sub||"",hr=Q?.tid||"";de?.spa_accountid&&d.account&&(d.account.nativeAccountId=de?.spa_accountid);const ii=d.account?{...d.account.getAccountInfo(),idTokenClaims:Q}:null;return{authority:u.canonicalAuthority,uniqueId:Ir,tenantId:hr,scopes:nt,account:ii,idToken:d?.idToken?.secret||"",idTokenClaims:Q||{},accessToken:Se,fromCache:y,expiresOn:gt,extExpiresOn:Bt,refreshOn:Un,correlationId:L.correlationId,requestId:Te||g.gT.EMPTY_STRING,familyId:En,tokenType:d.accessToken?.tokenType||g.gT.EMPTY_STRING,state:re?re.userRequestState:g.gT.EMPTY_STRING,cloudGraphHostName:d.account?.cloudGraphHostName||g.gT.EMPTY_STRING,msGraphHost:d.account?.msGraphHost||g.gT.EMPTY_STRING,code:de?.spa_code,fromNativeBroker:!1}})()}}class Oe extends I{constructor(c,u){super(c,u),this.includeRedirectUri=!0,this.oidcDefaultScopes=this.config.authOptions.authority.options.OIDCOptions?.defaultScopes}getAuthCodeUrl(c){var u=this;return(0,E.Z)(function*(){u.performanceClient?.addQueueMeasurement(w.Ak.GetAuthCodeUrl,c.correlationId);const d=yield _(u.createAuthCodeUrlQueryString.bind(u),w.Ak.AuthClientCreateQueryString,u.logger,u.performanceClient,c.correlationId)(c);return H.G.appendQueryString(u.authority.authorizationEndpoint,d)})()}acquireToken(c,u){var d=this;return(0,E.Z)(function*(){if(d.performanceClient?.addQueueMeasurement(w.Ak.AuthClientAcquireToken,c.correlationId),!c.code)throw(0,B.zP)(q.FU);const y=J.I.nowSeconds(),L=yield _(d.executeTokenRequest.bind(d),w.Ak.AuthClientExecuteTokenRequest,d.logger,d.performanceClient,c.correlationId)(d.authority,c),Q=L.headers?.[g.SZ.X_MS_REQUEST_ID],re=new ye(d.config.authOptions.clientId,d.cacheManager,d.cryptoUtils,d.logger,d.config.serializableCache,d.config.persistencePlugin,d.performanceClient);return re.validateTokenResponse(L.body),_(re.handleServerTokenResponse.bind(re),w.Ak.HandleServerTokenResponse,d.logger,d.performanceClient,c.correlationId)(L.body,d.authority,y,c,u,void 0,void 0,void 0,Q)})()}handleFragmentResponse(c,u){if(new ye(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null).validateServerAuthorizationCodeResponse(c,u),!c.code)throw(0,B.zP)(q.Zv);return c}getLogoutUri(c){if(!c)throw(0,D.ei)(te.$h);const u=this.createLogoutUrlQueryString(c);return H.G.appendQueryString(this.authority.endSessionEndpoint,u)}executeTokenRequest(c,u){var d=this;return(0,E.Z)(function*(){d.performanceClient?.addQueueMeasurement(w.Ak.AuthClientExecuteTokenRequest,u.correlationId);const y=d.createTokenQueryParameters(u),L=H.G.appendQueryString(c.tokenEndpoint,y),Q=yield _(d.createTokenRequestBody.bind(d),w.Ak.AuthClientCreateTokenRequestBody,d.logger,d.performanceClient,u.correlationId)(u);let re;if(u.clientInfo)try{const Se=(0,dr.B)(u.clientInfo,d.cryptoUtils);re={credential:`${Se.uid}${g.Bv.CLIENT_INFO_SEPARATOR}${Se.utid}`,type:"home_account_id"}}catch(Se){d.logger.verbose("Could not parse client info for CCS Header: "+Se)}const de=d.createTokenRequestHeaders(re||u.ccsCredential),Te={clientId:u.tokenBodyParameters?.clientId||d.config.authOptions.clientId,authority:c.canonicalAuthority,scopes:u.scopes,claims:u.claims,authenticationScheme:u.authenticationScheme,resourceRequestMethod:u.resourceRequestMethod,resourceRequestUri:u.resourceRequestUri,shrClaims:u.shrClaims,sshKid:u.sshKid};return _(d.executePostToTokenEndpoint.bind(d),w.Ak.AuthorizationCodeClientExecutePostToTokenEndpoint,d.logger,d.performanceClient,u.correlationId)(L,Q,de,Te,u.correlationId,w.Ak.AuthorizationCodeClientExecutePostToTokenEndpoint)})()}createTokenRequestBody(c){var u=this;return(0,E.Z)(function*(){u.performanceClient?.addQueueMeasurement(w.Ak.AuthClientCreateTokenRequestBody,c.correlationId);const d=new Oo;if(d.addClientId(c.tokenBodyParameters?.[g.Fo.CLIENT_ID]||u.config.authOptions.clientId),u.includeRedirectUri?d.addRedirectUri(c.redirectUri):Cn.validateRedirectUri(c.redirectUri),d.addScopes(c.scopes,!0,u.oidcDefaultScopes),d.addAuthorizationCode(c.code),d.addLibraryInfo(u.config.libraryInfo),d.addApplicationTelemetry(u.config.telemetry.application),d.addThrottling(),u.serverTelemetryManager&&!(0,qr.lh)(u.config)&&d.addServerTelemetry(u.serverTelemetryManager),c.codeVerifier&&d.addCodeVerifier(c.codeVerifier),u.config.clientCredentials.clientSecret&&d.addClientSecret(u.config.clientCredentials.clientSecret),u.config.clientCredentials.clientAssertion){const Q=u.config.clientCredentials.clientAssertion;d.addClientAssertion(Q.assertion),d.addClientAssertionType(Q.assertionType)}if(d.addGrantType(g.qJ.AUTHORIZATION_CODE_GRANT),d.addClientInfo(),c.authenticationScheme===g.hO.POP){const Q=new X(u.cryptoUtils,u.performanceClient),re=yield _(Q.generateCnf.bind(Q),w.Ak.PopTokenGenerateCnf,u.logger,u.performanceClient,c.correlationId)(c,u.logger);d.addPopToken(re.reqCnfString)}else if(c.authenticationScheme===g.hO.SSH){if(!c.sshJwk)throw(0,D.ei)(te.dK);d.addSshJwk(c.sshJwk)}const y=c.correlationId||u.config.cryptoInterface.createNewGuid();let L;if(d.addCorrelationId(y),(!G.x.isEmptyObj(c.claims)||u.config.authOptions.clientCapabilities&&u.config.authOptions.clientCapabilities.length>0)&&d.addClaims(c.claims,u.config.authOptions.clientCapabilities),c.clientInfo)try{const Q=(0,dr.B)(c.clientInfo,u.cryptoUtils);L={credential:`${Q.uid}${g.Bv.CLIENT_INFO_SEPARATOR}${Q.utid}`,type:"home_account_id"}}catch(Q){u.logger.verbose("Could not parse client info for CCS Header: "+Q)}else L=c.ccsCredential;if(u.config.systemOptions.preventCorsPreflight&&L)switch(L.type){case"home_account_id":try{const Q=(0,dr.j)(L.credential);d.addCcsOid(Q)}catch(Q){u.logger.verbose("Could not parse home account ID for CCS Header: "+Q)}break;case"UPN":d.addCcsUpn(L.credential)}return c.tokenBodyParameters&&d.addExtraQueryParameters(c.tokenBodyParameters),c.enableSpaAuthorizationCode&&(!c.tokenBodyParameters||!c.tokenBodyParameters[g.Fo.RETURN_SPA_CODE])&&d.addExtraQueryParameters({[g.Fo.RETURN_SPA_CODE]:"1"}),d.createQueryString()})()}createAuthCodeUrlQueryString(c){var u=this;return(0,E.Z)(function*(){u.performanceClient?.addQueueMeasurement(w.Ak.AuthClientCreateQueryString,c.correlationId);const d=new Oo;d.addClientId(c.extraQueryParameters?.[g.Fo.CLIENT_ID]||u.config.authOptions.clientId);const y=[...c.scopes||[],...c.extraScopesToConsent||[]];d.addScopes(y,!0,u.oidcDefaultScopes),d.addRedirectUri(c.redirectUri);const L=c.correlationId||u.config.cryptoInterface.createNewGuid();if(d.addCorrelationId(L),d.addResponseMode(c.responseMode),d.addResponseTypeCode(),d.addLibraryInfo(u.config.libraryInfo),(0,qr.lh)(u.config)||d.addApplicationTelemetry(u.config.telemetry.application),d.addClientInfo(),c.codeChallenge&&c.codeChallengeMethod&&d.addCodeChallengeParams(c.codeChallenge,c.codeChallengeMethod),c.prompt&&d.addPrompt(c.prompt),c.domainHint&&d.addDomainHint(c.domainHint),c.prompt!==g.NJ.SELECT_ACCOUNT)if(c.sid&&c.prompt===g.NJ.NONE)u.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),d.addSid(c.sid);else if(c.account){const Q=u.extractAccountSid(c.account),re=u.extractLoginHint(c.account);if(re){u.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),d.addLoginHint(re);try{const de=(0,dr.j)(c.account.homeAccountId);d.addCcsOid(de)}catch{u.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(Q&&c.prompt===g.NJ.NONE){u.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),d.addSid(Q);try{const de=(0,dr.j)(c.account.homeAccountId);d.addCcsOid(de)}catch{u.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(c.loginHint)u.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),d.addLoginHint(c.loginHint),d.addCcsUpn(c.loginHint);else if(c.account.username){u.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),d.addLoginHint(c.account.username);try{const de=(0,dr.j)(c.account.homeAccountId);d.addCcsOid(de)}catch{u.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else c.loginHint&&(u.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),d.addLoginHint(c.loginHint),d.addCcsUpn(c.loginHint));else u.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");if(c.nonce&&d.addNonce(c.nonce),c.state&&d.addState(c.state),(c.claims||u.config.authOptions.clientCapabilities&&u.config.authOptions.clientCapabilities.length>0)&&d.addClaims(c.claims,u.config.authOptions.clientCapabilities),c.extraQueryParameters&&d.addExtraQueryParameters(c.extraQueryParameters),c.nativeBroker&&(d.addNativeBroker(),c.authenticationScheme===g.hO.POP)){const Q=new X(u.cryptoUtils),re=yield _(Q.generateCnf.bind(Q),w.Ak.PopTokenGenerateCnf,u.logger,u.performanceClient,c.correlationId)(c,u.logger);d.addPopToken(re.reqCnfHash)}return d.createQueryString()})()}createLogoutUrlQueryString(c){const u=new Oo;return c.postLogoutRedirectUri&&u.addPostLogoutRedirectUri(c.postLogoutRedirectUri),c.correlationId&&u.addCorrelationId(c.correlationId),c.idTokenHint&&u.addIdTokenHint(c.idTokenHint),c.state&&u.addState(c.state),c.logoutHint&&u.addLogoutHint(c.logoutHint),c.extraQueryParameters&&u.addExtraQueryParameters(c.extraQueryParameters),u.createQueryString()}extractAccountSid(c){return c.idTokenClaims?.sid||null}extractLoginHint(c){return c.idTokenClaims?.login_hint||null}}class dt{constructor(c,u){this.cacheOutcome=g.To.NOT_APPLICABLE,this.cacheManager=u,this.apiId=c.apiId,this.correlationId=c.correlationId,this.wrapperSKU=c.wrapperSKU||g.gT.EMPTY_STRING,this.wrapperVer=c.wrapperVer||g.gT.EMPTY_STRING,this.telemetryCacheKey=g.HN.CACHE_KEY+g.Bv.CACHE_KEY_SEPARATOR+c.clientId}generateCurrentRequestHeaderValue(){const c=`${this.apiId}${g.HN.VALUE_SEPARATOR}${this.cacheOutcome}`,u=[this.wrapperSKU,this.wrapperVer].join(g.HN.VALUE_SEPARATOR),y=[c,this.getRegionDiscoveryFields()].join(g.HN.VALUE_SEPARATOR);return[g.HN.SCHEMA_VERSION,y,u].join(g.HN.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const c=this.getLastRequests(),u=dt.maxErrorsToSend(c),d=c.failedRequests.slice(0,2*u).join(g.HN.VALUE_SEPARATOR),y=c.errors.slice(0,u).join(g.HN.VALUE_SEPARATOR),L=c.errors.length,re=[L,u<L?g.HN.OVERFLOW_TRUE:g.HN.OVERFLOW_FALSE].join(g.HN.VALUE_SEPARATOR);return[g.HN.SCHEMA_VERSION,c.cacheHits,d,y,re].join(g.HN.CATEGORY_SEPARATOR)}cacheFailedRequest(c){const u=this.getLastRequests();u.errors.length>=g.HN.MAX_CACHED_ERRORS&&(u.failedRequests.shift(),u.failedRequests.shift(),u.errors.shift()),u.failedRequests.push(this.apiId,this.correlationId),c instanceof Error&&c&&c.toString()?u.errors.push(c instanceof U.l4?c.subError?c.subError:c.errorCode?c.errorCode:c.toString():c.toString()):u.errors.push(g.HN.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,u)}incrementCacheHits(){const c=this.getLastRequests();return c.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,c),c.cacheHits}getLastRequests(){return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||{failedRequests:[],errors:[],cacheHits:0}}clearTelemetryCache(){const c=this.getLastRequests(),u=dt.maxErrorsToSend(c);if(u===c.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{const y={failedRequests:c.failedRequests.slice(2*u),errors:c.errors.slice(u),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,y)}}static maxErrorsToSend(c){let u,d=0,y=0;const L=c.errors.length;for(u=0;u<L;u++){const re=c.failedRequests[2*u+1]||g.gT.EMPTY_STRING,de=c.errors[u]||g.gT.EMPTY_STRING;if(y+=(c.failedRequests[2*u]||g.gT.EMPTY_STRING).toString().length+re.toString().length+de.length+3,!(y<g.HN.MAX_LAST_HEADER_BYTES))break;d+=1}return d}getRegionDiscoveryFields(){const c=[];return c.push(this.regionUsed||g.gT.EMPTY_STRING),c.push(this.regionSource||g.gT.EMPTY_STRING),c.push(this.regionOutcome||g.gT.EMPTY_STRING),c.join(",")}updateRegionDiscoveryMetadata(c){this.regionUsed=c.region_used,this.regionSource=c.region_source,this.regionOutcome=c.region_outcome}setCacheOutcome(c){this.cacheOutcome=c}}var Kt=S(7580),wt=S(2690);class Gt{constructor(c,u,d,y,L,Q,re,de,Te){this.config=c,this.browserStorage=u,this.browserCrypto=d,this.networkClient=this.config.system.networkClient,this.eventHandler=L,this.navigationClient=Q,this.nativeMessageHandler=de,this.correlationId=Te||(0,wt.nn)(),this.logger=y.clone(N.qx.MSAL_SKU,Kt.i,this.correlationId),this.performanceClient=re}clearCacheOnLogout(c){var u=this;return(0,E.Z)(function*(){if(c){De.r.accountInfoIsEqual(c,u.browserStorage.getActiveAccount(),!1)&&(u.logger.verbose("Setting active account to null"),u.browserStorage.setActiveAccount(null));try{yield u.browserStorage.removeAccount(De.r.generateAccountCacheKey(c)),u.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch{u.logger.error("Account provided in logout request was not found. Local cache unchanged.")}}else try{u.logger.verbose("No account provided in logout request, clearing all cache items.",u.correlationId),yield u.browserStorage.clear(),yield u.browserCrypto.clearKeystore()}catch{u.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}})()}initializeBaseRequest(c,u){var d=this;return(0,E.Z)(function*(){d.performanceClient.addQueueMeasurement(w.Ak.InitializeBaseRequest,d.correlationId);const y=c.authority||d.config.auth.authority;u&&(yield d.validateRequestAuthority(y,u));const L=[...c&&c.scopes||[]],Q={...c,correlationId:d.correlationId,authority:y,scopes:L};if(Q.authenticationScheme){if(Q.authenticationScheme===g.hO.SSH){if(!c.sshJwk)throw(0,D.ei)(te.dK);if(!c.sshKid)throw(0,D.ei)(te.hI)}d.logger.verbose(`Authentication Scheme set to "${Q.authenticationScheme}" as configured in Auth request`)}else Q.authenticationScheme=g.hO.BEARER,d.logger.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return d.config.cache.claimsBasedCachingEnabled&&c.claims&&!G.x.isEmptyObj(c.claims)&&(Q.requestedClaimsHash=yield d.browserCrypto.hashString(c.claims)),Q})()}getRedirectUri(c){this.logger.verbose("getRedirectUri called");const u=c||this.config.auth.redirectUri||(0,ut.Re)();return H.G.getAbsoluteUrl(u,(0,ut.Re)())}validateRequestAuthority(c,u){var d=this;return(0,E.Z)(function*(){if(!(yield d.getDiscoveredAuthority(c)).isAlias(u.environment))throw(0,D.ei)(te.Hv)})()}initializeServerTelemetryManager(c,u){this.logger.verbose("initializeServerTelemetryManager called");const d={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:c,forceRefresh:u||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new dt(d,this.browserStorage)}getDiscoveredAuthority(c){var u=this;return(0,E.Z)(function*(){u.logger.verbose("getDiscoveredAuthority called");const d={protocolMode:u.config.auth.protocolMode,OIDCOptions:u.config.auth.OIDCOptions,knownAuthorities:u.config.auth.knownAuthorities,cloudDiscoveryMetadata:u.config.auth.cloudDiscoveryMetadata,authorityMetadata:u.config.auth.authorityMetadata};return c?(u.logger.verbose("Creating discovered authority with request authority"),yield Y.createDiscoveredInstance(c,u.config.system.networkClient,u.browserStorage,d,u.logger)):(u.logger.verbose("Creating discovered authority with configured authority"),yield Y.createDiscoveredInstance(u.config.auth.authority,u.config.system.networkClient,u.browserStorage,d,u.logger))})()}}const St=32;function hf(ke,c,u){return hs.apply(this,arguments)}function hs(){return(hs=(0,E.Z)(function*(ke,c,u){ke.addQueueMeasurement(w.Ak.GeneratePkceCodes,u);const d=j(Hl,w.Ak.GenerateCodeVerifier,c,ke,u)(ke,c,u);return{verifier:d,challenge:yield _(ff,w.Ak.GenerateCodeChallengeFromVerifier,c,ke,u)(d,ke,c,u)}})).apply(this,arguments)}function Hl(ke,c,u){try{const d=new Uint8Array(St);return j(wt.PP,w.Ak.GetRandomValues,c,ke,u)(d),(0,ft.Wy)(d)}catch{throw(0,T.Z_)(Ge.vD)}}function ff(ke,c,u,d){return Ba.apply(this,arguments)}function Ba(){return(Ba=(0,E.Z)(function*(ke,c,u,d){c.addQueueMeasurement(w.Ak.GenerateCodeChallengeFromVerifier,d);try{const y=yield _(wt.Fv,w.Ak.Sha256Digest,u,c,d)(ke,c,d);return(0,ft.Wy)(new Uint8Array(y))}catch{throw(0,T.Z_)(Ge.vD)}})).apply(this,arguments)}class ti extends Gt{initializeAuthorizationCodeRequest(c){var u=this;return(0,E.Z)(function*(){u.performanceClient.addQueueMeasurement(w.Ak.StandardInteractionClientInitializeAuthorizationCodeRequest,u.correlationId);const d=yield _(hf,w.Ak.GeneratePkceCodes,u.logger,u.performanceClient,u.correlationId)(u.performanceClient,u.logger,u.correlationId),y={...c,redirectUri:c.redirectUri,code:g.gT.EMPTY_STRING,codeVerifier:d.verifier};return c.codeChallenge=d.challenge,c.codeChallengeMethod=g.gT.S256_CODE_CHALLENGE_METHOD,y})()}initializeLogoutRequest(c){this.logger.verbose("initializeLogoutRequest called",c?.correlationId);const u={correlationId:this.correlationId||(0,wt.nn)(),...c};if(c)if(c.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(c.account){const d=this.getLogoutHintFromIdTokenClaims(c.account);d&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),u.logoutHint=d)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return c&&null===c.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",u.correlationId):c&&c.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",u.correlationId),u.postLogoutRedirectUri=H.G.getAbsoluteUrl(c.postLogoutRedirectUri,(0,ut.Re)())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",u.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",u.correlationId),u.postLogoutRedirectUri=H.G.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,(0,ut.Re)())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",u.correlationId),u.postLogoutRedirectUri=H.G.getAbsoluteUrl((0,ut.Re)(),(0,ut.Re)())),u}getLogoutHintFromIdTokenClaims(c){const u=c.idTokenClaims;if(u){if(u.login_hint)return u.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}createAuthCodeClient(c,u,d){var y=this;return(0,E.Z)(function*(){y.performanceClient.addQueueMeasurement(w.Ak.StandardInteractionClientCreateAuthCodeClient,y.correlationId);const L=yield _(y.getClientConfiguration.bind(y),w.Ak.StandardInteractionClientGetClientConfiguration,y.logger,y.performanceClient,y.correlationId)(c,u,d);return new Oe(L,y.performanceClient)})()}getClientConfiguration(c,u,d){var y=this;return(0,E.Z)(function*(){y.performanceClient.addQueueMeasurement(w.Ak.StandardInteractionClientGetClientConfiguration,y.correlationId);const L=yield _(y.getDiscoveredAuthority.bind(y),w.Ak.StandardInteractionClientGetDiscoveredAuthority,y.logger,y.performanceClient,y.correlationId)(u,d),Q=y.config.system.loggerOptions;return{authOptions:{clientId:y.config.auth.clientId,authority:L,clientCapabilities:y.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:y.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:Q.loggerCallback,piiLoggingEnabled:Q.piiLoggingEnabled,logLevel:Q.logLevel,correlationId:y.correlationId},cacheOptions:{claimsBasedCachingEnabled:y.config.cache.claimsBasedCachingEnabled},cryptoInterface:y.browserCrypto,networkInterface:y.networkClient,storageInterface:y.browserStorage,serverTelemetryManager:c,libraryInfo:{sku:N.qx.MSAL_SKU,version:Kt.i,cpu:g.gT.EMPTY_STRING,os:g.gT.EMPTY_STRING},telemetry:y.config.telemetry}})()}getDiscoveredAuthority(c,u){var d=this;return(0,E.Z)(function*(){d.performanceClient.addQueueMeasurement(w.Ak.StandardInteractionClientGetDiscoveredAuthority,d.correlationId);const y={protocolMode:d.config.auth.protocolMode,OIDCOptions:d.config.auth.OIDCOptions,knownAuthorities:d.config.auth.knownAuthorities,cloudDiscoveryMetadata:d.config.auth.cloudDiscoveryMetadata,authorityMetadata:d.config.auth.authorityMetadata,skipAuthorityMetadataCache:d.config.auth.skipAuthorityMetadataCache},Q=se.generateAuthority(c||d.config.auth.authority,u||d.config.auth.azureCloudOptions);return yield _(Y.createDiscoveredInstance.bind(Y),w.Ak.AuthorityFactoryCreateDiscoveredInstance,d.logger,d.performanceClient,d.correlationId)(Q,d.config.system.networkClient,d.browserStorage,y,d.logger,d.performanceClient,d.correlationId)})()}initializeAuthorizationRequest(c,u){var d=this;return(0,E.Z)(function*(){d.performanceClient.addQueueMeasurement(w.Ak.StandardInteractionClientInitializeAuthorizationRequest,d.correlationId);const y=d.getRedirectUri(c.redirectUri),Q=oe.setRequestState(d.browserCrypto,c&&c.state||g.gT.EMPTY_STRING,{interactionType:u}),de={...yield _(d.initializeBaseRequest.bind(d),w.Ak.InitializeBaseRequest,d.logger,d.performanceClient,d.correlationId)(c),redirectUri:y,state:Q,nonce:c.nonce||(0,wt.nn)(),responseMode:d.config.auth.OIDCOptions.serverResponseType},Te=c.account||d.browserStorage.getActiveAccount();if(Te&&(d.logger.verbose("Setting validated request account",d.correlationId),d.logger.verbosePii(`Setting validated request account: ${Te.homeAccountId}`,d.correlationId),de.account=Te),!de.loginHint&&!Te){const Se=d.browserStorage.getLegacyLoginHint();Se&&(de.loginHint=Se)}return de})()}}var $l=S(8012);const zl="user_switch",br={[zl]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class Kr extends U.l4{constructor(c,u,d){super(c,u),Object.setPrototypeOf(this,Kr.prototype),this.name="NativeAuthError",this.ext=d}}function ni(ke){return!!(ke.ext&&ke.ext.status&&("PERSISTENT_ERROR"===ke.ext.status||"DISABLED"===ke.ext.status)||ke.ext&&ke.ext.error&&-2147186943===ke.ext.error)||"ContentError"===ke.errorCode}function Mt(ke,c,u){if(u&&u.status)switch(u.status){case"ACCOUNT_UNAVAILABLE":return(0,me.ip)(Ee.QP);case"USER_INTERACTION_REQUIRED":return new me.Yo(ke,c);case"USER_CANCEL":return(0,T.Z_)(Ge.h7);case"NO_NETWORK":return(0,T.Z_)(Ge.Mq)}return new Kr(ke,br[ke]||c,u)}class ri extends I{constructor(c,u){super(c,u)}acquireToken(c){var u=this;return(0,E.Z)(function*(){u.performanceClient?.addQueueMeasurement(w.Ak.RefreshTokenClientAcquireToken,c.correlationId);const d=J.I.nowSeconds(),y=yield _(u.executeTokenRequest.bind(u),w.Ak.RefreshTokenClientExecuteTokenRequest,u.logger,u.performanceClient,c.correlationId)(c,u.authority),L=y.headers?.[g.SZ.X_MS_REQUEST_ID],Q=new ye(u.config.authOptions.clientId,u.cacheManager,u.cryptoUtils,u.logger,u.config.serializableCache,u.config.persistencePlugin);return Q.validateTokenResponse(y.body),_(Q.handleServerTokenResponse.bind(Q),w.Ak.HandleServerTokenResponse,u.logger,u.performanceClient,c.correlationId)(y.body,u.authority,d,c,void 0,void 0,!0,c.forceCache,L)})()}acquireTokenByRefreshToken(c){var u=this;return(0,E.Z)(function*(){if(!c)throw(0,D.ei)(te.dL);if(u.performanceClient?.addQueueMeasurement(w.Ak.RefreshTokenClientAcquireTokenByRefreshToken,c.correlationId),!c.account)throw(0,B.zP)(q.D7);if(u.cacheManager.isAppMetadataFOCI(c.account.environment))try{return _(u.acquireTokenWithCachedRefreshToken.bind(u),w.Ak.RefreshTokenClientAcquireTokenWithCachedRefreshToken,u.logger,u.performanceClient,c.correlationId)(c,!0)}catch(y){if(y instanceof me.Yo&&y.errorCode===Ee.I2||y instanceof qn.n&&y.errorCode===g.D1.INVALID_GRANT_ERROR&&y.subError===g.D1.CLIENT_MISMATCH_ERROR)return _(u.acquireTokenWithCachedRefreshToken.bind(u),w.Ak.RefreshTokenClientAcquireTokenWithCachedRefreshToken,u.logger,u.performanceClient,c.correlationId)(c,!1);throw y}return _(u.acquireTokenWithCachedRefreshToken.bind(u),w.Ak.RefreshTokenClientAcquireTokenWithCachedRefreshToken,u.logger,u.performanceClient,c.correlationId)(c,!1)})()}acquireTokenWithCachedRefreshToken(c,u){var d=this;return(0,E.Z)(function*(){d.performanceClient?.addQueueMeasurement(w.Ak.RefreshTokenClientAcquireTokenWithCachedRefreshToken,c.correlationId);const y=j(d.cacheManager.getRefreshToken.bind(d.cacheManager),w.Ak.CacheManagerGetRefreshToken,d.logger,d.performanceClient,c.correlationId)(c.account,u,void 0,d.performanceClient,c.correlationId);if(!y)throw(0,me.ip)(Ee.I2);const L={...c,refreshToken:y.secret,authenticationScheme:c.authenticationScheme||g.hO.BEARER,ccsCredential:{credential:c.account.homeAccountId,type:"home_account_id"}};return _(d.acquireToken.bind(d),w.Ak.RefreshTokenClientAcquireToken,d.logger,d.performanceClient,c.correlationId)(L)})()}executeTokenRequest(c,u){var d=this;return(0,E.Z)(function*(){d.performanceClient?.addQueueMeasurement(w.Ak.RefreshTokenClientExecuteTokenRequest,c.correlationId);const y=d.createTokenQueryParameters(c),L=H.G.appendQueryString(u.tokenEndpoint,y),Q=yield _(d.createTokenRequestBody.bind(d),w.Ak.RefreshTokenClientCreateTokenRequestBody,d.logger,d.performanceClient,c.correlationId)(c),re=d.createTokenRequestHeaders(c.ccsCredential),de={clientId:c.tokenBodyParameters?.clientId||d.config.authOptions.clientId,authority:u.canonicalAuthority,scopes:c.scopes,claims:c.claims,authenticationScheme:c.authenticationScheme,resourceRequestMethod:c.resourceRequestMethod,resourceRequestUri:c.resourceRequestUri,shrClaims:c.shrClaims,sshKid:c.sshKid};return _(d.executePostToTokenEndpoint.bind(d),w.Ak.RefreshTokenClientExecutePostToTokenEndpoint,d.logger,d.performanceClient,c.correlationId)(L,Q,re,de,c.correlationId,w.Ak.RefreshTokenClientExecutePostToTokenEndpoint)})()}createTokenRequestBody(c){var u=this;return(0,E.Z)(function*(){u.performanceClient?.addQueueMeasurement(w.Ak.RefreshTokenClientCreateTokenRequestBody,c.correlationId);const d=c.correlationId,y=new Oo;if(y.addClientId(c.tokenBodyParameters?.[g.Fo.CLIENT_ID]||u.config.authOptions.clientId),c.redirectUri&&y.addRedirectUri(c.redirectUri),y.addScopes(c.scopes,!0,u.config.authOptions.authority.options.OIDCOptions?.defaultScopes),y.addGrantType(g.qJ.REFRESH_TOKEN_GRANT),y.addClientInfo(),y.addLibraryInfo(u.config.libraryInfo),y.addApplicationTelemetry(u.config.telemetry.application),y.addThrottling(),u.serverTelemetryManager&&!(0,qr.lh)(u.config)&&y.addServerTelemetry(u.serverTelemetryManager),y.addCorrelationId(d),y.addRefreshToken(c.refreshToken),u.config.clientCredentials.clientSecret&&y.addClientSecret(u.config.clientCredentials.clientSecret),u.config.clientCredentials.clientAssertion){const L=u.config.clientCredentials.clientAssertion;y.addClientAssertion(L.assertion),y.addClientAssertionType(L.assertionType)}if(c.authenticationScheme===g.hO.POP){const L=new X(u.cryptoUtils,u.performanceClient),Q=yield _(L.generateCnf.bind(L),w.Ak.PopTokenGenerateCnf,u.logger,u.performanceClient,c.correlationId)(c,u.logger);y.addPopToken(Q.reqCnfString)}else if(c.authenticationScheme===g.hO.SSH){if(!c.sshJwk)throw(0,D.ei)(te.dK);y.addSshJwk(c.sshJwk)}if((!G.x.isEmptyObj(c.claims)||u.config.authOptions.clientCapabilities&&u.config.authOptions.clientCapabilities.length>0)&&y.addClaims(c.claims,u.config.authOptions.clientCapabilities),u.config.systemOptions.preventCorsPreflight&&c.ccsCredential)switch(c.ccsCredential.type){case"home_account_id":try{const L=(0,dr.j)(c.ccsCredential.credential);y.addCcsOid(L)}catch(L){u.logger.verbose("Could not parse home account ID for CCS Header: "+L)}break;case"UPN":y.addCcsUpn(c.ccsCredential.credential)}return c.tokenBodyParameters&&y.addExtraQueryParameters(c.tokenBodyParameters),y.createQueryString()})()}}class un extends I{constructor(c,u){super(c,u)}acquireToken(c){var u=this;return(0,E.Z)(function*(){try{const[d,y]=yield u.acquireCachedToken(c);return y===g.To.PROACTIVELY_REFRESHED&&(u.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed."),new ri(u.config,u.performanceClient).acquireTokenByRefreshToken(c).catch(()=>{})),d}catch(d){if(d instanceof B.er&&d.errorCode===q.s$)return new ri(u.config,u.performanceClient).acquireTokenByRefreshToken(c);throw d}})()}acquireCachedToken(c){var u=this;return(0,E.Z)(function*(){u.performanceClient?.addQueueMeasurement(w.Ak.SilentFlowClientAcquireCachedToken,c.correlationId);let d=g.To.NOT_APPLICABLE;if(c.forceRefresh||!u.config.cacheOptions.claimsBasedCachingEnabled&&!G.x.isEmptyObj(c.claims))throw u.setCacheOutcome(g.To.FORCE_REFRESH_OR_CLAIMS,c.correlationId),(0,B.zP)(q.s$);if(!c.account)throw(0,B.zP)(q.D7);const y=c.authority||u.authority.getPreferredCache(),L=u.cacheManager.readCacheRecord(c.account,c,y,u.performanceClient,c.correlationId);if(!L.accessToken)throw u.setCacheOutcome(g.To.NO_CACHED_ACCESS_TOKEN,c.correlationId),(0,B.zP)(q.s$);if(J.I.wasClockTurnedBack(L.accessToken.cachedAt)||J.I.isTokenExpired(L.accessToken.expiresOn,u.config.systemOptions.tokenRenewalOffsetSeconds))throw u.setCacheOutcome(g.To.CACHED_ACCESS_TOKEN_EXPIRED,c.correlationId),(0,B.zP)(q.s$);return L.accessToken.refreshOn&&J.I.isTokenExpired(L.accessToken.refreshOn,0)&&(d=g.To.PROACTIVELY_REFRESHED),u.setCacheOutcome(d,c.correlationId),u.config.serverTelemetryManager&&u.config.serverTelemetryManager.incrementCacheHits(),[yield _(u.generateResultFromCacheRecord.bind(u),w.Ak.SilentFlowClientGenerateResultFromCacheRecord,u.logger,u.performanceClient,c.correlationId)(L,c),d]})()}setCacheOutcome(c,u){this.serverTelemetryManager?.setCacheOutcome(c),this.performanceClient?.addFields({cacheOutcome:c},u),c!==g.To.NOT_APPLICABLE&&this.logger.info(`Token refresh is required due to cache outcome: ${c}`)}generateResultFromCacheRecord(c,u){var d=this;return(0,E.Z)(function*(){let y;if(d.performanceClient?.addQueueMeasurement(w.Ak.SilentFlowClientGenerateResultFromCacheRecord,u.correlationId),c.idToken&&(y=(0,ue.Z_)(c.idToken.secret,d.config.cryptoInterface.base64Decode)),u.maxAge||0===u.maxAge){const L=y?.auth_time;if(!L)throw(0,B.zP)(q.w7);(0,ue.ky)(L,u.maxAge)}return yield ye.generateAuthenticationResult(d.cryptoUtils,d.authority,c,!0,u,y)})()}}class fs extends ti{acquireToken(c){var u=this;return(0,E.Z)(function*(){u.performanceClient.addQueueMeasurement(w.Ak.SilentCacheClientAcquireToken,c.correlationId);const d=u.initializeServerTelemetryManager(N.WN.acquireTokenSilent_silentFlow),y=yield u.createSilentFlowClient(d,c.authority,c.azureCloudOptions);u.logger.verbose("Silent auth client created");try{const Q=(yield _(y.acquireCachedToken.bind(y),w.Ak.SilentFlowClientAcquireCachedToken,u.logger,u.performanceClient,c.correlationId)(c))[0];return u.performanceClient.addFields({fromCache:!0},c.correlationId),Q}catch(L){throw L instanceof T.Ut&&L.errorCode===Ge.XM&&u.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),L}})()}logout(c){this.logger.verbose("logoutRedirect called");const u=this.initializeLogoutRequest(c);return this.clearCacheOnLogout(u?.account)}createSilentFlowClient(c,u,d){var y=this;return(0,E.Z)(function*(){const L=yield _(y.getClientConfiguration.bind(y),w.Ak.StandardInteractionClientGetClientConfiguration,y.logger,y.performanceClient,y.correlationId)(c,u,d);return new un(L,y.performanceClient)})()}initializeSilentRequest(c,u){var d=this;return(0,E.Z)(function*(){d.performanceClient.addQueueMeasurement(w.Ak.InitializeSilentRequest,d.correlationId);const y=yield _(d.initializeBaseRequest.bind(d),w.Ak.InitializeBaseRequest,d.logger,d.performanceClient,d.correlationId)(c,u);return{...c,...y,account:u,forceRefresh:c.forceRefresh||!1}})()}}class Rt extends Gt{constructor(c,u,d,y,L,Q,re,de,Te,Se,nt,gt){super(c,u,d,y,L,Q,de,Te,gt),this.apiId=re,this.accountId=Se,this.nativeMessageHandler=Te,this.nativeStorageManager=nt,this.silentCacheClient=new fs(c,this.nativeStorageManager,d,y,L,Q,de,Te,gt)}acquireToken(c){var u=this;return(0,E.Z)(function*(){u.performanceClient.addQueueMeasurement(w.Ak.NativeInteractionClientAcquireToken,c.correlationId),u.logger.trace("NativeInteractionClient - acquireToken called.");const d=u.performanceClient.startMeasurement(w.Ak.NativeInteractionClientAcquireToken,c.correlationId),y=J.I.nowSeconds(),L=yield u.initializeNativeRequest(c);try{const Te=yield u.acquireTokensFromCache(u.accountId,L);return d.end({success:!0,isNativeBroker:!1,fromCache:!0}),Te}catch{u.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const Q={method:N.Ky.GetToken,request:L},re=yield u.nativeMessageHandler.sendMessage(Q),de=u.validateNativeResponse(re);return u.handleNativeResponse(de,L,y).then(Te=>(d.end({success:!0,isNativeBroker:!0,requestId:Te.requestId}),Te)).catch(Te=>{throw d.end({success:!1,errorCode:Te.errorCode,subErrorCode:Te.subError,isNativeBroker:!0}),Te})})()}createSilentCacheRequest(c,u){return{authority:c.authority,correlationId:this.correlationId,scopes:Fn.i.fromString(c.scope).asArray(),account:u,forceRefresh:!1}}acquireTokensFromCache(c,u){var d=this;return(0,E.Z)(function*(){if(!c)throw d.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),(0,B.zP)(q.cX);const y=d.browserStorage.getBaseAccountInfo({nativeAccountId:c});if(!y)throw(0,B.zP)(q.cX);try{const L=d.createSilentCacheRequest(u,y),Q=yield d.silentCacheClient.acquireToken(L),re={...y,idTokenClaims:Q?.idTokenClaims};return{...Q,account:re}}catch(L){throw L}})()}acquireTokenRedirect(c){var u=this;return(0,E.Z)(function*(){u.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const d=yield u.initializeNativeRequest(c),y={method:N.Ky.GetToken,request:d};try{const re=yield u.nativeMessageHandler.sendMessage(y);u.validateNativeResponse(re)}catch(re){if(re instanceof Kr&&ni(re))throw re}u.browserStorage.setTemporaryCache(N.c4.NATIVE_REQUEST,JSON.stringify(d),!0);const L={apiId:N.WN.acquireTokenRedirect,timeout:u.config.system.redirectNavigationTimeout,noHistory:!1},Q=u.config.auth.navigateToLoginRequestUrl?window.location.href:u.getRedirectUri(c.redirectUri);yield u.navigationClient.navigateExternal(Q,L)})()}handleRedirectPromise(){var c=this;return(0,E.Z)(function*(){if(c.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!c.browserStorage.isInteractionInProgress(!0))return c.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const u=c.browserStorage.getCachedNativeRequest();if(!u)return c.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),null;const{prompt:d,...y}=u;d&&c.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),c.browserStorage.removeItem(c.browserStorage.generateCacheKey(N.c4.NATIVE_REQUEST));const L={method:N.Ky.GetToken,request:y},Q=J.I.nowSeconds();try{c.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const re=yield c.nativeMessageHandler.sendMessage(L);c.validateNativeResponse(re);const de=c.handleNativeResponse(re,y,Q);return c.browserStorage.setInteractionInProgress(!1),de}catch(re){throw c.browserStorage.setInteractionInProgress(!1),re}})()}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}handleNativeResponse(c,u,d){var y=this;return(0,E.Z)(function*(){if(y.logger.trace("NativeInteractionClient - handleNativeResponse called."),c.account.id!==u.accountId)throw Mt(zl);const L=yield y.getDiscoveredAuthority(u.authority),Q=ue.Z_(c.id_token,xe.t),re=y.createHomeAccountIdentifier(c,Q),de=De.r.createAccount({homeAccountId:re,idTokenClaims:Q,clientInfo:c.client_info,nativeAccountId:c.account.id},L),Te=yield y.generateAuthenticationResult(c,u,Q,de,L.canonicalAuthority,d);return y.cacheAccount(de),y.cacheNativeTokens(c,u,re,Q,Te.accessToken,Te.tenantId,d),Te})()}createHomeAccountIdentifier(c,u){return De.r.generateHomeAccountId(c.client_info||g.gT.EMPTY_STRING,R.a.Default,this.logger,this.browserCrypto,u)}generateScopes(c,u){return Fn.i.fromString(c.scope?c.scope:u.scope)}generatePopAccessToken(c,u){var d=this;return(0,E.Z)(function*(){if(u.tokenType===g.hO.POP){if(c.shr)return d.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),c.shr;const y=new X(d.browserCrypto),L={resourceRequestMethod:u.resourceRequestMethod,resourceRequestUri:u.resourceRequestUri,shrClaims:u.shrClaims,shrNonce:u.shrNonce};if(!u.keyId)throw(0,B.zP)(q.Of);return yield y.signPopToken(c.access_token,u.keyId,L)}return c.access_token})()}generateAuthenticationResult(c,u,d,y,L,Q){var re=this;return(0,E.Z)(function*(){const de=re.addTelemetryFromNativeResponse(c),Te=Fn.i.fromString(c.scope?c.scope:u.scope),Se=c.account.properties||{},nt=Se.UID||d.oid||d.sub||g.gT.EMPTY_STRING,gt=Se.TenantId||d.tid||g.gT.EMPTY_STRING,Un=(d?Object.assign(new De.r,{...y,idTokenClaims:d}):y).getAccountInfo(),En=yield re.generatePopAccessToken(c,u),Ir=u.tokenType===g.hO.POP?g.hO.POP:g.hO.BEARER;return{authority:L,uniqueId:nt,tenantId:gt,scopes:Te.asArray(),account:Un,idToken:c.id_token,idTokenClaims:d,accessToken:En,fromCache:!!de&&re.isResponseFromCache(de),expiresOn:new Date(1e3*Number(Q+c.expires_in)),tokenType:Ir,correlationId:re.correlationId,state:c.state,fromNativeBroker:!0}})()}cacheAccount(c){this.browserStorage.setAccount(c),this.browserStorage.removeAccountContext(c).catch(u=>{this.logger.error(`Error occurred while removing account context from browser storage. ${u}`)})}cacheNativeTokens(c,u,d,y,L,Q,re){const de=Be.Md(d,u.authority,c.id_token||"",u.clientId,y.tid||""),Se=re+(u.tokenType===g.hO.POP?g.gT.SHR_NONCE_VALIDITY:("string"==typeof c.expires_in?parseInt(c.expires_in,10):c.expires_in)||0),nt=this.generateScopes(c,u),gt=Be.Ds(d,u.authority,L,u.clientId,y.tid||Q,nt.printScopes(),Se,0,xe.t),Bt=new m(void 0,de,gt);this.nativeStorageManager.saveCacheRecord(Bt,u.storeInCache)}addTelemetryFromNativeResponse(c){const u=this.getMATSFromResponse(c);return u?(this.performanceClient.addFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:u.broker_version,matsAccountJoinOnStart:u.account_join_on_start,matsAccountJoinOnEnd:u.account_join_on_end,matsDeviceJoin:u.device_join,matsPromptBehavior:u.prompt_behavior,matsApiErrorCode:u.api_error_code,matsUiVisible:u.ui_visible,matsSilentCode:u.silent_code,matsSilentBiSubCode:u.silent_bi_sub_code,matsSilentMessage:u.silent_message,matsSilentStatus:u.silent_status,matsHttpStatus:u.http_status,matsHttpEventCount:u.http_event_count},this.correlationId),u):null}validateNativeResponse(c){if(c.hasOwnProperty("access_token")&&c.hasOwnProperty("id_token")&&c.hasOwnProperty("client_info")&&c.hasOwnProperty("account")&&c.hasOwnProperty("scope")&&c.hasOwnProperty("expires_in"))return c;throw(0,U.MD)($l.g,"Response missing expected properties.")}getMATSFromResponse(c){if(c.properties.MATS)try{return JSON.parse(c.properties.MATS)}catch{this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(c){return typeof c.is_cached>"u"?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!c.is_cached}initializeNativeRequest(c){var u=this;return(0,E.Z)(function*(){u.logger.trace("NativeInteractionClient - initializeNativeRequest called");const d=c.authority||u.config.auth.authority;c.account&&(yield u.validateRequestAuthority(d,c.account));const y=new H.G(d);y.validateAsUri();const{scopes:L,...Q}=c,re=new Fn.i(L||[]);re.appendScopes(g.f_);const Te={...Q,accountId:u.accountId,clientId:u.config.auth.clientId,authority:y.urlString,scope:re.printScopes(),redirectUri:u.getRedirectUri(c.redirectUri),prompt:(()=>{switch(u.apiId){case N.WN.ssoSilent:case N.WN.acquireTokenSilent_silentFlow:return u.logger.trace("initializeNativeRequest: silent request sets prompt to none"),g.NJ.NONE}if(c.prompt)switch(c.prompt){case g.NJ.NONE:case g.NJ.CONSENT:case g.NJ.LOGIN:return u.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),c.prompt;default:throw u.logger.trace(`initializeNativeRequest: prompt = ${c.prompt} is not compatible with native flow`),(0,T.Z_)(Ge.o9)}else u.logger.trace("initializeNativeRequest: prompt was not provided")})(),correlationId:u.correlationId,tokenType:c.authenticationScheme,windowTitleSubstring:document.title,extraParameters:{...c.extraQueryParameters,...c.tokenQueryParameters},extendedExpiryToken:!1};if(u.handleExtraBrokerParams(Te),Te.extraParameters=Te.extraParameters||{},Te.extraParameters.telemetry=N.BD.MATS_TELEMETRY,c.authenticationScheme===g.hO.POP){const Se={resourceRequestUri:c.resourceRequestUri,resourceRequestMethod:c.resourceRequestMethod,shrClaims:c.shrClaims,shrNonce:c.shrNonce},nt=new X(u.browserCrypto),gt=yield _(nt.generateCnf.bind(nt),w.Ak.PopTokenGenerateCnf,u.logger,u.performanceClient,u.correlationId)(Se,u.logger);Te.reqCnf=gt.reqCnfHash,Te.keyId=gt.kid}return Te})()}handleExtraBrokerParams(c){if(c.extraParameters&&c.extraParameters.hasOwnProperty("brk_client_id")&&c.extraParameters.hasOwnProperty("brk_redirect_uri")&&c.extraParameters.hasOwnProperty(g.Fo.CLIENT_ID)){const y=c.extraParameters.brk_redirect_uri;c.extraParameters={child_client_id:c.extraParameters[g.Fo.CLIENT_ID],child_redirect_uri:c.redirectUri},c.redirectUri=y}}}class ot{constructor(c,u,d,y){this.logger=c,this.handshakeTimeoutMs=u,this.extensionId=y,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=d,this.handshakeEvent=d.startMeasurement(w.Ak.NativeMessageHandlerHandshake)}sendMessage(c){var u=this;return(0,E.Z)(function*(){u.logger.trace("NativeMessageHandler - sendMessage called.");const d={channel:N.BD.CHANNEL_ID,extensionId:u.extensionId,responseId:(0,wt.nn)(),body:c};return u.logger.trace("NativeMessageHandler - Sending request to browser extension"),u.logger.tracePii(`NativeMessageHandler - Sending request to browser extension: ${JSON.stringify(d)}`),u.messageChannel.port1.postMessage(d),new Promise((y,L)=>{u.resolvers.set(d.responseId,{resolve:y,reject:L})})})()}static createProvider(c,u,d){return(0,E.Z)(function*(){c.trace("NativeMessageHandler - createProvider called.");try{const y=new ot(c,u,d,N.BD.PREFERRED_EXTENSION_ID);return yield y.sendHandshakeRequest(),y}catch{const L=new ot(c,u,d);return yield L.sendHandshakeRequest(),L}})()}sendHandshakeRequest(){var c=this;return(0,E.Z)(function*(){c.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",c.windowListener,!1);const u={channel:N.BD.CHANNEL_ID,extensionId:c.extensionId,responseId:(0,wt.nn)(),body:{method:N.Ky.HandshakeRequest}};return c.handshakeEvent.add({extensionId:c.extensionId,extensionHandshakeTimeoutMs:c.handshakeTimeoutMs}),c.messageChannel.port1.onmessage=d=>{c.onChannelMessage(d)},window.postMessage(u,window.origin,[c.messageChannel.port2]),new Promise((d,y)=>{c.handshakeResolvers.set(u.responseId,{resolve:d,reject:y}),c.timeoutId=window.setTimeout(()=>{window.removeEventListener("message",c.windowListener,!1),c.messageChannel.port1.close(),c.messageChannel.port2.close(),c.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),y((0,T.Z_)(Ge.hR)),c.handshakeResolvers.delete(u.responseId)},c.handshakeTimeoutMs)})})()}onWindowMessage(c){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),c.source!==window)return;const u=c.data;if(u.channel&&u.channel===N.BD.CHANNEL_ID&&(!u.extensionId||u.extensionId===this.extensionId)&&u.body.method===N.Ky.HandshakeRequest){const d=this.handshakeResolvers.get(u.responseId);if(!d)return void this.logger.trace(`NativeMessageHandler.onWindowMessage - resolver can't be found for request ${u.responseId}`);this.logger.verbose(u.extensionId?`Extension with id: ${u.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),d.reject((0,T.Z_)(Ge.Wb))}}onChannelMessage(c){this.logger.trace("NativeMessageHandler - onChannelMessage called.");const u=c.data,d=this.resolvers.get(u.responseId),y=this.handshakeResolvers.get(u.responseId);try{const L=u.body.method;if(L===N.Ky.Response){if(!d)return;const Q=u.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii(`NativeMessageHandler - Received response from browser extension: ${JSON.stringify(Q)}`),"Success"!==Q.status)d.reject(Mt(Q.code,Q.description,Q.ext));else{if(!Q.result)throw(0,U.MD)($l.g,"Event does not contain result.");Q.result.code&&Q.result.description?d.reject(Mt(Q.result.code,Q.result.description,Q.result.ext)):d.resolve(Q.result)}this.resolvers.delete(u.responseId)}else if(L===N.Ky.HandshakeResponse){if(!y)return void this.logger.trace(`NativeMessageHandler.onChannelMessage - resolver can't be found for request ${u.responseId}`);clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=u.extensionId,this.extensionVersion=u.body.version,this.logger.verbose(`NativeMessageHandler - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),y.resolve(),this.handshakeResolvers.delete(u.responseId)}}catch(L){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${L}`),this.logger.errorPii(`Unable to parse ${c}`),d?d.reject(L):y&&y.reject(L)}}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}static isNativeAvailable(c,u,d,y){if(u.trace("isNativeAvailable called"),!c.system.allowNativeBroker)return u.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!d)return u.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(y)switch(y){case g.hO.BEARER:case g.hO.POP:return u.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return u.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0}}class Oi{constructor(c,u,d,y,L){this.authModule=c,this.browserStorage=u,this.authCodeRequest=d,this.logger=y,this.performanceClient=L}handleCodeResponse(c,u){var d=this;return(0,E.Z)(function*(){let y;d.performanceClient.addQueueMeasurement(w.Ak.HandleCodeResponse,u.correlationId);try{y=d.authModule.handleFragmentResponse(c,u.state)}catch(L){throw L instanceof qn.n&&L.subError===Ge.h7?(0,T.Z_)(Ge.h7):L}return _(d.handleCodeResponseFromServer.bind(d),w.Ak.HandleCodeResponseFromServer,d.logger,d.performanceClient,u.correlationId)(y,u)})()}handleCodeResponseFromServer(c,u,d=!0){var y=this;return(0,E.Z)(function*(){if(y.performanceClient.addQueueMeasurement(w.Ak.HandleCodeResponseFromServer,u.correlationId),y.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),y.authCodeRequest.code=c.code,c.cloud_instance_host_name&&(yield _(y.authModule.updateAuthority.bind(y.authModule),w.Ak.UpdateTokenEndpointAuthority,y.logger,y.performanceClient,u.correlationId)(c.cloud_instance_host_name,u.correlationId)),d&&(c.nonce=u.nonce||void 0),c.state=u.state,c.client_info)y.authCodeRequest.clientInfo=c.client_info;else{const Q=y.createCcsCredentials(u);Q&&(y.authCodeRequest.ccsCredential=Q)}return yield _(y.authModule.acquireToken.bind(y.authModule),w.Ak.AuthClientAcquireToken,y.logger,y.performanceClient,u.correlationId)(y.authCodeRequest,c)})()}createCcsCredentials(c){return c.account?{credential:c.account.homeAccountId,type:"home_account_id"}:c.loginHint?{credential:c.loginHint,type:"UPN"}:null}}var oi=S(1129);function mf(ke,c,u){const d=oi.F(ke);if(!d)throw oi.q(ke)?(u.error(`A ${c} is present in the iframe but it does not contain known properties. It's likely that the ${c} has been replaced by code running on the redirectUri page.`),u.errorPii(`The ${c} detected is: ${ke}`),(0,T.Z_)(Ge.S_)):(u.error(`The request has returned to the redirectUri but a ${c} is not present. It's likely that the ${c} has been removed or the page has been redirected by code running on the redirectUri page.`),(0,T.Z_)(Ge.nF));return d}class Fe extends ti{constructor(c,u,d,y,L,Q,re,de,Te,Se){super(c,u,d,y,L,Q,re,Te,Se),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=de}acquireToken(c){try{const u=this.generatePopupName(c.scopes||g.f_,c.authority||this.config.auth.authority),d=c.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(c,u,d);{this.logger.verbose("asyncPopup set to false, opening popup before acquiring token");const y=this.openSizedPopup("about:blank",u,d);return this.acquireTokenPopupAsync(c,u,d,y)}}catch(u){return Promise.reject(u)}}logout(c){try{this.logger.verbose("logoutPopup called");const u=this.initializeLogoutRequest(c),d=this.generateLogoutPopupName(u),y=c&&c.authority,L=c&&c.mainWindowRedirectUri,Q=c?.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(u,d,Q,y,void 0,L);{this.logger.verbose("asyncPopup set to false, opening popup");const re=this.openSizedPopup("about:blank",d,Q);return this.logoutPopupAsync(u,d,Q,y,re,L)}}catch(u){return Promise.reject(u)}}acquireTokenPopupAsync(c,u,d,y){var L=this;return(0,E.Z)(function*(){L.logger.verbose("acquireTokenPopupAsync called");const Q=L.initializeServerTelemetryManager(N.WN.acquireTokenPopup),re=yield _(L.initializeAuthorizationRequest.bind(L),w.Ak.StandardInteractionClientInitializeAuthorizationRequest,L.logger,L.performanceClient,L.correlationId)(c,N.s_.Popup);(0,ut.$P)(re.authority);try{const de=yield _(L.initializeAuthorizationCodeRequest.bind(L),w.Ak.StandardInteractionClientInitializeAuthorizationCodeRequest,L.logger,L.performanceClient,L.correlationId)(re),Te=yield _(L.createAuthCodeClient.bind(L),w.Ak.StandardInteractionClientCreateAuthCodeClient,L.logger,L.performanceClient,L.correlationId)(Q,re.authority,re.azureCloudOptions),Se=ot.isNativeAvailable(L.config,L.logger,L.nativeMessageHandler,c.authenticationScheme);let nt;Se&&(nt=L.performanceClient.startMeasurement(w.Ak.FetchAccountIdWithNativeBroker,c.correlationId));const gt=yield Te.getAuthCodeUrl({...re,nativeBroker:Se}),Bt=new Oi(Te,L.browserStorage,de,L.logger,L.performanceClient),En=L.initiateAuthRequest(gt,{popup:y,popupName:u,popupWindowAttributes:d});L.eventHandler.emitEvent(tt.t.POPUP_OPENED,N.s_.Popup,{popupWindow:En},null);const Ir=yield L.monitorPopupForHash(En),hr=j(mf,w.Ak.DeserializeResponse,L.logger,L.performanceClient,L.correlationId)(Ir,L.config.auth.OIDCOptions.serverResponseType,L.logger);if(Re.removeThrottle(L.browserStorage,L.config.auth.clientId,de),hr.accountId){if(L.logger.verbose("Account id found in hash, calling WAM for token"),nt&&nt.end({success:!0,isNativeBroker:!0}),!L.nativeMessageHandler)throw(0,T.Z_)(Ge.V7);const Ni=new Rt(L.config,L.browserStorage,L.browserCrypto,L.logger,L.eventHandler,L.navigationClient,N.WN.acquireTokenPopup,L.performanceClient,L.nativeMessageHandler,hr.accountId,L.nativeStorage,re.correlationId),{userRequestState:mt}=oe.parseRequestState(L.browserCrypto,re.state);return Ni.acquireToken({...re,state:mt,prompt:void 0})}return yield Bt.handleCodeResponse(hr,re)}catch(de){throw y&&y.close(),de instanceof U.l4&&(de.setCorrelationId(L.correlationId),Q.cacheFailedRequest(de)),de}})()}logoutPopupAsync(c,u,d,y,L,Q){var re=this;return(0,E.Z)(function*(){re.logger.verbose("logoutPopupAsync called"),re.eventHandler.emitEvent(tt.t.LOGOUT_START,N.s_.Popup,c);const de=re.initializeServerTelemetryManager(N.WN.logoutPopup);try{yield re.clearCacheOnLogout(c.account);const Se=(yield _(re.createAuthCodeClient.bind(re),w.Ak.StandardInteractionClientCreateAuthCodeClient,re.logger,re.performanceClient,re.correlationId)(de,y)).getLogoutUri(c);re.eventHandler.emitEvent(tt.t.LOGOUT_SUCCESS,N.s_.Popup,c);const nt=re.openPopup(Se,{popupName:u,popupWindowAttributes:d,popup:L});if(re.eventHandler.emitEvent(tt.t.POPUP_OPENED,N.s_.Popup,{popupWindow:nt},null),yield re.monitorPopupForHash(nt).catch(()=>{}),Q){const gt={apiId:N.WN.logoutPopup,timeout:re.config.system.redirectNavigationTimeout,noHistory:!1},Bt=H.G.getAbsoluteUrl(Q,(0,ut.Re)());re.logger.verbose("Redirecting main window to url specified in the request"),re.logger.verbosePii(`Redirecting main window to: ${Bt}`),yield re.navigationClient.navigateInternal(Bt,gt)}else re.logger.verbose("No main window navigation requested")}catch(Te){throw L&&L.close(),Te instanceof U.l4&&(Te.setCorrelationId(re.correlationId),de.cacheFailedRequest(Te)),re.browserStorage.setInteractionInProgress(!1),re.eventHandler.emitEvent(tt.t.LOGOUT_FAILURE,N.s_.Popup,null,Te),re.eventHandler.emitEvent(tt.t.LOGOUT_END,N.s_.Popup),Te}re.eventHandler.emitEvent(tt.t.LOGOUT_END,N.s_.Popup)})()}initiateAuthRequest(c,u){if(c)return this.logger.infoPii(`Navigate to: ${c}`),this.openPopup(c,u);throw this.logger.error("Navigate url is empty"),(0,T.Z_)(Ge._c)}monitorPopupForHash(c){return new Promise((u,d)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const y=setInterval(()=>{if(c.closed)return this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(y),void d((0,T.Z_)(Ge.h7));let L="";try{L=c.location.href}catch{}if(!L||"about:blank"===L)return;clearInterval(y);let Q="";c&&(Q=this.config.auth.OIDCOptions.serverResponseType===g.rg.QUERY?c.location.search:c.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),u(Q)},this.config.system.pollIntervalMilliseconds)}).finally(()=>{this.cleanPopup(c)})}openPopup(c,u){try{let d;if(u.popup?(d=u.popup,this.logger.verbosePii(`Navigating popup window to: ${c}`),d.location.assign(c)):typeof u.popup>"u"&&(this.logger.verbosePii(`Opening popup window to: ${c}`),d=this.openSizedPopup(c,u.popupName,u.popupWindowAttributes)),!d)throw(0,T.Z_)(Ge.H);return d.focus&&d.focus(),this.currentWindow=d,window.addEventListener("beforeunload",this.unloadWindow),d}catch(d){throw this.logger.error("error opening popup "+d.message),this.browserStorage.setInteractionInProgress(!1),(0,T.Z_)(Ge.E)}}openSizedPopup(c,u,d){const y=window.screenLeft?window.screenLeft:window.screenX,L=window.screenTop?window.screenTop:window.screenY,Q=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,re=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let de=d.popupSize?.width,Te=d.popupSize?.height,Se=d.popupPosition?.top,nt=d.popupPosition?.left;return(!de||de<0||de>Q)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),de=N.qx.POPUP_WIDTH),(!Te||Te<0||Te>re)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),Te=N.qx.POPUP_HEIGHT),(!Se||Se<0||Se>re)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),Se=Math.max(0,re/2-N.qx.POPUP_HEIGHT/2+L)),(!nt||nt<0||nt>Q)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),nt=Math.max(0,Q/2-N.qx.POPUP_WIDTH/2+y)),window.open(c,u,`width=${de}, height=${Te}, top=${Se}, left=${nt}, scrollbars=yes`)}unloadWindow(c){this.browserStorage.cleanRequestByInteractionType(N.s_.Popup),this.currentWindow&&this.currentWindow.close(),c.preventDefault()}cleanPopup(c){c&&c.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)}generatePopupName(c,u){return`${N.qx.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${c.join("-")}.${u}.${this.correlationId}`}generateLogoutPopupName(c){return`${N.qx.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${c.account&&c.account.homeAccountId}.${this.correlationId}`}}class ki{constructor(c,u,d,y,L){this.authModule=c,this.browserStorage=u,this.authCodeRequest=d,this.logger=y,this.performanceClient=L}initiateAuthRequest(c,u){var d=this;return(0,E.Z)(function*(){if(d.logger.verbose("RedirectHandler.initiateAuthRequest called"),c){u.redirectStartPage&&(d.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),d.browserStorage.setTemporaryCache(N.c4.ORIGIN_URI,u.redirectStartPage,!0)),d.browserStorage.setTemporaryCache(N.c4.CORRELATION_ID,d.authCodeRequest.correlationId,!0),d.browserStorage.cacheCodeRequest(d.authCodeRequest),d.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${c}`);const y={apiId:N.WN.acquireTokenRedirect,timeout:u.redirectTimeout,noHistory:!1};return"function"==typeof u.onRedirectNavigate?(d.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1!==u.onRedirectNavigate(c)?(d.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),void(yield u.navigationClient.navigateExternal(c,y))):void d.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation")):(d.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),void(yield u.navigationClient.navigateExternal(c,y)))}throw d.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),(0,T.Z_)(Ge._c)})()}handleCodeResponse(c,u){var d=this;return(0,E.Z)(function*(){d.logger.verbose("RedirectHandler.handleCodeResponse called"),d.browserStorage.setInteractionInProgress(!1);const y=d.browserStorage.generateStateKey(u),L=d.browserStorage.getTemporaryCache(y);if(!L)throw(0,B.zP)(q.LV,"Cached State");let Q;try{Q=d.authModule.handleFragmentResponse(c,L)}catch(Se){throw Se instanceof qn.n&&Se.subError===Ge.h7?(0,T.Z_)(Ge.h7):Se}const re=d.browserStorage.generateNonceKey(L),de=d.browserStorage.getTemporaryCache(re);if(d.authCodeRequest.code=Q.code,Q.cloud_instance_host_name&&(yield _(d.authModule.updateAuthority.bind(d.authModule),w.Ak.UpdateTokenEndpointAuthority,d.logger,d.performanceClient,d.authCodeRequest.correlationId)(Q.cloud_instance_host_name,d.authCodeRequest.correlationId)),Q.nonce=de||void 0,Q.state=L,Q.client_info)d.authCodeRequest.clientInfo=Q.client_info;else{const Se=d.checkCcsCredentials();Se&&(d.authCodeRequest.ccsCredential=Se)}const Te=yield d.authModule.acquireToken(d.authCodeRequest,Q);return d.browserStorage.cleanRequestByState(u),Te})()}checkCcsCredentials(){const c=this.browserStorage.getTemporaryCache(N.c4.CCS_CREDENTIAL,!0);if(c)try{return JSON.parse(c)}catch{this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii(`Cache credential could not be parsed: ${c}`)}return null}}class ct extends ti{constructor(c,u,d,y,L,Q,re,de,Te,Se){super(c,u,d,y,L,Q,re,Te,Se),this.nativeStorage=de}acquireToken(c){var u=this;return(0,E.Z)(function*(){const d=yield _(u.initializeAuthorizationRequest.bind(u),w.Ak.StandardInteractionClientInitializeAuthorizationRequest,u.logger,u.performanceClient,u.correlationId)(c,N.s_.Redirect);u.browserStorage.updateCacheEntries(d.state,d.nonce,d.authority,d.loginHint||"",d.account||null);const y=u.initializeServerTelemetryManager(N.WN.acquireTokenRedirect),L=Q=>{Q.persisted&&(u.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),u.browserStorage.cleanRequestByState(d.state),u.eventHandler.emitEvent(tt.t.RESTORE_FROM_BFCACHE,N.s_.Redirect))};try{const Q=yield _(u.initializeAuthorizationCodeRequest.bind(u),w.Ak.StandardInteractionClientInitializeAuthorizationCodeRequest,u.logger,u.performanceClient,u.correlationId)(d),re=yield _(u.createAuthCodeClient.bind(u),w.Ak.StandardInteractionClientCreateAuthCodeClient,u.logger,u.performanceClient,u.correlationId)(y,d.authority,d.azureCloudOptions),de=new ki(re,u.browserStorage,Q,u.logger,u.performanceClient),Te=yield re.getAuthCodeUrl({...d,nativeBroker:ot.isNativeAvailable(u.config,u.logger,u.nativeMessageHandler,c.authenticationScheme)}),Se=u.getRedirectStartPage(c.redirectStartPage);return u.logger.verbosePii(`Redirect start page: ${Se}`),window.addEventListener("pageshow",L),yield de.initiateAuthRequest(Te,{navigationClient:u.navigationClient,redirectTimeout:u.config.system.redirectNavigationTimeout,redirectStartPage:Se,onRedirectNavigate:c.onRedirectNavigate})}catch(Q){throw Q instanceof U.l4&&(Q.setCorrelationId(u.correlationId),y.cacheFailedRequest(Q)),window.removeEventListener("pageshow",L),u.browserStorage.cleanRequestByState(d.state),Q}})()}handleRedirectPromise(c){var u=this;return(0,E.Z)(function*(){const d=u.initializeServerTelemetryManager(N.WN.handleRedirectPromise);try{if(!u.browserStorage.isInteractionInProgress(!0))return u.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const[y,L]=u.getRedirectResponse(c||"");if(!y)return u.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),u.browserStorage.cleanRequestByInteractionType(N.s_.Redirect),null;const Q=u.browserStorage.getTemporaryCache(N.c4.ORIGIN_URI,!0)||g.gT.EMPTY_STRING;if(H.G.removeHashFromUrl(Q)===H.G.removeHashFromUrl(window.location.href)&&u.config.auth.navigateToLoginRequestUrl)return u.logger.verbose("Current page is loginRequestUrl, handling response"),Q.indexOf("#")>-1&&(0,ut.tT)(Q),yield u.handleResponse(y,d);if(!u.config.auth.navigateToLoginRequestUrl)return u.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),u.handleResponse(y,d);if(!(0,ut.zd)()||u.config.system.allowRedirectInIframe){u.browserStorage.setTemporaryCache(N.c4.URL_HASH,L,!0);const Te={apiId:N.WN.handleRedirectPromise,timeout:u.config.system.redirectNavigationTimeout,noHistory:!0};let Se=!0;if(Q&&"null"!==Q)u.logger.verbose(`Navigating to loginRequestUrl: ${Q}`),Se=yield u.navigationClient.navigateInternal(Q,Te);else{const nt=(0,ut.fl)();u.browserStorage.setTemporaryCache(N.c4.ORIGIN_URI,nt,!0),u.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),Se=yield u.navigationClient.navigateInternal(nt,Te)}if(!Se)return u.handleResponse(y,d)}return null}catch(y){throw y instanceof U.l4&&(y.setCorrelationId(u.correlationId),d.cacheFailedRequest(y)),u.browserStorage.cleanRequestByInteractionType(N.s_.Redirect),y}})()}getRedirectResponse(c){this.logger.verbose("getRedirectResponseHash called");let u=c;u||(u=this.config.auth.OIDCOptions.serverResponseType===g.rg.QUERY?window.location.search:window.location.hash);let d=oi.F(u);if(d){try{!function Gl(ke,c,u){if(!ke.state)throw(0,T.Z_)(Ge.Xk);const d=be(c,ke.state);if(!d)throw(0,T.Z_)(Ge.$P);if(d.interactionType!==u)throw(0,T.Z_)(Ge.yK)}(d,this.browserCrypto,N.s_.Redirect)}catch(L){return L instanceof U.l4&&this.logger.error(`Interaction type validation failed due to ${L.errorCode}: ${L.errorMessage}`),[null,""]}return(0,ut.hH)(window),this.logger.verbose("Hash contains known properties, returning response hash"),[d,u]}const y=this.browserStorage.getTemporaryCache(N.c4.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(N.c4.URL_HASH)),y&&(d=oi.F(y),d)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[d,y]):[null,""]}handleResponse(c,u){var d=this;return(0,E.Z)(function*(){const y=c.state;if(!y)throw(0,T.Z_)(Ge.Xk);const L=d.browserStorage.getCachedRequest(y);if(d.logger.verbose("handleResponse called, retrieved cached request"),c.accountId){if(d.logger.verbose("Account id found in hash, calling WAM for token"),!d.nativeMessageHandler)throw(0,T.Z_)(Ge.V7);const Te=new Rt(d.config,d.browserStorage,d.browserCrypto,d.logger,d.eventHandler,d.navigationClient,N.WN.acquireTokenPopup,d.performanceClient,d.nativeMessageHandler,c.accountId,d.nativeStorage,L.correlationId),{userRequestState:Se}=oe.parseRequestState(d.browserCrypto,y);return Te.acquireToken({...L,state:Se,prompt:void 0}).finally(()=>{d.browserStorage.cleanRequestByState(y)})}const Q=d.browserStorage.getCachedAuthority(y);if(!Q)throw(0,T.Z_)(Ge.dT);const re=yield _(d.createAuthCodeClient.bind(d),w.Ak.StandardInteractionClientCreateAuthCodeClient,d.logger,d.performanceClient,d.correlationId)(u,Q);return Re.removeThrottle(d.browserStorage,d.config.auth.clientId,L),yield new ki(re,d.browserStorage,L,d.logger,d.performanceClient).handleCodeResponse(c,y)})()}logout(c){var u=this;return(0,E.Z)(function*(){u.logger.verbose("logoutRedirect called");const d=u.initializeLogoutRequest(c),y=u.initializeServerTelemetryManager(N.WN.logout);try{u.eventHandler.emitEvent(tt.t.LOGOUT_START,N.s_.Redirect,c),yield u.clearCacheOnLogout(d.account);const L={apiId:N.WN.logout,timeout:u.config.system.redirectNavigationTimeout,noHistory:!1},re=(yield _(u.createAuthCodeClient.bind(u),w.Ak.StandardInteractionClientCreateAuthCodeClient,u.logger,u.performanceClient,u.correlationId)(y,c&&c.authority)).getLogoutUri(d);if(u.eventHandler.emitEvent(tt.t.LOGOUT_SUCCESS,N.s_.Redirect,d),!c||"function"!=typeof c.onRedirectNavigate)return u.browserStorage.getInteractionInProgress()||u.browserStorage.setInteractionInProgress(!0),void(yield u.navigationClient.navigateExternal(re,L));if(!1!==c.onRedirectNavigate(re))return u.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),u.browserStorage.getInteractionInProgress()||u.browserStorage.setInteractionInProgress(!0),void(yield u.navigationClient.navigateExternal(re,L));u.browserStorage.setInteractionInProgress(!1),u.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation")}catch(L){throw L instanceof U.l4&&(L.setCorrelationId(u.correlationId),y.cacheFailedRequest(L)),u.eventHandler.emitEvent(tt.t.LOGOUT_FAILURE,N.s_.Redirect,null,L),u.eventHandler.emitEvent(tt.t.LOGOUT_END,N.s_.Redirect),L}u.eventHandler.emitEvent(tt.t.LOGOUT_END,N.s_.Redirect)})()}getRedirectStartPage(c){const u=c||window.location.href;return H.G.getAbsoluteUrl(u,(0,ut.Re)())}}var Ot=S(7803);function _f(ke,c,u,d,y){return ql.apply(this,arguments)}function ql(){return(ql=(0,E.Z)(function*(ke,c,u,d,y){if(c.addQueueMeasurement(w.Ak.SilentHandlerInitiateAuthRequest,d),!ke)throw u.info("Navigate url is empty"),(0,T.Z_)(Ge._c);return y?yield _(Wn,w.Ak.SilentHandlerLoadFrame,u,c,d)(ke,y,c,d):j(Uy,w.Ak.SilentHandlerLoadFrameSync,u,c,d)(ke)})).apply(this,arguments)}function yf(ke,c,u,d,y,L,Q){return Pi.apply(this,arguments)}function Pi(){return(Pi=(0,E.Z)(function*(ke,c,u,d,y,L,Q){return d.addQueueMeasurement(w.Ak.SilentHandlerMonitorIframeForHash,L),new Promise((re,de)=>{c<Ot.Is&&y.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${c}ms) than the default (${Ot.Is}ms). This may result in timeouts.`);const Te=window.setTimeout(()=>{window.clearInterval(Se),de((0,T.Z_)(Ge.JA))},c),Se=window.setInterval(()=>{let nt="";const gt=ke.contentWindow;try{nt=gt?gt.location.href:""}catch{}if(!nt||"about:blank"===nt)return;let Bt="";gt&&(Bt=Q===g.rg.QUERY?gt.location.search:gt.location.hash),window.clearTimeout(Te),window.clearInterval(Se),re(Bt)},u)}).finally(()=>{j(By,w.Ak.RemoveHiddenIframe,y,d,L)(ke)})})).apply(this,arguments)}function Wn(ke,c,u,d){return u.addQueueMeasurement(w.Ak.SilentHandlerLoadFrame,d),new Promise((y,L)=>{const Q=Kl();window.setTimeout(()=>{Q?(Q.src=ke,y(Q)):L("Unable to load iframe")},c)})}function Uy(ke){const c=Kl();return c.src=ke,c}function Kl(){const ke=document.createElement("iframe");return ke.style.visibility="hidden",ke.style.position="absolute",ke.style.width=ke.style.height="0",ke.style.border="0",ke.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(ke),ke}function By(ke){document.body===ke.parentNode&&document.body.removeChild(ke)}class ko extends ti{constructor(c,u,d,y,L,Q,re,de,Te,Se,nt){super(c,u,d,y,L,Q,de,Se,nt),this.apiId=re,this.nativeStorage=Te}acquireToken(c){var u=this;return(0,E.Z)(function*(){if(u.performanceClient.addQueueMeasurement(w.Ak.SilentIframeClientAcquireToken,c.correlationId),!c.loginHint&&!c.sid&&(!c.account||!c.account.username)&&u.logger.warning("No user hint provided. The authorization server may need more information to complete this request."),c.prompt&&c.prompt!==g.NJ.NONE&&c.prompt!==g.NJ.NO_SESSION)throw(0,T.Z_)(Ge.WQ);const d=yield _(u.initializeAuthorizationRequest.bind(u),w.Ak.StandardInteractionClientInitializeAuthorizationRequest,u.logger,u.performanceClient,c.correlationId)({...c,prompt:c.prompt||g.NJ.NONE},N.s_.Silent);(0,ut.$P)(d.authority);const y=u.initializeServerTelemetryManager(u.apiId);try{const L=yield _(u.createAuthCodeClient.bind(u),w.Ak.StandardInteractionClientCreateAuthCodeClient,u.logger,u.performanceClient,c.correlationId)(y,d.authority,d.azureCloudOptions);return yield _(u.silentTokenHelper.bind(u),w.Ak.SilentIframeClientTokenHelper,u.logger,u.performanceClient,c.correlationId)(L,d)}catch(L){throw L instanceof U.l4&&(L.setCorrelationId(u.correlationId),y.cacheFailedRequest(L)),L}})()}logout(){return Promise.reject((0,T.Z_)(Ge.I9))}silentTokenHelper(c,u){var d=this;return(0,E.Z)(function*(){const y=u.correlationId;d.performanceClient.addQueueMeasurement(w.Ak.SilentIframeClientTokenHelper,y);const L=yield _(d.initializeAuthorizationCodeRequest.bind(d),w.Ak.StandardInteractionClientInitializeAuthorizationCodeRequest,d.logger,d.performanceClient,y)(u),Q=yield _(c.getAuthCodeUrl.bind(c),w.Ak.GetAuthCodeUrl,d.logger,d.performanceClient,y)({...u,nativeBroker:ot.isNativeAvailable(d.config,d.logger,d.nativeMessageHandler,u.authenticationScheme)}),re=new Oi(c,d.browserStorage,L,d.logger,d.performanceClient),de=yield _(_f,w.Ak.SilentHandlerInitiateAuthRequest,d.logger,d.performanceClient,y)(Q,d.performanceClient,d.logger,y,d.config.system.navigateFrameWait),Te=d.config.auth.OIDCOptions.serverResponseType,Se=yield _(yf,w.Ak.SilentHandlerMonitorIframeForHash,d.logger,d.performanceClient,y)(de,d.config.system.iframeHashTimeout,d.config.system.pollIntervalMilliseconds,d.performanceClient,d.logger,y,Te),nt=j(mf,w.Ak.DeserializeResponse,d.logger,d.performanceClient,d.correlationId)(Se,Te,d.logger);if(nt.accountId){if(d.logger.verbose("Account id found in hash, calling WAM for token"),!d.nativeMessageHandler)throw(0,T.Z_)(Ge.V7);const gt=new Rt(d.config,d.browserStorage,d.browserCrypto,d.logger,d.eventHandler,d.navigationClient,d.apiId,d.performanceClient,d.nativeMessageHandler,nt.accountId,d.browserStorage,y),{userRequestState:Bt}=oe.parseRequestState(d.browserCrypto,u.state);return _(gt.acquireToken.bind(gt),w.Ak.NativeInteractionClientAcquireToken,d.logger,d.performanceClient,y)({...u,state:Bt,prompt:u.prompt||g.NJ.NONE})}return _(re.handleCodeResponse.bind(re),w.Ak.HandleCodeResponse,d.logger,d.performanceClient,y)(nt,u)})()}}class jy extends ti{acquireToken(c){var u=this;return(0,E.Z)(function*(){u.performanceClient.addQueueMeasurement(w.Ak.SilentRefreshClientAcquireToken,c.correlationId);const d=yield _(u.initializeBaseRequest.bind(u),w.Ak.InitializeBaseRequest,u.logger,u.performanceClient,c.correlationId)(c,c.account),y={...c,...d},L=u.initializeServerTelemetryManager(N.WN.acquireTokenSilent_silentFlow),Q=yield u.createRefreshTokenClient(L,y.authority,y.azureCloudOptions);return _(Q.acquireTokenByRefreshToken.bind(Q),w.Ak.RefreshTokenClientAcquireTokenByRefreshToken,u.logger,u.performanceClient,c.correlationId)(y).catch(re=>{throw re.setCorrelationId(u.correlationId),L.cacheFailedRequest(re),re})})()}logout(){return Promise.reject((0,T.Z_)(Ge.I9))}createRefreshTokenClient(c,u,d){var y=this;return(0,E.Z)(function*(){const L=yield _(y.getClientConfiguration.bind(y),w.Ak.StandardInteractionClientGetClientConfiguration,y.logger,y.performanceClient,y.correlationId)(c,u,d);return new ri(L,y.performanceClient)})()}}class Hy{constructor(c,u,d,y){this.isBrowserEnvironment=typeof window<"u",this.config=c,this.storage=u,this.logger=d,this.cryptoObj=y}loadExternalTokens(c,u,d){if(this.logger.info("TokenCache - loadExternalTokens called"),!u.id_token)throw(0,T.Z_)(Ge.Jd);const y=ue.Z_(u.id_token,xe.t);let L,Q,re;if(c.account)re=De.r.createFromAccountInfo(c.account),L=new m(re,this.loadIdToken(u.id_token,re.homeAccountId,c.account.environment,c.account.tenantId),this.loadAccessToken(c,u,re.homeAccountId,c.account.environment,c.account.tenantId,d),this.loadRefreshToken(c,u,re.homeAccountId,c.account.environment));else{if(!c.authority)throw(0,T.Z_)(Ge.Jd);{const de=se.generateAuthority(c.authority,c.azureCloudOptions);if(Q=new se(de,this.config.system.networkClient,this.storage,{protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},this.logger),d.clientInfo)this.logger.trace("TokenCache - homeAccountId from options"),re=this.loadAccount(y,Q,d.clientInfo),L=new m(re,this.loadIdToken(u.id_token,re.homeAccountId,Q.hostnameAndPort,Q.tenant),this.loadAccessToken(c,u,re.homeAccountId,Q.hostnameAndPort,Q.tenant,d),this.loadRefreshToken(c,u,re.homeAccountId,Q.hostnameAndPort));else{if(!u.client_info)throw(0,T.Z_)(Ge.Jd);this.logger.trace("TokenCache - homeAccountId from response"),re=this.loadAccount(y,Q,u.client_info),L=new m(re,this.loadIdToken(u.id_token,re.homeAccountId,Q.hostnameAndPort,Q.tenant),this.loadAccessToken(c,u,re.homeAccountId,Q.hostnameAndPort,Q.tenant,d),this.loadRefreshToken(c,u,re.homeAccountId,Q.hostnameAndPort))}}}return this.generateAuthenticationResult(c,y,L,re,Q)}loadAccount(c,u,d,y){let L;if(y?L=y:void 0!==u.authorityType&&d&&(L=De.r.generateHomeAccountId(d,u.authorityType,this.logger,this.cryptoObj,c)),!L)throw(0,T.Z_)(Ge.Jd);const Q=De.r.createAccount({homeAccountId:L,idTokenClaims:c,clientInfo:d,environment:u.hostnameAndPort},u);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading account"),this.storage.setAccount(Q),Q;throw(0,T.Z_)(Ge.Jd)}loadIdToken(c,u,d,y){const L=Be.Md(u,d,c,this.config.auth.clientId,y);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading id token"),this.storage.setIdTokenCredential(L),L;throw(0,T.Z_)(Ge.Jd)}loadAccessToken(c,u,d,y,L,Q){if(!u.access_token)return this.logger.verbose("TokenCache - No access token provided for caching"),null;if(!u.expires_in||!Q.extendedExpiresOn)throw(0,T.Z_)(Ge.Jd);const re=new Fn.i(c.scopes).printScopes(),de=Q.expiresOn||u.expires_in+(new Date).getTime()/1e3,Se=Be.Ds(d,y,u.access_token,this.config.auth.clientId,L,re,de,Q.extendedExpiresOn,xe.t);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading access token"),this.storage.setAccessTokenCredential(Se),Se;throw(0,T.Z_)(Ge.Jd)}loadRefreshToken(c,u,d,y){if(!u.refresh_token)return this.logger.verbose("TokenCache - No refresh token provided for caching"),null;const L=Be.OJ(d,y,u.refresh_token,this.config.auth.clientId);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading refresh token"),this.storage.setRefreshTokenCredential(L),L;throw(0,T.Z_)(Ge.Jd)}generateAuthenticationResult(c,u,d,y,L){let Te,Q=g.gT.EMPTY_STRING,re=[],de=null;return d?.accessToken&&(Q=d.accessToken.secret,re=Fn.i.fromString(d.accessToken.target).asArray(),de=new Date(1e3*Number(d.accessToken.expiresOn)),Te=new Date(1e3*Number(d.accessToken.extendedExpiresOn))),{authority:L?L.canonicalAuthority:g.gT.EMPTY_STRING,uniqueId:u.oid||u.sub||g.gT.EMPTY_STRING,tenantId:u.tid||g.gT.EMPTY_STRING,scopes:re,account:y.getAccountInfo(),idToken:d.idToken?.secret||"",idTokenClaims:u||{},accessToken:Q,fromCache:!0,expiresOn:de,correlationId:c.correlationId||g.gT.EMPTY_STRING,requestId:g.gT.EMPTY_STRING,extExpiresOn:Te,familyId:g.gT.EMPTY_STRING,tokenType:d?.accessToken?.tokenType||g.gT.EMPTY_STRING,state:g.gT.EMPTY_STRING,cloudGraphHostName:y.cloudGraphHostName||g.gT.EMPTY_STRING,msGraphHost:y.msGraphHost||g.gT.EMPTY_STRING,code:void 0,fromNativeBroker:!1}}}class $y extends Oe{constructor(c){super(c),this.includeRedirectUri=!1}}class Vy extends ti{constructor(c,u,d,y,L,Q,re,de,Te,Se){super(c,u,d,y,L,Q,de,Te,Se),this.apiId=re}acquireToken(c){var u=this;return(0,E.Z)(function*(){if(!c.code)throw(0,T.Z_)(Ge.Aj);const d=yield _(u.initializeAuthorizationRequest.bind(u),w.Ak.StandardInteractionClientInitializeAuthorizationRequest,u.logger,u.performanceClient,c.correlationId)(c,N.s_.Silent),y=u.initializeServerTelemetryManager(u.apiId);try{const L={...d,code:c.code},Q=yield _(u.getClientConfiguration.bind(u),w.Ak.StandardInteractionClientGetClientConfiguration,u.logger,u.performanceClient,c.correlationId)(y,d.authority),re=new $y(Q);u.logger.verbose("Auth code client created");const de=new Oi(re,u.browserStorage,L,u.logger,u.performanceClient);return _(de.handleCodeResponseFromServer.bind(de),w.Ak.HandleCodeResponseFromServer,u.logger,u.performanceClient,c.correlationId)({code:c.code,msgraph_host:c.msGraphHost,cloud_graph_host_name:c.cloudGraphHostName,cloud_instance_host_name:c.cloudInstanceHostName},d,!1)}catch(L){throw L instanceof U.l4&&(L.setCorrelationId(u.correlationId),y.cacheFailedRequest(L)),L}})()}logout(){return Promise.reject((0,T.Z_)(Ge.I9))}}class Va{constructor(c){this.atsAsyncMeasurement=void 0,this.operatingContext=c,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=c.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new p.Q(this.logger,this.performanceClient):O.d,this.eventHandler=new ur.b(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new tn(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,function ce(ke){const c=ke.cloudDiscoveryMetadata;let u;if(c)try{u=JSON.parse(c)}catch{throw(0,D.ei)(te.E)}return{canonicalAuthority:ke.authority?ie(ke.authority):void 0,knownAuthorities:ke.knownAuthorities,cloudDiscoveryMetadata:u}}(this.config.auth)):((ke,c)=>new tn(this.config.auth.clientId,{cacheLocation:N.Ix.MemoryStorage,temporaryCacheLocation:N.Ix.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1},O.d,this.logger))(),this.nativeInternalStorage=new tn(this.config.auth.clientId,{cacheLocation:N.Ix.MemoryStorage,temporaryCacheLocation:N.Ix.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1},this.browserCrypto,this.logger),this.tokenCache=new Hy(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}static createController(c){return(0,E.Z)(function*(){const u=new Va(c);return yield u.initialize(),u})()}trackPageVisibility(){this.atsAsyncMeasurement&&(this.logger.info("Perf: Visibility change detected"),this.atsAsyncMeasurement.increment({visibilityChangeCount:1}))}initialize(){var c=this;return(0,E.Z)(function*(){if(c.logger.trace("initialize called"),c.initialized)return void c.logger.info("initialize has already been called, exiting early.");const u=c.config.system.allowNativeBroker,d=c.performanceClient.startMeasurement(w.Ak.InitializeClientApplication);if(c.eventHandler.emitEvent(tt.t.INITIALIZE_START),u)try{c.nativeExtensionProvider=yield ot.createProvider(c.logger,c.config.system.nativeBrokerHandshakeTimeout,c.performanceClient)}catch(y){c.logger.verbose(y)}c.config.cache.claimsBasedCachingEnabled||(c.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),yield _(c.browserStorage.clearTokensAndKeysWithClaims.bind(c.browserStorage),w.Ak.ClearTokensAndKeysWithClaims,c.logger,c.performanceClient)(c.performanceClient)),c.initialized=!0,c.eventHandler.emitEvent(tt.t.INITIALIZE_END),d.end({allowNativeBroker:u,success:!0})})()}handleRedirectPromise(c){var u=this;return(0,E.Z)(function*(){u.logger.verbose("handleRedirectPromise called"),(0,ut.eQ)(u.initialized);const d=u.getAllAccounts();if(u.isBrowserEnvironment){const y=c||"";let L=u.redirectResponse.get(y);if(typeof L>"u"){u.eventHandler.emitEvent(tt.t.HANDLE_REDIRECT_START,N.s_.Redirect),u.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise");const Q=u.browserStorage.getCachedNativeRequest();let re;if(Q&&ot.isNativeAvailable(u.config,u.logger,u.nativeExtensionProvider)&&u.nativeExtensionProvider&&!c)u.logger.trace("handleRedirectPromise - acquiring token from native platform"),re=new Rt(u.config,u.browserStorage,u.browserCrypto,u.logger,u.eventHandler,u.navigationClient,N.WN.handleRedirectPromise,u.performanceClient,u.nativeExtensionProvider,Q.accountId,u.nativeInternalStorage,Q.correlationId).handleRedirectPromise();else{u.logger.trace("handleRedirectPromise - acquiring token from web flow");const de=u.browserStorage.getTemporaryCache(N.c4.CORRELATION_ID,!0)||g.gT.EMPTY_STRING;re=u.createRedirectClient(de).handleRedirectPromise(c)}L=re.then(de=>(de&&(d.length<u.getAllAccounts().length?(u.eventHandler.emitEvent(tt.t.LOGIN_SUCCESS,N.s_.Redirect,de),u.logger.verbose("handleRedirectResponse returned result, login success")):(u.eventHandler.emitEvent(tt.t.ACQUIRE_TOKEN_SUCCESS,N.s_.Redirect,de),u.logger.verbose("handleRedirectResponse returned result, acquire token success"))),u.eventHandler.emitEvent(tt.t.HANDLE_REDIRECT_END,N.s_.Redirect),de)).catch(de=>{throw u.eventHandler.emitEvent(d.length>0?tt.t.ACQUIRE_TOKEN_FAILURE:tt.t.LOGIN_FAILURE,N.s_.Redirect,null,de),u.eventHandler.emitEvent(tt.t.HANDLE_REDIRECT_END,N.s_.Redirect),de}),u.redirectResponse.set(y,L)}else u.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call");return L}return u.logger.verbose("handleRedirectPromise returns null, not browser environment"),null})()}acquireTokenRedirect(c){var u=this;return(0,E.Z)(function*(){const d=u.getRequestCorrelationId(c);u.logger.verbose("acquireTokenRedirect called",d),u.preflightBrowserEnvironmentCheck(N.s_.Redirect);const y=u.getAllAccounts().length>0;let L;return u.eventHandler.emitEvent(y?tt.t.ACQUIRE_TOKEN_START:tt.t.LOGIN_START,N.s_.Redirect,c),L=u.nativeExtensionProvider&&u.canUseNative(c)?new Rt(u.config,u.browserStorage,u.browserCrypto,u.logger,u.eventHandler,u.navigationClient,N.WN.acquireTokenRedirect,u.performanceClient,u.nativeExtensionProvider,u.getNativeAccountId(c),u.nativeInternalStorage,d).acquireTokenRedirect(c).catch(re=>{if(re instanceof Kr&&ni(re))return u.nativeExtensionProvider=void 0,u.createRedirectClient(d).acquireToken(c);if(re instanceof me.Yo)return u.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),u.createRedirectClient(d).acquireToken(c);throw u.getBrowserStorage().setInteractionInProgress(!1),re}):u.createRedirectClient(d).acquireToken(c),L.catch(Q=>{throw u.eventHandler.emitEvent(y?tt.t.ACQUIRE_TOKEN_FAILURE:tt.t.LOGIN_FAILURE,N.s_.Redirect,null,Q),Q})})()}acquireTokenPopup(c){const u=this.getRequestCorrelationId(c),d=this.performanceClient.startMeasurement(w.Ak.AcquireTokenPopup,u);try{this.logger.verbose("acquireTokenPopup called",u),this.preflightBrowserEnvironmentCheck(N.s_.Popup)}catch(Q){return Promise.reject(Q)}const y=this.getAllAccounts();let L;return this.eventHandler.emitEvent(y.length>0?tt.t.ACQUIRE_TOKEN_START:tt.t.LOGIN_START,N.s_.Popup,c),L=this.canUseNative(c)?this.acquireTokenNative({...c,correlationId:u},N.WN.acquireTokenPopup).then(Q=>(this.getBrowserStorage().setInteractionInProgress(!1),d.end({success:!0,isNativeBroker:!0,requestId:Q.requestId}),Q)).catch(Q=>{if(Q instanceof Kr&&ni(Q))return this.nativeExtensionProvider=void 0,this.createPopupClient(u).acquireToken(c);if(Q instanceof me.Yo)return this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createPopupClient(u).acquireToken(c);throw this.getBrowserStorage().setInteractionInProgress(!1),Q}):this.createPopupClient(u).acquireToken(c),L.then(Q=>(y.length<this.getAllAccounts().length?this.eventHandler.emitEvent(tt.t.LOGIN_SUCCESS,N.s_.Popup,Q):this.eventHandler.emitEvent(tt.t.ACQUIRE_TOKEN_SUCCESS,N.s_.Popup,Q),d.add({accessTokenSize:Q.accessToken.length,idTokenSize:Q.idToken.length}),d.end({success:!0,requestId:Q.requestId}),Q)).catch(Q=>(this.eventHandler.emitEvent(y.length>0?tt.t.ACQUIRE_TOKEN_FAILURE:tt.t.LOGIN_FAILURE,N.s_.Popup,null,Q),d.end({errorCode:Q.errorCode,subErrorCode:Q.subError,success:!1}),Promise.reject(Q)))}trackPageVisibilityWithMeasurement(){const c=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;c&&(this.logger.info("Perf: Visibility change detected in ",c.event.name),c.increment({visibilityChangeCount:1}))}ssoSilent(c){var u=this;return(0,E.Z)(function*(){const d=u.getRequestCorrelationId(c),y={...c,prompt:c.prompt,correlationId:d};let L;return u.preflightBrowserEnvironmentCheck(N.s_.Silent),u.ssoSilentMeasurement=u.performanceClient.startMeasurement(w.Ak.SsoSilent,d),u.ssoSilentMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",u.trackPageVisibilityWithMeasurement),u.logger.verbose("ssoSilent called",d),u.eventHandler.emitEvent(tt.t.SSO_SILENT_START,N.s_.Silent,y),L=u.canUseNative(y)?u.acquireTokenNative(y,N.WN.ssoSilent).catch(Q=>{if(Q instanceof Kr&&ni(Q))return u.nativeExtensionProvider=void 0,u.createSilentIframeClient(y.correlationId).acquireToken(y);throw Q}):u.createSilentIframeClient(y.correlationId).acquireToken(y),L.then(Q=>(u.eventHandler.emitEvent(tt.t.SSO_SILENT_SUCCESS,N.s_.Silent,Q),u.ssoSilentMeasurement?.add({accessTokenSize:Q.accessToken.length,idTokenSize:Q.idToken.length}),u.ssoSilentMeasurement?.end({success:!0,isNativeBroker:Q.fromNativeBroker,requestId:Q.requestId}),Q)).catch(Q=>{throw u.eventHandler.emitEvent(tt.t.SSO_SILENT_FAILURE,N.s_.Silent,null,Q),u.ssoSilentMeasurement?.end({errorCode:Q.errorCode,subErrorCode:Q.subError,success:!1}),Q}).finally(()=>{document.removeEventListener("visibilitychange",u.trackPageVisibilityWithMeasurement)})})()}acquireTokenByCode(c){var u=this;return(0,E.Z)(function*(){const d=u.getRequestCorrelationId(c);u.preflightBrowserEnvironmentCheck(N.s_.Silent),u.logger.trace("acquireTokenByCode called",d),u.eventHandler.emitEvent(tt.t.ACQUIRE_TOKEN_BY_CODE_START,N.s_.Silent,c);const y=u.performanceClient.startMeasurement(w.Ak.AcquireTokenByCode,d);try{if(c.code&&c.nativeAccountId)throw(0,T.Z_)(Ge.LL);if(c.code){const L=c.code;let Q=u.hybridAuthCodeResponses.get(L);return Q?(u.logger.verbose("Existing acquireTokenByCode request found",d),y.discard()):(u.logger.verbose("Initiating new acquireTokenByCode request",d),Q=u.acquireTokenByCodeAsync({...c,correlationId:d}).then(re=>(u.eventHandler.emitEvent(tt.t.ACQUIRE_TOKEN_BY_CODE_SUCCESS,N.s_.Silent,re),u.hybridAuthCodeResponses.delete(L),y.add({accessTokenSize:re.accessToken.length,idTokenSize:re.idToken.length}),y.end({success:!0,isNativeBroker:re.fromNativeBroker,requestId:re.requestId}),re)).catch(re=>{throw u.hybridAuthCodeResponses.delete(L),u.eventHandler.emitEvent(tt.t.ACQUIRE_TOKEN_BY_CODE_FAILURE,N.s_.Silent,null,re),y.end({errorCode:re.errorCode,subErrorCode:re.subError,success:!1}),re}),u.hybridAuthCodeResponses.set(L,Q)),Q}if(c.nativeAccountId){if(u.canUseNative(c,c.nativeAccountId))return u.acquireTokenNative({...c,correlationId:d},N.WN.acquireTokenByCode,c.nativeAccountId).catch(L=>{throw L instanceof Kr&&ni(L)&&(u.nativeExtensionProvider=void 0),L});throw(0,T.Z_)(Ge.KA)}throw(0,T.Z_)(Ge.Dy)}catch(L){throw u.eventHandler.emitEvent(tt.t.ACQUIRE_TOKEN_BY_CODE_FAILURE,N.s_.Silent,null,L),y.end({errorCode:L instanceof U.l4&&L.errorCode||void 0,subErrorCode:L instanceof U.l4&&L.subError||void 0,success:!1}),L}})()}acquireTokenByCodeAsync(c){var u=this;return(0,E.Z)(function*(){return u.logger.trace("acquireTokenByCodeAsync called",c.correlationId),u.acquireTokenByCodeAsyncMeasurement=u.performanceClient.startMeasurement(w.Ak.AcquireTokenByCodeAsync,c.correlationId),u.acquireTokenByCodeAsyncMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",u.trackPageVisibilityWithMeasurement),yield u.createSilentAuthCodeClient(c.correlationId).acquireToken(c).then(L=>(u.acquireTokenByCodeAsyncMeasurement?.end({success:!0,fromCache:L.fromCache,isNativeBroker:L.fromNativeBroker,requestId:L.requestId}),L)).catch(L=>{throw u.acquireTokenByCodeAsyncMeasurement?.end({errorCode:L.errorCode,subErrorCode:L.subError,success:!1}),L}).finally(()=>{document.removeEventListener("visibilitychange",u.trackPageVisibilityWithMeasurement)})})()}acquireTokenFromCache(c,u,d){var y=this;return(0,E.Z)(function*(){switch(y.performanceClient.addQueueMeasurement(w.Ak.AcquireTokenFromCache,u.correlationId),d){case N.lu.Default:case N.lu.AccessToken:case N.lu.AccessTokenAndRefreshToken:return _(c.acquireToken.bind(c),w.Ak.SilentCacheClientAcquireToken,y.logger,y.performanceClient,u.correlationId)(u);default:throw(0,B.zP)(q.s$)}})()}acquireTokenByRefreshToken(c,u){var d=this;return(0,E.Z)(function*(){switch(d.performanceClient.addQueueMeasurement(w.Ak.AcquireTokenByRefreshToken,c.correlationId),u){case N.lu.Default:case N.lu.AccessTokenAndRefreshToken:case N.lu.RefreshToken:case N.lu.RefreshTokenAndNetwork:const y=d.createSilentRefreshClient(c.correlationId);return _(y.acquireToken.bind(y),w.Ak.SilentRefreshClientAcquireToken,d.logger,d.performanceClient,c.correlationId)(c);default:throw(0,B.zP)(q.s$)}})()}acquireTokenBySilentIframe(c){var u=this;return(0,E.Z)(function*(){u.performanceClient.addQueueMeasurement(w.Ak.AcquireTokenBySilentIframe,c.correlationId);const d=u.createSilentIframeClient(c.correlationId);return _(d.acquireToken.bind(d),w.Ak.SilentIframeClientAcquireToken,u.logger,u.performanceClient,c.correlationId)(c)})()}logout(c){var u=this;return(0,E.Z)(function*(){const d=u.getRequestCorrelationId(c);return u.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",d),u.logoutRedirect({correlationId:d,...c})})()}logoutRedirect(c){var u=this;return(0,E.Z)(function*(){const d=u.getRequestCorrelationId(c);return u.preflightBrowserEnvironmentCheck(N.s_.Redirect),u.createRedirectClient(d).logout(c)})()}logoutPopup(c){try{const u=this.getRequestCorrelationId(c);return this.preflightBrowserEnvironmentCheck(N.s_.Popup),this.createPopupClient(u).logout(c)}catch(u){return Promise.reject(u)}}clearCache(c){var u=this;return(0,E.Z)(function*(){const d=u.getRequestCorrelationId(c);return u.createSilentCacheClient(d).logout(c)})()}getAllAccounts(c){return this.logger.verbose("getAllAccounts called"),this.isBrowserEnvironment?this.browserStorage.getAllAccounts(c):[]}getAccount(c){if(this.logger.trace("getAccount called"),0===Object.keys(c).length)return this.logger.warning("getAccount: No accountFilter provided"),null;const u=this.browserStorage.getAccountInfoFilteredBy(c);return u?(this.logger.verbose("getAccount: Account matching provided filter found, returning"),u):(this.logger.verbose("getAccount: No matching account found, returning null"),null)}getAccountByUsername(c){if(this.logger.trace("getAccountByUsername called"),!c)return this.logger.warning("getAccountByUsername: No username provided"),null;const u=this.browserStorage.getAccountInfoFilteredBy({username:c});return u?(this.logger.verbose("getAccountByUsername: Account matching username found, returning"),this.logger.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${c}`),u):(this.logger.verbose("getAccountByUsername: No matching account found, returning null"),null)}getAccountByHomeId(c){if(this.logger.trace("getAccountByHomeId called"),!c)return this.logger.warning("getAccountByHomeId: No homeAccountId provided"),null;const u=this.browserStorage.getAccountInfoFilteredBy({homeAccountId:c});return u?(this.logger.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),this.logger.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${c}`),u):(this.logger.verbose("getAccountByHomeId: No matching account found, returning null"),null)}getAccountByLocalId(c){if(this.logger.trace("getAccountByLocalId called"),!c)return this.logger.warning("getAccountByLocalId: No localAccountId provided"),null;const u=this.browserStorage.getAccountInfoFilteredBy({localAccountId:c});return u?(this.logger.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),this.logger.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${c}`),u):(this.logger.verbose("getAccountByLocalId: No matching account found, returning null"),null)}setActiveAccount(c){this.browserStorage.setActiveAccount(c)}getActiveAccount(){return this.browserStorage.getActiveAccount()}hydrateCache(c,u){var d=this;return(0,E.Z)(function*(){d.logger.verbose("hydrateCache called");const y=De.r.createFromAccountInfo(c.account,c.cloudGraphHostName,c.msGraphHost);return d.browserStorage.setAccount(y),c.fromNativeBroker?(d.logger.verbose("Response was from native broker, storing in-memory"),d.nativeInternalStorage.hydrateCache(c,u)):d.browserStorage.hydrateCache(c,u)})()}preflightBrowserEnvironmentCheck(c,u=!1){if(this.logger.verbose("preflightBrowserEnvironmentCheck started"),(0,ut.$S)(this.isBrowserEnvironment),(0,ut.$V)(c,this.config.system.allowRedirectInIframe),(0,ut.ET)(),(0,ut.L7)(),(0,ut.eQ)(this.initialized),c===N.s_.Redirect&&this.config.cache.cacheLocation===N.Ix.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw(0,le.Z1)(Ce.xC);(c===N.s_.Redirect||c===N.s_.Popup)&&this.preflightInteractiveRequest(!u)}preflightInteractiveRequest(c){this.logger.verbose("preflightInteractiveRequest called, validating app environment"),(0,ut.ET)(),c&&this.getBrowserStorage().setInteractionInProgress(!0)}acquireTokenNative(c,u,d){var y=this;return(0,E.Z)(function*(){if(y.logger.trace("acquireTokenNative called"),!y.nativeExtensionProvider)throw(0,T.Z_)(Ge.V7);return new Rt(y.config,y.browserStorage,y.browserCrypto,y.logger,y.eventHandler,y.navigationClient,u,y.performanceClient,y.nativeExtensionProvider,d||y.getNativeAccountId(c),y.nativeInternalStorage,c.correlationId).acquireToken(c)})()}canUseNative(c,u){if(this.logger.trace("canUseNative called"),!ot.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,c.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(c.prompt)switch(c.prompt){case g.NJ.NONE:case g.NJ.CONSENT:case g.NJ.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace(`canUseNative: prompt = ${c.prompt} is not compatible with native flow, returning false`),!1}return!(!u&&!this.getNativeAccountId(c)&&(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),1))}getNativeAccountId(c){const u=c.account||this.browserStorage.getAccountInfoFilteredBy({loginHint:c.loginHint,sid:c.sid})||this.getActiveAccount();return u&&u.nativeAccountId||""}createPopupClient(c){return new Fe(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,c)}createRedirectClient(c){return new ct(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,c)}createSilentIframeClient(c){return new ko(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,N.WN.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,c)}createSilentCacheClient(c){return new fs(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,c)}createSilentRefreshClient(c){return new jy(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,c)}createSilentAuthCodeClient(c){return new Vy(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,N.WN.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,c)}addEventCallback(c){return this.eventHandler.addEventCallback(c)}removeEventCallback(c){this.eventHandler.removeEventCallback(c)}addPerformanceCallback(c){return this.performanceClient.addPerformanceCallback(c)}removePerformanceCallback(c){return this.performanceClient.removePerformanceCallback(c)}enableAccountStorageEvents(){this.eventHandler.enableAccountStorageEvents()}disableAccountStorageEvents(){this.eventHandler.disableAccountStorageEvents()}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(c){this.logger=c}initializeWrapperLibrary(c,u){this.browserStorage.setWrapperMetadata(c,u)}setNavigationClient(c){this.navigationClient=c}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}getBrowserStorage(){return this.browserStorage}isBrowserEnv(){return this.isBrowserEnvironment}getEventHandler(){return this.eventHandler}getRequestCorrelationId(c){return c?.correlationId?c.correlationId:this.isBrowserEnvironment?(0,wt.nn)():g.gT.EMPTY_STRING}loginRedirect(c){var u=this;return(0,E.Z)(function*(){const d=u.getRequestCorrelationId(c);return u.logger.verbose("loginRedirect called",d),u.acquireTokenRedirect({correlationId:d,...c||N.yo})})()}loginPopup(c){const u=this.getRequestCorrelationId(c);return this.logger.verbose("loginPopup called",u),this.acquireTokenPopup({correlationId:u,...c||N.yo})}acquireTokenSilent(c){var u=this;return(0,E.Z)(function*(){const d=u.getRequestCorrelationId(c),y=u.performanceClient.startMeasurement(w.Ak.AcquireTokenSilent,d);y.add({cacheLookupPolicy:c.cacheLookupPolicy}),u.preflightBrowserEnvironmentCheck(N.s_.Silent),u.logger.verbose("acquireTokenSilent called",d);const L=c.account||u.getActiveAccount();if(!L)throw(0,T.Z_)(Ge.wH);const re=JSON.stringify({clientId:u.config.auth.clientId,authority:c.authority||g.gT.EMPTY_STRING,scopes:c.scopes,homeAccountIdentifier:L.homeAccountId,claims:c.claims,authenticationScheme:c.authenticationScheme,resourceRequestMethod:c.resourceRequestMethod,resourceRequestUri:c.resourceRequestUri,shrClaims:c.shrClaims,sshKid:c.sshKid,shrOptions:c.shrOptions}),de=u.activeSilentTokenRequests.get(re);if(typeof de>"u"){u.logger.verbose("acquireTokenSilent called for the first time, storing active request",d);const Te=_(u.acquireTokenSilentAsync.bind(u),w.Ak.AcquireTokenSilentAsync,u.logger,u.performanceClient,d)({...c,correlationId:d},L).then(Se=>(u.activeSilentTokenRequests.delete(re),y.add({accessTokenSize:Se.accessToken.length,idTokenSize:Se.idToken.length}),y.end({success:!0,fromCache:Se.fromCache,isNativeBroker:Se.fromNativeBroker,cacheLookupPolicy:c.cacheLookupPolicy,requestId:Se.requestId}),Se)).catch(Se=>{throw u.activeSilentTokenRequests.delete(re),y.end({errorCode:Se.errorCode,subErrorCode:Se.subError,success:!1}),Se});return u.activeSilentTokenRequests.set(re,Te),Te}return u.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",d),y.discard(),de})()}acquireTokenSilentAsync(c,u){var d=this;return(0,E.Z)(function*(){let y;if(d.performanceClient.addQueueMeasurement(w.Ak.AcquireTokenSilentAsync,c.correlationId),d.eventHandler.emitEvent(tt.t.ACQUIRE_TOKEN_START,N.s_.Silent,c),d.atsAsyncMeasurement=d.performanceClient.startMeasurement(w.Ak.AcquireTokenSilentAsync,c.correlationId),d.atsAsyncMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",d.trackPageVisibility),ot.isNativeAvailable(d.config,d.logger,d.nativeExtensionProvider,c.authenticationScheme)&&u.nativeAccountId){d.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform");const L={...c,account:u};y=d.acquireTokenNative(L,N.WN.acquireTokenSilent_silentFlow).catch(function(){var Q=(0,E.Z)(function*(re){if(re instanceof Kr&&ni(re))return d.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),d.nativeExtensionProvider=void 0,d.createSilentIframeClient(c.correlationId).acquireToken(c);throw re});return function(re){return Q.apply(this,arguments)}}())}else{d.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow");const L=d.createSilentCacheClient(c.correlationId),Q=yield _(L.initializeSilentRequest.bind(L),w.Ak.InitializeSilentRequest,d.logger,d.performanceClient,c.correlationId)(c,u),re=c.cacheLookupPolicy||N.lu.Default;y=_(d.acquireTokenFromCache.bind(d),w.Ak.AcquireTokenFromCache,d.logger,d.performanceClient,Q.correlationId)(L,Q,re).catch(de=>{if(c.cacheLookupPolicy===N.lu.AccessToken)throw de;return(0,ut.ET)(),d.eventHandler.emitEvent(tt.t.ACQUIRE_TOKEN_NETWORK_START,N.s_.Silent,Q),_(d.acquireTokenByRefreshToken.bind(d),w.Ak.AcquireTokenByRefreshToken,d.logger,d.performanceClient,Q.correlationId)(Q,re).catch(Te=>{if(!((Te instanceof me.Yo||Te.errorCode!==N.qx.INVALID_GRANT_ERROR&&Te.errorCode!==q.s$)&&Te.errorCode!==Ee.I2||re!==N.lu.Default&&re!==N.lu.Skip&&re!==N.lu.RefreshTokenAndNetwork))return d.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",c.correlationId),_(d.acquireTokenBySilentIframe.bind(d),w.Ak.AcquireTokenBySilentIframe,d.logger,d.performanceClient,Q.correlationId)(Q);throw Te})})}return y.then(L=>(d.eventHandler.emitEvent(tt.t.ACQUIRE_TOKEN_SUCCESS,N.s_.Silent,L),d.atsAsyncMeasurement?.end({success:!0,fromCache:L.fromCache,isNativeBroker:L.fromNativeBroker,requestId:L.requestId}),L)).catch(L=>{throw d.eventHandler.emitEvent(tt.t.ACQUIRE_TOKEN_FAILURE,N.s_.Silent,null,L),d.atsAsyncMeasurement?.end({errorCode:L.errorCode,subErrorCode:L.subError,success:!1}),L}).finally(()=>{document.removeEventListener("visibilitychange",d.trackPageVisibility)})})()}}},2690:(fe,F,S)=>{"use strict";S.d(F,{$5:()=>b,Au:()=>K,Fv:()=>J,Mg:()=>j,PP:()=>C,Xx:()=>q,nn:()=>k,qz:()=>V});var E=S(5861),p=S(8293),O=S(7979),R=S(8593),$=S(7377);const B="SHA-256",M=new Uint8Array([1,0,1]),D={name:"RSASSA-PKCS1-v1_5",hash:B,modulusLength:2048,publicExponent:M};function V(se){if(!("crypto"in window))throw se.error("BrowserCrypto: crypto interface is unavailable"),(0,p.Z_)($.TR);se.verbose("BrowserCrypto: modern crypto interface available")}function J(se,ie,ce){return z.apply(this,arguments)}function z(){return(z=(0,E.Z)(function*(se,ie,ce){ie?.addQueueMeasurement(O.Ak.Sha256Digest,ce);const De=(new TextEncoder).encode(se);return window.crypto.subtle.digest(B,De)})).apply(this,arguments)}function C(se){return window.crypto.getRandomValues(se)}function k(){return window.crypto.randomUUID()}function K(se,ie){return w.apply(this,arguments)}function w(){return(w=(0,E.Z)(function*(se,ie){return window.crypto.subtle.generateKey(D,se,ie)})).apply(this,arguments)}function j(se){return _.apply(this,arguments)}function _(){return(_=(0,E.Z)(function*(se){return window.crypto.subtle.exportKey(R.Mm,se)})).apply(this,arguments)}function b(se,ie,ce){return U.apply(this,arguments)}function U(){return(U=(0,E.Z)(function*(se,ie,ce){return window.crypto.subtle.importKey(R.Mm,se,D,ie,ce)})).apply(this,arguments)}function q(se,ie){return te.apply(this,arguments)}function te(){return(te=(0,E.Z)(function*(se,ie){return window.crypto.subtle.sign(D,se,ie)})).apply(this,arguments)}},2341:(fe,F,S)=>{"use strict";S.d(F,{Q:()=>q});var E=S(5861),p=S(7979),O=S(7481);const R="missing_kid_error",$="missing_alg_error",H={[R]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[$]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class B extends O.l4{constructor(ie,ce){super(ie,ce),this.name="JoseHeaderError",Object.setPrototypeOf(this,B.prototype)}}function g(se){return new B(se,H[se])}var M=S(5500);class D{constructor(ie){this.typ=ie.typ,this.alg=ie.alg,this.kid=ie.kid}static getShrHeaderString(ie){if(!ie.kid)throw g(R);if(!ie.alg)throw g($);const ce=new D({typ:ie.typ||M.xd.Pop,kid:ie.kid,alg:ie.alg});return JSON.stringify(ce)}}var V=S(1173),J=S(6787),z=S(2690),C=S(8293),k=S(8593),K=S(7377);class w{constructor(){this.dbName=k.H4,this.version=k.kd,this.tableName=k.Gv,this.dbOpen=!1}open(){var ie=this;return(0,E.Z)(function*(){return new Promise((ce,me)=>{const De=window.indexedDB.open(ie.dbName,ie.version);De.addEventListener("upgradeneeded",Ee=>{Ee.target.result.createObjectStore(ie.tableName)}),De.addEventListener("success",Ee=>{ie.db=Ee.target.result,ie.dbOpen=!0,ce()}),De.addEventListener("error",()=>me((0,C.Z_)(K.Pi)))})})()}closeConnection(){const ie=this.db;ie&&this.dbOpen&&(ie.close(),this.dbOpen=!1)}validateDbIsOpen(){var ie=this;return(0,E.Z)(function*(){if(!ie.dbOpen)return yield ie.open()})()}getItem(ie){var ce=this;return(0,E.Z)(function*(){return yield ce.validateDbIsOpen(),new Promise((me,De)=>{if(!ce.db)return De((0,C.Z_)(K.IL));const Be=ce.db.transaction([ce.tableName],"readonly").objectStore(ce.tableName).get(ie);Be.addEventListener("success",ze=>{const pe=ze;ce.closeConnection(),me(pe.target.result)}),Be.addEventListener("error",ze=>{ce.closeConnection(),De(ze)})})})()}setItem(ie,ce){var me=this;return(0,E.Z)(function*(){return yield me.validateDbIsOpen(),new Promise((De,Ee)=>{if(!me.db)return Ee((0,C.Z_)(K.IL));const ze=me.db.transaction([me.tableName],"readwrite").objectStore(me.tableName).put(ce,ie);ze.addEventListener("success",()=>{me.closeConnection(),De()}),ze.addEventListener("error",pe=>{me.closeConnection(),Ee(pe)})})})()}removeItem(ie){var ce=this;return(0,E.Z)(function*(){return yield ce.validateDbIsOpen(),new Promise((me,De)=>{if(!ce.db)return De((0,C.Z_)(K.IL));const Be=ce.db.transaction([ce.tableName],"readwrite").objectStore(ce.tableName).delete(ie);Be.addEventListener("success",()=>{ce.closeConnection(),me()}),Be.addEventListener("error",ze=>{ce.closeConnection(),De(ze)})})})()}getKeys(){var ie=this;return(0,E.Z)(function*(){return yield ie.validateDbIsOpen(),new Promise((ce,me)=>{if(!ie.db)return me((0,C.Z_)(K.IL));const He=ie.db.transaction([ie.tableName],"readonly").objectStore(ie.tableName).getAllKeys();He.addEventListener("success",Be=>{const ze=Be;ie.closeConnection(),ce(ze.target.result)}),He.addEventListener("error",Be=>{ie.closeConnection(),me(Be)})})})()}containsKey(ie){var ce=this;return(0,E.Z)(function*(){return yield ce.validateDbIsOpen(),new Promise((me,De)=>{if(!ce.db)return De((0,C.Z_)(K.IL));const Be=ce.db.transaction([ce.tableName],"readonly").objectStore(ce.tableName).count(ie);Be.addEventListener("success",ze=>{const pe=ze;ce.closeConnection(),me(1===pe.target.result)}),Be.addEventListener("error",ze=>{ce.closeConnection(),De(ze)})})})()}deleteDatabase(){var ie=this;return(0,E.Z)(function*(){return ie.db&&ie.dbOpen&&ie.closeConnection(),new Promise((ce,me)=>{const De=window.indexedDB.deleteDatabase(k.H4);De.addEventListener("success",()=>ce(!0)),De.addEventListener("blocked",()=>ce(!0)),De.addEventListener("error",()=>me(!1))})})()}}var j=S(6475);class _{constructor(ie,ce){this.inMemoryCache=new j.k,this.indexedDBCache=new w,this.logger=ie,this.storeName=ce}handleDatabaseAccessError(ie){if(!(ie instanceof C.Ut&&ie.errorCode===K.Pi))throw ie;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")}getItem(ie){var ce=this;return(0,E.Z)(function*(){const me=ce.inMemoryCache.getItem(ie);if(!me)try{return ce.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),yield ce.indexedDBCache.getItem(ie)}catch(De){ce.handleDatabaseAccessError(De)}return me})()}setItem(ie,ce){var me=this;return(0,E.Z)(function*(){me.inMemoryCache.setItem(ie,ce);try{yield me.indexedDBCache.setItem(ie,ce)}catch(De){me.handleDatabaseAccessError(De)}})()}removeItem(ie){var ce=this;return(0,E.Z)(function*(){ce.inMemoryCache.removeItem(ie);try{yield ce.indexedDBCache.removeItem(ie)}catch(me){ce.handleDatabaseAccessError(me)}})()}getKeys(){var ie=this;return(0,E.Z)(function*(){const ce=ie.inMemoryCache.getKeys();if(0===ce.length)try{return ie.logger.verbose("In-memory cache is empty, now querying persistent storage."),yield ie.indexedDBCache.getKeys()}catch(me){ie.handleDatabaseAccessError(me)}return ce})()}containsKey(ie){var ce=this;return(0,E.Z)(function*(){const me=ce.inMemoryCache.containsKey(ie);if(!me)try{return ce.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),yield ce.indexedDBCache.containsKey(ie)}catch(De){ce.handleDatabaseAccessError(De)}return me})()}clearInMemory(){this.logger.verbose(`Deleting in-memory keystore ${this.storeName}`),this.inMemoryCache.clear(),this.logger.verbose(`In-memory keystore ${this.storeName} deleted`)}clearPersistent(){var ie=this;return(0,E.Z)(function*(){try{ie.logger.verbose("Deleting persistent keystore");const ce=yield ie.indexedDBCache.deleteDatabase();return ce&&ie.logger.verbose("Persistent keystore deleted"),ce}catch(ce){return ie.handleDatabaseAccessError(ce),!1}})()}}class U{constructor(ie){this.logger=ie,this.asymmetricKeys=new _(this.logger,"asymmetricKeys"),this.symmetricKeys=new _(this.logger,"symmetricKeys")}clear(){var ie=this;return(0,E.Z)(function*(){ie.asymmetricKeys.clearInMemory(),ie.symmetricKeys.clearInMemory();try{return yield ie.asymmetricKeys.clearPersistent(),!0}catch(ce){return ce instanceof Error?ie.logger.error(`Clearing keystore failed with error: ${ce.message}`):ie.logger.error("Clearing keystore failed with unknown error"),!1}})()}}let q=(()=>{class se{constructor(ce,me){this.logger=ce,(0,z.qz)(ce),this.cache=new U(this.logger),this.performanceClient=me}createNewGuid(){return(0,z.nn)()}base64Encode(ce){return(0,V.h$)(ce)}base64Decode(ce){return(0,J.t)(ce)}getPublicKeyThumbprint(ce){var me=this;return(0,E.Z)(function*(){const De=me.performanceClient?.startMeasurement(p.Ak.CryptoOptsGetPublicKeyThumbprint,ce.correlationId),Ee=yield(0,z.Au)(se.EXTRACTABLE,se.POP_KEY_USAGES),He=yield(0,z.Mg)(Ee.publicKey),ze=te({e:He.e,kty:He.kty,n:He.n}),pe=yield me.hashString(ze),G=yield(0,z.Mg)(Ee.privateKey),oe=yield(0,z.$5)(G,!1,["sign"]);return yield me.cache.asymmetricKeys.setItem(pe,{privateKey:oe,publicKey:Ee.publicKey,requestMethod:ce.resourceRequestMethod,requestUri:ce.resourceRequestUri}),De&&De.end({success:!0}),pe})()}removeTokenBindingKey(ce){var me=this;return(0,E.Z)(function*(){return yield me.cache.asymmetricKeys.removeItem(ce),!(yield me.cache.asymmetricKeys.containsKey(ce))})()}clearKeystore(){var ce=this;return(0,E.Z)(function*(){return yield ce.cache.clear()})()}signJwt(ce,me,De,Ee){var He=this;return(0,E.Z)(function*(){const Be=He.performanceClient?.startMeasurement(p.Ak.CryptoOptsSignJwt,Ee),ze=yield He.cache.asymmetricKeys.getItem(me);if(!ze)throw(0,C.Z_)(K.XM);const pe=yield(0,z.Mg)(ze.publicKey),G=te(pe),oe=(0,V._j)(JSON.stringify({kid:me})),ee=D.getShrHeaderString({...De?.header,alg:pe.alg,kid:oe}),ue=(0,V._j)(ee);ce.cnf={jwk:JSON.parse(G)};const T=`${ue}.${(0,V._j)(JSON.stringify(ce))}`,le=(new TextEncoder).encode(T),Ce=yield(0,z.Xx)(ze.privateKey,le),Ke=`${T}.${(0,V.Wy)(new Uint8Array(Ce))}`;return Be&&Be.end({success:!0}),Ke})()}hashString(ce){return(0,E.Z)(function*(){const me=yield(0,z.Fv)(ce),De=new Uint8Array(me);return(0,V.Wy)(De)})()}}return se.POP_KEY_USAGES=["sign","verify"],se.EXTRACTABLE=!0,se})();function te(se){return JSON.stringify(se,Object.keys(se).sort())}},6787:(fe,F,S)=>{"use strict";S.d(F,{t:()=>O});var E=S(8293),p=S(7377);function O($){return(new TextDecoder).decode(function R($){let H=$.replace(/-/g,"+").replace(/_/g,"/");switch(H.length%4){case 0:break;case 2:H+="==";break;case 3:H+="=";break;default:throw(0,E.Z_)(p.lZ)}const B=atob(H);return Uint8Array.from(B,g=>g.codePointAt(0)||0)}($))}},1173:(fe,F,S)=>{"use strict";function E($){return encodeURIComponent(O($).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function p($){return R($).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function O($){return R((new TextEncoder).encode($))}function R($){const H=Array.from($,B=>String.fromCodePoint(B)).join("");return btoa(H)}S.d(F,{Wy:()=>p,_j:()=>E,h$:()=>O})},8293:(fe,F,S)=>{"use strict";S.d(F,{Ut:()=>H,Z_:()=>B});var E=S(7481),p=S(7377);const O="For more visit: aka.ms/msaljs/browser-errors",R={[p.vD]:"The PKCE code challenge and verifier could not be generated.",[p.TR]:"The crypto object or function is not available.",[p._c]:"Navigation URI is empty. Please check stack trace for more info.",[p.nF]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${O}`,[p.Xk]:"Hash does not contain state. Please verify that the request originated from msal.",[p.S_]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${O}`,[p.$P]:"Unable to parse state. Please verify that the request originated from msal.",[p.yK]:"Hash contains state but the interaction type does not match the caller.",[p.Ck]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${O}`,[p.E]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[p.H]:"window.open returned null or undefined window object.",[p.h7]:"User cancelled the flow.",[p.ZT]:`Token acquisition in popup failed due to timeout.  ${O}`,[p.JA]:`Token acquisition in iframe failed due to timeout.  ${O}`,[p.b_]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[p.xO]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${O}`,[p.bj]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[p.h8]:"The iframe being monitored was closed prematurely.",[p.I9]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[p.wH]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[p.WQ]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[p.QO]:"No token request found in cache.",[p.e$]:"The cached token request could not be parsed.",[p.dT]:"No cached authority found.",[p.BO]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[p.Ut]:"Invalid cache type",[p.Dx]:"Login and token requests are not supported in non-browser environments.",[p.IL]:"Database is not open!",[p.Mq]:"No network connectivity. Check your internet connection.",[p.Dc]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[p.C8]:"Network request failed. Please check the network trace to determine root cause.",[p.w6]:"Failed to parse network response. Check network trace.",[p.Jd]:"Error loading token to cache.",[p.XM]:"Cryptographic Key or Keypair not found in browser storage.",[p.Aj]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[p.Dy]:"An authorization code or nativeAccountId must be provided to this flow.",[p.LL]:"Request cannot contain both spa code and native account id.",[p.Pi]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[p.KA]:`Unable to acquire token from native platform.  ${O}`,[p.hR]:"Timed out while attempting to establish connection to browser extension",[p.Wb]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[p.V7]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${O}`,[p.al]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${O}`,[p.o9]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[p.lZ]:"Invalid base64 encoded string."};class H extends E.l4{constructor(M){super(M,R[M]),Object.setPrototypeOf(this,H.prototype),this.name="BrowserAuthError"}}function B(g){return new H(g)}},7377:(fe,F,S)=>{"use strict";S.d(F,{$P:()=>B,Aj:()=>oe,BO:()=>ie,C8:()=>Be,Ck:()=>M,Dc:()=>He,Dx:()=>me,Dy:()=>ee,E:()=>D,H:()=>V,I9:()=>_,IL:()=>De,JA:()=>C,Jd:()=>pe,KA:()=>T,LL:()=>ue,Mq:()=>Ee,Pi:()=>m,QO:()=>q,S_:()=>H,TR:()=>p,Ut:()=>ce,V7:()=>Ce,WQ:()=>U,Wb:()=>le,XM:()=>G,Xk:()=>$,ZT:()=>z,_c:()=>O,al:()=>Me,b_:()=>k,bj:()=>w,dT:()=>se,e$:()=>te,h7:()=>J,h8:()=>j,hR:()=>N,lZ:()=>be,nF:()=>R,o9:()=>Ke,vD:()=>E,w6:()=>ze,wH:()=>b,xO:()=>K,yK:()=>g});const E="pkce_not_created",p="crypto_nonexistent",O="empty_navigate_uri",R="hash_empty_error",$="no_state_in_hash",H="hash_does_not_contain_known_properties",B="unable_to_parse_state",g="state_interaction_type_mismatch",M="interaction_in_progress",D="popup_window_error",V="empty_window_error",J="user_cancelled",z="monitor_popup_timeout",C="monitor_window_timeout",k="redirect_in_iframe",K="block_iframe_reload",w="block_nested_popups",j="iframe_closed_prematurely",_="silent_logout_unsupported",b="no_account_error",U="silent_prompt_value_error",q="no_token_request_cache_error",te="unable_to_parse_token_request_cache_error",se="no_cached_authority_error",ie="auth_request_not_set_error",ce="invalid_cache_type",me="non_browser_environment",De="database_not_open",Ee="no_network_connectivity",He="post_request_failed",Be="get_request_failed",ze="failed_to_parse_response",pe="unable_to_load_token",G="crypto_key_not_found",oe="auth_code_required",ee="auth_code_or_nativeAccountId_required",ue="spa_code_and_nativeAccountId_present",m="database_unavailable",T="unable_to_acquire_token_from_native_platform",N="native_handshake_timeout",le="native_extension_not_installed",Ce="native_connection_not_established",Me="uninitialized_public_client_application",Ke="native_prompt_not_supported",be="invalid_base64_string"},3325:(fe,F,S)=>{"use strict";S.d(F,{WK:()=>$,Z1:()=>H});var E=S(7481),p=S(3094);const O={[p.m4]:"Given storage configuration option was not supported.",[p.hJ]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[p.xC]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};class $ extends E.l4{constructor(g,M){super(g,M),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,$.prototype)}}function H(B){return new $(B,O[B])}},3094:(fe,F,S)=>{"use strict";S.d(F,{hJ:()=>p,m4:()=>E,xC:()=>O});const E="storage_not_supported",p="stubbed_public_client_application_called",O="in_mem_redirect_unavailable"},4076:(fe,F,S)=>{"use strict";S.d(F,{b:()=>$});var E=S(6603),p=S(9723),O=S(6097),R=S(2690);class ${constructor(B,g){this.eventCallbacks=new Map,this.logger=B,this.browserCrypto=g,this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}addEventCallback(B){if(typeof window<"u"){const g=(0,R.nn)();return this.eventCallbacks.set(g,B),this.logger.verbose(`Event callback registered with id: ${g}`),g}return null}removeEventCallback(B){this.eventCallbacks.delete(B),this.logger.verbose(`Event callback ${B} removed.`)}enableAccountStorageEvents(){typeof window>"u"||(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))}disableAccountStorageEvents(){typeof window>"u"||(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))}emitEvent(B,g,M,D){if(typeof window<"u"){const V={eventType:B,interactionType:g||null,payload:M||null,error:D||null,timestamp:Date.now()};this.logger.info(`Emitting event: ${B}`),this.eventCallbacks.forEach((J,z)=>{this.logger.verbose(`Emitting event to callback ${z}: ${B}`),J.apply(null,[V])})}}handleAccountCacheChange(B){try{const g=B.newValue||B.oldValue;if(!g)return;const M=JSON.parse(g);if("object"!=typeof M||!E.r.isAccountEntity(M))return;const V=p.L.toObject(new E.r,M).getAccountInfo();!B.oldValue&&B.newValue?(this.logger.info("Account was added to cache in a different window"),this.emitEvent(O.t.ACCOUNT_ADDED,void 0,V)):!B.newValue&&B.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.emitEvent(O.t.ACCOUNT_REMOVED,void 0,V))}catch{return}}}},6097:(fe,F,S)=>{"use strict";S.d(F,{t:()=>E});const E={INITIALIZE_START:"msal:initializeStart",INITIALIZE_END:"msal:initializeEnd",ACCOUNT_ADDED:"msal:accountAdded",ACCOUNT_REMOVED:"msal:accountRemoved",LOGIN_START:"msal:loginStart",LOGIN_SUCCESS:"msal:loginSuccess",LOGIN_FAILURE:"msal:loginFailure",ACQUIRE_TOKEN_START:"msal:acquireTokenStart",ACQUIRE_TOKEN_SUCCESS:"msal:acquireTokenSuccess",ACQUIRE_TOKEN_FAILURE:"msal:acquireTokenFailure",ACQUIRE_TOKEN_NETWORK_START:"msal:acquireTokenFromNetworkStart",SSO_SILENT_START:"msal:ssoSilentStart",SSO_SILENT_SUCCESS:"msal:ssoSilentSuccess",SSO_SILENT_FAILURE:"msal:ssoSilentFailure",ACQUIRE_TOKEN_BY_CODE_START:"msal:acquireTokenByCodeStart",ACQUIRE_TOKEN_BY_CODE_SUCCESS:"msal:acquireTokenByCodeSuccess",ACQUIRE_TOKEN_BY_CODE_FAILURE:"msal:acquireTokenByCodeFailure",HANDLE_REDIRECT_START:"msal:handleRedirectStart",HANDLE_REDIRECT_END:"msal:handleRedirectEnd",POPUP_OPENED:"msal:popupOpened",LOGOUT_START:"msal:logoutStart",LOGOUT_SUCCESS:"msal:logoutSuccess",LOGOUT_FAILURE:"msal:logoutFailure",LOGOUT_END:"msal:logoutEnd",RESTORE_FROM_BFCACHE:"msal:restoreFromBFCache"}},7580:(fe,F,S)=>{"use strict";S.d(F,{i:()=>p,u:()=>E});const E="@azure/msal-browser",p="3.5.0"},8593:(fe,F,S)=>{"use strict";S.d(F,{$H:()=>J,BD:()=>O,Bs:()=>M,EC:()=>H,Gv:()=>j,H4:()=>K,Ix:()=>$,Ky:()=>R,Mm:()=>C,Oq:()=>g,WN:()=>D,c4:()=>B,kd:()=>w,lA:()=>k,lu:()=>_,qx:()=>p,s_:()=>V,yo:()=>z});var E=S(5500);const p={INTERACTION_IN_PROGRESS_VALUE:"interaction_in_progress",INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},O={CHANNEL_ID:"53ee284d-920a-4b59-9d30-a60315b26836",PREFERRED_EXTENSION_ID:"ppnbnpeolgkicgegkbkbjmhlideopiji",MATS_TELEMETRY:"MATS"},R={HandshakeRequest:"Handshake",HandshakeResponse:"HandshakeResponse",GetToken:"GetToken",Response:"Response"},$={LocalStorage:"localStorage",SessionStorage:"sessionStorage",MemoryStorage:"memoryStorage"},H={GET:"GET",POST:"POST"},B={AUTHORITY:"authority",ACQUIRE_TOKEN_ACCOUNT:"acquireToken.account",SESSION_STATE:"session.state",REQUEST_STATE:"request.state",NONCE_IDTOKEN:"nonce.id_token",ORIGIN_URI:"request.origin",RENEW_STATUS:"token.renew.status",URL_HASH:"urlHash",REQUEST_PARAMS:"request.params",SCOPES:"scopes",INTERACTION_STATUS_KEY:"interaction.status",CCS_CREDENTIAL:"ccs.credential",CORRELATION_ID:"request.correlationId",NATIVE_REQUEST:"request.native",REDIRECT_CONTEXT:"request.redirect.context"},g={ACCOUNT_KEYS:"msal.account.keys",TOKEN_KEYS:"msal.token.keys"},M={WRAPPER_SKU:"wrapper.sku",WRAPPER_VER:"wrapper.version"},D={acquireTokenRedirect:861,acquireTokenPopup:862,ssoSilent:863,acquireTokenSilent_authCode:864,handleRedirectPromise:865,acquireTokenByCode:866,acquireTokenSilent_silentFlow:61,logout:961,logoutPopup:962};var V=function(b){return b.Redirect="redirect",b.Popup="popup",b.Silent="silent",b.None="none",b}(V||{});const J={Startup:"startup",Login:"login",Logout:"logout",AcquireToken:"acquireToken",SsoSilent:"ssoSilent",HandleRedirect:"handleRedirect",None:"none"},z={scopes:E.f_},C="jwk",k={React:"@azure/msal-react",Angular:"@azure/msal-angular"},K="msal.db",w=1,j=`${K}.keys`,_={Default:0,AccessToken:1,AccessTokenAndRefreshToken:2,RefreshToken:3,RefreshTokenAndNetwork:4,Skip:5}},5291:(fe,F,S)=>{"use strict";S.d(F,{$P:()=>K,$S:()=>C,$V:()=>J,ET:()=>V,L7:()=>z,Re:()=>M,eQ:()=>k,fl:()=>D,hH:()=>$,tT:()=>H,zd:()=>B});var E=S(7581),p=S(8293),O=S(8593),R=S(7377);function $(w){w.location.hash="","function"==typeof w.history.replaceState&&w.history.replaceState(null,"",`${w.location.origin}${w.location.pathname}${w.location.search}`)}function H(w){const j=w.split("#");j.shift(),window.location.hash=j.length>0?j.join("#"):""}function B(){return window.parent!==window}function M(){return window.location.href.split("?")[0].split("#")[0]}function D(){const j=new E.G(window.location.href).getUrlComponents();return`${j.Protocol}//${j.HostNameAndPort}/`}function V(){if(E.G.hashContainsKnownProperties(window.location.hash)&&B())throw(0,p.Z_)(R.xO)}function J(w,j){const _=B();if(w===O.s_.Redirect&&_&&!j)throw(0,p.Z_)(R.b_)}function z(){if(function g(){return typeof window<"u"&&!!window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf(`${O.qx.POPUP_NAME_PREFIX}.`)}())throw(0,p.Z_)(R.bj)}function C(w){if(!w)throw(0,p.Z_)(R.Dx)}function k(w){if(!w)throw(0,p.Z_)(R.al)}function K(w){const j=document.createElement("link");j.rel="preconnect",j.href=new URL(w).origin,j.crossOrigin="anonymous",document.head.appendChild(j),window.setTimeout(()=>{try{document.head.removeChild(j)}catch{}},1e4)}},9082:(fe,F,S)=>{"use strict";S.d(F,{Z_:()=>O,ky:()=>$});var E=S(5140),p=S(5841);function O(H,B){const g=function R(H){if(!H)throw(0,E.zP)(p.PM);const g=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(H);if(!g||g.length<4)throw(0,E.zP)(p.GH);return g[2]}(H);try{const M=B(g);return JSON.parse(M)}catch{throw(0,E.zP)(p.GH)}}function $(H,B){if(0===B||Date.now()-3e5>H+B)throw(0,E.zP)(p.Ao)}},1758:(fe,F,S)=>{"use strict";S.d(F,{B:()=>R,j:()=>$});var E=S(5140),p=S(5500),O=S(5841);function R(H,B){if(!H)throw(0,E.zP)(O.S7);try{const g=B.base64Decode(H);return JSON.parse(g)}catch{throw(0,E.zP)(O.ZE)}}function $(H){if(!H)throw(0,E.zP)(O.ZE);const B=H.split(p.Bv.CLIENT_INFO_SEPARATOR,2);return{uid:B[0],utid:B.length<2?p.gT.EMPTY_STRING:B[1]}}},1322:(fe,F,S)=>{"use strict";S.d(F,{Qh:()=>R,_u:()=>B,eM:()=>D,ix:()=>M,wn:()=>H});var E=S(7581),p=S(5500);const R={"https://login.microsoftonline.com/common/":{token_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/common/":{token_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/common/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/common/":{token_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/consumers/":{token_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/consumers/":{token_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/consumers/":{token_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/organizations/":{token_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/organizations/":{token_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/organizations/":{token_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"}},$={tenant_discovery_endpoint:"https://{canonicalAuthority}/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},H=new Set;function B(V,J){let z;const C=V.canonicalAuthority;if(C){const k=new E.G(C).getUrlComponents().HostNameAndPort;z=g(k,V.cloudDiscoveryMetadata?.metadata,p.pQ.CONFIG,J)||g(k,$.metadata,p.pQ.HARDCODED_VALUES,J)||V.knownAuthorities}return z||[]}function g(V,J,z,C){if(C?.trace(`getAliasesFromMetadata called with source: ${z}`),V&&J){const k=D(J,V);if(k)return C?.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${z}, returning aliases`),k.aliases;C?.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${z}`)}return null}function M(V){return D($.metadata,V)}function D(V,J){for(let z=0;z<V.length;z++){const C=V[z];if(C.aliases.includes(J))return C}return null}$.metadata.forEach(V=>{V.aliases.forEach(J=>{H.add(J)})})},2286:(fe,F,S)=>{"use strict";S.d(F,{z:()=>E});const E={None:"none",AzurePublic:"https://login.microsoftonline.com",AzurePpe:"https://login.windows-ppe.net",AzureChina:"https://login.chinacloudapi.cn",AzureGermany:"https://login.microsoftonline.de",AzureUsGovernment:"https://login.microsoftonline.us"}},63:(fe,F,S)=>{"use strict";S.d(F,{a:()=>E});const E={Default:0,Adfs:1,Dsts:2,Ciam:3}},6132:(fe,F,S)=>{"use strict";S.d(F,{A:()=>E});const E={AAD:"AAD",OIDC:"OIDC"}},9723:(fe,F,S)=>{"use strict";S.d(F,{L:()=>V,w:()=>J});var E=S(5861),p=S(5500),O=S(8821),R=S(7795),$=S(6603),H=S(5140),B=S(9082),g=S(1667),M=S(1322),D=S(5841);class V{constructor(C,k,K,w){this.clientId=C,this.cryptoImpl=k,this.commonLogger=K.clone(g.u,g.i),this.staticAuthorityOptions=w}getAllAccounts(C){const k=[];return this.getAccountsFilteredBy(C||{}).forEach(K=>{const w=this.getAccountInfoFromEntity(K,C);w&&k.push(w)}),k}getAccountInfoFilteredBy(C){const k=this.getAllAccounts(C);return k.length>1?k.filter(K=>!!K.idTokenClaims)[0]:1===k.length?k[0]:null}getBaseAccountInfo(C){const k=this.getAccountsFilteredBy(C);return k.length>0?k[0].getAccountInfo():null}getAccountInfoFromEntity(C,k){const K=C.getAccountInfo(),w=this.getIdToken(K);if(w){const j=(0,B.Z_)(w.secret,this.cryptoImpl.base64Decode);if(this.idTokenClaimsMatchAccountFilter(j,k))return K.idToken=w.secret,K.idTokenClaims=j,K}return K}idTokenClaimsMatchAccountFilter(C,k){return!(k&&(k.loginHint&&!this.matchLoginHint(C,k.loginHint)||k.sid&&!this.matchSid(C,k.sid)))}saveCacheRecord(C,k){var K=this;return(0,E.Z)(function*(){if(!C)throw(0,H.zP)(D.mj);C.account&&K.setAccount(C.account),C.idToken&&!1!==k?.idToken&&K.setIdTokenCredential(C.idToken),C.accessToken&&!1!==k?.accessToken&&(yield K.saveAccessToken(C.accessToken)),C.refreshToken&&!1!==k?.refreshToken&&K.setRefreshTokenCredential(C.refreshToken),C.appMetadata&&K.setAppMetadata(C.appMetadata)})()}saveAccessToken(C){var k=this;return(0,E.Z)(function*(){const K={clientId:C.clientId,credentialType:C.credentialType,environment:C.environment,homeAccountId:C.homeAccountId,realm:C.realm,tokenType:C.tokenType,requestedClaimsHash:C.requestedClaimsHash},w=k.getTokenKeys(),j=R.i.fromString(C.target),_=[];w.accessToken.forEach(b=>{if(!k.accessTokenKeyMatchesFilter(b,K,!1))return;const U=k.getAccessTokenCredential(b);U&&k.credentialMatchesFilter(U,K)&&R.i.fromString(U.target).intersectingScopeSets(j)&&_.push(k.removeAccessToken(b))}),yield Promise.all(_),k.setAccessTokenCredential(C)})()}getAccountsFilteredBy(C){const k=this.getAccountKeys(),K=[];return k.forEach(w=>{if(!this.isAccountKey(w,C.homeAccountId,C.tenantId))return;const j=this.getAccount(w);j&&(C.homeAccountId&&!this.matchHomeAccountId(j,C.homeAccountId)||C.localAccountId&&!this.matchLocalAccountId(j,C.localAccountId)||C.username&&!this.matchUsername(j,C.username)||C.environment&&!this.matchEnvironment(j,C.environment)||C.realm&&!this.matchRealm(j,C.realm)||C.tenantId&&!this.matchRealm(j,C.tenantId)||C.nativeAccountId&&!this.matchNativeAccountId(j,C.nativeAccountId)||C.authorityType&&!this.matchAuthorityType(j,C.authorityType)||C.name&&!this.matchName(j,C.name)||K.push(j))}),K}isAccountKey(C,k,K){return!(C.split(p.Bv.CACHE_KEY_SEPARATOR).length<3||k&&!C.toLowerCase().includes(k.toLowerCase())||K&&!C.toLowerCase().includes(K.toLowerCase()))}isCredentialKey(C){if(C.split(p.Bv.CACHE_KEY_SEPARATOR).length<6)return!1;const k=C.toLowerCase();if(-1===k.indexOf(p.d3.ID_TOKEN.toLowerCase())&&-1===k.indexOf(p.d3.ACCESS_TOKEN.toLowerCase())&&-1===k.indexOf(p.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())&&-1===k.indexOf(p.d3.REFRESH_TOKEN.toLowerCase()))return!1;if(k.indexOf(p.d3.REFRESH_TOKEN.toLowerCase())>-1){const w=`${p.d3.REFRESH_TOKEN}${p.Bv.CACHE_KEY_SEPARATOR}${p.ch}${p.Bv.CACHE_KEY_SEPARATOR}`;if(-1===k.indexOf(`${p.d3.REFRESH_TOKEN}${p.Bv.CACHE_KEY_SEPARATOR}${this.clientId}${p.Bv.CACHE_KEY_SEPARATOR}`.toLowerCase())&&-1===k.indexOf(w.toLowerCase()))return!1}else if(-1===k.indexOf(this.clientId.toLowerCase()))return!1;return!0}credentialMatchesFilter(C,k){return!(k.clientId&&!this.matchClientId(C,k.clientId)||k.userAssertionHash&&!this.matchUserAssertionHash(C,k.userAssertionHash)||"string"==typeof k.homeAccountId&&!this.matchHomeAccountId(C,k.homeAccountId)||k.environment&&!this.matchEnvironment(C,k.environment)||k.realm&&!this.matchRealm(C,k.realm)||k.credentialType&&!this.matchCredentialType(C,k.credentialType)||k.familyId&&!this.matchFamilyId(C,k.familyId)||k.target&&!this.matchTarget(C,k.target)||(k.requestedClaimsHash||C.requestedClaimsHash)&&C.requestedClaimsHash!==k.requestedClaimsHash||C.credentialType===p.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME&&(k.tokenType&&!this.matchTokenType(C,k.tokenType)||k.tokenType===p.hO.SSH&&k.keyId&&!this.matchKeyId(C,k.keyId)))}getAppMetadataFilteredBy(C){return this.getAppMetadataFilteredByInternal(C.environment,C.clientId)}getAppMetadataFilteredByInternal(C,k){const K=this.getKeys(),w={};return K.forEach(j=>{if(!this.isAppMetadata(j))return;const _=this.getAppMetadata(j);_&&(C&&!this.matchEnvironment(_,C)||k&&!this.matchClientId(_,k)||(w[j]=_))}),w}getAuthorityMetadataByAlias(C){const k=this.getAuthorityMetadataKeys();let K=null;return k.forEach(w=>{if(!this.isAuthorityMetadata(w)||-1===w.indexOf(this.clientId))return;const j=this.getAuthorityMetadata(w);j&&-1!==j.aliases.indexOf(C)&&(K=j)}),K}removeAllAccounts(){var C=this;return(0,E.Z)(function*(){const k=C.getAccountKeys(),K=[];k.forEach(w=>{K.push(C.removeAccount(w))}),yield Promise.all(K)})()}removeAccount(C){var k=this;return(0,E.Z)(function*(){const K=k.getAccount(C);K&&(yield k.removeAccountContext(K),k.removeItem(C))})()}removeAccountContext(C){var k=this;return(0,E.Z)(function*(){const K=k.getTokenKeys(),w=C.generateAccountId(),j=[];K.idToken.forEach(_=>{0===_.indexOf(w)&&k.removeIdToken(_)}),K.accessToken.forEach(_=>{0===_.indexOf(w)&&j.push(k.removeAccessToken(_))}),K.refreshToken.forEach(_=>{0===_.indexOf(w)&&k.removeRefreshToken(_)}),yield Promise.all(j)})()}removeAccessToken(C){var k=this;return(0,E.Z)(function*(){const K=k.getAccessTokenCredential(C);if(K){if(K.credentialType.toLowerCase()===p.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()&&K.tokenType===p.hO.POP){const j=K.keyId;if(j)try{yield k.cryptoImpl.removeTokenBindingKey(j)}catch{throw(0,H.zP)(D.ol)}}return k.removeItem(C)}})()}removeAppMetadata(){return this.getKeys().forEach(k=>{this.isAppMetadata(k)&&this.removeItem(k)}),!0}readCacheRecord(C,k,K,w,j){const _=this.getTokenKeys(),b=this.readAccountFromCache(C),U=this.getIdToken(C,_,w,j),q=this.getAccessToken(C,k,_,w,j),te=this.getRefreshToken(C,!1,_,w,j),se=this.readAppMetadataFromCache(K);return b&&U&&(b.idTokenClaims=(0,B.Z_)(U.secret,this.cryptoImpl.base64Decode)),{account:b,idToken:U,accessToken:q,refreshToken:te,appMetadata:se}}readAccountFromCache(C){const k=$.r.generateAccountCacheKey(C);return this.getAccount(k)}getIdToken(C,k,K,w){this.commonLogger.trace("CacheManager - getIdToken called");const _=this.getIdTokensByFilter({homeAccountId:C.homeAccountId,environment:C.environment,credentialType:p.d3.ID_TOKEN,clientId:this.clientId,realm:C.tenantId},k),b=_.length;return b<1?(this.commonLogger.info("CacheManager:getIdToken - No token found"),null):b>1?(this.commonLogger.info("CacheManager:getIdToken - Multiple id tokens found, clearing them"),_.forEach(U=>{this.removeIdToken((0,O.Mk)(U))}),K&&w&&K.addFields({multiMatchedID:_.length},w),null):(this.commonLogger.info("CacheManager:getIdToken - Returning id token"),_[0])}getIdTokensByFilter(C,k){const K=k&&k.idToken||this.getTokenKeys().idToken,w=[];return K.forEach(j=>{if(!this.idTokenKeyMatchesFilter(j,{clientId:this.clientId,...C}))return;const _=this.getIdTokenCredential(j);_&&this.credentialMatchesFilter(_,C)&&w.push(_)}),w}idTokenKeyMatchesFilter(C,k){const K=C.toLowerCase();return!(k.clientId&&-1===K.indexOf(k.clientId.toLowerCase())||k.homeAccountId&&-1===K.indexOf(k.homeAccountId.toLowerCase()))}removeIdToken(C){this.removeItem(C)}removeRefreshToken(C){this.removeItem(C)}getAccessToken(C,k,K,w,j){this.commonLogger.trace("CacheManager - getAccessToken called");const _=R.i.createSearchScopes(k.scopes),b=k.authenticationScheme||p.hO.BEARER,U=b&&b.toLowerCase()!==p.hO.BEARER.toLowerCase()?p.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME:p.d3.ACCESS_TOKEN,q={homeAccountId:C.homeAccountId,environment:C.environment,credentialType:U,clientId:this.clientId,realm:C.tenantId,target:_,tokenType:b,keyId:k.sshKid,requestedClaimsHash:k.requestedClaimsHash},te=K&&K.accessToken||this.getTokenKeys().accessToken,se=[];te.forEach(ce=>{if(this.accessTokenKeyMatchesFilter(ce,q,!0)){const me=this.getAccessTokenCredential(ce);me&&this.credentialMatchesFilter(me,q)&&se.push(me)}});const ie=se.length;return ie<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):ie>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),se.forEach(ce=>{this.removeAccessToken((0,O.Mk)(ce))}),w&&j&&w.addFields({multiMatchedAT:se.length},j),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),se[0])}accessTokenKeyMatchesFilter(C,k,K){const w=C.toLowerCase();if(k.clientId&&-1===w.indexOf(k.clientId.toLowerCase())||k.homeAccountId&&-1===w.indexOf(k.homeAccountId.toLowerCase())||k.realm&&-1===w.indexOf(k.realm.toLowerCase())||k.requestedClaimsHash&&-1===w.indexOf(k.requestedClaimsHash.toLowerCase()))return!1;if(k.target){const j=k.target.asArray();for(let _=0;_<j.length;_++){if(K&&!w.includes(j[_].toLowerCase()))return!1;if(!K&&w.includes(j[_].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(C){const k=this.getTokenKeys(),K=[];return k.accessToken.forEach(w=>{if(!this.accessTokenKeyMatchesFilter(w,C,!0))return;const j=this.getAccessTokenCredential(w);j&&this.credentialMatchesFilter(j,C)&&K.push(j)}),K}getRefreshToken(C,k,K,w,j){this.commonLogger.trace("CacheManager - getRefreshToken called");const b={homeAccountId:C.homeAccountId,environment:C.environment,credentialType:p.d3.REFRESH_TOKEN,clientId:this.clientId,familyId:k?p.ch:void 0},U=K&&K.refreshToken||this.getTokenKeys().refreshToken,q=[];U.forEach(se=>{if(this.refreshTokenKeyMatchesFilter(se,b)){const ie=this.getRefreshTokenCredential(se);ie&&this.credentialMatchesFilter(ie,b)&&q.push(ie)}});const te=q.length;return te<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(te>1&&w&&j&&w.addFields({multiMatchedRT:te},j),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),q[0])}refreshTokenKeyMatchesFilter(C,k){const K=C.toLowerCase();return!(k.familyId&&-1===K.indexOf(k.familyId.toLowerCase())||!k.familyId&&k.clientId&&-1===K.indexOf(k.clientId.toLowerCase())||k.homeAccountId&&-1===K.indexOf(k.homeAccountId.toLowerCase()))}readAppMetadataFromCache(C){const K=this.getAppMetadataFilteredBy({environment:C,clientId:this.clientId}),w=Object.keys(K).map(_=>K[_]),j=w.length;if(j<1)return null;if(j>1)throw(0,H.zP)(D.EC);return w[0]}isAppMetadataFOCI(C){const k=this.readAppMetadataFromCache(C);return!(!k||k.familyId!==p.ch)}matchHomeAccountId(C,k){return"string"==typeof C.homeAccountId&&k===C.homeAccountId}matchLocalAccountId(C,k){return"string"==typeof C.localAccountId&&k===C.localAccountId}matchUsername(C,k){return"string"==typeof C.username&&k.toLowerCase()===C.username.toLowerCase()}matchName(C,k){return k.toLowerCase()===C.name?.toLowerCase()}matchUserAssertionHash(C,k){return!(!C.userAssertionHash||k!==C.userAssertionHash)}matchEnvironment(C,k){if(this.staticAuthorityOptions){const w=(0,M._u)(this.staticAuthorityOptions,this.commonLogger);if(w.includes(k)&&w.includes(C.environment))return!0}const K=this.getAuthorityMetadataByAlias(k);return!!(K&&K.aliases.indexOf(C.environment)>-1)}matchCredentialType(C,k){return C.credentialType&&k.toLowerCase()===C.credentialType.toLowerCase()}matchClientId(C,k){return!(!C.clientId||k!==C.clientId)}matchFamilyId(C,k){return!(!C.familyId||k!==C.familyId)}matchRealm(C,k){return!(!C.realm||k!==C.realm)}matchNativeAccountId(C,k){return!(!C.nativeAccountId||k!==C.nativeAccountId)}matchLoginHint(C,k){return C?.login_hint===k||C.preferred_username===k||C?.upn===k}matchSid(C,k){return!(!C?.sid||C.sid!==k)}matchAuthorityType(C,k){return!(!C.authorityType||k.toLowerCase()!==C.authorityType.toLowerCase())}matchTarget(C,k){return!(C.credentialType!==p.d3.ACCESS_TOKEN&&C.credentialType!==p.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME||!C.target)&&R.i.fromString(C.target).containsScopeSet(k)}matchTokenType(C,k){return!(!C.tokenType||C.tokenType!==k)}matchKeyId(C,k){return!(!C.keyId||C.keyId!==k)}isAppMetadata(C){return-1!==C.indexOf(p.dg)}isAuthorityMetadata(C){return-1!==C.indexOf(p.QU.CACHE_KEY)}generateAuthorityMetadataCacheKey(C){return`${p.QU.CACHE_KEY}-${this.clientId}-${C}`}static toObject(C,k){for(const K in k)C[K]=k[K];return C}}class J extends V{setAccount(){throw(0,H.zP)(D.M2)}getAccount(){throw(0,H.zP)(D.M2)}setIdTokenCredential(){throw(0,H.zP)(D.M2)}getIdTokenCredential(){throw(0,H.zP)(D.M2)}setAccessTokenCredential(){throw(0,H.zP)(D.M2)}getAccessTokenCredential(){throw(0,H.zP)(D.M2)}setRefreshTokenCredential(){throw(0,H.zP)(D.M2)}getRefreshTokenCredential(){throw(0,H.zP)(D.M2)}setAppMetadata(){throw(0,H.zP)(D.M2)}getAppMetadata(){throw(0,H.zP)(D.M2)}setServerTelemetry(){throw(0,H.zP)(D.M2)}getServerTelemetry(){throw(0,H.zP)(D.M2)}setAuthorityMetadata(){throw(0,H.zP)(D.M2)}getAuthorityMetadata(){throw(0,H.zP)(D.M2)}getAuthorityMetadataKeys(){throw(0,H.zP)(D.M2)}setThrottlingCache(){throw(0,H.zP)(D.M2)}getThrottlingCache(){throw(0,H.zP)(D.M2)}removeItem(){throw(0,H.zP)(D.M2)}containsKey(){throw(0,H.zP)(D.M2)}getKeys(){throw(0,H.zP)(D.M2)}getAccountKeys(){throw(0,H.zP)(D.M2)}getTokenKeys(){throw(0,H.zP)(D.M2)}clear(){return(0,E.Z)(function*(){throw(0,H.zP)(D.M2)})()}updateCredentialCacheKey(){throw(0,H.zP)(D.M2)}}},6603:(fe,F,S)=>{"use strict";S.d(F,{r:()=>B});var E=S(5500),p=S(1758),O=S(5140),R=S(63),$=S(6132),H=S(5841);class B{generateAccountId(){return[this.homeAccountId,this.environment].join(E.Bv.CACHE_KEY_SEPARATOR).toLowerCase()}generateAccountKey(){return B.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType}}static generateAccountCacheKey(M){return[M.homeAccountId,M.environment||E.gT.EMPTY_STRING,M.tenantId||E.gT.EMPTY_STRING].join(E.Bv.CACHE_KEY_SEPARATOR).toLowerCase()}static createAccount(M,D){const V=new B;V.authorityType=D.authorityType===R.a.Adfs?E.iR.ADFS_ACCOUNT_TYPE:D.protocolMode===$.A.AAD?E.iR.MSSTS_ACCOUNT_TYPE:E.iR.GENERIC_ACCOUNT_TYPE,V.clientInfo=M.clientInfo,V.homeAccountId=M.homeAccountId,V.nativeAccountId=M.nativeAccountId;const J=M.environment||D&&D.getPreferredCache();if(!J)throw(0,O.zP)(H.Q9);return V.environment=J,V.realm=M.idTokenClaims.tid||E.gT.EMPTY_STRING,V.localAccountId=M.idTokenClaims.oid||M.idTokenClaims.sub||E.gT.EMPTY_STRING,V.username=M.idTokenClaims.preferred_username||M.idTokenClaims.upn||(M.idTokenClaims.emails?M.idTokenClaims.emails[0]:null)||E.gT.EMPTY_STRING,V.name=M.idTokenClaims.name,V.cloudGraphHostName=M.cloudGraphHostName,V.msGraphHost=M.msGraphHost,V}static createFromAccountInfo(M,D,V){const J=new B;return J.authorityType=M.authorityType||E.iR.GENERIC_ACCOUNT_TYPE,J.homeAccountId=M.homeAccountId,J.localAccountId=M.localAccountId,J.nativeAccountId=M.nativeAccountId,J.realm=M.tenantId,J.environment=M.environment,J.username=M.username,J.name=M.name,J.cloudGraphHostName=D,J.msGraphHost=V,J}static generateHomeAccountId(M,D,V,J,z){const C=z?.sub?z.sub:E.gT.EMPTY_STRING;if(D===R.a.Adfs||D===R.a.Dsts)return C;if(M)try{const k=(0,p.B)(M,J);if(k.uid&&k.utid)return`${k.uid}${E.Bv.CLIENT_INFO_SEPARATOR}${k.utid}`}catch{}return V.verbose("No client info in response"),C}static isAccountEntity(M){return!!M&&M.hasOwnProperty("homeAccountId")&&M.hasOwnProperty("environment")&&M.hasOwnProperty("realm")&&M.hasOwnProperty("localAccountId")&&M.hasOwnProperty("username")&&M.hasOwnProperty("authorityType")}static accountInfoIsEqual(M,D,V){if(!M||!D)return!1;let J=!0;if(V){const z=M.idTokenClaims||{},C=D.idTokenClaims||{};J=z.iat===C.iat&&z.nonce===C.nonce}return M.homeAccountId===D.homeAccountId&&M.localAccountId===D.localAccountId&&M.username===D.username&&M.tenantId===D.tenantId&&M.environment===D.environment&&M.nativeAccountId===D.nativeAccountId&&J}}},8821:(fe,F,S)=>{"use strict";S.d(F,{Bq:()=>J,Ds:()=>g,Js:()=>_,Md:()=>B,Mk:()=>H,OJ:()=>M,Om:()=>V,x4:()=>z});var E=S(9082),p=S(5140),O=S(5500),R=S(4441),$=S(5841);function H(b){return[C(b),k(b),K(b),w(b),j(b)].join(O.Bv.CACHE_KEY_SEPARATOR).toLowerCase()}function B(b,U,q,te,se){return{credentialType:O.d3.ID_TOKEN,homeAccountId:b,environment:U,clientId:te,secret:q,realm:se}}function g(b,U,q,te,se,ie,ce,me,De,Ee,He,Be,ze,pe,G){const oe={homeAccountId:b,credentialType:O.d3.ACCESS_TOKEN,secret:q,cachedAt:R.I.nowSeconds().toString(),expiresOn:ce.toString(),extendedExpiresOn:me.toString(),environment:U,clientId:te,realm:se,target:ie,tokenType:He||O.hO.BEARER};if(Be&&(oe.userAssertionHash=Be),Ee&&(oe.refreshOn=Ee.toString()),pe&&(oe.requestedClaims=pe,oe.requestedClaimsHash=G),oe.tokenType?.toLowerCase()!==O.hO.BEARER.toLowerCase())switch(oe.credentialType=O.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME,oe.tokenType){case O.hO.POP:const ee=(0,E.Z_)(q,De);if(!ee?.cnf?.kid)throw(0,p.zP)($.P_);oe.keyId=ee.cnf.kid;break;case O.hO.SSH:oe.keyId=ze}return oe}function M(b,U,q,te,se,ie){const ce={credentialType:O.d3.REFRESH_TOKEN,homeAccountId:b,environment:U,clientId:te,secret:q};return ie&&(ce.userAssertionHash=ie),se&&(ce.familyId=se),ce}function D(b){return b.hasOwnProperty("homeAccountId")&&b.hasOwnProperty("environment")&&b.hasOwnProperty("credentialType")&&b.hasOwnProperty("clientId")&&b.hasOwnProperty("secret")}function V(b){return!!b&&D(b)&&b.hasOwnProperty("realm")&&b.hasOwnProperty("target")&&(b.credentialType===O.d3.ACCESS_TOKEN||b.credentialType===O.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME)}function J(b){return!!b&&D(b)&&b.hasOwnProperty("realm")&&b.credentialType===O.d3.ID_TOKEN}function z(b){return!!b&&D(b)&&b.credentialType===O.d3.REFRESH_TOKEN}function C(b){return[b.homeAccountId,b.environment].join(O.Bv.CACHE_KEY_SEPARATOR).toLowerCase()}function k(b){return[b.credentialType,b.credentialType===O.d3.REFRESH_TOKEN&&b.familyId||b.clientId,b.realm||""].join(O.Bv.CACHE_KEY_SEPARATOR).toLowerCase()}function K(b){return(b.target||"").toLowerCase()}function w(b){return(b.requestedClaimsHash||"").toLowerCase()}function j(b){return b.tokenType&&b.tokenType.toLowerCase()!==O.hO.BEARER.toLowerCase()?b.tokenType.toLowerCase():""}function _(b,U){const q=0===b.indexOf(O.HN.CACHE_KEY);let te=!0;return U&&(te=U.hasOwnProperty("failedRequests")&&U.hasOwnProperty("errors")&&U.hasOwnProperty("cacheHits")),q&&te}},6703:(fe,F,S)=>{"use strict";S.d(F,{j6:()=>b,lh:()=>q,z:()=>J});var E=S(5861),p=S(8214),O=S(4630),R=S(5500),$=S(1667),H=S(2286),B=S(9723),g=S(6132),M=S(5140),D=S(5841);const J={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},z={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:O.i.Info,correlationId:R.gT.EMPTY_STRING},C={claimsBasedCachingEnabled:!1},k={sendGetRequestAsync:()=>(0,E.Z)(function*(){throw(0,M.zP)(D.M2)})(),sendPostRequestAsync:()=>(0,E.Z)(function*(){throw(0,M.zP)(D.M2)})()},K={sku:R.gT.SKU,version:$.i,cpu:R.gT.EMPTY_STRING,os:R.gT.EMPTY_STRING},w={clientSecret:R.gT.EMPTY_STRING,clientAssertion:void 0},j={azureCloudInstance:H.z.None,tenant:`${R.gT.DEFAULT_COMMON_TENANT}`},_={application:{appName:"",appVersion:""}};function b({authOptions:te,systemOptions:se,loggerOptions:ie,cacheOptions:ce,storageInterface:me,networkInterface:De,cryptoInterface:Ee,clientCredentials:He,libraryInfo:Be,telemetry:ze,serverTelemetryManager:pe,persistencePlugin:G,serializableCache:oe}){const ee={...z,...ie};return{authOptions:U(te),systemOptions:{...J,...se},loggerOptions:ee,cacheOptions:{...C,...ce},storageInterface:me||new B.w(te.clientId,p.d,new O.Y(ee)),networkInterface:De||k,cryptoInterface:Ee||p.d,clientCredentials:He||w,libraryInfo:{...K,...Be},telemetry:{..._,...ze},serverTelemetryManager:pe||null,persistencePlugin:G||null,serializableCache:oe||null}}function U(te){return{clientCapabilities:[],azureCloudOptions:j,skipAuthorityMetadataCache:!1,...te}}function q(te){return te.authOptions.authority.options.protocolMode===g.A.OIDC}},8214:(fe,F,S)=>{"use strict";S.d(F,{d:()=>R});var E=S(5861),p=S(5140),O=S(5841);const R={createNewGuid:()=>{throw(0,p.zP)(O.M2)},base64Decode:()=>{throw(0,p.zP)(O.M2)},base64Encode:()=>{throw(0,p.zP)(O.M2)},getPublicKeyThumbprint:()=>(0,E.Z)(function*(){throw(0,p.zP)(O.M2)})(),removeTokenBindingKey:()=>(0,E.Z)(function*(){throw(0,p.zP)(O.M2)})(),clearKeystore:()=>(0,E.Z)(function*(){throw(0,p.zP)(O.M2)})(),signJwt:()=>(0,E.Z)(function*(){throw(0,p.zP)(O.M2)})(),hashString:()=>(0,E.Z)(function*(){throw(0,p.zP)(O.M2)})()}},7481:(fe,F,S)=>{"use strict";S.d(F,{MD:()=>H,l4:()=>$});var E=S(5500),p=S(8012);const O={[p.g]:"Unexpected error in authentication.",[p.D]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};class $ extends Error{constructor(g,M,D){super(M?`${g}: ${M}`:g),Object.setPrototypeOf(this,$.prototype),this.errorCode=g||E.gT.EMPTY_STRING,this.errorMessage=M||E.gT.EMPTY_STRING,this.subError=D||E.gT.EMPTY_STRING,this.name="AuthError"}setCorrelationId(g){this.correlationId=g}}function H(B,g){return new $(B,g?`${O[B]} ${g}`:O[B])}},8012:(fe,F,S)=>{"use strict";S.d(F,{D:()=>p,g:()=>E});const E="unexpected_error",p="post_request_failed"},5140:(fe,F,S)=>{"use strict";S.d(F,{er:()=>$,zP:()=>H});var E=S(7481),p=S(5841);const O={[p.ZE]:"The client info could not be parsed/decoded correctly",[p.S7]:"The client info was empty",[p.GH]:"Token cannot be parsed",[p.PM]:"The token is null or empty",[p.HO]:"Endpoints cannot be resolved",[p.EF]:"Network request failed",[p.Ce]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[p.b4]:"The hash parameters could not be deserialized",[p.r8]:"State was not the expected format",[p.Tu]:"State mismatch error",[p.LV]:"State not found",[p.vR]:"Nonce mismatch error",[p.w7]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[p.Ao]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[p.MU]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[p.RH]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[p.EC]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[p.FU]:"Token request cannot be made without authorization code or refresh token.",[p.v1]:"Cannot remove null or empty scope from ScopeSet",[p.f4]:"Cannot append ScopeSet",[p.S]:"Empty input ScopeSet cannot be processed",[p.Jk]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[p.tS]:"Device code is expired.",[p.ZT]:"Device code stopped polling for unknown reasons.",[p.D7]:"Please pass an account object, silent flow is not supported without account information",[p.mj]:"Cache record object was null or undefined.",[p.Q9]:"Invalid environment when attempting to create cache entry",[p.cX]:"No account found in cache for given key.",[p.QL]:"No crypto object detected.",[p.cy]:"Unexpected credential type.",[p.aE]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[p.SX]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[p.s$]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[p.nQ]:"User defined timeout for device code polling reached",[p.P_]:"Cannot generate a POP jwt if the token_claims are not populated",[p.Zv]:"Server response does not contain an authorization code to proceed",[p.ol]:"Could not remove the credential's binding key from storage.",[p.ig]:"The provided authority does not support logout",[p.Of]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[p.Mq]:"No network connectivity. Check your internet connection.",[p.$R]:"User cancelled the flow.",[p.k7]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[p.M2]:"This method has not been implemented",[p.Ls]:"The nested app auth bridge is disabled"};class $ extends E.l4{constructor(g,M){super(g,M?`${O[g]}: ${M}`:O[g]),this.name="ClientAuthError",Object.setPrototypeOf(this,$.prototype)}}function H(B,g){return new $(B,g)}},5841:(fe,F,S)=>{"use strict";S.d(F,{$R:()=>le,Ao:()=>C,Ce:()=>B,D7:()=>ie,EC:()=>w,EF:()=>H,FU:()=>j,GH:()=>O,HO:()=>$,Jk:()=>q,LV:()=>V,Ls:()=>Ke,M2:()=>Me,MU:()=>k,Mq:()=>N,Of:()=>T,PM:()=>R,P_:()=>oe,Q9:()=>me,QL:()=>Ee,RH:()=>K,S:()=>U,S7:()=>p,SX:()=>ze,Tu:()=>D,ZE:()=>E,ZT:()=>se,Zv:()=>ee,aE:()=>Be,b4:()=>g,cX:()=>De,cy:()=>He,f4:()=>b,ig:()=>m,k7:()=>Ce,mj:()=>ce,nQ:()=>G,ol:()=>ue,r8:()=>M,s$:()=>pe,tS:()=>te,v1:()=>_,vR:()=>J,w7:()=>z});const E="client_info_decoding_error",p="client_info_empty_error",O="token_parsing_error",R="null_or_empty_token",$="endpoints_resolution_error",H="network_error",B="openid_config_error",g="hash_not_deserialized",M="invalid_state",D="state_mismatch",V="state_not_found",J="nonce_mismatch",z="auth_time_not_found",C="max_age_transpired",k="multiple_matching_tokens",K="multiple_matching_accounts",w="multiple_matching_appMetadata",j="request_cannot_be_made",_="cannot_remove_empty_scope",b="cannot_append_scopeset",U="empty_input_scopeset",q="device_code_polling_cancelled",te="device_code_expired",se="device_code_unknown_error",ie="no_account_in_silent_request",ce="invalid_cache_record",me="invalid_cache_environment",De="no_account_found",Ee="no_crypto_object",He="unexpected_credential_type",Be="invalid_assertion",ze="invalid_client_credential",pe="token_refresh_required",G="user_timeout_reached",oe="token_claims_cnf_required_for_signedjwt",ee="authorization_code_missing_from_server_response",ue="binding_key_not_removed",m="end_session_endpoint_not_supported",T="key_id_missing",N="no_network_connectivity",le="user_canceled",Ce="missing_tenant_id_error",Me="method_not_implemented",Ke="nested_app_auth_bridge_disabled"},4680:(fe,F,S)=>{"use strict";S.d(F,{ei:()=>H});var E=S(7481),p=S(7299);const O={[p.RV]:"A redirect URI is required for all calls, and none has been set.",[p.LB]:"Could not parse the given claims request object.",[p.Oz]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[p.yH]:"URL could not be parsed into appropriate segments.",[p.To]:"URL was empty or null.",[p.vE]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[p.z_]:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",[p.nm]:"Given claims parameter must be a stringified JSON object.",[p.dL]:"Token request was empty and not found in cache.",[p.$h]:"The logout request was null or undefined.",[p.d6]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[p.TU]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[p.E]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[p.zx]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[p.o_]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[p.dK]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[p.hI]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[p.U9]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[p.i1]:"Invalid authentication header provided",[p.qz]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[p.Ol]:"Cannot set allowNativeBroker parameter to true when not in AAD protocol mode.",[p.Hv]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."};class $ extends E.l4{constructor(g){super(g,O[g]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,$.prototype)}}function H(B){return new $(B)}},7299:(fe,F,S)=>{"use strict";S.d(F,{$h:()=>D,E:()=>z,Hv:()=>q,LB:()=>p,Ol:()=>U,Oz:()=>O,RV:()=>E,TU:()=>J,To:()=>$,U9:()=>j,d6:()=>V,dK:()=>K,dL:()=>M,hI:()=>w,i1:()=>_,nm:()=>g,o_:()=>k,qz:()=>b,vE:()=>H,yH:()=>R,z_:()=>B,zx:()=>C});const E="redirect_uri_empty",p="claims_request_parsing_error",O="authority_uri_insecure",R="url_parse_error",$="empty_url_error",H="empty_input_scopes_error",B="invalid_prompt_value",g="invalid_claims",M="token_request_empty",D="logout_request_empty",V="invalid_code_challenge_method",J="pkce_params_missing",z="invalid_cloud_discovery_metadata",C="invalid_authority_metadata",k="untrusted_authority",K="missing_ssh_jwk",w="missing_ssh_kid",j="missing_nonce_authentication_header",_="invalid_authentication_header",b="cannot_set_OIDCOptions",U="cannot_allow_native_broker",q="authority_mismatch"},544:(fe,F,S)=>{"use strict";S.d(F,{Cf:()=>M,Yo:()=>g,ip:()=>D});var E=S(5500),p=S(7481),O=S(6490);const R=[O.tZ,O.Mo,O.kk],$=["message_only","additional_action","basic_action","user_password_expired","consent_required"],H={[O.I2]:"No refresh token found in the cache. Please sign-in.",[O.QP]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API."};class g extends p.l4{constructor(J,z,C,k,K,w,j){super(J,z,C),Object.setPrototypeOf(this,g.prototype),this.timestamp=k||E.gT.EMPTY_STRING,this.traceId=K||E.gT.EMPTY_STRING,this.correlationId=w||E.gT.EMPTY_STRING,this.claims=j||E.gT.EMPTY_STRING,this.name="InteractionRequiredAuthError"}}function M(V,J,z){const C=!!V&&R.indexOf(V)>-1,k=!!z&&$.indexOf(z)>-1,K=!!J&&R.some(w=>J.indexOf(w)>-1);return C||K||k}function D(V){return new g(V,H[V])}},6490:(fe,F,S)=>{"use strict";S.d(F,{I2:()=>E,Mo:()=>R,QP:()=>p,kk:()=>$,tZ:()=>O});const E="no_tokens_found",p="native_account_unavailable",O="interaction_required",R="consent_required",$="login_required"},4498:(fe,F,S)=>{"use strict";S.d(F,{n:()=>p});var E=S(7481);class p extends E.l4{constructor(R,$,H){super(R,$,H),this.name="ServerError",Object.setPrototypeOf(this,p.prototype)}}},4630:(fe,F,S)=>{"use strict";S.d(F,{Y:()=>O,i:()=>p});var E=S(5500),p=function(R){return R[R.Error=0]="Error",R[R.Warning=1]="Warning",R[R.Info=2]="Info",R[R.Verbose=3]="Verbose",R[R.Trace=4]="Trace",R}(p||{});class O{constructor($,H,B){this.level=p.Info;const M=$||O.createDefaultLoggerOptions();this.localCallback=M.loggerCallback||(()=>{}),this.piiLoggingEnabled=M.piiLoggingEnabled||!1,this.level="number"==typeof M.logLevel?M.logLevel:p.Info,this.correlationId=M.correlationId||E.gT.EMPTY_STRING,this.packageName=H||E.gT.EMPTY_STRING,this.packageVersion=B||E.gT.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:p.Info}}clone($,H,B){return new O({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:B||this.correlationId},$,H)}logMessage($,H){if(H.logLevel>this.level||!this.piiLoggingEnabled&&H.containsPii)return;const M=`[${(new Date).toUTCString()}] : [${H.correlationId||this.correlationId||""}] : ${this.packageName}@${this.packageVersion} : ${p[H.logLevel]} - ${$}`;this.executeCallback(H.logLevel,M,H.containsPii||!1)}executeCallback($,H,B){this.localCallback&&this.localCallback($,H,B)}error($,H){this.logMessage($,{logLevel:p.Error,containsPii:!1,correlationId:H||E.gT.EMPTY_STRING})}errorPii($,H){this.logMessage($,{logLevel:p.Error,containsPii:!0,correlationId:H||E.gT.EMPTY_STRING})}warning($,H){this.logMessage($,{logLevel:p.Warning,containsPii:!1,correlationId:H||E.gT.EMPTY_STRING})}warningPii($,H){this.logMessage($,{logLevel:p.Warning,containsPii:!0,correlationId:H||E.gT.EMPTY_STRING})}info($,H){this.logMessage($,{logLevel:p.Info,containsPii:!1,correlationId:H||E.gT.EMPTY_STRING})}infoPii($,H){this.logMessage($,{logLevel:p.Info,containsPii:!0,correlationId:H||E.gT.EMPTY_STRING})}verbose($,H){this.logMessage($,{logLevel:p.Verbose,containsPii:!1,correlationId:H||E.gT.EMPTY_STRING})}verbosePii($,H){this.logMessage($,{logLevel:p.Verbose,containsPii:!0,correlationId:H||E.gT.EMPTY_STRING})}trace($,H){this.logMessage($,{logLevel:p.Trace,containsPii:!1,correlationId:H||E.gT.EMPTY_STRING})}tracePii($,H){this.logMessage($,{logLevel:p.Trace,containsPii:!0,correlationId:H||E.gT.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}},1667:(fe,F,S)=>{"use strict";S.d(F,{i:()=>p,u:()=>E});const E="@azure/msal-common",p="14.4.0"},7795:(fe,F,S)=>{"use strict";S.d(F,{i:()=>B});var E=S(4680),p=S(9092),O=S(5140),R=S(5500),$=S(7299),H=S(5841);class B{constructor(M){const D=M?p.x.trimArrayEntries([...M]):[],V=D?p.x.removeEmptyStringsFromArray(D):[];this.validateInputScopes(V),this.scopes=new Set,V.forEach(J=>this.scopes.add(J))}static fromString(M){const V=(M||R.gT.EMPTY_STRING).split(" ");return new B(V)}static createSearchScopes(M){const D=new B(M);return D.containsOnlyOIDCScopes()?D.removeScope(R.gT.OFFLINE_ACCESS_SCOPE):D.removeOIDCScopes(),D}validateInputScopes(M){if(!M||M.length<1)throw(0,E.ei)($.vE)}containsScope(M){const D=this.printScopesLowerCase().split(" "),V=new B(D);return!!M&&V.scopes.has(M.toLowerCase())}containsScopeSet(M){return!(!M||M.scopes.size<=0)&&this.scopes.size>=M.scopes.size&&M.asArray().every(D=>this.containsScope(D))}containsOnlyOIDCScopes(){let M=0;return R.$f.forEach(D=>{this.containsScope(D)&&(M+=1)}),this.scopes.size===M}appendScope(M){M&&this.scopes.add(M.trim())}appendScopes(M){try{M.forEach(D=>this.appendScope(D))}catch{throw(0,O.zP)(H.f4)}}removeScope(M){if(!M)throw(0,O.zP)(H.v1);this.scopes.delete(M.trim())}removeOIDCScopes(){R.$f.forEach(M=>{this.scopes.delete(M)})}unionScopeSets(M){if(!M)throw(0,O.zP)(H.S);const D=new Set;return M.scopes.forEach(V=>D.add(V.toLowerCase())),this.scopes.forEach(V=>D.add(V.toLowerCase())),D}intersectingScopeSets(M){if(!M)throw(0,O.zP)(H.S);M.containsOnlyOIDCScopes()||M.removeOIDCScopes();const D=this.unionScopeSets(M),V=M.getScopeCount(),J=this.getScopeCount();return D.size<J+V}getScopeCount(){return this.scopes.size}asArray(){const M=[];return this.scopes.forEach(D=>M.push(D)),M}printScopes(){return this.scopes?this.asArray().join(" "):R.gT.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}},7979:(fe,F,S)=>{"use strict";S.d(F,{$L:()=>p,Ak:()=>E});const E={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",RefreshTokenClientExecutePostToTokenEndpoint:"refreshTokenClientExecutePostToTokenEndpoint",AuthorizationCodeClientExecutePostToTokenEndpoint:"authorizationCodeClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",SilentFlowClientAcquireCachedToken:"silentFlowClientAcquireCachedToken",SilentFlowClientGenerateResultFromCacheRecord:"silentFlowClientGenerateResultFromCacheRecord",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",SilentHandlerLoadFrameSync:"silentHandlerLoadFrameSync",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",StandardInteractionClientInitializeAuthorizationCodeRequest:"standardInteractionClientInitializeAuthorizationCodeRequest",GetAuthCodeUrl:"getAuthCodeUrl",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponse:"handleCodeResponse",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",AuthClientCreateQueryString:"authClientCreateQueryString",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",DeserializeResponse:"deserializeResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityResolveEndpointsFromLocalSources:"authorityResolveEndpointsFromLocalSources",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromiseMeasurement",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",RemoveHiddenIframe:"removeHiddenIframe",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims",CacheManagerGetRefreshToken:"cacheManagerGetRefreshToken",GeneratePkceCodes:"generatePkceCodes",GenerateCodeVerifier:"generateCodeVerifier",GenerateCodeChallengeFromVerifier:"generateCodeChallengeFromVerifier",Sha256Digest:"sha256Digest",GetRandomValues:"getRandomValues"},p={NotStarted:0,InProgress:1,Completed:2}},7581:(fe,F,S)=>{"use strict";S.d(F,{G:()=>H});var E=S(4680),p=S(9092),O=S(5500),R=S(1129),$=S(7299);class H{get urlString(){return this._urlString}constructor(g){if(this._urlString=g,!this._urlString)throw(0,E.ei)($.To);g.includes("#")||(this._urlString=H.canonicalizeUri(g))}static canonicalizeUri(g){if(g){let M=g.toLowerCase();return p.x.endsWith(M,"?")?M=M.slice(0,-1):p.x.endsWith(M,"?/")&&(M=M.slice(0,-2)),p.x.endsWith(M,"/")||(M+="/"),M}return g}validateAsUri(){let g;try{g=this.getUrlComponents()}catch{throw(0,E.ei)($.yH)}if(!g.HostNameAndPort||!g.PathSegments)throw(0,E.ei)($.yH);if(!g.Protocol||"https:"!==g.Protocol.toLowerCase())throw(0,E.ei)($.Oz)}static appendQueryString(g,M){return M?g.indexOf("?")<0?`${g}?${M}`:`${g}&${M}`:g}static removeHashFromUrl(g){return H.canonicalizeUri(g.split("#")[0])}replaceTenantPath(g){const M=this.getUrlComponents(),D=M.PathSegments;return g&&0!==D.length&&(D[0]===O.Nb.COMMON||D[0]===O.Nb.ORGANIZATIONS)&&(D[0]=g),H.constructAuthorityUriFromObject(M)}getUrlComponents(){const g=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),M=this.urlString.match(g);if(!M)throw(0,E.ei)($.yH);const D={Protocol:M[1],HostNameAndPort:M[4],AbsolutePath:M[5],QueryString:M[7]};let V=D.AbsolutePath.split("/");return V=V.filter(J=>J&&J.length>0),D.PathSegments=V,D.QueryString&&D.QueryString.endsWith("/")&&(D.QueryString=D.QueryString.substring(0,D.QueryString.length-1)),D}static getDomainFromUrl(g){const M=RegExp("^([^:/?#]+://)?([^/?#]*)"),D=g.match(M);if(!D)throw(0,E.ei)($.yH);return D[2]}static getAbsoluteUrl(g,M){if(g[0]===O.gT.FORWARD_SLASH){const V=new H(M).getUrlComponents();return V.Protocol+"//"+V.HostNameAndPort+g}return g}static constructAuthorityUriFromObject(g){return new H(g.Protocol+"//"+g.HostNameAndPort+"/"+g.PathSegments.join("/"))}static hashContainsKnownProperties(g){return!!(0,R.F)(g)}}},5500:(fe,F,S)=>{"use strict";S.d(F,{$f:()=>R,As:()=>M,Bv:()=>w,D1:()=>De,Fo:()=>g,Ge:()=>Ee,HN:()=>ie,NJ:()=>D,Nb:()=>B,QU:()=>te,SZ:()=>$,To:()=>pe,VO:()=>V,VX:()=>J,Vi:()=>H,W:()=>Be,YY:()=>He,bb:()=>me,ch:()=>q,d3:()=>j,dg:()=>b,f_:()=>O,gT:()=>E,hO:()=>ce,iR:()=>K,ki:()=>ze,oj:()=>p,pQ:()=>se,qJ:()=>k,rg:()=>z,sR:()=>U,vw:()=>C,xd:()=>G});const E={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},p={SUCCESS_RANGE_START:200,SUCCESS_RANGE_END:299,REDIRECT:302,CLIENT_ERROR_RANGE_START:400,CLIENT_ERROR_RANGE_END:499,SERVER_ERROR_RANGE_START:500,SERVER_ERROR_RANGE_END:599},O=[E.OPENID_SCOPE,E.PROFILE_SCOPE,E.OFFLINE_ACCESS_SCOPE],R=[...O,E.EMAIL_SCOPE],$={CONTENT_TYPE:"Content-Type",RETRY_AFTER:"Retry-After",CCS_HEADER:"X-AnchorMailbox",WWWAuthenticate:"WWW-Authenticate",AuthenticationInfo:"Authentication-Info",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_HTTP_VERSION:"x-ms-httpver"},H={ID_TOKEN:"idtoken",CLIENT_INFO:"client.info",ADAL_ID_TOKEN:"adal.idtoken",ERROR:"error",ERROR_DESC:"error.description",ACTIVE_ACCOUNT:"active-account",ACTIVE_ACCOUNT_FILTERS:"active-account-filters"},B={COMMON:"common",ORGANIZATIONS:"organizations",CONSUMERS:"consumers"},g={CLIENT_ID:"client_id",REDIRECT_URI:"redirect_uri",RESPONSE_TYPE:"response_type",RESPONSE_MODE:"response_mode",GRANT_TYPE:"grant_type",CLAIMS:"claims",SCOPE:"scope",ERROR:"error",ERROR_DESCRIPTION:"error_description",ACCESS_TOKEN:"access_token",ID_TOKEN:"id_token",REFRESH_TOKEN:"refresh_token",EXPIRES_IN:"expires_in",STATE:"state",NONCE:"nonce",PROMPT:"prompt",SESSION_STATE:"session_state",CLIENT_INFO:"client_info",CODE:"code",CODE_CHALLENGE:"code_challenge",CODE_CHALLENGE_METHOD:"code_challenge_method",CODE_VERIFIER:"code_verifier",CLIENT_REQUEST_ID:"client-request-id",X_CLIENT_SKU:"x-client-SKU",X_CLIENT_VER:"x-client-VER",X_CLIENT_OS:"x-client-OS",X_CLIENT_CPU:"x-client-CPU",X_CLIENT_CURR_TELEM:"x-client-current-telemetry",X_CLIENT_LAST_TELEM:"x-client-last-telemetry",X_MS_LIB_CAPABILITY:"x-ms-lib-capability",X_APP_NAME:"x-app-name",X_APP_VER:"x-app-ver",POST_LOGOUT_URI:"post_logout_redirect_uri",ID_TOKEN_HINT:"id_token_hint",DEVICE_CODE:"device_code",CLIENT_SECRET:"client_secret",CLIENT_ASSERTION:"client_assertion",CLIENT_ASSERTION_TYPE:"client_assertion_type",TOKEN_TYPE:"token_type",REQ_CNF:"req_cnf",OBO_ASSERTION:"assertion",REQUESTED_TOKEN_USE:"requested_token_use",ON_BEHALF_OF:"on_behalf_of",FOCI:"foci",CCS_HEADER:"X-AnchorMailbox",RETURN_SPA_CODE:"return_spa_code",NATIVE_BROKER:"nativebroker",LOGOUT_HINT:"logout_hint"},M={ACCESS_TOKEN:"access_token",XMS_CC:"xms_cc"},D={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},V={ACCOUNT:"account",SID:"sid",LOGIN_HINT:"login_hint",ID_TOKEN:"id_token",DOMAIN_HINT:"domain_hint",ORGANIZATIONS:"organizations",CONSUMERS:"consumers",ACCOUNT_ID:"accountIdentifier",HOMEACCOUNT_ID:"homeAccountIdentifier"},J={PLAIN:"plain",S256:"S256"},z={QUERY:"query",FRAGMENT:"fragment"},C={...z,FORM_POST:"form_post"},k={IMPLICIT_GRANT:"implicit",AUTHORIZATION_CODE_GRANT:"authorization_code",CLIENT_CREDENTIALS_GRANT:"client_credentials",RESOURCE_OWNER_PASSWORD_GRANT:"password",REFRESH_TOKEN_GRANT:"refresh_token",DEVICE_CODE_GRANT:"device_code",JWT_BEARER:"urn:ietf:params:oauth:grant-type:jwt-bearer"},K={MSSTS_ACCOUNT_TYPE:"MSSTS",ADFS_ACCOUNT_TYPE:"ADFS",MSAV1_ACCOUNT_TYPE:"MSA",GENERIC_ACCOUNT_TYPE:"Generic"},w={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},j={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},b="appmetadata",U="client_info",q="1",te={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:86400},se={CONFIG:"config",CACHE:"cache",NETWORK:"network",HARDCODED_VALUES:"hardcoded_values"},ie={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},ce={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},me={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},De={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},Ee={username:"username",password:"password"},He={httpSuccess:200,httpBadRequest:400},Be={FAILED_AUTO_DETECTION:"1",INTERNAL_CACHE:"2",ENVIRONMENT_VARIABLE:"3",IMDS:"4"},ze={CONFIGURED_MATCHES_DETECTED:"1",CONFIGURED_NO_AUTO_DETECTION:"2",CONFIGURED_NOT_DETECTED:"3",AUTO_DETECTION_REQUESTED_SUCCESSFUL:"4",AUTO_DETECTION_REQUESTED_FAILED:"5"},pe={NOT_APPLICABLE:"0",FORCE_REFRESH_OR_CLAIMS:"1",NO_CACHED_ACCESS_TOKEN:"2",CACHED_ACCESS_TOKEN_EXPIRED:"3",PROACTIVELY_REFRESHED:"4"},G={Jwt:"JWT",Jwk:"JWK",Pop:"pop"}},9092:(fe,F,S)=>{"use strict";S.d(F,{x:()=>E});class E{static isEmptyObj(O){if(O)try{const R=JSON.parse(O);return 0===Object.keys(R).length}catch{}return!0}static startsWith(O,R){return 0===O.indexOf(R)}static endsWith(O,R){return O.length>=R.length&&O.lastIndexOf(R)===O.length-R.length}static queryStringToObject(O){const R={},$=O.split("&"),H=B=>decodeURIComponent(B.replace(/\+/g," "));return $.forEach(B=>{if(B.trim()){const[g,M]=B.split(/=(.+)/g,2);g&&M&&(R[H(g)]=H(M))}}),R}static trimArrayEntries(O){return O.map(R=>R.trim())}static removeEmptyStringsFromArray(O){return O.filter(R=>!!R)}static jsonParseHelper(O){try{return JSON.parse(O)}catch{return null}}static matchPattern(O,R){return new RegExp(O.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(R)}}},4441:(fe,F,S)=>{"use strict";S.d(F,{I:()=>E});class E{static nowSeconds(){return Math.round((new Date).getTime()/1e3)}static isTokenExpired(O,R){const $=Number(O)||0;return E.nowSeconds()+R>$}static wasClockTurnedBack(O){return Number(O)>E.nowSeconds()}static delay(O,R){return new Promise($=>setTimeout(()=>$(R),O))}}},1129:(fe,F,S)=>{"use strict";S.d(F,{F:()=>R,q:()=>O});var E=S(5140),p=S(5841);function O($){return $.startsWith("#/")?$.substring(2):$.startsWith("#")||$.startsWith("?")?$.substring(1):$}function R($){if(!$||$.indexOf("=")<0)return null;try{const H=O($),B=Object.fromEntries(new URLSearchParams(H));if(B.code||B.error||B.error_description||B.state)return B}catch{throw(0,E.zP)(p.b4)}return null}},5861:(fe,F,S)=>{"use strict";function E(O,R,$,H,B,g,M){try{var D=O[g](M),V=D.value}catch(J){return void $(J)}D.done?R(V):Promise.resolve(V).then(H,B)}function p(O){return function(){var R=this,$=arguments;return new Promise(function(H,B){var g=O.apply(R,$);function M(V){E(g,H,B,M,D,"next",V)}function D(V){E(g,H,B,M,D,"throw",V)}M(void 0)})}}S.d(F,{Z:()=>p})},7582:(fe,F,S)=>{"use strict";S.r(F),S.d(F,{__addDisposableResource:()=>ze,__assign:()=>O,__asyncDelegator:()=>te,__asyncGenerator:()=>q,__asyncValues:()=>se,__await:()=>U,__awaiter:()=>J,__classPrivateFieldGet:()=>Ee,__classPrivateFieldIn:()=>Be,__classPrivateFieldSet:()=>He,__createBinding:()=>C,__decorate:()=>$,__disposeResources:()=>G,__esDecorate:()=>B,__exportStar:()=>k,__extends:()=>p,__generator:()=>z,__importDefault:()=>De,__importStar:()=>me,__makeTemplateObject:()=>ie,__metadata:()=>V,__param:()=>H,__propKey:()=>M,__read:()=>w,__rest:()=>R,__runInitializers:()=>g,__setFunctionName:()=>D,__spread:()=>j,__spreadArray:()=>b,__spreadArrays:()=>_,__values:()=>K,default:()=>oe});var E=function(ee,ue){return(E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,T){m.__proto__=T}||function(m,T){for(var N in T)Object.prototype.hasOwnProperty.call(T,N)&&(m[N]=T[N])})(ee,ue)};function p(ee,ue){if("function"!=typeof ue&&null!==ue)throw new TypeError("Class extends value "+String(ue)+" is not a constructor or null");function m(){this.constructor=ee}E(ee,ue),ee.prototype=null===ue?Object.create(ue):(m.prototype=ue.prototype,new m)}var O=function(){return O=Object.assign||function(ue){for(var m,T=1,N=arguments.length;T<N;T++)for(var le in m=arguments[T])Object.prototype.hasOwnProperty.call(m,le)&&(ue[le]=m[le]);return ue},O.apply(this,arguments)};function R(ee,ue){var m={};for(var T in ee)Object.prototype.hasOwnProperty.call(ee,T)&&ue.indexOf(T)<0&&(m[T]=ee[T]);if(null!=ee&&"function"==typeof Object.getOwnPropertySymbols){var N=0;for(T=Object.getOwnPropertySymbols(ee);N<T.length;N++)ue.indexOf(T[N])<0&&Object.prototype.propertyIsEnumerable.call(ee,T[N])&&(m[T[N]]=ee[T[N]])}return m}function $(ee,ue,m,T){var Ce,N=arguments.length,le=N<3?ue:null===T?T=Object.getOwnPropertyDescriptor(ue,m):T;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)le=Reflect.decorate(ee,ue,m,T);else for(var Me=ee.length-1;Me>=0;Me--)(Ce=ee[Me])&&(le=(N<3?Ce(le):N>3?Ce(ue,m,le):Ce(ue,m))||le);return N>3&&le&&Object.defineProperty(ue,m,le),le}function H(ee,ue){return function(m,T){ue(m,T,ee)}}function B(ee,ue,m,T,N,le){function Ce(ur){if(void 0!==ur&&"function"!=typeof ur)throw new TypeError("Function expected");return ur}for(var ft,Me=T.kind,Ke="getter"===Me?"get":"setter"===Me?"set":"value",be=!ue&&ee?T.static?ee:ee.prototype:null,xe=ue||(be?Object.getOwnPropertyDescriptor(be,T.name):{}),Ge=!1,tn=m.length-1;tn>=0;tn--){var qt={};for(var ut in T)qt[ut]="access"===ut?{}:T[ut];for(var ut in T.access)qt.access[ut]=T.access[ut];qt.addInitializer=function(ur){if(Ge)throw new TypeError("Cannot add initializers after decoration has completed");le.push(Ce(ur||null))};var tt=(0,m[tn])("accessor"===Me?{get:xe.get,set:xe.set}:xe[Ke],qt);if("accessor"===Me){if(void 0===tt)continue;if(null===tt||"object"!=typeof tt)throw new TypeError("Object expected");(ft=Ce(tt.get))&&(xe.get=ft),(ft=Ce(tt.set))&&(xe.set=ft),(ft=Ce(tt.init))&&N.unshift(ft)}else(ft=Ce(tt))&&("field"===Me?N.unshift(ft):xe[Ke]=ft)}be&&Object.defineProperty(be,T.name,xe),Ge=!0}function g(ee,ue,m){for(var T=arguments.length>2,N=0;N<ue.length;N++)m=T?ue[N].call(ee,m):ue[N].call(ee);return T?m:void 0}function M(ee){return"symbol"==typeof ee?ee:"".concat(ee)}function D(ee,ue,m){return"symbol"==typeof ue&&(ue=ue.description?"[".concat(ue.description,"]"):""),Object.defineProperty(ee,"name",{configurable:!0,value:m?"".concat(m," ",ue):ue})}function V(ee,ue){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(ee,ue)}function J(ee,ue,m,T){return new(m||(m=Promise))(function(le,Ce){function Me(xe){try{be(T.next(xe))}catch(ft){Ce(ft)}}function Ke(xe){try{be(T.throw(xe))}catch(ft){Ce(ft)}}function be(xe){xe.done?le(xe.value):function N(le){return le instanceof m?le:new m(function(Ce){Ce(le)})}(xe.value).then(Me,Ke)}be((T=T.apply(ee,ue||[])).next())})}function z(ee,ue){var T,N,le,Ce,m={label:0,sent:function(){if(1&le[0])throw le[1];return le[1]},trys:[],ops:[]};return Ce={next:Me(0),throw:Me(1),return:Me(2)},"function"==typeof Symbol&&(Ce[Symbol.iterator]=function(){return this}),Ce;function Me(be){return function(xe){return function Ke(be){if(T)throw new TypeError("Generator is already executing.");for(;Ce&&(Ce=0,be[0]&&(m=0)),m;)try{if(T=1,N&&(le=2&be[0]?N.return:be[0]?N.throw||((le=N.return)&&le.call(N),0):N.next)&&!(le=le.call(N,be[1])).done)return le;switch(N=0,le&&(be=[2&be[0],le.value]),be[0]){case 0:case 1:le=be;break;case 4:return m.label++,{value:be[1],done:!1};case 5:m.label++,N=be[1],be=[0];continue;case 7:be=m.ops.pop(),m.trys.pop();continue;default:if(!(le=(le=m.trys).length>0&&le[le.length-1])&&(6===be[0]||2===be[0])){m=0;continue}if(3===be[0]&&(!le||be[1]>le[0]&&be[1]<le[3])){m.label=be[1];break}if(6===be[0]&&m.label<le[1]){m.label=le[1],le=be;break}if(le&&m.label<le[2]){m.label=le[2],m.ops.push(be);break}le[2]&&m.ops.pop(),m.trys.pop();continue}be=ue.call(ee,m)}catch(xe){be=[6,xe],N=0}finally{T=le=0}if(5&be[0])throw be[1];return{value:be[0]?be[1]:void 0,done:!0}}([be,xe])}}}var C=Object.create?function(ee,ue,m,T){void 0===T&&(T=m);var N=Object.getOwnPropertyDescriptor(ue,m);(!N||("get"in N?!ue.__esModule:N.writable||N.configurable))&&(N={enumerable:!0,get:function(){return ue[m]}}),Object.defineProperty(ee,T,N)}:function(ee,ue,m,T){void 0===T&&(T=m),ee[T]=ue[m]};function k(ee,ue){for(var m in ee)"default"!==m&&!Object.prototype.hasOwnProperty.call(ue,m)&&C(ue,ee,m)}function K(ee){var ue="function"==typeof Symbol&&Symbol.iterator,m=ue&&ee[ue],T=0;if(m)return m.call(ee);if(ee&&"number"==typeof ee.length)return{next:function(){return ee&&T>=ee.length&&(ee=void 0),{value:ee&&ee[T++],done:!ee}}};throw new TypeError(ue?"Object is not iterable.":"Symbol.iterator is not defined.")}function w(ee,ue){var m="function"==typeof Symbol&&ee[Symbol.iterator];if(!m)return ee;var N,Ce,T=m.call(ee),le=[];try{for(;(void 0===ue||ue-- >0)&&!(N=T.next()).done;)le.push(N.value)}catch(Me){Ce={error:Me}}finally{try{N&&!N.done&&(m=T.return)&&m.call(T)}finally{if(Ce)throw Ce.error}}return le}function j(){for(var ee=[],ue=0;ue<arguments.length;ue++)ee=ee.concat(w(arguments[ue]));return ee}function _(){for(var ee=0,ue=0,m=arguments.length;ue<m;ue++)ee+=arguments[ue].length;var T=Array(ee),N=0;for(ue=0;ue<m;ue++)for(var le=arguments[ue],Ce=0,Me=le.length;Ce<Me;Ce++,N++)T[N]=le[Ce];return T}function b(ee,ue,m){if(m||2===arguments.length)for(var le,T=0,N=ue.length;T<N;T++)(le||!(T in ue))&&(le||(le=Array.prototype.slice.call(ue,0,T)),le[T]=ue[T]);return ee.concat(le||Array.prototype.slice.call(ue))}function U(ee){return this instanceof U?(this.v=ee,this):new U(ee)}function q(ee,ue,m){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var N,T=m.apply(ee,ue||[]),le=[];return N={},Ce("next"),Ce("throw"),Ce("return"),N[Symbol.asyncIterator]=function(){return this},N;function Ce(Ge){T[Ge]&&(N[Ge]=function(tn){return new Promise(function(qt,ut){le.push([Ge,tn,qt,ut])>1||Me(Ge,tn)})})}function Me(Ge,tn){try{!function Ke(Ge){Ge.value instanceof U?Promise.resolve(Ge.value.v).then(be,xe):ft(le[0][2],Ge)}(T[Ge](tn))}catch(qt){ft(le[0][3],qt)}}function be(Ge){Me("next",Ge)}function xe(Ge){Me("throw",Ge)}function ft(Ge,tn){Ge(tn),le.shift(),le.length&&Me(le[0][0],le[0][1])}}function te(ee){var ue,m;return ue={},T("next"),T("throw",function(N){throw N}),T("return"),ue[Symbol.iterator]=function(){return this},ue;function T(N,le){ue[N]=ee[N]?function(Ce){return(m=!m)?{value:U(ee[N](Ce)),done:!1}:le?le(Ce):Ce}:le}}function se(ee){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var m,ue=ee[Symbol.asyncIterator];return ue?ue.call(ee):(ee=K(ee),m={},T("next"),T("throw"),T("return"),m[Symbol.asyncIterator]=function(){return this},m);function T(le){m[le]=ee[le]&&function(Ce){return new Promise(function(Me,Ke){!function N(le,Ce,Me,Ke){Promise.resolve(Ke).then(function(be){le({value:be,done:Me})},Ce)}(Me,Ke,(Ce=ee[le](Ce)).done,Ce.value)})}}}function ie(ee,ue){return Object.defineProperty?Object.defineProperty(ee,"raw",{value:ue}):ee.raw=ue,ee}var ce=Object.create?function(ee,ue){Object.defineProperty(ee,"default",{enumerable:!0,value:ue})}:function(ee,ue){ee.default=ue};function me(ee){if(ee&&ee.__esModule)return ee;var ue={};if(null!=ee)for(var m in ee)"default"!==m&&Object.prototype.hasOwnProperty.call(ee,m)&&C(ue,ee,m);return ce(ue,ee),ue}function De(ee){return ee&&ee.__esModule?ee:{default:ee}}function Ee(ee,ue,m,T){if("a"===m&&!T)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof ue?ee!==ue||!T:!ue.has(ee))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===m?T:"a"===m?T.call(ee):T?T.value:ue.get(ee)}function He(ee,ue,m,T,N){if("m"===T)throw new TypeError("Private method is not writable");if("a"===T&&!N)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof ue?ee!==ue||!N:!ue.has(ee))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===T?N.call(ee,m):N?N.value=m:ue.set(ee,m),m}function Be(ee,ue){if(null===ue||"object"!=typeof ue&&"function"!=typeof ue)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof ee?ue===ee:ee.has(ue)}function ze(ee,ue,m){if(null!=ue){if("object"!=typeof ue&&"function"!=typeof ue)throw new TypeError("Object expected.");var T;if(m){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");T=ue[Symbol.asyncDispose]}if(void 0===T){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");T=ue[Symbol.dispose]}if("function"!=typeof T)throw new TypeError("Object not disposable.");ee.stack.push({value:ue,dispose:T,async:m})}else m&&ee.stack.push({async:!0});return ue}var pe="function"==typeof SuppressedError?SuppressedError:function(ee,ue,m){var T=new Error(m);return T.name="SuppressedError",T.error=ee,T.suppressed=ue,T};function G(ee){function ue(T){ee.error=ee.hasError?new pe(T,ee.error,"An error was suppressed during disposal."):T,ee.hasError=!0}return function m(){for(;ee.stack.length;){var T=ee.stack.pop();try{var N=T.dispose&&T.dispose.call(T.value);if(T.async)return Promise.resolve(N).then(m,function(le){return ue(le),m()})}catch(le){ue(le)}}if(ee.hasError)throw ee.error}()}const oe={__extends:p,__assign:O,__rest:R,__decorate:$,__param:H,__metadata:V,__awaiter:J,__generator:z,__createBinding:C,__exportStar:k,__values:K,__read:w,__spread:j,__spreadArrays:_,__spreadArray:b,__await:U,__asyncGenerator:q,__asyncDelegator:te,__asyncValues:se,__makeTemplateObject:ie,__importStar:me,__importDefault:De,__classPrivateFieldGet:Ee,__classPrivateFieldSet:He,__classPrivateFieldIn:Be,__addDisposableResource:ze,__disposeResources:G}}},fe=>{fe(fe.s=4423)}]);